Number of devices: 2
batch_size_per_replica: 250
batch_size: 500 = 250 * 2
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
60000 10000
Epoch 1/20
 1/96 [..............................] - ETA: 6:02 - loss: 106.5698 - accuracy: 0.136015/96 [===>..........................] - ETA: 0s - loss: 55.7963 - accuracy: 0.3885   30/96 [========>.....................] - ETA: 0s - loss: 39.3161 - accuracy: 0.506045/96 [=============>................] - ETA: 0s - loss: 31.1703 - accuracy: 0.571459/96 [=================>............] - ETA: 0s - loss: 26.4617 - accuracy: 0.610274/96 [======================>.......] - ETA: 0s - loss: 22.9643 - accuracy: 0.637888/96 [==========================>...] - ETA: 0s - loss: 20.5496 - accuracy: 0.655096/96 [==============================] - 6s 22ms/step - loss: 19.2882 - accuracy: 0.6635 - val_loss: 0.9826 - val_accuracy: 0.7587
Epoch 2/20
 1/96 [..............................] - ETA: 0s - loss: 0.8283 - accuracy: 0.754015/96 [===>..........................] - ETA: 0s - loss: 0.9017 - accuracy: 0.759930/96 [========>.....................] - ETA: 0s - loss: 0.8655 - accuracy: 0.773544/96 [============>.................] - ETA: 0s - loss: 0.8389 - accuracy: 0.782258/96 [=================>............] - ETA: 0s - loss: 0.8224 - accuracy: 0.788473/96 [=====================>........] - ETA: 0s - loss: 0.8098 - accuracy: 0.793287/96 [==========================>...] - ETA: 0s - loss: 0.8004 - accuracy: 0.797096/96 [==============================] - 1s 6ms/step - loss: 0.7943 - accuracy: 0.7994 - val_loss: 0.6446 - val_accuracy: 0.8564
Epoch 3/20
 1/96 [..............................] - ETA: 0s - loss: 0.6099 - accuracy: 0.828015/96 [===>..........................] - ETA: 0s - loss: 0.5564 - accuracy: 0.847529/96 [========>.....................] - ETA: 0s - loss: 0.5458 - accuracy: 0.852543/96 [============>.................] - ETA: 0s - loss: 0.5360 - accuracy: 0.856658/96 [=================>............] - ETA: 0s - loss: 0.5318 - accuracy: 0.859472/96 [=====================>........] - ETA: 0s - loss: 0.5289 - accuracy: 0.861086/96 [=========================>....] - ETA: 0s - loss: 0.5264 - accuracy: 0.862496/96 [==============================] - 1s 5ms/step - loss: 0.5243 - accuracy: 0.8633 - val_loss: 0.5283 - val_accuracy: 0.8888
Epoch 4/20
 1/96 [..............................] - ETA: 0s - loss: 0.3955 - accuracy: 0.884015/96 [===>..........................] - ETA: 0s - loss: 0.3847 - accuracy: 0.889630/96 [========>.....................] - ETA: 0s - loss: 0.3874 - accuracy: 0.891445/96 [=============>................] - ETA: 0s - loss: 0.3908 - accuracy: 0.892259/96 [=================>............] - ETA: 0s - loss: 0.3913 - accuracy: 0.893174/96 [======================>.......] - ETA: 0s - loss: 0.3901 - accuracy: 0.894089/96 [==========================>...] - ETA: 0s - loss: 0.3886 - accuracy: 0.894896/96 [==============================] - 1s 6ms/step - loss: 0.3880 - accuracy: 0.8951 - val_loss: 0.4833 - val_accuracy: 0.9012
Epoch 5/20
 1/96 [..............................] - ETA: 0s - loss: 0.2706 - accuracy: 0.912015/96 [===>..........................] - ETA: 0s - loss: 0.2969 - accuracy: 0.912830/96 [========>.....................] - ETA: 0s - loss: 0.3031 - accuracy: 0.913445/96 [=============>................] - ETA: 0s - loss: 0.3028 - accuracy: 0.914359/96 [=================>............] - ETA: 0s - loss: 0.3022 - accuracy: 0.914873/96 [=====================>........] - ETA: 0s - loss: 0.3020 - accuracy: 0.915188/96 [==========================>...] - ETA: 0s - loss: 0.3022 - accuracy: 0.915496/96 [==============================] - 1s 5ms/step - loss: 0.3021 - accuracy: 0.9155 - val_loss: 0.4531 - val_accuracy: 0.9093
Epoch 6/20
 1/96 [..............................] - ETA: 0s - loss: 0.2200 - accuracy: 0.926015/96 [===>..........................] - ETA: 0s - loss: 0.2859 - accuracy: 0.919430/96 [========>.....................] - ETA: 0s - loss: 0.2768 - accuracy: 0.921044/96 [============>.................] - ETA: 0s - loss: 0.2714 - accuracy: 0.922359/96 [=================>............] - ETA: 0s - loss: 0.2668 - accuracy: 0.923674/96 [======================>.......] - ETA: 0s - loss: 0.2636 - accuracy: 0.924688/96 [==========================>...] - ETA: 0s - loss: 0.2620 - accuracy: 0.925196/96 [==============================] - 1s 5ms/step - loss: 0.2613 - accuracy: 0.9254 - val_loss: 0.4263 - val_accuracy: 0.9143
Epoch 7/20
 1/96 [..............................] - ETA: 0s - loss: 0.1783 - accuracy: 0.952015/96 [===>..........................] - ETA: 0s - loss: 0.2246 - accuracy: 0.935229/96 [========>.....................] - ETA: 0s - loss: 0.2245 - accuracy: 0.935143/96 [============>.................] - ETA: 0s - loss: 0.2240 - accuracy: 0.935157/96 [================>.............] - ETA: 0s - loss: 0.2231 - accuracy: 0.935571/96 [=====================>........] - ETA: 0s - loss: 0.2219 - accuracy: 0.935984/96 [=========================>....] - ETA: 0s - loss: 0.2212 - accuracy: 0.936296/96 [==============================] - 1s 6ms/step - loss: 0.2210 - accuracy: 0.9363 - val_loss: 0.4140 - val_accuracy: 0.9263
Epoch 8/20
 1/96 [..............................] - ETA: 0s - loss: 0.3042 - accuracy: 0.926015/96 [===>..........................] - ETA: 0s - loss: 0.1969 - accuracy: 0.945929/96 [========>.....................] - ETA: 0s - loss: 0.1899 - accuracy: 0.947243/96 [============>.................] - ETA: 0s - loss: 0.1878 - accuracy: 0.947257/96 [================>.............] - ETA: 0s - loss: 0.1877 - accuracy: 0.946871/96 [=====================>........] - ETA: 0s - loss: 0.1878 - accuracy: 0.946585/96 [=========================>....] - ETA: 0s - loss: 0.1880 - accuracy: 0.946396/96 [==============================] - 1s 6ms/step - loss: 0.1879 - accuracy: 0.9462 - val_loss: 0.4070 - val_accuracy: 0.9283
Epoch 9/20
 1/96 [..............................] - ETA: 0s - loss: 0.1568 - accuracy: 0.946015/96 [===>..........................] - ETA: 0s - loss: 0.1608 - accuracy: 0.950029/96 [========>.....................] - ETA: 0s - loss: 0.1613 - accuracy: 0.950144/96 [============>.................] - ETA: 0s - loss: 0.1606 - accuracy: 0.950558/96 [=================>............] - ETA: 0s - loss: 0.1603 - accuracy: 0.950772/96 [=====================>........] - ETA: 0s - loss: 0.1608 - accuracy: 0.950886/96 [=========================>....] - ETA: 0s - loss: 0.1610 - accuracy: 0.950996/96 [==============================] - 1s 5ms/step - loss: 0.1611 - accuracy: 0.9509 - val_loss: 0.3943 - val_accuracy: 0.9303
Epoch 10/20
 1/96 [..............................] - ETA: 0s - loss: 0.1311 - accuracy: 0.958016/96 [====>.........................] - ETA: 0s - loss: 0.1508 - accuracy: 0.953930/96 [========>.....................] - ETA: 0s - loss: 0.1474 - accuracy: 0.955044/96 [============>.................] - ETA: 0s - loss: 0.1458 - accuracy: 0.955558/96 [=================>............] - ETA: 0s - loss: 0.1449 - accuracy: 0.955872/96 [=====================>........] - ETA: 0s - loss: 0.1450 - accuracy: 0.955887/96 [==========================>...] - ETA: 0s - loss: 0.1455 - accuracy: 0.955696/96 [==============================] - 1s 6ms/step - loss: 0.1458 - accuracy: 0.9556 - val_loss: 0.3943 - val_accuracy: 0.9331
Epoch 11/20
 1/96 [..............................] - ETA: 0s - loss: 0.1249 - accuracy: 0.956015/96 [===>..........................] - ETA: 0s - loss: 0.1424 - accuracy: 0.954729/96 [========>.....................] - ETA: 0s - loss: 0.1384 - accuracy: 0.956343/96 [============>.................] - ETA: 0s - loss: 0.1355 - accuracy: 0.957657/96 [================>.............] - ETA: 0s - loss: 0.1342 - accuracy: 0.958271/96 [=====================>........] - ETA: 0s - loss: 0.1330 - accuracy: 0.958685/96 [=========================>....] - ETA: 0s - loss: 0.1322 - accuracy: 0.958996/96 [==============================] - 1s 5ms/step - loss: 0.1318 - accuracy: 0.9591 - val_loss: 0.3803 - val_accuracy: 0.9362
Epoch 12/20
 1/96 [..............................] - ETA: 0s - loss: 0.1108 - accuracy: 0.964016/96 [====>.........................] - ETA: 0s - loss: 0.1187 - accuracy: 0.965730/96 [========>.....................] - ETA: 0s - loss: 0.1143 - accuracy: 0.966044/96 [============>.................] - ETA: 0s - loss: 0.1140 - accuracy: 0.965858/96 [=================>............] - ETA: 0s - loss: 0.1142 - accuracy: 0.965672/96 [=====================>........] - ETA: 0s - loss: 0.1144 - accuracy: 0.965386/96 [=========================>....] - ETA: 0s - loss: 0.1147 - accuracy: 0.965296/96 [==============================] - 1s 5ms/step - loss: 0.1148 - accuracy: 0.9651 - val_loss: 0.3710 - val_accuracy: 0.9394
Epoch 13/20
 1/96 [..............................] - ETA: 0s - loss: 0.1079 - accuracy: 0.966015/96 [===>..........................] - ETA: 0s - loss: 0.1002 - accuracy: 0.966329/96 [========>.....................] - ETA: 0s - loss: 0.1026 - accuracy: 0.966144/96 [============>.................] - ETA: 0s - loss: 0.1031 - accuracy: 0.966358/96 [=================>............] - ETA: 0s - loss: 0.1025 - accuracy: 0.966672/96 [=====================>........] - ETA: 0s - loss: 0.1023 - accuracy: 0.966886/96 [=========================>....] - ETA: 0s - loss: 0.1019 - accuracy: 0.967096/96 [==============================] - 1s 5ms/step - loss: 0.1018 - accuracy: 0.9671 - val_loss: 0.3664 - val_accuracy: 0.9387
Epoch 14/20
 1/96 [..............................] - ETA: 0s - loss: 0.1148 - accuracy: 0.968015/96 [===>..........................] - ETA: 0s - loss: 0.1052 - accuracy: 0.965929/96 [========>.....................] - ETA: 0s - loss: 0.0996 - accuracy: 0.967144/96 [============>.................] - ETA: 0s - loss: 0.0972 - accuracy: 0.967958/96 [=================>............] - ETA: 0s - loss: 0.0958 - accuracy: 0.968472/96 [=====================>........] - ETA: 0s - loss: 0.0947 - accuracy: 0.968986/96 [=========================>....] - ETA: 0s - loss: 0.0942 - accuracy: 0.969196/96 [==============================] - 1s 5ms/step - loss: 0.0940 - accuracy: 0.9693 - val_loss: 0.3571 - val_accuracy: 0.9439
Epoch 15/20
 1/96 [..............................] - ETA: 0s - loss: 0.0884 - accuracy: 0.972015/96 [===>..........................] - ETA: 0s - loss: 0.0832 - accuracy: 0.973630/96 [========>.....................] - ETA: 0s - loss: 0.0803 - accuracy: 0.974544/96 [============>.................] - ETA: 0s - loss: 0.0794 - accuracy: 0.974458/96 [=================>............] - ETA: 0s - loss: 0.0791 - accuracy: 0.974372/96 [=====================>........] - ETA: 0s - loss: 0.0793 - accuracy: 0.974386/96 [=========================>....] - ETA: 0s - loss: 0.0797 - accuracy: 0.974296/96 [==============================] - 1s 5ms/step - loss: 0.0801 - accuracy: 0.9741 - val_loss: 0.3432 - val_accuracy: 0.9456
Epoch 16/20
 1/96 [..............................] - ETA: 0s - loss: 0.0979 - accuracy: 0.964015/96 [===>..........................] - ETA: 0s - loss: 0.0800 - accuracy: 0.972130/96 [========>.....................] - ETA: 0s - loss: 0.0773 - accuracy: 0.973344/96 [============>.................] - ETA: 0s - loss: 0.0760 - accuracy: 0.974058/96 [=================>............] - ETA: 0s - loss: 0.0751 - accuracy: 0.974672/96 [=====================>........] - ETA: 0s - loss: 0.0746 - accuracy: 0.974987/96 [==========================>...] - ETA: 0s - loss: 0.0746 - accuracy: 0.975096/96 [==============================] - 1s 5ms/step - loss: 0.0748 - accuracy: 0.9750 - val_loss: 0.3683 - val_accuracy: 0.9494
Epoch 17/20
 1/96 [..............................] - ETA: 0s - loss: 0.0448 - accuracy: 0.984015/96 [===>..........................] - ETA: 0s - loss: 0.0574 - accuracy: 0.978429/96 [========>.....................] - ETA: 0s - loss: 0.0636 - accuracy: 0.977443/96 [============>.................] - ETA: 0s - loss: 0.0661 - accuracy: 0.977358/96 [=================>............] - ETA: 0s - loss: 0.0678 - accuracy: 0.977273/96 [=====================>........] - ETA: 0s - loss: 0.0691 - accuracy: 0.977288/96 [==========================>...] - ETA: 0s - loss: 0.0700 - accuracy: 0.977196/96 [==============================] - 1s 6ms/step - loss: 0.0704 - accuracy: 0.9771 - val_loss: 0.3510 - val_accuracy: 0.9513
Epoch 18/20
 1/96 [..............................] - ETA: 0s - loss: 0.0486 - accuracy: 0.978016/96 [====>.........................] - ETA: 0s - loss: 0.0606 - accuracy: 0.981230/96 [========>.....................] - ETA: 0s - loss: 0.0628 - accuracy: 0.980444/96 [============>.................] - ETA: 0s - loss: 0.0631 - accuracy: 0.980258/96 [=================>............] - ETA: 0s - loss: 0.0639 - accuracy: 0.979873/96 [=====================>........] - ETA: 0s - loss: 0.0646 - accuracy: 0.979587/96 [==========================>...] - ETA: 0s - loss: 0.0652 - accuracy: 0.979396/96 [==============================] - 1s 5ms/step - loss: 0.0657 - accuracy: 0.9791 - val_loss: 0.3232 - val_accuracy: 0.9491
Epoch 19/20
 1/96 [..............................] - ETA: 0s - loss: 0.0636 - accuracy: 0.982015/96 [===>..........................] - ETA: 0s - loss: 0.0619 - accuracy: 0.980629/96 [========>.....................] - ETA: 0s - loss: 0.0627 - accuracy: 0.979743/96 [============>.................] - ETA: 0s - loss: 0.0626 - accuracy: 0.979458/96 [=================>............] - ETA: 0s - loss: 0.0629 - accuracy: 0.979373/96 [=====================>........] - ETA: 0s - loss: 0.0631 - accuracy: 0.979388/96 [==========================>...] - ETA: 0s - loss: 0.0632 - accuracy: 0.979296/96 [==============================] - 1s 6ms/step - loss: 0.0634 - accuracy: 0.9792 - val_loss: 0.3264 - val_accuracy: 0.9507
Epoch 20/20
 1/96 [..............................] - ETA: 0s - loss: 0.0620 - accuracy: 0.972015/96 [===>..........................] - ETA: 0s - loss: 0.0681 - accuracy: 0.977029/96 [========>.....................] - ETA: 0s - loss: 0.0686 - accuracy: 0.977143/96 [============>.................] - ETA: 0s - loss: 0.0689 - accuracy: 0.977257/96 [================>.............] - ETA: 0s - loss: 0.0701 - accuracy: 0.977271/96 [=====================>........] - ETA: 0s - loss: 0.0715 - accuracy: 0.977085/96 [=========================>....] - ETA: 0s - loss: 0.0725 - accuracy: 0.976996/96 [==============================] - 1s 5ms/step - loss: 0.0729 - accuracy: 0.9769 - val_loss: 0.3523 - val_accuracy: 0.9534
training_time: 0:00:16.188696
  1/313 [..............................] - ETA: 7:49 - loss: 0.1460 - accuracy: 0.9688 15/313 [>.............................] - ETA: 1s - loss: 0.4448 - accuracy: 0.9417   29/313 [=>............................] - ETA: 1s - loss: 0.3783 - accuracy: 0.9429 43/313 [===>..........................] - ETA: 1s - loss: 0.5141 - accuracy: 0.9288 56/313 [====>.........................] - ETA: 0s - loss: 0.6188 - accuracy: 0.9252 69/313 [=====>........................] - ETA: 0s - loss: 0.6237 - accuracy: 0.9239 83/313 [======>.......................] - ETA: 0s - loss: 0.5889 - accuracy: 0.9255 96/313 [========>.....................] - ETA: 0s - loss: 0.5482 - accuracy: 0.9277110/313 [=========>....................] - ETA: 0s - loss: 0.5259 - accuracy: 0.9312124/313 [==========>...................] - ETA: 0s - loss: 0.5616 - accuracy: 0.9304138/313 [============>.................] - ETA: 0s - loss: 0.5574 - accuracy: 0.9298152/313 [=============>................] - ETA: 0s - loss: 0.5576 - accuracy: 0.9313166/313 [==============>...............] - ETA: 0s - loss: 0.5333 - accuracy: 0.9341180/313 [================>.............] - ETA: 0s - loss: 0.5119 - accuracy: 0.9370194/313 [=================>............] - ETA: 0s - loss: 0.5052 - accuracy: 0.9364208/313 [==================>...........] - ETA: 0s - loss: 0.4960 - accuracy: 0.9383222/313 [====================>.........] - ETA: 0s - loss: 0.4732 - accuracy: 0.9405236/313 [=====================>........] - ETA: 0s - loss: 0.4523 - accuracy: 0.9424249/313 [======================>.......] - ETA: 0s - loss: 0.4371 - accuracy: 0.9443262/313 [========================>.....] - ETA: 0s - loss: 0.4289 - accuracy: 0.9448276/313 [=========================>....] - ETA: 0s - loss: 0.4105 - accuracy: 0.9468290/313 [==========================>...] - ETA: 0s - loss: 0.4092 - accuracy: 0.9482304/313 [============================>.] - ETA: 0s - loss: 0.4025 - accuracy: 0.9487313/313 [==============================] - 3s 4ms/step - loss: 0.3989 - accuracy: 0.9479
Test results: Loss = 0.39891451597213745, Accuracy = 0.9478999972343445
