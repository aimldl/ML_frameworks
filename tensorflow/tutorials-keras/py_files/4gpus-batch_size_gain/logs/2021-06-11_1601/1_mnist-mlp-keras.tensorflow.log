Number of devices: 2
batch_size_per_replica: 250
batch_size: 500 = 250 * 2
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
60000 10000
Epoch 1/20
 1/96 [..............................] - ETA: 6:05 - loss: 83.6105 - accuracy: 0.090015/96 [===>..........................] - ETA: 0s - loss: 39.7884 - accuracy: 0.3687  29/96 [========>.....................] - ETA: 0s - loss: 28.1663 - accuracy: 0.439043/96 [============>.................] - ETA: 0s - loss: 22.3433 - accuracy: 0.464857/96 [================>.............] - ETA: 0s - loss: 18.7730 - accuracy: 0.481871/96 [=====================>........] - ETA: 0s - loss: 16.3283 - accuracy: 0.498285/96 [=========================>....] - ETA: 0s - loss: 14.5338 - accuracy: 0.514196/96 [==============================] - 6s 22ms/step - loss: 13.3293 - accuracy: 0.5270 - val_loss: 0.8605 - val_accuracy: 0.8100
Epoch 2/20
 1/96 [..............................] - ETA: 0s - loss: 0.8619 - accuracy: 0.810016/96 [====>.........................] - ETA: 0s - loss: 0.8668 - accuracy: 0.800231/96 [========>.....................] - ETA: 0s - loss: 0.8536 - accuracy: 0.800446/96 [=============>................] - ETA: 0s - loss: 0.8342 - accuracy: 0.803960/96 [=================>............] - ETA: 0s - loss: 0.8186 - accuracy: 0.807274/96 [======================>.......] - ETA: 0s - loss: 0.8062 - accuracy: 0.809989/96 [==========================>...] - ETA: 0s - loss: 0.7934 - accuracy: 0.812796/96 [==============================] - 1s 5ms/step - loss: 0.7871 - accuracy: 0.8141 - val_loss: 0.5734 - val_accuracy: 0.8683
Epoch 3/20
 1/96 [..............................] - ETA: 0s - loss: 0.6082 - accuracy: 0.852015/96 [===>..........................] - ETA: 0s - loss: 0.5637 - accuracy: 0.862729/96 [========>.....................] - ETA: 0s - loss: 0.5509 - accuracy: 0.865644/96 [============>.................] - ETA: 0s - loss: 0.5399 - accuracy: 0.867458/96 [=================>............] - ETA: 0s - loss: 0.5331 - accuracy: 0.868672/96 [=====================>........] - ETA: 0s - loss: 0.5270 - accuracy: 0.869986/96 [=========================>....] - ETA: 0s - loss: 0.5215 - accuracy: 0.871296/96 [==============================] - 1s 6ms/step - loss: 0.5177 - accuracy: 0.8721 - val_loss: 0.4773 - val_accuracy: 0.8967
Epoch 4/20
 1/96 [..............................] - ETA: 0s - loss: 0.4332 - accuracy: 0.894015/96 [===>..........................] - ETA: 0s - loss: 0.4171 - accuracy: 0.899529/96 [========>.....................] - ETA: 0s - loss: 0.4124 - accuracy: 0.897743/96 [============>.................] - ETA: 0s - loss: 0.4119 - accuracy: 0.897757/96 [================>.............] - ETA: 0s - loss: 0.4088 - accuracy: 0.898572/96 [=====================>........] - ETA: 0s - loss: 0.4057 - accuracy: 0.899387/96 [==========================>...] - ETA: 0s - loss: 0.4024 - accuracy: 0.900096/96 [==============================] - 1s 6ms/step - loss: 0.4000 - accuracy: 0.9006 - val_loss: 0.4381 - val_accuracy: 0.9079
Epoch 5/20
 1/96 [..............................] - ETA: 0s - loss: 0.2949 - accuracy: 0.928014/96 [===>..........................] - ETA: 0s - loss: 0.2722 - accuracy: 0.921028/96 [=======>......................] - ETA: 0s - loss: 0.2785 - accuracy: 0.920442/96 [============>.................] - ETA: 0s - loss: 0.2863 - accuracy: 0.919656/96 [================>.............] - ETA: 0s - loss: 0.2902 - accuracy: 0.919470/96 [====================>.........] - ETA: 0s - loss: 0.2926 - accuracy: 0.919584/96 [=========================>....] - ETA: 0s - loss: 0.2942 - accuracy: 0.919596/96 [==============================] - 1s 6ms/step - loss: 0.2950 - accuracy: 0.9195 - val_loss: 0.3943 - val_accuracy: 0.9247
Epoch 6/20
 1/96 [..............................] - ETA: 0s - loss: 0.1632 - accuracy: 0.950016/96 [====>.........................] - ETA: 0s - loss: 0.2268 - accuracy: 0.933431/96 [========>.....................] - ETA: 0s - loss: 0.2328 - accuracy: 0.933546/96 [=============>................] - ETA: 0s - loss: 0.2366 - accuracy: 0.933161/96 [==================>...........] - ETA: 0s - loss: 0.2393 - accuracy: 0.932975/96 [======================>.......] - ETA: 0s - loss: 0.2412 - accuracy: 0.932790/96 [===========================>..] - ETA: 0s - loss: 0.2424 - accuracy: 0.932696/96 [==============================] - 1s 6ms/step - loss: 0.2426 - accuracy: 0.9326 - val_loss: 0.3709 - val_accuracy: 0.9310
Epoch 7/20
 1/96 [..............................] - ETA: 0s - loss: 0.2331 - accuracy: 0.926015/96 [===>..........................] - ETA: 0s - loss: 0.1936 - accuracy: 0.942829/96 [========>.....................] - ETA: 0s - loss: 0.1963 - accuracy: 0.943643/96 [============>.................] - ETA: 0s - loss: 0.1995 - accuracy: 0.943258/96 [=================>............] - ETA: 0s - loss: 0.2025 - accuracy: 0.942673/96 [=====================>........] - ETA: 0s - loss: 0.2040 - accuracy: 0.942487/96 [==========================>...] - ETA: 0s - loss: 0.2047 - accuracy: 0.942396/96 [==============================] - 1s 5ms/step - loss: 0.2051 - accuracy: 0.9423 - val_loss: 0.3331 - val_accuracy: 0.9350
Epoch 8/20
 1/96 [..............................] - ETA: 0s - loss: 0.1973 - accuracy: 0.936015/96 [===>..........................] - ETA: 0s - loss: 0.1842 - accuracy: 0.946230/96 [========>.....................] - ETA: 0s - loss: 0.1832 - accuracy: 0.947944/96 [============>.................] - ETA: 0s - loss: 0.1819 - accuracy: 0.948658/96 [=================>............] - ETA: 0s - loss: 0.1811 - accuracy: 0.948872/96 [=====================>........] - ETA: 0s - loss: 0.1806 - accuracy: 0.948986/96 [=========================>....] - ETA: 0s - loss: 0.1799 - accuracy: 0.949196/96 [==============================] - 1s 6ms/step - loss: 0.1796 - accuracy: 0.9492 - val_loss: 0.3300 - val_accuracy: 0.9392
Epoch 9/20
 1/96 [..............................] - ETA: 0s - loss: 0.1569 - accuracy: 0.950016/96 [====>.........................] - ETA: 0s - loss: 0.1485 - accuracy: 0.957331/96 [========>.....................] - ETA: 0s - loss: 0.1473 - accuracy: 0.957746/96 [=============>................] - ETA: 0s - loss: 0.1474 - accuracy: 0.957761/96 [==================>...........] - ETA: 0s - loss: 0.1495 - accuracy: 0.957375/96 [======================>.......] - ETA: 0s - loss: 0.1511 - accuracy: 0.957090/96 [===========================>..] - ETA: 0s - loss: 0.1522 - accuracy: 0.956796/96 [==============================] - 1s 5ms/step - loss: 0.1526 - accuracy: 0.9566 - val_loss: 0.3188 - val_accuracy: 0.9396
Epoch 10/20
 1/96 [..............................] - ETA: 0s - loss: 0.1394 - accuracy: 0.954016/96 [====>.........................] - ETA: 0s - loss: 0.1249 - accuracy: 0.961031/96 [========>.....................] - ETA: 0s - loss: 0.1279 - accuracy: 0.960945/96 [=============>................] - ETA: 0s - loss: 0.1309 - accuracy: 0.960259/96 [=================>............] - ETA: 0s - loss: 0.1322 - accuracy: 0.959973/96 [=====================>........] - ETA: 0s - loss: 0.1338 - accuracy: 0.959687/96 [==========================>...] - ETA: 0s - loss: 0.1350 - accuracy: 0.959396/96 [==============================] - 1s 5ms/step - loss: 0.1356 - accuracy: 0.9592 - val_loss: 0.3194 - val_accuracy: 0.9489
Epoch 11/20
 1/96 [..............................] - ETA: 0s - loss: 0.0954 - accuracy: 0.968015/96 [===>..........................] - ETA: 0s - loss: 0.1046 - accuracy: 0.968429/96 [========>.....................] - ETA: 0s - loss: 0.1073 - accuracy: 0.967543/96 [============>.................] - ETA: 0s - loss: 0.1091 - accuracy: 0.966957/96 [================>.............] - ETA: 0s - loss: 0.1106 - accuracy: 0.966471/96 [=====================>........] - ETA: 0s - loss: 0.1117 - accuracy: 0.966186/96 [=========================>....] - ETA: 0s - loss: 0.1129 - accuracy: 0.965896/96 [==============================] - 1s 5ms/step - loss: 0.1138 - accuracy: 0.9656 - val_loss: 0.3131 - val_accuracy: 0.9481
Epoch 12/20
 1/96 [..............................] - ETA: 0s - loss: 0.1002 - accuracy: 0.968015/96 [===>..........................] - ETA: 0s - loss: 0.1087 - accuracy: 0.965130/96 [========>.....................] - ETA: 0s - loss: 0.1093 - accuracy: 0.965145/96 [=============>................] - ETA: 0s - loss: 0.1083 - accuracy: 0.965859/96 [=================>............] - ETA: 0s - loss: 0.1083 - accuracy: 0.966173/96 [=====================>........] - ETA: 0s - loss: 0.1083 - accuracy: 0.966387/96 [==========================>...] - ETA: 0s - loss: 0.1085 - accuracy: 0.966396/96 [==============================] - 1s 5ms/step - loss: 0.1088 - accuracy: 0.9663 - val_loss: 0.2975 - val_accuracy: 0.9497
Epoch 13/20
 1/96 [..............................] - ETA: 0s - loss: 0.1196 - accuracy: 0.964015/96 [===>..........................] - ETA: 0s - loss: 0.1007 - accuracy: 0.968029/96 [========>.....................] - ETA: 0s - loss: 0.0981 - accuracy: 0.969043/96 [============>.................] - ETA: 0s - loss: 0.0974 - accuracy: 0.969458/96 [=================>............] - ETA: 0s - loss: 0.0971 - accuracy: 0.969473/96 [=====================>........] - ETA: 0s - loss: 0.0977 - accuracy: 0.969387/96 [==========================>...] - ETA: 0s - loss: 0.0983 - accuracy: 0.969296/96 [==============================] - 1s 5ms/step - loss: 0.0989 - accuracy: 0.9691 - val_loss: 0.3053 - val_accuracy: 0.9457
Epoch 14/20
 1/96 [..............................] - ETA: 0s - loss: 0.0745 - accuracy: 0.970015/96 [===>..........................] - ETA: 0s - loss: 0.1037 - accuracy: 0.965729/96 [========>.....................] - ETA: 0s - loss: 0.1041 - accuracy: 0.967043/96 [============>.................] - ETA: 0s - loss: 0.1021 - accuracy: 0.968057/96 [================>.............] - ETA: 0s - loss: 0.1002 - accuracy: 0.968871/96 [=====================>........] - ETA: 0s - loss: 0.0987 - accuracy: 0.969386/96 [=========================>....] - ETA: 0s - loss: 0.0976 - accuracy: 0.969896/96 [==============================] - 1s 5ms/step - loss: 0.0970 - accuracy: 0.9700 - val_loss: 0.2770 - val_accuracy: 0.9552
Epoch 15/20
 1/96 [..............................] - ETA: 0s - loss: 0.0795 - accuracy: 0.974016/96 [====>.........................] - ETA: 0s - loss: 0.0740 - accuracy: 0.975431/96 [========>.....................] - ETA: 0s - loss: 0.0740 - accuracy: 0.975745/96 [=============>................] - ETA: 0s - loss: 0.0753 - accuracy: 0.975860/96 [=================>............] - ETA: 0s - loss: 0.0772 - accuracy: 0.975575/96 [======================>.......] - ETA: 0s - loss: 0.0782 - accuracy: 0.975389/96 [==========================>...] - ETA: 0s - loss: 0.0789 - accuracy: 0.975196/96 [==============================] - 1s 5ms/step - loss: 0.0793 - accuracy: 0.9750 - val_loss: 0.2919 - val_accuracy: 0.9576
Epoch 16/20
 1/96 [..............................] - ETA: 0s - loss: 0.0844 - accuracy: 0.968015/96 [===>..........................] - ETA: 0s - loss: 0.0776 - accuracy: 0.973129/96 [========>.....................] - ETA: 0s - loss: 0.0802 - accuracy: 0.972943/96 [============>.................] - ETA: 0s - loss: 0.0805 - accuracy: 0.973357/96 [================>.............] - ETA: 0s - loss: 0.0808 - accuracy: 0.973471/96 [=====================>........] - ETA: 0s - loss: 0.0813 - accuracy: 0.973485/96 [=========================>....] - ETA: 0s - loss: 0.0818 - accuracy: 0.973496/96 [==============================] - 1s 5ms/step - loss: 0.0822 - accuracy: 0.9734 - val_loss: 0.3311 - val_accuracy: 0.9552
Epoch 17/20
 1/96 [..............................] - ETA: 0s - loss: 0.0378 - accuracy: 0.986015/96 [===>..........................] - ETA: 0s - loss: 0.0655 - accuracy: 0.978429/96 [========>.....................] - ETA: 0s - loss: 0.0673 - accuracy: 0.978643/96 [============>.................] - ETA: 0s - loss: 0.0686 - accuracy: 0.978557/96 [================>.............] - ETA: 0s - loss: 0.0696 - accuracy: 0.978571/96 [=====================>........] - ETA: 0s - loss: 0.0703 - accuracy: 0.978385/96 [=========================>....] - ETA: 0s - loss: 0.0706 - accuracy: 0.978296/96 [==============================] - 1s 5ms/step - loss: 0.0706 - accuracy: 0.9782 - val_loss: 0.2926 - val_accuracy: 0.9571
Epoch 18/20
 1/96 [..............................] - ETA: 0s - loss: 0.0908 - accuracy: 0.974015/96 [===>..........................] - ETA: 0s - loss: 0.0685 - accuracy: 0.978829/96 [========>.....................] - ETA: 0s - loss: 0.0657 - accuracy: 0.979444/96 [============>.................] - ETA: 0s - loss: 0.0643 - accuracy: 0.979758/96 [=================>............] - ETA: 0s - loss: 0.0634 - accuracy: 0.979972/96 [=====================>........] - ETA: 0s - loss: 0.0627 - accuracy: 0.980186/96 [=========================>....] - ETA: 0s - loss: 0.0623 - accuracy: 0.980296/96 [==============================] - 1s 5ms/step - loss: 0.0624 - accuracy: 0.9801 - val_loss: 0.2952 - val_accuracy: 0.9567
Epoch 19/20
 1/96 [..............................] - ETA: 0s - loss: 0.0586 - accuracy: 0.980016/96 [====>.........................] - ETA: 0s - loss: 0.0639 - accuracy: 0.978131/96 [========>.....................] - ETA: 0s - loss: 0.0635 - accuracy: 0.978845/96 [=============>................] - ETA: 0s - loss: 0.0630 - accuracy: 0.979359/96 [=================>............] - ETA: 0s - loss: 0.0629 - accuracy: 0.979574/96 [======================>.......] - ETA: 0s - loss: 0.0633 - accuracy: 0.979589/96 [==========================>...] - ETA: 0s - loss: 0.0637 - accuracy: 0.979596/96 [==============================] - 1s 5ms/step - loss: 0.0641 - accuracy: 0.9794 - val_loss: 0.2981 - val_accuracy: 0.9582
Epoch 20/20
 1/96 [..............................] - ETA: 0s - loss: 0.0929 - accuracy: 0.970015/96 [===>..........................] - ETA: 0s - loss: 0.0754 - accuracy: 0.975730/96 [========>.....................] - ETA: 0s - loss: 0.0716 - accuracy: 0.977244/96 [============>.................] - ETA: 0s - loss: 0.0704 - accuracy: 0.977758/96 [=================>............] - ETA: 0s - loss: 0.0703 - accuracy: 0.978072/96 [=====================>........] - ETA: 0s - loss: 0.0701 - accuracy: 0.978187/96 [==========================>...] - ETA: 0s - loss: 0.0700 - accuracy: 0.978396/96 [==============================] - 1s 5ms/step - loss: 0.0700 - accuracy: 0.9783 - val_loss: 0.3004 - val_accuracy: 0.9589
training_time: 0:00:16.250872
  1/313 [..............................] - ETA: 7:57 - loss: 0.1957 - accuracy: 0.9688 14/313 [>.............................] - ETA: 1s - loss: 0.2539 - accuracy: 0.9643   28/313 [=>............................] - ETA: 1s - loss: 0.2219 - accuracy: 0.9621 42/313 [===>..........................] - ETA: 1s - loss: 0.2899 - accuracy: 0.9501 56/313 [====>.........................] - ETA: 0s - loss: 0.3371 - accuracy: 0.9453 70/313 [=====>........................] - ETA: 0s - loss: 0.3698 - accuracy: 0.9420 84/313 [=======>......................] - ETA: 0s - loss: 0.3931 - accuracy: 0.9435 98/313 [========>.....................] - ETA: 0s - loss: 0.3736 - accuracy: 0.9439112/313 [=========>....................] - ETA: 0s - loss: 0.3814 - accuracy: 0.9453126/313 [===========>..................] - ETA: 0s - loss: 0.4029 - accuracy: 0.9439140/313 [============>.................] - ETA: 0s - loss: 0.3892 - accuracy: 0.9438153/313 [=============>................] - ETA: 0s - loss: 0.4132 - accuracy: 0.9432167/313 [===============>..............] - ETA: 0s - loss: 0.3975 - accuracy: 0.9454181/313 [================>.............] - ETA: 0s - loss: 0.3893 - accuracy: 0.9477195/313 [=================>............] - ETA: 0s - loss: 0.3973 - accuracy: 0.9486209/313 [===================>..........] - ETA: 0s - loss: 0.3919 - accuracy: 0.9495223/313 [====================>.........] - ETA: 0s - loss: 0.3730 - accuracy: 0.9519236/313 [=====================>........] - ETA: 0s - loss: 0.3562 - accuracy: 0.9538249/313 [======================>.......] - ETA: 0s - loss: 0.3430 - accuracy: 0.9549262/313 [========================>.....] - ETA: 0s - loss: 0.3330 - accuracy: 0.9553276/313 [=========================>....] - ETA: 0s - loss: 0.3193 - accuracy: 0.9567290/313 [==========================>...] - ETA: 0s - loss: 0.3235 - accuracy: 0.9581304/313 [============================>.] - ETA: 0s - loss: 0.3161 - accuracy: 0.9587313/313 [==============================] - 3s 4ms/step - loss: 0.3209 - accuracy: 0.9574
Test results: Loss = 0.32094210386276245, Accuracy = 0.9574000239372253
