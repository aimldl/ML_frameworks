Number of devices: 2
batch_size_per_replica: 250
batch_size: 500 = 250 * 2
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
60000 10000
Epoch 1/20
 1/96 [..............................] - ETA: 6:04 - loss: 98.2896 - accuracy: 0.082015/96 [===>..........................] - ETA: 0s - loss: 46.1255 - accuracy: 0.3103  29/96 [========>.....................] - ETA: 0s - loss: 32.5696 - accuracy: 0.433543/96 [============>.................] - ETA: 0s - loss: 25.9005 - accuracy: 0.502958/96 [=================>............] - ETA: 0s - loss: 21.5602 - accuracy: 0.547073/96 [=====================>........] - ETA: 0s - loss: 18.6326 - accuracy: 0.574887/96 [==========================>...] - ETA: 0s - loss: 16.6286 - accuracy: 0.594496/96 [==============================] - 6s 21ms/step - loss: 15.4814 - accuracy: 0.6063 - val_loss: 0.8542 - val_accuracy: 0.8225
Epoch 2/20
 1/96 [..............................] - ETA: 0s - loss: 0.7517 - accuracy: 0.836015/96 [===>..........................] - ETA: 0s - loss: 0.7723 - accuracy: 0.827230/96 [========>.....................] - ETA: 0s - loss: 0.7605 - accuracy: 0.827044/96 [============>.................] - ETA: 0s - loss: 0.7488 - accuracy: 0.829358/96 [=================>............] - ETA: 0s - loss: 0.7398 - accuracy: 0.831273/96 [=====================>........] - ETA: 0s - loss: 0.7309 - accuracy: 0.833087/96 [==========================>...] - ETA: 0s - loss: 0.7236 - accuracy: 0.834696/96 [==============================] - 1s 6ms/step - loss: 0.7188 - accuracy: 0.8357 - val_loss: 0.5960 - val_accuracy: 0.8665
Epoch 3/20
 1/96 [..............................] - ETA: 0s - loss: 0.4807 - accuracy: 0.864015/96 [===>..........................] - ETA: 0s - loss: 0.4508 - accuracy: 0.873929/96 [========>.....................] - ETA: 0s - loss: 0.4600 - accuracy: 0.875243/96 [============>.................] - ETA: 0s - loss: 0.4632 - accuracy: 0.876157/96 [================>.............] - ETA: 0s - loss: 0.4632 - accuracy: 0.877271/96 [=====================>........] - ETA: 0s - loss: 0.4631 - accuracy: 0.878285/96 [=========================>....] - ETA: 0s - loss: 0.4622 - accuracy: 0.878896/96 [==============================] - 1s 6ms/step - loss: 0.4612 - accuracy: 0.8795 - val_loss: 0.5241 - val_accuracy: 0.8877
Epoch 4/20
 1/96 [..............................] - ETA: 0s - loss: 0.3609 - accuracy: 0.896015/96 [===>..........................] - ETA: 0s - loss: 0.3697 - accuracy: 0.894829/96 [========>.....................] - ETA: 0s - loss: 0.3710 - accuracy: 0.897243/96 [============>.................] - ETA: 0s - loss: 0.3702 - accuracy: 0.898657/96 [================>.............] - ETA: 0s - loss: 0.3681 - accuracy: 0.899671/96 [=====================>........] - ETA: 0s - loss: 0.3663 - accuracy: 0.900685/96 [=========================>....] - ETA: 0s - loss: 0.3649 - accuracy: 0.901496/96 [==============================] - 1s 6ms/step - loss: 0.3636 - accuracy: 0.9020 - val_loss: 0.4567 - val_accuracy: 0.9114
Epoch 5/20
 1/96 [..............................] - ETA: 0s - loss: 0.2132 - accuracy: 0.926015/96 [===>..........................] - ETA: 0s - loss: 0.2746 - accuracy: 0.921229/96 [========>.....................] - ETA: 0s - loss: 0.2753 - accuracy: 0.921843/96 [============>.................] - ETA: 0s - loss: 0.2759 - accuracy: 0.921857/96 [================>.............] - ETA: 0s - loss: 0.2766 - accuracy: 0.921771/96 [=====================>........] - ETA: 0s - loss: 0.2772 - accuracy: 0.921885/96 [=========================>....] - ETA: 0s - loss: 0.2776 - accuracy: 0.921996/96 [==============================] - 1s 6ms/step - loss: 0.2777 - accuracy: 0.9220 - val_loss: 0.4092 - val_accuracy: 0.9170
Epoch 6/20
 1/96 [..............................] - ETA: 0s - loss: 0.2094 - accuracy: 0.930015/96 [===>..........................] - ETA: 0s - loss: 0.2234 - accuracy: 0.931129/96 [========>.....................] - ETA: 0s - loss: 0.2248 - accuracy: 0.932143/96 [============>.................] - ETA: 0s - loss: 0.2266 - accuracy: 0.932157/96 [================>.............] - ETA: 0s - loss: 0.2267 - accuracy: 0.932571/96 [=====================>........] - ETA: 0s - loss: 0.2263 - accuracy: 0.933085/96 [=========================>....] - ETA: 0s - loss: 0.2264 - accuracy: 0.933496/96 [==============================] - 1s 5ms/step - loss: 0.2264 - accuracy: 0.9336 - val_loss: 0.3914 - val_accuracy: 0.9251
Epoch 7/20
 1/96 [..............................] - ETA: 0s - loss: 0.2150 - accuracy: 0.934015/96 [===>..........................] - ETA: 0s - loss: 0.1816 - accuracy: 0.945029/96 [========>.....................] - ETA: 0s - loss: 0.1780 - accuracy: 0.945643/96 [============>.................] - ETA: 0s - loss: 0.1777 - accuracy: 0.945757/96 [================>.............] - ETA: 0s - loss: 0.1783 - accuracy: 0.945671/96 [=====================>........] - ETA: 0s - loss: 0.1788 - accuracy: 0.945686/96 [=========================>....] - ETA: 0s - loss: 0.1801 - accuracy: 0.945596/96 [==============================] - 1s 5ms/step - loss: 0.1812 - accuracy: 0.9454 - val_loss: 0.3847 - val_accuracy: 0.9312
Epoch 8/20
 1/96 [..............................] - ETA: 0s - loss: 0.1562 - accuracy: 0.960015/96 [===>..........................] - ETA: 0s - loss: 0.1702 - accuracy: 0.950629/96 [========>.....................] - ETA: 0s - loss: 0.1693 - accuracy: 0.950143/96 [============>.................] - ETA: 0s - loss: 0.1676 - accuracy: 0.950357/96 [================>.............] - ETA: 0s - loss: 0.1670 - accuracy: 0.950271/96 [=====================>........] - ETA: 0s - loss: 0.1672 - accuracy: 0.950085/96 [=========================>....] - ETA: 0s - loss: 0.1671 - accuracy: 0.950096/96 [==============================] - 1s 6ms/step - loss: 0.1670 - accuracy: 0.9501 - val_loss: 0.3731 - val_accuracy: 0.9336
Epoch 9/20
 1/96 [..............................] - ETA: 0s - loss: 0.1516 - accuracy: 0.954015/96 [===>..........................] - ETA: 0s - loss: 0.1542 - accuracy: 0.953429/96 [========>.....................] - ETA: 0s - loss: 0.1518 - accuracy: 0.954243/96 [============>.................] - ETA: 0s - loss: 0.1496 - accuracy: 0.955157/96 [================>.............] - ETA: 0s - loss: 0.1497 - accuracy: 0.955371/96 [=====================>........] - ETA: 0s - loss: 0.1508 - accuracy: 0.955185/96 [=========================>....] - ETA: 0s - loss: 0.1517 - accuracy: 0.954996/96 [==============================] - 1s 5ms/step - loss: 0.1524 - accuracy: 0.9547 - val_loss: 0.3644 - val_accuracy: 0.9349
Epoch 10/20
 1/96 [..............................] - ETA: 0s - loss: 0.1506 - accuracy: 0.942015/96 [===>..........................] - ETA: 0s - loss: 0.1533 - accuracy: 0.948229/96 [========>.....................] - ETA: 0s - loss: 0.1493 - accuracy: 0.950543/96 [============>.................] - ETA: 0s - loss: 0.1450 - accuracy: 0.952158/96 [=================>............] - ETA: 0s - loss: 0.1429 - accuracy: 0.953273/96 [=====================>........] - ETA: 0s - loss: 0.1410 - accuracy: 0.954187/96 [==========================>...] - ETA: 0s - loss: 0.1398 - accuracy: 0.954896/96 [==============================] - 1s 5ms/step - loss: 0.1390 - accuracy: 0.9552 - val_loss: 0.3728 - val_accuracy: 0.9401
Epoch 11/20
 1/96 [..............................] - ETA: 0s - loss: 0.1177 - accuracy: 0.962015/96 [===>..........................] - ETA: 0s - loss: 0.1143 - accuracy: 0.963629/96 [========>.....................] - ETA: 0s - loss: 0.1141 - accuracy: 0.963443/96 [============>.................] - ETA: 0s - loss: 0.1142 - accuracy: 0.963357/96 [================>.............] - ETA: 0s - loss: 0.1134 - accuracy: 0.963671/96 [=====================>........] - ETA: 0s - loss: 0.1133 - accuracy: 0.963786/96 [=========================>....] - ETA: 0s - loss: 0.1135 - accuracy: 0.963796/96 [==============================] - 1s 5ms/step - loss: 0.1138 - accuracy: 0.9636 - val_loss: 0.3759 - val_accuracy: 0.9441
Epoch 12/20
 1/96 [..............................] - ETA: 0s - loss: 0.0960 - accuracy: 0.970015/96 [===>..........................] - ETA: 0s - loss: 0.1143 - accuracy: 0.966829/96 [========>.....................] - ETA: 0s - loss: 0.1163 - accuracy: 0.965043/96 [============>.................] - ETA: 0s - loss: 0.1177 - accuracy: 0.964057/96 [================>.............] - ETA: 0s - loss: 0.1192 - accuracy: 0.963671/96 [=====================>........] - ETA: 0s - loss: 0.1197 - accuracy: 0.963686/96 [=========================>....] - ETA: 0s - loss: 0.1198 - accuracy: 0.963796/96 [==============================] - 1s 5ms/step - loss: 0.1199 - accuracy: 0.9638 - val_loss: 0.3354 - val_accuracy: 0.9452
Epoch 13/20
 1/96 [..............................] - ETA: 0s - loss: 0.0694 - accuracy: 0.976015/96 [===>..........................] - ETA: 0s - loss: 0.0791 - accuracy: 0.971929/96 [========>.....................] - ETA: 0s - loss: 0.0832 - accuracy: 0.971443/96 [============>.................] - ETA: 0s - loss: 0.0875 - accuracy: 0.970757/96 [================>.............] - ETA: 0s - loss: 0.0903 - accuracy: 0.970271/96 [=====================>........] - ETA: 0s - loss: 0.0916 - accuracy: 0.970086/96 [=========================>....] - ETA: 0s - loss: 0.0925 - accuracy: 0.969996/96 [==============================] - 1s 6ms/step - loss: 0.0930 - accuracy: 0.9698 - val_loss: 0.3370 - val_accuracy: 0.9483
Epoch 14/20
 1/96 [..............................] - ETA: 0s - loss: 0.0850 - accuracy: 0.970015/96 [===>..........................] - ETA: 0s - loss: 0.0821 - accuracy: 0.972529/96 [========>.....................] - ETA: 0s - loss: 0.0812 - accuracy: 0.973043/96 [============>.................] - ETA: 0s - loss: 0.0822 - accuracy: 0.972857/96 [================>.............] - ETA: 0s - loss: 0.0829 - accuracy: 0.972771/96 [=====================>........] - ETA: 0s - loss: 0.0837 - accuracy: 0.972586/96 [=========================>....] - ETA: 0s - loss: 0.0847 - accuracy: 0.972396/96 [==============================] - 1s 6ms/step - loss: 0.0855 - accuracy: 0.9722 - val_loss: 0.3673 - val_accuracy: 0.9484
Epoch 15/20
 1/96 [..............................] - ETA: 0s - loss: 0.0729 - accuracy: 0.970016/96 [====>.........................] - ETA: 0s - loss: 0.0880 - accuracy: 0.968531/96 [========>.....................] - ETA: 0s - loss: 0.0895 - accuracy: 0.969445/96 [=============>................] - ETA: 0s - loss: 0.0885 - accuracy: 0.970460/96 [=================>............] - ETA: 0s - loss: 0.0878 - accuracy: 0.971074/96 [======================>.......] - ETA: 0s - loss: 0.0878 - accuracy: 0.971389/96 [==========================>...] - ETA: 0s - loss: 0.0881 - accuracy: 0.971596/96 [==============================] - 1s 6ms/step - loss: 0.0883 - accuracy: 0.9715 - val_loss: 0.4059 - val_accuracy: 0.9500
Epoch 16/20
 1/96 [..............................] - ETA: 0s - loss: 0.0710 - accuracy: 0.982015/96 [===>..........................] - ETA: 0s - loss: 0.0755 - accuracy: 0.976029/96 [========>.....................] - ETA: 0s - loss: 0.0775 - accuracy: 0.975244/96 [============>.................] - ETA: 0s - loss: 0.0792 - accuracy: 0.974759/96 [=================>............] - ETA: 0s - loss: 0.0806 - accuracy: 0.974273/96 [=====================>........] - ETA: 0s - loss: 0.0821 - accuracy: 0.973988/96 [==========================>...] - ETA: 0s - loss: 0.0833 - accuracy: 0.973696/96 [==============================] - 1s 5ms/step - loss: 0.0838 - accuracy: 0.9735 - val_loss: 0.3928 - val_accuracy: 0.9484
Epoch 17/20
 1/96 [..............................] - ETA: 0s - loss: 0.0612 - accuracy: 0.978015/96 [===>..........................] - ETA: 0s - loss: 0.0770 - accuracy: 0.974830/96 [========>.....................] - ETA: 0s - loss: 0.0784 - accuracy: 0.974644/96 [============>.................] - ETA: 0s - loss: 0.0779 - accuracy: 0.974958/96 [=================>............] - ETA: 0s - loss: 0.0771 - accuracy: 0.975272/96 [=====================>........] - ETA: 0s - loss: 0.0765 - accuracy: 0.975586/96 [=========================>....] - ETA: 0s - loss: 0.0762 - accuracy: 0.975796/96 [==============================] - 1s 6ms/step - loss: 0.0761 - accuracy: 0.9757 - val_loss: 0.3832 - val_accuracy: 0.9508
Epoch 18/20
 1/96 [..............................] - ETA: 0s - loss: 0.0402 - accuracy: 0.986016/96 [====>.........................] - ETA: 0s - loss: 0.0600 - accuracy: 0.980731/96 [========>.....................] - ETA: 0s - loss: 0.0637 - accuracy: 0.979045/96 [=============>................] - ETA: 0s - loss: 0.0650 - accuracy: 0.978459/96 [=================>............] - ETA: 0s - loss: 0.0657 - accuracy: 0.978373/96 [=====================>........] - ETA: 0s - loss: 0.0659 - accuracy: 0.978287/96 [==========================>...] - ETA: 0s - loss: 0.0662 - accuracy: 0.978196/96 [==============================] - 1s 5ms/step - loss: 0.0665 - accuracy: 0.9781 - val_loss: 0.3497 - val_accuracy: 0.9521
Epoch 19/20
 1/96 [..............................] - ETA: 0s - loss: 0.0629 - accuracy: 0.978016/96 [====>.........................] - ETA: 0s - loss: 0.0548 - accuracy: 0.982130/96 [========>.....................] - ETA: 0s - loss: 0.0569 - accuracy: 0.982145/96 [=============>................] - ETA: 0s - loss: 0.0589 - accuracy: 0.981759/96 [=================>............] - ETA: 0s - loss: 0.0611 - accuracy: 0.981173/96 [=====================>........] - ETA: 0s - loss: 0.0626 - accuracy: 0.980687/96 [==========================>...] - ETA: 0s - loss: 0.0638 - accuracy: 0.980196/96 [==============================] - 1s 5ms/step - loss: 0.0645 - accuracy: 0.9799 - val_loss: 0.3624 - val_accuracy: 0.9528
Epoch 20/20
 1/96 [..............................] - ETA: 0s - loss: 0.0270 - accuracy: 0.988015/96 [===>..........................] - ETA: 0s - loss: 0.0473 - accuracy: 0.983029/96 [========>.....................] - ETA: 0s - loss: 0.0530 - accuracy: 0.981643/96 [============>.................] - ETA: 0s - loss: 0.0551 - accuracy: 0.981257/96 [================>.............] - ETA: 0s - loss: 0.0565 - accuracy: 0.981071/96 [=====================>........] - ETA: 0s - loss: 0.0574 - accuracy: 0.980886/96 [=========================>....] - ETA: 0s - loss: 0.0580 - accuracy: 0.980696/96 [==============================] - 1s 5ms/step - loss: 0.0583 - accuracy: 0.9805 - val_loss: 0.3585 - val_accuracy: 0.9563
training_time: 0:00:16.328256
  1/313 [..............................] - ETA: 8:05 - loss: 0.7769 - accuracy: 0.9688 14/313 [>.............................] - ETA: 1s - loss: 0.2663 - accuracy: 0.9643   28/313 [=>............................] - ETA: 1s - loss: 0.2544 - accuracy: 0.9654 42/313 [===>..........................] - ETA: 1s - loss: 0.3946 - accuracy: 0.9531 56/313 [====>.........................] - ETA: 0s - loss: 0.4037 - accuracy: 0.9475 70/313 [=====>........................] - ETA: 0s - loss: 0.4291 - accuracy: 0.9429 84/313 [=======>......................] - ETA: 0s - loss: 0.4514 - accuracy: 0.9412 98/313 [========>.....................] - ETA: 0s - loss: 0.4307 - accuracy: 0.9442112/313 [=========>....................] - ETA: 0s - loss: 0.4067 - accuracy: 0.9470126/313 [===========>..................] - ETA: 0s - loss: 0.4198 - accuracy: 0.9442140/313 [============>.................] - ETA: 0s - loss: 0.4141 - accuracy: 0.9438153/313 [=============>................] - ETA: 0s - loss: 0.4104 - accuracy: 0.9428166/313 [==============>...............] - ETA: 0s - loss: 0.3934 - accuracy: 0.9452180/313 [================>.............] - ETA: 0s - loss: 0.3844 - accuracy: 0.9472194/313 [=================>............] - ETA: 0s - loss: 0.3783 - accuracy: 0.9475208/313 [==================>...........] - ETA: 0s - loss: 0.3814 - accuracy: 0.9479222/313 [====================>.........] - ETA: 0s - loss: 0.3631 - accuracy: 0.9503236/313 [=====================>........] - ETA: 0s - loss: 0.3482 - accuracy: 0.9519249/313 [======================>.......] - ETA: 0s - loss: 0.3396 - accuracy: 0.9531263/313 [========================>.....] - ETA: 0s - loss: 0.3288 - accuracy: 0.9533277/313 [=========================>....] - ETA: 0s - loss: 0.3153 - accuracy: 0.9552290/313 [==========================>...] - ETA: 0s - loss: 0.3195 - accuracy: 0.9565303/313 [============================>.] - ETA: 0s - loss: 0.3118 - accuracy: 0.9573313/313 [==============================] - 3s 4ms/step - loss: 0.3153 - accuracy: 0.9558
Test results: Loss = 0.31527432799339294, Accuracy = 0.9557999968528748
