Number of devices: 2
batch_size_per_replica: 250
batch_size: 500 = 250 * 2
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
60000 10000
Epoch 1/20
 1/96 [..............................] - ETA: 4:26 - loss: 136.2721 - accuracy: 0.096015/96 [===>..........................] - ETA: 0s - loss: 62.6918 - accuracy: 0.3387   29/96 [========>.....................] - ETA: 0s - loss: 43.8359 - accuracy: 0.440843/96 [============>.................] - ETA: 0s - loss: 34.5198 - accuracy: 0.478057/96 [================>.............] - ETA: 0s - loss: 28.8365 - accuracy: 0.494472/96 [=====================>........] - ETA: 0s - loss: 24.7290 - accuracy: 0.507286/96 [=========================>....] - ETA: 0s - loss: 21.9512 - accuracy: 0.517796/96 [==============================] - 5s 21ms/step - loss: 20.2300 - accuracy: 0.5255 - val_loss: 1.0286 - val_accuracy: 0.6940
Epoch 2/20
 1/96 [..............................] - ETA: 0s - loss: 0.9636 - accuracy: 0.698015/96 [===>..........................] - ETA: 0s - loss: 1.0363 - accuracy: 0.688029/96 [========>.....................] - ETA: 0s - loss: 1.0183 - accuracy: 0.701543/96 [============>.................] - ETA: 0s - loss: 1.0073 - accuracy: 0.714757/96 [================>.............] - ETA: 0s - loss: 0.9933 - accuracy: 0.725471/96 [=====================>........] - ETA: 0s - loss: 0.9795 - accuracy: 0.734185/96 [=========================>....] - ETA: 0s - loss: 0.9680 - accuracy: 0.741096/96 [==============================] - 1s 5ms/step - loss: 0.9598 - accuracy: 0.7458 - val_loss: 0.7927 - val_accuracy: 0.8236
Epoch 3/20
 1/96 [..............................] - ETA: 0s - loss: 0.6469 - accuracy: 0.848015/96 [===>..........................] - ETA: 0s - loss: 0.7200 - accuracy: 0.831229/96 [========>.....................] - ETA: 0s - loss: 0.7173 - accuracy: 0.837443/96 [============>.................] - ETA: 0s - loss: 0.7112 - accuracy: 0.840357/96 [================>.............] - ETA: 0s - loss: 0.7052 - accuracy: 0.842571/96 [=====================>........] - ETA: 0s - loss: 0.7010 - accuracy: 0.844285/96 [=========================>....] - ETA: 0s - loss: 0.6975 - accuracy: 0.845596/96 [==============================] - 1s 6ms/step - loss: 0.6951 - accuracy: 0.8465 - val_loss: 0.6434 - val_accuracy: 0.8701
Epoch 4/20
 1/96 [..............................] - ETA: 0s - loss: 0.6253 - accuracy: 0.870015/96 [===>..........................] - ETA: 0s - loss: 0.5612 - accuracy: 0.873929/96 [========>.....................] - ETA: 0s - loss: 0.5499 - accuracy: 0.876543/96 [============>.................] - ETA: 0s - loss: 0.5427 - accuracy: 0.877757/96 [================>.............] - ETA: 0s - loss: 0.5351 - accuracy: 0.878871/96 [=====================>........] - ETA: 0s - loss: 0.5278 - accuracy: 0.880085/96 [=========================>....] - ETA: 0s - loss: 0.5214 - accuracy: 0.880996/96 [==============================] - 1s 5ms/step - loss: 0.5175 - accuracy: 0.8814 - val_loss: 0.4929 - val_accuracy: 0.8922
Epoch 5/20
 1/96 [..............................] - ETA: 0s - loss: 0.3694 - accuracy: 0.914015/96 [===>..........................] - ETA: 0s - loss: 0.3730 - accuracy: 0.907229/96 [========>.....................] - ETA: 0s - loss: 0.3770 - accuracy: 0.906043/96 [============>.................] - ETA: 0s - loss: 0.3785 - accuracy: 0.905257/96 [================>.............] - ETA: 0s - loss: 0.3799 - accuracy: 0.904871/96 [=====================>........] - ETA: 0s - loss: 0.3809 - accuracy: 0.904685/96 [=========================>....] - ETA: 0s - loss: 0.3806 - accuracy: 0.904696/96 [==============================] - 1s 5ms/step - loss: 0.3798 - accuracy: 0.9048 - val_loss: 0.4203 - val_accuracy: 0.9046
Epoch 6/20
 1/96 [..............................] - ETA: 0s - loss: 0.3331 - accuracy: 0.906016/96 [====>.........................] - ETA: 0s - loss: 0.3027 - accuracy: 0.917030/96 [========>.....................] - ETA: 0s - loss: 0.3033 - accuracy: 0.917945/96 [=============>................] - ETA: 0s - loss: 0.3046 - accuracy: 0.918260/96 [=================>............] - ETA: 0s - loss: 0.3069 - accuracy: 0.918275/96 [======================>.......] - ETA: 0s - loss: 0.3084 - accuracy: 0.918390/96 [===========================>..] - ETA: 0s - loss: 0.3094 - accuracy: 0.918596/96 [==============================] - 1s 5ms/step - loss: 0.3096 - accuracy: 0.9185 - val_loss: 0.3869 - val_accuracy: 0.9208
Epoch 7/20
 1/96 [..............................] - ETA: 0s - loss: 0.2795 - accuracy: 0.918015/96 [===>..........................] - ETA: 0s - loss: 0.2441 - accuracy: 0.931929/96 [========>.....................] - ETA: 0s - loss: 0.2439 - accuracy: 0.932743/96 [============>.................] - ETA: 0s - loss: 0.2458 - accuracy: 0.932757/96 [================>.............] - ETA: 0s - loss: 0.2473 - accuracy: 0.932671/96 [=====================>........] - ETA: 0s - loss: 0.2486 - accuracy: 0.932585/96 [=========================>....] - ETA: 0s - loss: 0.2498 - accuracy: 0.932596/96 [==============================] - 1s 6ms/step - loss: 0.2506 - accuracy: 0.9324 - val_loss: 0.3433 - val_accuracy: 0.9253
Epoch 8/20
 1/96 [..............................] - ETA: 0s - loss: 0.2468 - accuracy: 0.930015/96 [===>..........................] - ETA: 0s - loss: 0.2279 - accuracy: 0.937830/96 [========>.....................] - ETA: 0s - loss: 0.2185 - accuracy: 0.940545/96 [=============>................] - ETA: 0s - loss: 0.2136 - accuracy: 0.941759/96 [=================>............] - ETA: 0s - loss: 0.2127 - accuracy: 0.942274/96 [======================>.......] - ETA: 0s - loss: 0.2134 - accuracy: 0.942189/96 [==========================>...] - ETA: 0s - loss: 0.2143 - accuracy: 0.941896/96 [==============================] - 1s 5ms/step - loss: 0.2146 - accuracy: 0.9417 - val_loss: 0.3500 - val_accuracy: 0.9278
Epoch 9/20
 1/96 [..............................] - ETA: 0s - loss: 0.1833 - accuracy: 0.952015/96 [===>..........................] - ETA: 0s - loss: 0.1818 - accuracy: 0.949829/96 [========>.....................] - ETA: 0s - loss: 0.1833 - accuracy: 0.949543/96 [============>.................] - ETA: 0s - loss: 0.1857 - accuracy: 0.948757/96 [================>.............] - ETA: 0s - loss: 0.1865 - accuracy: 0.948471/96 [=====================>........] - ETA: 0s - loss: 0.1870 - accuracy: 0.948385/96 [=========================>....] - ETA: 0s - loss: 0.1869 - accuracy: 0.948296/96 [==============================] - 1s 6ms/step - loss: 0.1870 - accuracy: 0.9482 - val_loss: 0.3451 - val_accuracy: 0.9277
Epoch 10/20
 1/96 [..............................] - ETA: 0s - loss: 0.2044 - accuracy: 0.940015/96 [===>..........................] - ETA: 0s - loss: 0.1945 - accuracy: 0.942829/96 [========>.....................] - ETA: 0s - loss: 0.1810 - accuracy: 0.946843/96 [============>.................] - ETA: 0s - loss: 0.1753 - accuracy: 0.948557/96 [================>.............] - ETA: 0s - loss: 0.1739 - accuracy: 0.949271/96 [=====================>........] - ETA: 0s - loss: 0.1729 - accuracy: 0.949785/96 [=========================>....] - ETA: 0s - loss: 0.1721 - accuracy: 0.950196/96 [==============================] - 1s 5ms/step - loss: 0.1717 - accuracy: 0.9504 - val_loss: 0.3156 - val_accuracy: 0.9393
Epoch 11/20
 1/96 [..............................] - ETA: 0s - loss: 0.1386 - accuracy: 0.958015/96 [===>..........................] - ETA: 0s - loss: 0.1407 - accuracy: 0.960229/96 [========>.....................] - ETA: 0s - loss: 0.1385 - accuracy: 0.960343/96 [============>.................] - ETA: 0s - loss: 0.1398 - accuracy: 0.959857/96 [================>.............] - ETA: 0s - loss: 0.1408 - accuracy: 0.959471/96 [=====================>........] - ETA: 0s - loss: 0.1412 - accuracy: 0.959285/96 [=========================>....] - ETA: 0s - loss: 0.1414 - accuracy: 0.959096/96 [==============================] - 1s 6ms/step - loss: 0.1415 - accuracy: 0.9589 - val_loss: 0.3289 - val_accuracy: 0.9382
Epoch 12/20
 1/96 [..............................] - ETA: 0s - loss: 0.1271 - accuracy: 0.966015/96 [===>..........................] - ETA: 0s - loss: 0.1270 - accuracy: 0.962829/96 [========>.....................] - ETA: 0s - loss: 0.1258 - accuracy: 0.962343/96 [============>.................] - ETA: 0s - loss: 0.1254 - accuracy: 0.962357/96 [================>.............] - ETA: 0s - loss: 0.1251 - accuracy: 0.962471/96 [=====================>........] - ETA: 0s - loss: 0.1252 - accuracy: 0.962585/96 [=========================>....] - ETA: 0s - loss: 0.1256 - accuracy: 0.962596/96 [==============================] - 1s 6ms/step - loss: 0.1260 - accuracy: 0.9624 - val_loss: 0.3493 - val_accuracy: 0.9380
Epoch 13/20
 1/96 [..............................] - ETA: 0s - loss: 0.1535 - accuracy: 0.960015/96 [===>..........................] - ETA: 0s - loss: 0.1316 - accuracy: 0.961929/96 [========>.....................] - ETA: 0s - loss: 0.1264 - accuracy: 0.962243/96 [============>.................] - ETA: 0s - loss: 0.1236 - accuracy: 0.962757/96 [================>.............] - ETA: 0s - loss: 0.1220 - accuracy: 0.963071/96 [=====================>........] - ETA: 0s - loss: 0.1217 - accuracy: 0.963186/96 [=========================>....] - ETA: 0s - loss: 0.1216 - accuracy: 0.963296/96 [==============================] - 1s 5ms/step - loss: 0.1216 - accuracy: 0.9633 - val_loss: 0.2969 - val_accuracy: 0.9476
Epoch 14/20
 1/96 [..............................] - ETA: 0s - loss: 0.0862 - accuracy: 0.968015/96 [===>..........................] - ETA: 0s - loss: 0.1037 - accuracy: 0.968229/96 [========>.....................] - ETA: 0s - loss: 0.1070 - accuracy: 0.967644/96 [============>.................] - ETA: 0s - loss: 0.1090 - accuracy: 0.966958/96 [=================>............] - ETA: 0s - loss: 0.1101 - accuracy: 0.966572/96 [=====================>........] - ETA: 0s - loss: 0.1106 - accuracy: 0.966387/96 [==========================>...] - ETA: 0s - loss: 0.1106 - accuracy: 0.966396/96 [==============================] - 1s 6ms/step - loss: 0.1105 - accuracy: 0.9663 - val_loss: 0.2890 - val_accuracy: 0.9484
Epoch 15/20
 1/96 [..............................] - ETA: 0s - loss: 0.0871 - accuracy: 0.982015/96 [===>..........................] - ETA: 0s - loss: 0.0860 - accuracy: 0.974429/96 [========>.....................] - ETA: 0s - loss: 0.0897 - accuracy: 0.972943/96 [============>.................] - ETA: 0s - loss: 0.0926 - accuracy: 0.971957/96 [================>.............] - ETA: 0s - loss: 0.0939 - accuracy: 0.971371/96 [=====================>........] - ETA: 0s - loss: 0.0947 - accuracy: 0.971085/96 [=========================>....] - ETA: 0s - loss: 0.0950 - accuracy: 0.970896/96 [==============================] - 1s 5ms/step - loss: 0.0950 - accuracy: 0.9708 - val_loss: 0.3016 - val_accuracy: 0.9507
Epoch 16/20
 1/96 [..............................] - ETA: 0s - loss: 0.0523 - accuracy: 0.988015/96 [===>..........................] - ETA: 0s - loss: 0.0820 - accuracy: 0.974629/96 [========>.....................] - ETA: 0s - loss: 0.0886 - accuracy: 0.971843/96 [============>.................] - ETA: 0s - loss: 0.0894 - accuracy: 0.971357/96 [================>.............] - ETA: 0s - loss: 0.0895 - accuracy: 0.971271/96 [=====================>........] - ETA: 0s - loss: 0.0895 - accuracy: 0.971385/96 [=========================>....] - ETA: 0s - loss: 0.0897 - accuracy: 0.971396/96 [==============================] - 1s 6ms/step - loss: 0.0900 - accuracy: 0.9713 - val_loss: 0.2887 - val_accuracy: 0.9500
Epoch 17/20
 1/96 [..............................] - ETA: 0s - loss: 0.0997 - accuracy: 0.970016/96 [====>.........................] - ETA: 0s - loss: 0.0869 - accuracy: 0.972630/96 [========>.....................] - ETA: 0s - loss: 0.0855 - accuracy: 0.972745/96 [=============>................] - ETA: 0s - loss: 0.0842 - accuracy: 0.973060/96 [=================>............] - ETA: 0s - loss: 0.0839 - accuracy: 0.973175/96 [======================>.......] - ETA: 0s - loss: 0.0835 - accuracy: 0.973389/96 [==========================>...] - ETA: 0s - loss: 0.0832 - accuracy: 0.973496/96 [==============================] - 1s 5ms/step - loss: 0.0832 - accuracy: 0.9734 - val_loss: 0.2813 - val_accuracy: 0.9538
Epoch 18/20
 1/96 [..............................] - ETA: 0s - loss: 0.0789 - accuracy: 0.976015/96 [===>..........................] - ETA: 0s - loss: 0.0745 - accuracy: 0.974829/96 [========>.....................] - ETA: 0s - loss: 0.0743 - accuracy: 0.974844/96 [============>.................] - ETA: 0s - loss: 0.0741 - accuracy: 0.975159/96 [=================>............] - ETA: 0s - loss: 0.0743 - accuracy: 0.975473/96 [=====================>........] - ETA: 0s - loss: 0.0744 - accuracy: 0.975587/96 [==========================>...] - ETA: 0s - loss: 0.0744 - accuracy: 0.975796/96 [==============================] - 1s 6ms/step - loss: 0.0743 - accuracy: 0.9758 - val_loss: 0.2722 - val_accuracy: 0.9538
Epoch 19/20
 1/96 [..............................] - ETA: 0s - loss: 0.0688 - accuracy: 0.976015/96 [===>..........................] - ETA: 0s - loss: 0.0647 - accuracy: 0.977929/96 [========>.....................] - ETA: 0s - loss: 0.0627 - accuracy: 0.978743/96 [============>.................] - ETA: 0s - loss: 0.0622 - accuracy: 0.978858/96 [=================>............] - ETA: 0s - loss: 0.0627 - accuracy: 0.978773/96 [=====================>........] - ETA: 0s - loss: 0.0631 - accuracy: 0.978688/96 [==========================>...] - ETA: 0s - loss: 0.0636 - accuracy: 0.978696/96 [==============================] - 1s 5ms/step - loss: 0.0640 - accuracy: 0.9785 - val_loss: 0.2879 - val_accuracy: 0.9525
Epoch 20/20
 1/96 [..............................] - ETA: 0s - loss: 0.0471 - accuracy: 0.988016/96 [====>.........................] - ETA: 0s - loss: 0.0702 - accuracy: 0.977930/96 [========>.....................] - ETA: 0s - loss: 0.0710 - accuracy: 0.977645/96 [=============>................] - ETA: 0s - loss: 0.0709 - accuracy: 0.977759/96 [=================>............] - ETA: 0s - loss: 0.0706 - accuracy: 0.977773/96 [=====================>........] - ETA: 0s - loss: 0.0702 - accuracy: 0.977887/96 [==========================>...] - ETA: 0s - loss: 0.0700 - accuracy: 0.977996/96 [==============================] - 1s 5ms/step - loss: 0.0700 - accuracy: 0.9779 - val_loss: 0.2608 - val_accuracy: 0.9534
training_time: 0:00:15.193353
  1/313 [..............................] - ETA: 7:47 - loss: 0.0449 - accuracy: 0.9688 14/313 [>.............................] - ETA: 1s - loss: 0.3411 - accuracy: 0.9643   28/313 [=>............................] - ETA: 1s - loss: 0.3190 - accuracy: 0.9554 41/313 [==>...........................] - ETA: 1s - loss: 0.3783 - accuracy: 0.9444 54/313 [====>.........................] - ETA: 0s - loss: 0.4163 - accuracy: 0.9404 67/313 [=====>........................] - ETA: 0s - loss: 0.4251 - accuracy: 0.9389 81/313 [======>.......................] - ETA: 0s - loss: 0.4287 - accuracy: 0.9390 95/313 [========>.....................] - ETA: 0s - loss: 0.4054 - accuracy: 0.9401108/313 [=========>....................] - ETA: 0s - loss: 0.3858 - accuracy: 0.9433121/313 [==========>...................] - ETA: 0s - loss: 0.4070 - accuracy: 0.9414135/313 [===========>..................] - ETA: 0s - loss: 0.4230 - accuracy: 0.9394149/313 [=============>................] - ETA: 0s - loss: 0.4102 - accuracy: 0.9385163/313 [==============>...............] - ETA: 0s - loss: 0.4031 - accuracy: 0.9400177/313 [===============>..............] - ETA: 0s - loss: 0.3777 - accuracy: 0.9437191/313 [=================>............] - ETA: 0s - loss: 0.3724 - accuracy: 0.9416205/313 [==================>...........] - ETA: 0s - loss: 0.3550 - accuracy: 0.9436219/313 [===================>..........] - ETA: 0s - loss: 0.3568 - accuracy: 0.9438233/313 [=====================>........] - ETA: 0s - loss: 0.3392 - accuracy: 0.9461246/313 [======================>.......] - ETA: 0s - loss: 0.3263 - accuracy: 0.9475259/313 [=======================>......] - ETA: 0s - loss: 0.3213 - accuracy: 0.9478273/313 [=========================>....] - ETA: 0s - loss: 0.3093 - accuracy: 0.9492287/313 [==========================>...] - ETA: 0s - loss: 0.3094 - accuracy: 0.9509301/313 [===========================>..] - ETA: 0s - loss: 0.2996 - accuracy: 0.9523313/313 [==============================] - 3s 4ms/step - loss: 0.3086 - accuracy: 0.9506
Test results: Loss = 0.30856573581695557, Accuracy = 0.9506000280380249
