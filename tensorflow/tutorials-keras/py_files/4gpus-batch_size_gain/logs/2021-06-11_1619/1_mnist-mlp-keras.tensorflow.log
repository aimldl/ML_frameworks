Number of devices: 2
batch_size_per_replica: 250
batch_size: 500 = 250 * 2
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
60000 10000
Epoch 1/20
 1/96 [..............................] - ETA: 6:02 - loss: 107.7064 - accuracy: 0.074015/96 [===>..........................] - ETA: 0s - loss: 52.3979 - accuracy: 0.2777   29/96 [========>.....................] - ETA: 0s - loss: 36.7038 - accuracy: 0.377643/96 [============>.................] - ETA: 0s - loss: 28.9446 - accuracy: 0.424957/96 [================>.............] - ETA: 0s - loss: 24.2136 - accuracy: 0.451872/96 [=====================>........] - ETA: 0s - loss: 20.7968 - accuracy: 0.473987/96 [==========================>...] - ETA: 0s - loss: 18.3416 - accuracy: 0.493296/96 [==============================] - 5s 11ms/step - loss: 17.0497 - accuracy: 0.5051 - val_loss: 0.9545 - val_accuracy: 0.7762
Epoch 2/20
 1/96 [..............................] - ETA: 0s - loss: 1.0254 - accuracy: 0.774015/96 [===>..........................] - ETA: 0s - loss: 0.9596 - accuracy: 0.774129/96 [========>.....................] - ETA: 0s - loss: 0.9337 - accuracy: 0.777743/96 [============>.................] - ETA: 0s - loss: 0.9140 - accuracy: 0.781957/96 [================>.............] - ETA: 0s - loss: 0.8965 - accuracy: 0.785971/96 [=====================>........] - ETA: 0s - loss: 0.8832 - accuracy: 0.789285/96 [=========================>....] - ETA: 0s - loss: 0.8732 - accuracy: 0.791996/96 [==============================] - 1s 6ms/step - loss: 0.8649 - accuracy: 0.7939 - val_loss: 0.6665 - val_accuracy: 0.8502
Epoch 3/20
 1/96 [..............................] - ETA: 0s - loss: 0.6347 - accuracy: 0.838016/96 [====>.........................] - ETA: 0s - loss: 0.5909 - accuracy: 0.846231/96 [========>.....................] - ETA: 0s - loss: 0.5906 - accuracy: 0.847346/96 [=============>................] - ETA: 0s - loss: 0.5906 - accuracy: 0.848160/96 [=================>............] - ETA: 0s - loss: 0.5884 - accuracy: 0.849275/96 [======================>.......] - ETA: 0s - loss: 0.5844 - accuracy: 0.850790/96 [===========================>..] - ETA: 0s - loss: 0.5806 - accuracy: 0.852396/96 [==============================] - 1s 5ms/step - loss: 0.5789 - accuracy: 0.8530 - val_loss: 0.5546 - val_accuracy: 0.8780
Epoch 4/20
 1/96 [..............................] - ETA: 0s - loss: 0.4487 - accuracy: 0.890016/96 [====>.........................] - ETA: 0s - loss: 0.4304 - accuracy: 0.888631/96 [========>.....................] - ETA: 0s - loss: 0.4364 - accuracy: 0.887746/96 [=============>................] - ETA: 0s - loss: 0.4366 - accuracy: 0.887960/96 [=================>............] - ETA: 0s - loss: 0.4347 - accuracy: 0.888574/96 [======================>.......] - ETA: 0s - loss: 0.4331 - accuracy: 0.889188/96 [==========================>...] - ETA: 0s - loss: 0.4314 - accuracy: 0.889796/96 [==============================] - 1s 6ms/step - loss: 0.4304 - accuracy: 0.8900 - val_loss: 0.4709 - val_accuracy: 0.9002
Epoch 5/20
 1/96 [..............................] - ETA: 0s - loss: 0.2908 - accuracy: 0.916016/96 [====>.........................] - ETA: 0s - loss: 0.3264 - accuracy: 0.907430/96 [========>.....................] - ETA: 0s - loss: 0.3321 - accuracy: 0.907445/96 [=============>................] - ETA: 0s - loss: 0.3368 - accuracy: 0.907859/96 [=================>............] - ETA: 0s - loss: 0.3381 - accuracy: 0.908373/96 [=====================>........] - ETA: 0s - loss: 0.3386 - accuracy: 0.908787/96 [==========================>...] - ETA: 0s - loss: 0.3384 - accuracy: 0.909196/96 [==============================] - 1s 5ms/step - loss: 0.3382 - accuracy: 0.9094 - val_loss: 0.4321 - val_accuracy: 0.9068
Epoch 6/20
 1/96 [..............................] - ETA: 0s - loss: 0.2641 - accuracy: 0.908016/96 [====>.........................] - ETA: 0s - loss: 0.2753 - accuracy: 0.921131/96 [========>.....................] - ETA: 0s - loss: 0.2744 - accuracy: 0.923346/96 [=============>................] - ETA: 0s - loss: 0.2753 - accuracy: 0.924160/96 [=================>............] - ETA: 0s - loss: 0.2767 - accuracy: 0.924675/96 [======================>.......] - ETA: 0s - loss: 0.2781 - accuracy: 0.924789/96 [==========================>...] - ETA: 0s - loss: 0.2788 - accuracy: 0.924896/96 [==============================] - 1s 5ms/step - loss: 0.2793 - accuracy: 0.9247 - val_loss: 0.3814 - val_accuracy: 0.9145
Epoch 7/20
 1/96 [..............................] - ETA: 0s - loss: 0.3174 - accuracy: 0.906015/96 [===>..........................] - ETA: 0s - loss: 0.2546 - accuracy: 0.924229/96 [========>.....................] - ETA: 0s - loss: 0.2450 - accuracy: 0.927943/96 [============>.................] - ETA: 0s - loss: 0.2424 - accuracy: 0.929557/96 [================>.............] - ETA: 0s - loss: 0.2418 - accuracy: 0.930271/96 [=====================>........] - ETA: 0s - loss: 0.2409 - accuracy: 0.930885/96 [=========================>....] - ETA: 0s - loss: 0.2401 - accuracy: 0.931396/96 [==============================] - 1s 5ms/step - loss: 0.2400 - accuracy: 0.9316 - val_loss: 0.3807 - val_accuracy: 0.9274
Epoch 8/20
 1/96 [..............................] - ETA: 0s - loss: 0.1870 - accuracy: 0.934015/96 [===>..........................] - ETA: 0s - loss: 0.1937 - accuracy: 0.940529/96 [========>.....................] - ETA: 0s - loss: 0.1977 - accuracy: 0.941744/96 [============>.................] - ETA: 0s - loss: 0.2017 - accuracy: 0.941059/96 [=================>............] - ETA: 0s - loss: 0.2028 - accuracy: 0.941174/96 [======================>.......] - ETA: 0s - loss: 0.2031 - accuracy: 0.941389/96 [==========================>...] - ETA: 0s - loss: 0.2033 - accuracy: 0.941496/96 [==============================] - 1s 5ms/step - loss: 0.2034 - accuracy: 0.9415 - val_loss: 0.3555 - val_accuracy: 0.9330
Epoch 9/20
 1/96 [..............................] - ETA: 0s - loss: 0.1525 - accuracy: 0.960015/96 [===>..........................] - ETA: 0s - loss: 0.1768 - accuracy: 0.950029/96 [========>.....................] - ETA: 0s - loss: 0.1774 - accuracy: 0.949843/96 [============>.................] - ETA: 0s - loss: 0.1785 - accuracy: 0.949657/96 [================>.............] - ETA: 0s - loss: 0.1802 - accuracy: 0.949371/96 [=====================>........] - ETA: 0s - loss: 0.1813 - accuracy: 0.949186/96 [=========================>....] - ETA: 0s - loss: 0.1818 - accuracy: 0.949096/96 [==============================] - 1s 5ms/step - loss: 0.1821 - accuracy: 0.9489 - val_loss: 0.3580 - val_accuracy: 0.9370
Epoch 10/20
 1/96 [..............................] - ETA: 0s - loss: 0.1777 - accuracy: 0.948016/96 [====>.........................] - ETA: 0s - loss: 0.1667 - accuracy: 0.952531/96 [========>.....................] - ETA: 0s - loss: 0.1670 - accuracy: 0.952646/96 [=============>................] - ETA: 0s - loss: 0.1655 - accuracy: 0.952961/96 [==================>...........] - ETA: 0s - loss: 0.1654 - accuracy: 0.953075/96 [======================>.......] - ETA: 0s - loss: 0.1651 - accuracy: 0.953190/96 [===========================>..] - ETA: 0s - loss: 0.1651 - accuracy: 0.953196/96 [==============================] - 1s 5ms/step - loss: 0.1652 - accuracy: 0.9531 - val_loss: 0.3383 - val_accuracy: 0.9340
Epoch 11/20
 1/96 [..............................] - ETA: 0s - loss: 0.1766 - accuracy: 0.944015/96 [===>..........................] - ETA: 0s - loss: 0.1605 - accuracy: 0.949829/96 [========>.....................] - ETA: 0s - loss: 0.1566 - accuracy: 0.951643/96 [============>.................] - ETA: 0s - loss: 0.1539 - accuracy: 0.952857/96 [================>.............] - ETA: 0s - loss: 0.1518 - accuracy: 0.953571/96 [=====================>........] - ETA: 0s - loss: 0.1502 - accuracy: 0.954185/96 [=========================>....] - ETA: 0s - loss: 0.1491 - accuracy: 0.954696/96 [==============================] - 1s 5ms/step - loss: 0.1484 - accuracy: 0.9548 - val_loss: 0.3078 - val_accuracy: 0.9461
Epoch 12/20
 1/96 [..............................] - ETA: 0s - loss: 0.1310 - accuracy: 0.958015/96 [===>..........................] - ETA: 0s - loss: 0.1361 - accuracy: 0.957430/96 [========>.....................] - ETA: 0s - loss: 0.1322 - accuracy: 0.959344/96 [============>.................] - ETA: 0s - loss: 0.1298 - accuracy: 0.960459/96 [=================>............] - ETA: 0s - loss: 0.1288 - accuracy: 0.960873/96 [=====================>........] - ETA: 0s - loss: 0.1292 - accuracy: 0.960887/96 [==========================>...] - ETA: 0s - loss: 0.1295 - accuracy: 0.960896/96 [==============================] - 1s 5ms/step - loss: 0.1297 - accuracy: 0.9608 - val_loss: 0.3034 - val_accuracy: 0.9470
Epoch 13/20
 1/96 [..............................] - ETA: 0s - loss: 0.1186 - accuracy: 0.962016/96 [====>.........................] - ETA: 0s - loss: 0.1156 - accuracy: 0.963331/96 [========>.....................] - ETA: 0s - loss: 0.1211 - accuracy: 0.961645/96 [=============>................] - ETA: 0s - loss: 0.1223 - accuracy: 0.961259/96 [=================>............] - ETA: 0s - loss: 0.1224 - accuracy: 0.961373/96 [=====================>........] - ETA: 0s - loss: 0.1225 - accuracy: 0.961587/96 [==========================>...] - ETA: 0s - loss: 0.1227 - accuracy: 0.961696/96 [==============================] - 1s 5ms/step - loss: 0.1229 - accuracy: 0.9616 - val_loss: 0.3106 - val_accuracy: 0.9457
Epoch 14/20
 1/96 [..............................] - ETA: 0s - loss: 0.0755 - accuracy: 0.970016/96 [====>.........................] - ETA: 0s - loss: 0.0976 - accuracy: 0.968531/96 [========>.....................] - ETA: 0s - loss: 0.1004 - accuracy: 0.968346/96 [=============>................] - ETA: 0s - loss: 0.1010 - accuracy: 0.968460/96 [=================>............] - ETA: 0s - loss: 0.1015 - accuracy: 0.968375/96 [======================>.......] - ETA: 0s - loss: 0.1026 - accuracy: 0.968189/96 [==========================>...] - ETA: 0s - loss: 0.1037 - accuracy: 0.967896/96 [==============================] - 1s 5ms/step - loss: 0.1041 - accuracy: 0.9677 - val_loss: 0.3161 - val_accuracy: 0.9453
Epoch 15/20
 1/96 [..............................] - ETA: 0s - loss: 0.1133 - accuracy: 0.962016/96 [====>.........................] - ETA: 0s - loss: 0.1086 - accuracy: 0.967130/96 [========>.....................] - ETA: 0s - loss: 0.1119 - accuracy: 0.966644/96 [============>.................] - ETA: 0s - loss: 0.1103 - accuracy: 0.966959/96 [=================>............] - ETA: 0s - loss: 0.1090 - accuracy: 0.967274/96 [======================>.......] - ETA: 0s - loss: 0.1079 - accuracy: 0.967589/96 [==========================>...] - ETA: 0s - loss: 0.1071 - accuracy: 0.967796/96 [==============================] - 1s 5ms/step - loss: 0.1069 - accuracy: 0.9677 - val_loss: 0.3104 - val_accuracy: 0.9483
Epoch 16/20
 1/96 [..............................] - ETA: 0s - loss: 0.1324 - accuracy: 0.956016/96 [====>.........................] - ETA: 0s - loss: 0.1007 - accuracy: 0.968931/96 [========>.....................] - ETA: 0s - loss: 0.0978 - accuracy: 0.970045/96 [=============>................] - ETA: 0s - loss: 0.0974 - accuracy: 0.970259/96 [=================>............] - ETA: 0s - loss: 0.0978 - accuracy: 0.970173/96 [=====================>........] - ETA: 0s - loss: 0.0978 - accuracy: 0.970187/96 [==========================>...] - ETA: 0s - loss: 0.0977 - accuracy: 0.970296/96 [==============================] - 1s 6ms/step - loss: 0.0975 - accuracy: 0.9703 - val_loss: 0.2987 - val_accuracy: 0.9510
Epoch 17/20
 1/96 [..............................] - ETA: 0s - loss: 0.0932 - accuracy: 0.968015/96 [===>..........................] - ETA: 0s - loss: 0.0823 - accuracy: 0.975129/96 [========>.....................] - ETA: 0s - loss: 0.0859 - accuracy: 0.974943/96 [============>.................] - ETA: 0s - loss: 0.0878 - accuracy: 0.974258/96 [=================>............] - ETA: 0s - loss: 0.0884 - accuracy: 0.973872/96 [=====================>........] - ETA: 0s - loss: 0.0886 - accuracy: 0.973686/96 [=========================>....] - ETA: 0s - loss: 0.0886 - accuracy: 0.973596/96 [==============================] - 1s 6ms/step - loss: 0.0889 - accuracy: 0.9734 - val_loss: 0.3020 - val_accuracy: 0.9483
Epoch 18/20
 1/96 [..............................] - ETA: 0s - loss: 0.0872 - accuracy: 0.978016/96 [====>.........................] - ETA: 0s - loss: 0.0831 - accuracy: 0.975330/96 [========>.....................] - ETA: 0s - loss: 0.0819 - accuracy: 0.975244/96 [============>.................] - ETA: 0s - loss: 0.0815 - accuracy: 0.975158/96 [=================>............] - ETA: 0s - loss: 0.0815 - accuracy: 0.975072/96 [=====================>........] - ETA: 0s - loss: 0.0818 - accuracy: 0.974887/96 [==========================>...] - ETA: 0s - loss: 0.0818 - accuracy: 0.974696/96 [==============================] - 1s 6ms/step - loss: 0.0819 - accuracy: 0.9745 - val_loss: 0.2910 - val_accuracy: 0.9523
Epoch 19/20
 1/96 [..............................] - ETA: 0s - loss: 0.1007 - accuracy: 0.960015/96 [===>..........................] - ETA: 0s - loss: 0.0813 - accuracy: 0.972729/96 [========>.....................] - ETA: 0s - loss: 0.0822 - accuracy: 0.973244/96 [============>.................] - ETA: 0s - loss: 0.0820 - accuracy: 0.973359/96 [=================>............] - ETA: 0s - loss: 0.0812 - accuracy: 0.973674/96 [======================>.......] - ETA: 0s - loss: 0.0806 - accuracy: 0.973889/96 [==========================>...] - ETA: 0s - loss: 0.0801 - accuracy: 0.974096/96 [==============================] - 1s 5ms/step - loss: 0.0800 - accuracy: 0.9741 - val_loss: 0.2914 - val_accuracy: 0.9548
Epoch 20/20
 1/96 [..............................] - ETA: 0s - loss: 0.0695 - accuracy: 0.976015/96 [===>..........................] - ETA: 0s - loss: 0.0727 - accuracy: 0.976530/96 [========>.....................] - ETA: 0s - loss: 0.0761 - accuracy: 0.976045/96 [=============>................] - ETA: 0s - loss: 0.0761 - accuracy: 0.976159/96 [=================>............] - ETA: 0s - loss: 0.0757 - accuracy: 0.976273/96 [=====================>........] - ETA: 0s - loss: 0.0754 - accuracy: 0.976487/96 [==========================>...] - ETA: 0s - loss: 0.0753 - accuracy: 0.976496/96 [==============================] - 1s 5ms/step - loss: 0.0754 - accuracy: 0.9764 - val_loss: 0.2724 - val_accuracy: 0.9532
training_time: 0:00:15.076070
  1/313 [..............................] - ETA: 7:48 - loss: 0.2282 - accuracy: 0.9688 14/313 [>.............................] - ETA: 1s - loss: 0.2529 - accuracy: 0.9621   28/313 [=>............................] - ETA: 1s - loss: 0.2624 - accuracy: 0.9576 42/313 [===>..........................] - ETA: 1s - loss: 0.3526 - accuracy: 0.9472 56/313 [====>.........................] - ETA: 0s - loss: 0.3695 - accuracy: 0.9442 70/313 [=====>........................] - ETA: 0s - loss: 0.3981 - accuracy: 0.9366 84/313 [=======>......................] - ETA: 0s - loss: 0.3844 - accuracy: 0.9394 97/313 [========>.....................] - ETA: 0s - loss: 0.3545 - accuracy: 0.9423111/313 [=========>....................] - ETA: 0s - loss: 0.3457 - accuracy: 0.9440125/313 [==========>...................] - ETA: 0s - loss: 0.3723 - accuracy: 0.9413139/313 [============>.................] - ETA: 0s - loss: 0.3712 - accuracy: 0.9406153/313 [=============>................] - ETA: 0s - loss: 0.3903 - accuracy: 0.9406167/313 [===============>..............] - ETA: 0s - loss: 0.3770 - accuracy: 0.9427181/313 [================>.............] - ETA: 0s - loss: 0.3602 - accuracy: 0.9453195/313 [=================>............] - ETA: 0s - loss: 0.3541 - accuracy: 0.9449209/313 [===================>..........] - ETA: 0s - loss: 0.3425 - accuracy: 0.9460223/313 [====================>.........] - ETA: 0s - loss: 0.3247 - accuracy: 0.9484237/313 [=====================>........] - ETA: 0s - loss: 0.3143 - accuracy: 0.9500251/313 [=======================>......] - ETA: 0s - loss: 0.3038 - accuracy: 0.9511265/313 [========================>.....] - ETA: 0s - loss: 0.2993 - accuracy: 0.9512279/313 [=========================>....] - ETA: 0s - loss: 0.2853 - accuracy: 0.9533293/313 [===========================>..] - ETA: 0s - loss: 0.2790 - accuracy: 0.9542307/313 [============================>.] - ETA: 0s - loss: 0.2866 - accuracy: 0.9536313/313 [==============================] - 3s 4ms/step - loss: 0.2889 - accuracy: 0.9526
Test results: Loss = 0.2889081835746765, Accuracy = 0.9526000022888184
