Number of devices: 4
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
60000 10000
Epoch 1/20
  1/192 [..............................] - ETA: 2:29 - loss: 106.3736 - accuracy: 0.1680 24/192 [==>...........................] - ETA: 0s - loss: 41.5441 - accuracy: 0.4168    48/192 [======>.......................] - ETA: 0s - loss: 28.1828 - accuracy: 0.5349 72/192 [==========>...................] - ETA: 0s - loss: 22.0267 - accuracy: 0.5925 96/192 [==============>...............] - ETA: 0s - loss: 18.3479 - accuracy: 0.6251120/192 [=================>............] - ETA: 0s - loss: 15.8622 - accuracy: 0.6472144/192 [=====================>........] - ETA: 0s - loss: 14.0557 - accuracy: 0.6637168/192 [=========================>....] - ETA: 0s - loss: 12.6744 - accuracy: 0.6771192/192 [==============================] - ETA: 0s - loss: 11.5792 - accuracy: 0.6882192/192 [==============================] - 2s 5ms/step - loss: 11.5385 - accuracy: 0.6887 - val_loss: 0.7335 - val_accuracy: 0.8610
Epoch 2/20
  1/192 [..............................] - ETA: 0s - loss: 0.6714 - accuracy: 0.8240 25/192 [==>...........................] - ETA: 0s - loss: 0.6598 - accuracy: 0.8510 49/192 [======>.......................] - ETA: 0s - loss: 0.6488 - accuracy: 0.8539 73/192 [==========>...................] - ETA: 0s - loss: 0.6402 - accuracy: 0.8557 98/192 [==============>...............] - ETA: 0s - loss: 0.6324 - accuracy: 0.8571122/192 [==================>...........] - ETA: 0s - loss: 0.6259 - accuracy: 0.8582146/192 [=====================>........] - ETA: 0s - loss: 0.6191 - accuracy: 0.8597170/192 [=========================>....] - ETA: 0s - loss: 0.6119 - accuracy: 0.8614192/192 [==============================] - 1s 3ms/step - loss: 0.6055 - accuracy: 0.8628 - val_loss: 0.4722 - val_accuracy: 0.8947
Epoch 3/20
  1/192 [..............................] - ETA: 0s - loss: 0.3202 - accuracy: 0.9080 25/192 [==>...........................] - ETA: 0s - loss: 0.3975 - accuracy: 0.9021 49/192 [======>.......................] - ETA: 0s - loss: 0.3897 - accuracy: 0.9045 72/192 [==========>...................] - ETA: 0s - loss: 0.3858 - accuracy: 0.9060 96/192 [==============>...............] - ETA: 0s - loss: 0.3836 - accuracy: 0.9070120/192 [=================>............] - ETA: 0s - loss: 0.3821 - accuracy: 0.9076145/192 [=====================>........] - ETA: 0s - loss: 0.3803 - accuracy: 0.9083169/192 [=========================>....] - ETA: 0s - loss: 0.3786 - accuracy: 0.9088192/192 [==============================] - 1s 3ms/step - loss: 0.3768 - accuracy: 0.9093 - val_loss: 0.4349 - val_accuracy: 0.9153
Epoch 4/20
  1/192 [..............................] - ETA: 0s - loss: 0.2282 - accuracy: 0.9240 23/192 [==>...........................] - ETA: 0s - loss: 0.2783 - accuracy: 0.9227 45/192 [======>.......................] - ETA: 0s - loss: 0.2823 - accuracy: 0.9254 67/192 [=========>....................] - ETA: 0s - loss: 0.2813 - accuracy: 0.9273 89/192 [============>.................] - ETA: 0s - loss: 0.2783 - accuracy: 0.9288111/192 [================>.............] - ETA: 0s - loss: 0.2764 - accuracy: 0.9297133/192 [===================>..........] - ETA: 0s - loss: 0.2745 - accuracy: 0.9304155/192 [=======================>......] - ETA: 0s - loss: 0.2733 - accuracy: 0.9308177/192 [==========================>...] - ETA: 0s - loss: 0.2728 - accuracy: 0.9312192/192 [==============================] - 1s 3ms/step - loss: 0.2725 - accuracy: 0.9314 - val_loss: 0.3917 - val_accuracy: 0.9248
Epoch 5/20
  1/192 [..............................] - ETA: 0s - loss: 0.1335 - accuracy: 0.9640 25/192 [==>...........................] - ETA: 0s - loss: 0.2171 - accuracy: 0.9416 49/192 [======>.......................] - ETA: 0s - loss: 0.2090 - accuracy: 0.9436 73/192 [==========>...................] - ETA: 0s - loss: 0.2060 - accuracy: 0.9447 97/192 [==============>...............] - ETA: 0s - loss: 0.2056 - accuracy: 0.9452121/192 [=================>............] - ETA: 0s - loss: 0.2061 - accuracy: 0.9456145/192 [=====================>........] - ETA: 0s - loss: 0.2068 - accuracy: 0.9457169/192 [=========================>....] - ETA: 0s - loss: 0.2075 - accuracy: 0.9457192/192 [==============================] - 1s 3ms/step - loss: 0.2082 - accuracy: 0.9457 - val_loss: 0.3472 - val_accuracy: 0.9362
Epoch 6/20
  1/192 [..............................] - ETA: 0s - loss: 0.2778 - accuracy: 0.9480 25/192 [==>...........................] - ETA: 0s - loss: 0.1919 - accuracy: 0.9523 49/192 [======>.......................] - ETA: 0s - loss: 0.1875 - accuracy: 0.9518 73/192 [==========>...................] - ETA: 0s - loss: 0.1833 - accuracy: 0.9522 97/192 [==============>...............] - ETA: 0s - loss: 0.1819 - accuracy: 0.9522121/192 [=================>............] - ETA: 0s - loss: 0.1808 - accuracy: 0.9524145/192 [=====================>........] - ETA: 0s - loss: 0.1799 - accuracy: 0.9526169/192 [=========================>....] - ETA: 0s - loss: 0.1793 - accuracy: 0.9527192/192 [==============================] - 1s 3ms/step - loss: 0.1786 - accuracy: 0.9528 - val_loss: 0.3543 - val_accuracy: 0.9385
Epoch 7/20
  1/192 [..............................] - ETA: 0s - loss: 0.1191 - accuracy: 0.9720 25/192 [==>...........................] - ETA: 0s - loss: 0.1516 - accuracy: 0.9574 49/192 [======>.......................] - ETA: 0s - loss: 0.1481 - accuracy: 0.9585 73/192 [==========>...................] - ETA: 0s - loss: 0.1470 - accuracy: 0.9587 97/192 [==============>...............] - ETA: 0s - loss: 0.1465 - accuracy: 0.9589121/192 [=================>............] - ETA: 0s - loss: 0.1461 - accuracy: 0.9592145/192 [=====================>........] - ETA: 0s - loss: 0.1466 - accuracy: 0.9593169/192 [=========================>....] - ETA: 0s - loss: 0.1477 - accuracy: 0.9592192/192 [==============================] - 1s 3ms/step - loss: 0.1487 - accuracy: 0.9592 - val_loss: 0.3178 - val_accuracy: 0.9418
Epoch 8/20
  1/192 [..............................] - ETA: 0s - loss: 0.1074 - accuracy: 0.9760 24/192 [==>...........................] - ETA: 0s - loss: 0.1355 - accuracy: 0.9618 48/192 [======>.......................] - ETA: 0s - loss: 0.1368 - accuracy: 0.9611 72/192 [==========>...................] - ETA: 0s - loss: 0.1357 - accuracy: 0.9615 96/192 [==============>...............] - ETA: 0s - loss: 0.1348 - accuracy: 0.9620120/192 [=================>............] - ETA: 0s - loss: 0.1345 - accuracy: 0.9624144/192 [=====================>........] - ETA: 0s - loss: 0.1346 - accuracy: 0.9626168/192 [=========================>....] - ETA: 0s - loss: 0.1350 - accuracy: 0.9627192/192 [==============================] - ETA: 0s - loss: 0.1355 - accuracy: 0.9627192/192 [==============================] - 1s 3ms/step - loss: 0.1355 - accuracy: 0.9627 - val_loss: 0.2951 - val_accuracy: 0.9458
Epoch 9/20
  1/192 [..............................] - ETA: 0s - loss: 0.1235 - accuracy: 0.9640 25/192 [==>...........................] - ETA: 0s - loss: 0.1228 - accuracy: 0.9679 49/192 [======>.......................] - ETA: 0s - loss: 0.1230 - accuracy: 0.9681 73/192 [==========>...................] - ETA: 0s - loss: 0.1211 - accuracy: 0.9681 98/192 [==============>...............] - ETA: 0s - loss: 0.1207 - accuracy: 0.9679122/192 [==================>...........] - ETA: 0s - loss: 0.1210 - accuracy: 0.9677147/192 [=====================>........] - ETA: 0s - loss: 0.1216 - accuracy: 0.9674172/192 [=========================>....] - ETA: 0s - loss: 0.1219 - accuracy: 0.9673192/192 [==============================] - 1s 3ms/step - loss: 0.1224 - accuracy: 0.9672 - val_loss: 0.2997 - val_accuracy: 0.9476
Epoch 10/20
  1/192 [..............................] - ETA: 0s - loss: 0.1382 - accuracy: 0.9640 26/192 [===>..........................] - ETA: 0s - loss: 0.1446 - accuracy: 0.9608 51/192 [======>.......................] - ETA: 0s - loss: 0.1398 - accuracy: 0.9627 76/192 [==========>...................] - ETA: 0s - loss: 0.1335 - accuracy: 0.9643101/192 [==============>...............] - ETA: 0s - loss: 0.1291 - accuracy: 0.9654125/192 [==================>...........] - ETA: 0s - loss: 0.1262 - accuracy: 0.9662150/192 [======================>.......] - ETA: 0s - loss: 0.1245 - accuracy: 0.9666174/192 [==========================>...] - ETA: 0s - loss: 0.1234 - accuracy: 0.9668192/192 [==============================] - 1s 3ms/step - loss: 0.1229 - accuracy: 0.9669 - val_loss: 0.2983 - val_accuracy: 0.9532
Epoch 11/20
  1/192 [..............................] - ETA: 0s - loss: 0.1048 - accuracy: 0.9680 25/192 [==>...........................] - ETA: 0s - loss: 0.1099 - accuracy: 0.9665 49/192 [======>.......................] - ETA: 0s - loss: 0.1036 - accuracy: 0.9685 74/192 [==========>...................] - ETA: 0s - loss: 0.0999 - accuracy: 0.9700 98/192 [==============>...............] - ETA: 0s - loss: 0.0975 - accuracy: 0.9709122/192 [==================>...........] - ETA: 0s - loss: 0.0965 - accuracy: 0.9714146/192 [=====================>........] - ETA: 0s - loss: 0.0961 - accuracy: 0.9717170/192 [=========================>....] - ETA: 0s - loss: 0.0960 - accuracy: 0.9718192/192 [==============================] - 1s 3ms/step - loss: 0.0960 - accuracy: 0.9720 - val_loss: 0.2784 - val_accuracy: 0.9524
Epoch 12/20
  1/192 [..............................] - ETA: 0s - loss: 0.0475 - accuracy: 0.9880 26/192 [===>..........................] - ETA: 0s - loss: 0.0700 - accuracy: 0.9783 51/192 [======>.......................] - ETA: 0s - loss: 0.0746 - accuracy: 0.9782 76/192 [==========>...................] - ETA: 0s - loss: 0.0766 - accuracy: 0.9781100/192 [==============>...............] - ETA: 0s - loss: 0.0786 - accuracy: 0.9777125/192 [==================>...........] - ETA: 0s - loss: 0.0805 - accuracy: 0.9773150/192 [======================>.......] - ETA: 0s - loss: 0.0820 - accuracy: 0.9769175/192 [==========================>...] - ETA: 0s - loss: 0.0832 - accuracy: 0.9767192/192 [==============================] - 1s 3ms/step - loss: 0.0840 - accuracy: 0.9765 - val_loss: 0.2896 - val_accuracy: 0.9572
Epoch 13/20
  1/192 [..............................] - ETA: 0s - loss: 0.0682 - accuracy: 0.9840 25/192 [==>...........................] - ETA: 0s - loss: 0.0739 - accuracy: 0.9794 49/192 [======>.......................] - ETA: 0s - loss: 0.0785 - accuracy: 0.9782 73/192 [==========>...................] - ETA: 0s - loss: 0.0788 - accuracy: 0.9780 97/192 [==============>...............] - ETA: 0s - loss: 0.0790 - accuracy: 0.9779121/192 [=================>............] - ETA: 0s - loss: 0.0791 - accuracy: 0.9778145/192 [=====================>........] - ETA: 0s - loss: 0.0793 - accuracy: 0.9776169/192 [=========================>....] - ETA: 0s - loss: 0.0797 - accuracy: 0.9774192/192 [==============================] - 1s 3ms/step - loss: 0.0802 - accuracy: 0.9772 - val_loss: 0.3323 - val_accuracy: 0.9514
Epoch 14/20
  1/192 [..............................] - ETA: 0s - loss: 0.1093 - accuracy: 0.9760 25/192 [==>...........................] - ETA: 0s - loss: 0.1052 - accuracy: 0.9728 50/192 [======>.......................] - ETA: 0s - loss: 0.0989 - accuracy: 0.9735 74/192 [==========>...................] - ETA: 0s - loss: 0.0945 - accuracy: 0.9743 98/192 [==============>...............] - ETA: 0s - loss: 0.0920 - accuracy: 0.9748122/192 [==================>...........] - ETA: 0s - loss: 0.0910 - accuracy: 0.9751146/192 [=====================>........] - ETA: 0s - loss: 0.0909 - accuracy: 0.9752170/192 [=========================>....] - ETA: 0s - loss: 0.0913 - accuracy: 0.9752192/192 [==============================] - 1s 3ms/step - loss: 0.0918 - accuracy: 0.9751 - val_loss: 0.2828 - val_accuracy: 0.9560
Epoch 15/20
  1/192 [..............................] - ETA: 0s - loss: 0.0965 - accuracy: 0.9880 25/192 [==>...........................] - ETA: 0s - loss: 0.0746 - accuracy: 0.9803 49/192 [======>.......................] - ETA: 0s - loss: 0.0716 - accuracy: 0.9808 73/192 [==========>...................] - ETA: 0s - loss: 0.0718 - accuracy: 0.9807 97/192 [==============>...............] - ETA: 0s - loss: 0.0723 - accuracy: 0.9804121/192 [=================>............] - ETA: 0s - loss: 0.0734 - accuracy: 0.9801145/192 [=====================>........] - ETA: 0s - loss: 0.0743 - accuracy: 0.9799169/192 [=========================>....] - ETA: 0s - loss: 0.0750 - accuracy: 0.9797192/192 [==============================] - 1s 3ms/step - loss: 0.0760 - accuracy: 0.9794 - val_loss: 0.2951 - val_accuracy: 0.9532
Epoch 16/20
  1/192 [..............................] - ETA: 0s - loss: 0.0722 - accuracy: 0.9880 25/192 [==>...........................] - ETA: 0s - loss: 0.0853 - accuracy: 0.9808 49/192 [======>.......................] - ETA: 0s - loss: 0.0864 - accuracy: 0.9794 73/192 [==========>...................] - ETA: 0s - loss: 0.0853 - accuracy: 0.9791 97/192 [==============>...............] - ETA: 0s - loss: 0.0845 - accuracy: 0.9790121/192 [=================>............] - ETA: 0s - loss: 0.0843 - accuracy: 0.9788145/192 [=====================>........] - ETA: 0s - loss: 0.0842 - accuracy: 0.9786169/192 [=========================>....] - ETA: 0s - loss: 0.0840 - accuracy: 0.9785192/192 [==============================] - 1s 3ms/step - loss: 0.0837 - accuracy: 0.9785 - val_loss: 0.2609 - val_accuracy: 0.9577
Epoch 17/20
  1/192 [..............................] - ETA: 0s - loss: 0.1210 - accuracy: 0.9720 25/192 [==>...........................] - ETA: 0s - loss: 0.0822 - accuracy: 0.9760 49/192 [======>.......................] - ETA: 0s - loss: 0.0800 - accuracy: 0.9771 73/192 [==========>...................] - ETA: 0s - loss: 0.0793 - accuracy: 0.9775 96/192 [==============>...............] - ETA: 0s - loss: 0.0782 - accuracy: 0.9779119/192 [=================>............] - ETA: 0s - loss: 0.0771 - accuracy: 0.9783143/192 [=====================>........] - ETA: 0s - loss: 0.0767 - accuracy: 0.9785167/192 [=========================>....] - ETA: 0s - loss: 0.0764 - accuracy: 0.9787191/192 [============================>.] - ETA: 0s - loss: 0.0763 - accuracy: 0.9788192/192 [==============================] - 1s 3ms/step - loss: 0.0763 - accuracy: 0.9788 - val_loss: 0.2441 - val_accuracy: 0.9580
Epoch 18/20
  1/192 [..............................] - ETA: 0s - loss: 0.0341 - accuracy: 0.9920 25/192 [==>...........................] - ETA: 0s - loss: 0.0552 - accuracy: 0.9851 48/192 [======>.......................] - ETA: 0s - loss: 0.0582 - accuracy: 0.9838 71/192 [==========>...................] - ETA: 0s - loss: 0.0599 - accuracy: 0.9835 95/192 [=============>................] - ETA: 0s - loss: 0.0608 - accuracy: 0.9832118/192 [=================>............] - ETA: 0s - loss: 0.0615 - accuracy: 0.9830142/192 [=====================>........] - ETA: 0s - loss: 0.0619 - accuracy: 0.9829166/192 [========================>.....] - ETA: 0s - loss: 0.0623 - accuracy: 0.9827190/192 [============================>.] - ETA: 0s - loss: 0.0626 - accuracy: 0.9826192/192 [==============================] - 1s 3ms/step - loss: 0.0627 - accuracy: 0.9826 - val_loss: 0.2763 - val_accuracy: 0.9592
Epoch 19/20
  1/192 [..............................] - ETA: 0s - loss: 0.0202 - accuracy: 0.9920 24/192 [==>...........................] - ETA: 0s - loss: 0.0476 - accuracy: 0.9871 47/192 [======>.......................] - ETA: 0s - loss: 0.0526 - accuracy: 0.9855 70/192 [=========>....................] - ETA: 0s - loss: 0.0543 - accuracy: 0.9848 93/192 [=============>................] - ETA: 0s - loss: 0.0562 - accuracy: 0.9841117/192 [=================>............] - ETA: 0s - loss: 0.0583 - accuracy: 0.9836140/192 [====================>.........] - ETA: 0s - loss: 0.0602 - accuracy: 0.9831163/192 [========================>.....] - ETA: 0s - loss: 0.0616 - accuracy: 0.9828187/192 [============================>.] - ETA: 0s - loss: 0.0627 - accuracy: 0.9826192/192 [==============================] - 1s 3ms/step - loss: 0.0628 - accuracy: 0.9826 - val_loss: 0.2551 - val_accuracy: 0.9602
Epoch 20/20
  1/192 [..............................] - ETA: 0s - loss: 0.0374 - accuracy: 0.9880 24/192 [==>...........................] - ETA: 0s - loss: 0.0642 - accuracy: 0.9821 47/192 [======>.......................] - ETA: 0s - loss: 0.0609 - accuracy: 0.9828 70/192 [=========>....................] - ETA: 0s - loss: 0.0602 - accuracy: 0.9831 93/192 [=============>................] - ETA: 0s - loss: 0.0607 - accuracy: 0.9832116/192 [=================>............] - ETA: 0s - loss: 0.0623 - accuracy: 0.9830139/192 [====================>.........] - ETA: 0s - loss: 0.0637 - accuracy: 0.9827162/192 [========================>.....] - ETA: 0s - loss: 0.0647 - accuracy: 0.9826185/192 [===========================>..] - ETA: 0s - loss: 0.0654 - accuracy: 0.9824192/192 [==============================] - 1s 3ms/step - loss: 0.0656 - accuracy: 0.9824 - val_loss: 0.2401 - val_accuracy: 0.9583
training_time: 0:00:11.623619
  1/313 [..............................] - ETA: 40s - loss: 0.0087 - accuracy: 1.0000 22/313 [=>............................] - ETA: 0s - loss: 0.2754 - accuracy: 0.9545  43/313 [===>..........................] - ETA: 0s - loss: 0.3062 - accuracy: 0.9462 64/313 [=====>........................] - ETA: 0s - loss: 0.3222 - accuracy: 0.9448 85/313 [=======>......................] - ETA: 0s - loss: 0.3205 - accuracy: 0.9430106/313 [=========>....................] - ETA: 0s - loss: 0.3124 - accuracy: 0.9460127/313 [===========>..................] - ETA: 0s - loss: 0.3334 - accuracy: 0.9434149/313 [=============>................] - ETA: 0s - loss: 0.3226 - accuracy: 0.9425171/313 [===============>..............] - ETA: 0s - loss: 0.3054 - accuracy: 0.9455192/313 [=================>............] - ETA: 0s - loss: 0.2986 - accuracy: 0.9466214/313 [===================>..........] - ETA: 0s - loss: 0.2876 - accuracy: 0.9474236/313 [=====================>........] - ETA: 0s - loss: 0.2676 - accuracy: 0.9501257/313 [=======================>......] - ETA: 0s - loss: 0.2557 - accuracy: 0.9521278/313 [=========================>....] - ETA: 0s - loss: 0.2501 - accuracy: 0.9538300/313 [===========================>..] - ETA: 0s - loss: 0.2384 - accuracy: 0.9559313/313 [==============================] - 1s 2ms/step - loss: 0.2460 - accuracy: 0.9537
Test results: Loss = 0.24602659046649933, Accuracy = 0.9537000060081482
