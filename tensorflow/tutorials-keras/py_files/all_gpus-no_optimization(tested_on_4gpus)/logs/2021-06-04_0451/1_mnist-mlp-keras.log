Number of devices: 4
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
60000 10000
Epoch 1/20
  1/192 [..............................] - ETA: 2:34 - loss: 101.8804 - accuracy: 0.0960 24/192 [==>...........................] - ETA: 0s - loss: 34.0561 - accuracy: 0.3615    47/192 [======>.......................] - ETA: 0s - loss: 22.6296 - accuracy: 0.4070 71/192 [==========>...................] - ETA: 0s - loss: 17.3457 - accuracy: 0.4287 94/192 [=============>................] - ETA: 0s - loss: 14.4208 - accuracy: 0.4459118/192 [=================>............] - ETA: 0s - loss: 12.3960 - accuracy: 0.4639142/192 [=====================>........] - ETA: 0s - loss: 10.9499 - accuracy: 0.4811165/192 [========================>.....] - ETA: 0s - loss: 9.8989 - accuracy: 0.4969 189/192 [============================>.] - ETA: 0s - loss: 9.0333 - accuracy: 0.5120192/192 [==============================] - 2s 5ms/step - loss: 8.9067 - accuracy: 0.5144 - val_loss: 0.7807 - val_accuracy: 0.7832
Epoch 2/20
  1/192 [..............................] - ETA: 0s - loss: 1.0220 - accuracy: 0.7680 24/192 [==>...........................] - ETA: 0s - loss: 0.7799 - accuracy: 0.7928 47/192 [======>.......................] - ETA: 0s - loss: 0.7473 - accuracy: 0.8042 70/192 [=========>....................] - ETA: 0s - loss: 0.7280 - accuracy: 0.8104 93/192 [=============>................] - ETA: 0s - loss: 0.7125 - accuracy: 0.8151116/192 [=================>............] - ETA: 0s - loss: 0.6990 - accuracy: 0.8190140/192 [====================>.........] - ETA: 0s - loss: 0.6864 - accuracy: 0.8224163/192 [========================>.....] - ETA: 0s - loss: 0.6755 - accuracy: 0.8252187/192 [============================>.] - ETA: 0s - loss: 0.6660 - accuracy: 0.8278192/192 [==============================] - 1s 3ms/step - loss: 0.6638 - accuracy: 0.8283 - val_loss: 0.4804 - val_accuracy: 0.8752
Epoch 3/20
  1/192 [..............................] - ETA: 0s - loss: 0.3035 - accuracy: 0.9200 24/192 [==>...........................] - ETA: 0s - loss: 0.3970 - accuracy: 0.8865 48/192 [======>.......................] - ETA: 0s - loss: 0.4061 - accuracy: 0.8862 71/192 [==========>...................] - ETA: 0s - loss: 0.4094 - accuracy: 0.8863 95/192 [=============>................] - ETA: 0s - loss: 0.4111 - accuracy: 0.8870119/192 [=================>............] - ETA: 0s - loss: 0.4121 - accuracy: 0.8874143/192 [=====================>........] - ETA: 0s - loss: 0.4126 - accuracy: 0.8877167/192 [=========================>....] - ETA: 0s - loss: 0.4124 - accuracy: 0.8880191/192 [============================>.] - ETA: 0s - loss: 0.4115 - accuracy: 0.8885192/192 [==============================] - 1s 3ms/step - loss: 0.4114 - accuracy: 0.8885 - val_loss: 0.3976 - val_accuracy: 0.8929
Epoch 4/20
  1/192 [..............................] - ETA: 0s - loss: 0.2825 - accuracy: 0.9240 25/192 [==>...........................] - ETA: 0s - loss: 0.3114 - accuracy: 0.9111 49/192 [======>.......................] - ETA: 0s - loss: 0.3102 - accuracy: 0.9121 73/192 [==========>...................] - ETA: 0s - loss: 0.3102 - accuracy: 0.9133 97/192 [==============>...............] - ETA: 0s - loss: 0.3102 - accuracy: 0.9138122/192 [==================>...........] - ETA: 0s - loss: 0.3097 - accuracy: 0.9144146/192 [=====================>........] - ETA: 0s - loss: 0.3087 - accuracy: 0.9149170/192 [=========================>....] - ETA: 0s - loss: 0.3076 - accuracy: 0.9154192/192 [==============================] - 1s 3ms/step - loss: 0.3065 - accuracy: 0.9159 - val_loss: 0.3492 - val_accuracy: 0.9246
Epoch 5/20
  1/192 [..............................] - ETA: 0s - loss: 0.2669 - accuracy: 0.9280 25/192 [==>...........................] - ETA: 0s - loss: 0.2179 - accuracy: 0.9363 49/192 [======>.......................] - ETA: 0s - loss: 0.2193 - accuracy: 0.9367 74/192 [==========>...................] - ETA: 0s - loss: 0.2245 - accuracy: 0.9363 98/192 [==============>...............] - ETA: 0s - loss: 0.2287 - accuracy: 0.9358122/192 [==================>...........] - ETA: 0s - loss: 0.2299 - accuracy: 0.9359146/192 [=====================>........] - ETA: 0s - loss: 0.2308 - accuracy: 0.9360170/192 [=========================>....] - ETA: 0s - loss: 0.2314 - accuracy: 0.9360192/192 [==============================] - 1s 3ms/step - loss: 0.2320 - accuracy: 0.9361 - val_loss: 0.3315 - val_accuracy: 0.9345
Epoch 6/20
  1/192 [..............................] - ETA: 0s - loss: 0.1861 - accuracy: 0.9400 25/192 [==>...........................] - ETA: 0s - loss: 0.2064 - accuracy: 0.9429 49/192 [======>.......................] - ETA: 0s - loss: 0.2030 - accuracy: 0.9426 73/192 [==========>...................] - ETA: 0s - loss: 0.2022 - accuracy: 0.9430 97/192 [==============>...............] - ETA: 0s - loss: 0.2020 - accuracy: 0.9433121/192 [=================>............] - ETA: 0s - loss: 0.2022 - accuracy: 0.9436145/192 [=====================>........] - ETA: 0s - loss: 0.2022 - accuracy: 0.9438169/192 [=========================>....] - ETA: 0s - loss: 0.2018 - accuracy: 0.9440192/192 [==============================] - 1s 3ms/step - loss: 0.2013 - accuracy: 0.9442 - val_loss: 0.2859 - val_accuracy: 0.9441
Epoch 7/20
  1/192 [..............................] - ETA: 0s - loss: 0.1923 - accuracy: 0.9280 25/192 [==>...........................] - ETA: 0s - loss: 0.1594 - accuracy: 0.9556 49/192 [======>.......................] - ETA: 0s - loss: 0.1572 - accuracy: 0.9560 73/192 [==========>...................] - ETA: 0s - loss: 0.1556 - accuracy: 0.9561 97/192 [==============>...............] - ETA: 0s - loss: 0.1546 - accuracy: 0.9563121/192 [=================>............] - ETA: 0s - loss: 0.1545 - accuracy: 0.9562145/192 [=====================>........] - ETA: 0s - loss: 0.1549 - accuracy: 0.9561169/192 [=========================>....] - ETA: 0s - loss: 0.1559 - accuracy: 0.9560192/192 [==============================] - 1s 3ms/step - loss: 0.1571 - accuracy: 0.9558 - val_loss: 0.2761 - val_accuracy: 0.9382
Epoch 8/20
  1/192 [..............................] - ETA: 0s - loss: 0.1436 - accuracy: 0.9480 25/192 [==>...........................] - ETA: 0s - loss: 0.1701 - accuracy: 0.9467 49/192 [======>.......................] - ETA: 0s - loss: 0.1732 - accuracy: 0.9488 73/192 [==========>...................] - ETA: 0s - loss: 0.1723 - accuracy: 0.9504 97/192 [==============>...............] - ETA: 0s - loss: 0.1700 - accuracy: 0.9515121/192 [=================>............] - ETA: 0s - loss: 0.1678 - accuracy: 0.9524145/192 [=====================>........] - ETA: 0s - loss: 0.1659 - accuracy: 0.9530169/192 [=========================>....] - ETA: 0s - loss: 0.1646 - accuracy: 0.9535192/192 [==============================] - 1s 3ms/step - loss: 0.1636 - accuracy: 0.9539 - val_loss: 0.2309 - val_accuracy: 0.9489
Epoch 9/20
  1/192 [..............................] - ETA: 0s - loss: 0.1428 - accuracy: 0.9520 25/192 [==>...........................] - ETA: 0s - loss: 0.1291 - accuracy: 0.9568 50/192 [======>.......................] - ETA: 0s - loss: 0.1295 - accuracy: 0.9601 74/192 [==========>...................] - ETA: 0s - loss: 0.1305 - accuracy: 0.9610 98/192 [==============>...............] - ETA: 0s - loss: 0.1313 - accuracy: 0.9613122/192 [==================>...........] - ETA: 0s - loss: 0.1323 - accuracy: 0.9614147/192 [=====================>........] - ETA: 0s - loss: 0.1326 - accuracy: 0.9616172/192 [=========================>....] - ETA: 0s - loss: 0.1327 - accuracy: 0.9617192/192 [==============================] - 1s 3ms/step - loss: 0.1326 - accuracy: 0.9619 - val_loss: 0.2538 - val_accuracy: 0.9532
Epoch 10/20
  1/192 [..............................] - ETA: 0s - loss: 0.1002 - accuracy: 0.9600 25/192 [==>...........................] - ETA: 0s - loss: 0.1087 - accuracy: 0.9675 50/192 [======>.......................] - ETA: 0s - loss: 0.1044 - accuracy: 0.9685 75/192 [==========>...................] - ETA: 0s - loss: 0.1043 - accuracy: 0.9685 99/192 [==============>...............] - ETA: 0s - loss: 0.1039 - accuracy: 0.9687123/192 [==================>...........] - ETA: 0s - loss: 0.1039 - accuracy: 0.9688147/192 [=====================>........] - ETA: 0s - loss: 0.1040 - accuracy: 0.9688172/192 [=========================>....] - ETA: 0s - loss: 0.1047 - accuracy: 0.9687192/192 [==============================] - 1s 3ms/step - loss: 0.1051 - accuracy: 0.9686 - val_loss: 0.2483 - val_accuracy: 0.9572
Epoch 11/20
  1/192 [..............................] - ETA: 0s - loss: 0.0768 - accuracy: 0.9760 25/192 [==>...........................] - ETA: 0s - loss: 0.0814 - accuracy: 0.9766 49/192 [======>.......................] - ETA: 0s - loss: 0.0881 - accuracy: 0.9748 74/192 [==========>...................] - ETA: 0s - loss: 0.0927 - accuracy: 0.9736 98/192 [==============>...............] - ETA: 0s - loss: 0.0954 - accuracy: 0.9730122/192 [==================>...........] - ETA: 0s - loss: 0.0974 - accuracy: 0.9725146/192 [=====================>........] - ETA: 0s - loss: 0.0988 - accuracy: 0.9720170/192 [=========================>....] - ETA: 0s - loss: 0.0996 - accuracy: 0.9717192/192 [==============================] - 1s 3ms/step - loss: 0.1002 - accuracy: 0.9715 - val_loss: 0.2067 - val_accuracy: 0.9577
Epoch 12/20
  1/192 [..............................] - ETA: 0s - loss: 0.0783 - accuracy: 0.9760 25/192 [==>...........................] - ETA: 0s - loss: 0.0952 - accuracy: 0.9700 49/192 [======>.......................] - ETA: 0s - loss: 0.0940 - accuracy: 0.9711 73/192 [==========>...................] - ETA: 0s - loss: 0.0941 - accuracy: 0.9715 97/192 [==============>...............] - ETA: 0s - loss: 0.0941 - accuracy: 0.9716122/192 [==================>...........] - ETA: 0s - loss: 0.0935 - accuracy: 0.9718146/192 [=====================>........] - ETA: 0s - loss: 0.0928 - accuracy: 0.9720170/192 [=========================>....] - ETA: 0s - loss: 0.0923 - accuracy: 0.9722192/192 [==============================] - 1s 3ms/step - loss: 0.0921 - accuracy: 0.9723 - val_loss: 0.2134 - val_accuracy: 0.9606
Epoch 13/20
  1/192 [..............................] - ETA: 0s - loss: 0.1110 - accuracy: 0.9560 25/192 [==>...........................] - ETA: 0s - loss: 0.0818 - accuracy: 0.9741 49/192 [======>.......................] - ETA: 0s - loss: 0.0828 - accuracy: 0.9744 73/192 [==========>...................] - ETA: 0s - loss: 0.0817 - accuracy: 0.9747 97/192 [==============>...............] - ETA: 0s - loss: 0.0820 - accuracy: 0.9748121/192 [=================>............] - ETA: 0s - loss: 0.0843 - accuracy: 0.9746145/192 [=====================>........] - ETA: 0s - loss: 0.0861 - accuracy: 0.9743169/192 [=========================>....] - ETA: 0s - loss: 0.0873 - accuracy: 0.9741192/192 [==============================] - 1s 3ms/step - loss: 0.0881 - accuracy: 0.9740 - val_loss: 0.2397 - val_accuracy: 0.9603
Epoch 14/20
  1/192 [..............................] - ETA: 0s - loss: 0.0554 - accuracy: 0.9920 25/192 [==>...........................] - ETA: 0s - loss: 0.0801 - accuracy: 0.9784 49/192 [======>.......................] - ETA: 0s - loss: 0.0793 - accuracy: 0.9776 73/192 [==========>...................] - ETA: 0s - loss: 0.0799 - accuracy: 0.9774 97/192 [==============>...............] - ETA: 0s - loss: 0.0810 - accuracy: 0.9772121/192 [=================>............] - ETA: 0s - loss: 0.0818 - accuracy: 0.9771145/192 [=====================>........] - ETA: 0s - loss: 0.0824 - accuracy: 0.9769169/192 [=========================>....] - ETA: 0s - loss: 0.0829 - accuracy: 0.9767192/192 [==============================] - 1s 3ms/step - loss: 0.0837 - accuracy: 0.9766 - val_loss: 0.2258 - val_accuracy: 0.9613
Epoch 15/20
  1/192 [..............................] - ETA: 0s - loss: 0.0375 - accuracy: 0.9840 25/192 [==>...........................] - ETA: 0s - loss: 0.0708 - accuracy: 0.9782 49/192 [======>.......................] - ETA: 0s - loss: 0.0721 - accuracy: 0.9777 73/192 [==========>...................] - ETA: 0s - loss: 0.0730 - accuracy: 0.9775 97/192 [==============>...............] - ETA: 0s - loss: 0.0730 - accuracy: 0.9776121/192 [=================>............] - ETA: 0s - loss: 0.0730 - accuracy: 0.9777145/192 [=====================>........] - ETA: 0s - loss: 0.0732 - accuracy: 0.9777169/192 [=========================>....] - ETA: 0s - loss: 0.0733 - accuracy: 0.9778192/192 [==============================] - 1s 3ms/step - loss: 0.0735 - accuracy: 0.9778 - val_loss: 0.2019 - val_accuracy: 0.9632
Epoch 16/20
  1/192 [..............................] - ETA: 0s - loss: 0.0091 - accuracy: 1.0000 25/192 [==>...........................] - ETA: 0s - loss: 0.0635 - accuracy: 0.9799 49/192 [======>.......................] - ETA: 0s - loss: 0.0645 - accuracy: 0.9799 73/192 [==========>...................] - ETA: 0s - loss: 0.0658 - accuracy: 0.9796 97/192 [==============>...............] - ETA: 0s - loss: 0.0664 - accuracy: 0.9796121/192 [=================>............] - ETA: 0s - loss: 0.0665 - accuracy: 0.9797145/192 [=====================>........] - ETA: 0s - loss: 0.0665 - accuracy: 0.9798169/192 [=========================>....] - ETA: 0s - loss: 0.0670 - accuracy: 0.9798192/192 [==============================] - 1s 3ms/step - loss: 0.0673 - accuracy: 0.9798 - val_loss: 0.2218 - val_accuracy: 0.9645
Epoch 17/20
  1/192 [..............................] - ETA: 0s - loss: 0.0216 - accuracy: 0.9880 25/192 [==>...........................] - ETA: 0s - loss: 0.0465 - accuracy: 0.9847 48/192 [======>.......................] - ETA: 0s - loss: 0.0536 - accuracy: 0.9834 71/192 [==========>...................] - ETA: 0s - loss: 0.0585 - accuracy: 0.9827 95/192 [=============>................] - ETA: 0s - loss: 0.0610 - accuracy: 0.9822118/192 [=================>............] - ETA: 0s - loss: 0.0625 - accuracy: 0.9819142/192 [=====================>........] - ETA: 0s - loss: 0.0637 - accuracy: 0.9816166/192 [========================>.....] - ETA: 0s - loss: 0.0646 - accuracy: 0.9814190/192 [============================>.] - ETA: 0s - loss: 0.0656 - accuracy: 0.9811192/192 [==============================] - 1s 3ms/step - loss: 0.0657 - accuracy: 0.9811 - val_loss: 0.2215 - val_accuracy: 0.9622
Epoch 18/20
  1/192 [..............................] - ETA: 0s - loss: 0.0398 - accuracy: 0.9880 25/192 [==>...........................] - ETA: 0s - loss: 0.0570 - accuracy: 0.9843 49/192 [======>.......................] - ETA: 0s - loss: 0.0574 - accuracy: 0.9834 73/192 [==========>...................] - ETA: 0s - loss: 0.0575 - accuracy: 0.9829 97/192 [==============>...............] - ETA: 0s - loss: 0.0569 - accuracy: 0.9830121/192 [=================>............] - ETA: 0s - loss: 0.0567 - accuracy: 0.9830145/192 [=====================>........] - ETA: 0s - loss: 0.0567 - accuracy: 0.9830169/192 [=========================>....] - ETA: 0s - loss: 0.0566 - accuracy: 0.9830192/192 [==============================] - 1s 3ms/step - loss: 0.0565 - accuracy: 0.9830 - val_loss: 0.2073 - val_accuracy: 0.9647
Epoch 19/20
  1/192 [..............................] - ETA: 0s - loss: 0.0124 - accuracy: 0.9960 25/192 [==>...........................] - ETA: 0s - loss: 0.0415 - accuracy: 0.9870 49/192 [======>.......................] - ETA: 0s - loss: 0.0417 - accuracy: 0.9869 73/192 [==========>...................] - ETA: 0s - loss: 0.0434 - accuracy: 0.9865 97/192 [==============>...............] - ETA: 0s - loss: 0.0446 - accuracy: 0.9862121/192 [=================>............] - ETA: 0s - loss: 0.0457 - accuracy: 0.9860145/192 [=====================>........] - ETA: 0s - loss: 0.0469 - accuracy: 0.9857169/192 [=========================>....] - ETA: 0s - loss: 0.0478 - accuracy: 0.9855192/192 [==============================] - 1s 3ms/step - loss: 0.0482 - accuracy: 0.9853 - val_loss: 0.1995 - val_accuracy: 0.9670
Epoch 20/20
  1/192 [..............................] - ETA: 0s - loss: 0.0643 - accuracy: 0.9760 25/192 [==>...........................] - ETA: 0s - loss: 0.0508 - accuracy: 0.9829 49/192 [======>.......................] - ETA: 0s - loss: 0.0491 - accuracy: 0.9840 73/192 [==========>...................] - ETA: 0s - loss: 0.0478 - accuracy: 0.9847 97/192 [==============>...............] - ETA: 0s - loss: 0.0471 - accuracy: 0.9852121/192 [=================>............] - ETA: 0s - loss: 0.0470 - accuracy: 0.9853145/192 [=====================>........] - ETA: 0s - loss: 0.0474 - accuracy: 0.9853169/192 [=========================>....] - ETA: 0s - loss: 0.0480 - accuracy: 0.9852192/192 [==============================] - 1s 3ms/step - loss: 0.0486 - accuracy: 0.9851 - val_loss: 0.2269 - val_accuracy: 0.9640
training_time: 0:00:11.597530
  1/313 [..............................] - ETA: 40s - loss: 0.0237 - accuracy: 1.0000 23/313 [=>............................] - ETA: 0s - loss: 0.1658 - accuracy: 0.9688  45/313 [===>..........................] - ETA: 0s - loss: 0.2733 - accuracy: 0.9604 67/313 [=====>........................] - ETA: 0s - loss: 0.3433 - accuracy: 0.9543 89/313 [=======>......................] - ETA: 0s - loss: 0.3210 - accuracy: 0.9561111/313 [=========>....................] - ETA: 0s - loss: 0.3213 - accuracy: 0.9564133/313 [===========>..................] - ETA: 0s - loss: 0.3232 - accuracy: 0.9551155/313 [=============>................] - ETA: 0s - loss: 0.3185 - accuracy: 0.9558177/313 [===============>..............] - ETA: 0s - loss: 0.2935 - accuracy: 0.9582199/313 [==================>...........] - ETA: 0s - loss: 0.2771 - accuracy: 0.9595221/313 [====================>.........] - ETA: 0s - loss: 0.2714 - accuracy: 0.9608243/313 [======================>.......] - ETA: 0s - loss: 0.2488 - accuracy: 0.9637265/313 [========================>.....] - ETA: 0s - loss: 0.2385 - accuracy: 0.9649287/313 [==========================>...] - ETA: 0s - loss: 0.2333 - accuracy: 0.9668309/313 [============================>.] - ETA: 0s - loss: 0.2325 - accuracy: 0.9665313/313 [==============================] - 1s 2ms/step - loss: 0.2321 - accuracy: 0.9663
Test results: Loss = 0.23212288320064545, Accuracy = 0.9663000106811523
