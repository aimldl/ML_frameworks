Number of devices: 4
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
60000 10000
Epoch 1/20
  1/192 [..............................] - ETA: 2:30 - loss: 140.1546 - accuracy: 0.1200 24/192 [==>...........................] - ETA: 0s - loss: 47.2263 - accuracy: 0.3968    48/192 [======>.......................] - ETA: 0s - loss: 30.8322 - accuracy: 0.4715 72/192 [==========>...................] - ETA: 0s - loss: 23.5818 - accuracy: 0.5018 96/192 [==============>...............] - ETA: 0s - loss: 19.3818 - accuracy: 0.5260119/192 [=================>............] - ETA: 0s - loss: 16.6997 - accuracy: 0.5461142/192 [=====================>........] - ETA: 0s - loss: 14.7535 - accuracy: 0.5636165/192 [========================>.....] - ETA: 0s - loss: 13.2705 - accuracy: 0.5786188/192 [============================>.] - ETA: 0s - loss: 12.0982 - accuracy: 0.5917192/192 [==============================] - 2s 5ms/step - loss: 11.8747 - accuracy: 0.5943 - val_loss: 0.6623 - val_accuracy: 0.8442
Epoch 2/20
  1/192 [..............................] - ETA: 0s - loss: 0.6083 - accuracy: 0.8560 24/192 [==>...........................] - ETA: 0s - loss: 0.6085 - accuracy: 0.8479 47/192 [======>.......................] - ETA: 0s - loss: 0.6055 - accuracy: 0.8482 70/192 [=========>....................] - ETA: 0s - loss: 0.6017 - accuracy: 0.8493 93/192 [=============>................] - ETA: 0s - loss: 0.5982 - accuracy: 0.8505116/192 [=================>............] - ETA: 0s - loss: 0.5945 - accuracy: 0.8516139/192 [====================>.........] - ETA: 0s - loss: 0.5922 - accuracy: 0.8524162/192 [========================>.....] - ETA: 0s - loss: 0.5903 - accuracy: 0.8532186/192 [============================>.] - ETA: 0s - loss: 0.5879 - accuracy: 0.8539192/192 [==============================] - 1s 3ms/step - loss: 0.5872 - accuracy: 0.8541 - val_loss: 0.4639 - val_accuracy: 0.8867
Epoch 3/20
  1/192 [..............................] - ETA: 0s - loss: 0.2982 - accuracy: 0.9120 24/192 [==>...........................] - ETA: 0s - loss: 0.3917 - accuracy: 0.8856 47/192 [======>.......................] - ETA: 0s - loss: 0.3956 - accuracy: 0.8886 70/192 [=========>....................] - ETA: 0s - loss: 0.4004 - accuracy: 0.8896 93/192 [=============>................] - ETA: 0s - loss: 0.4005 - accuracy: 0.8911116/192 [=================>............] - ETA: 0s - loss: 0.3995 - accuracy: 0.8924139/192 [====================>.........] - ETA: 0s - loss: 0.3983 - accuracy: 0.8935162/192 [========================>.....] - ETA: 0s - loss: 0.3973 - accuracy: 0.8945185/192 [===========================>..] - ETA: 0s - loss: 0.3965 - accuracy: 0.8952192/192 [==============================] - 1s 3ms/step - loss: 0.3961 - accuracy: 0.8954 - val_loss: 0.3895 - val_accuracy: 0.9095
Epoch 4/20
  1/192 [..............................] - ETA: 0s - loss: 0.2519 - accuracy: 0.9200 24/192 [==>...........................] - ETA: 0s - loss: 0.2872 - accuracy: 0.9198 47/192 [======>.......................] - ETA: 0s - loss: 0.2931 - accuracy: 0.9197 70/192 [=========>....................] - ETA: 0s - loss: 0.2952 - accuracy: 0.9201 93/192 [=============>................] - ETA: 0s - loss: 0.2958 - accuracy: 0.9205116/192 [=================>............] - ETA: 0s - loss: 0.2959 - accuracy: 0.9207139/192 [====================>.........] - ETA: 0s - loss: 0.2957 - accuracy: 0.9209162/192 [========================>.....] - ETA: 0s - loss: 0.2957 - accuracy: 0.9210185/192 [===========================>..] - ETA: 0s - loss: 0.2961 - accuracy: 0.9210192/192 [==============================] - 1s 3ms/step - loss: 0.2962 - accuracy: 0.9210 - val_loss: 0.3342 - val_accuracy: 0.9304
Epoch 5/20
  1/192 [..............................] - ETA: 0s - loss: 0.2087 - accuracy: 0.9400 24/192 [==>...........................] - ETA: 0s - loss: 0.2119 - accuracy: 0.9443 47/192 [======>.......................] - ETA: 0s - loss: 0.2240 - accuracy: 0.9405 70/192 [=========>....................] - ETA: 0s - loss: 0.2327 - accuracy: 0.9385 93/192 [=============>................] - ETA: 0s - loss: 0.2394 - accuracy: 0.9371116/192 [=================>............] - ETA: 0s - loss: 0.2432 - accuracy: 0.9365139/192 [====================>.........] - ETA: 0s - loss: 0.2463 - accuracy: 0.9359162/192 [========================>.....] - ETA: 0s - loss: 0.2484 - accuracy: 0.9356185/192 [===========================>..] - ETA: 0s - loss: 0.2498 - accuracy: 0.9353192/192 [==============================] - 1s 3ms/step - loss: 0.2501 - accuracy: 0.9352 - val_loss: 0.3057 - val_accuracy: 0.9325
Epoch 6/20
  1/192 [..............................] - ETA: 0s - loss: 0.2339 - accuracy: 0.9160 25/192 [==>...........................] - ETA: 0s - loss: 0.2015 - accuracy: 0.9395 48/192 [======>.......................] - ETA: 0s - loss: 0.2024 - accuracy: 0.9415 72/192 [==========>...................] - ETA: 0s - loss: 0.2019 - accuracy: 0.9423 96/192 [==============>...............] - ETA: 0s - loss: 0.2033 - accuracy: 0.9425120/192 [=================>............] - ETA: 0s - loss: 0.2053 - accuracy: 0.9425143/192 [=====================>........] - ETA: 0s - loss: 0.2064 - accuracy: 0.9425166/192 [========================>.....] - ETA: 0s - loss: 0.2072 - accuracy: 0.9425190/192 [============================>.] - ETA: 0s - loss: 0.2081 - accuracy: 0.9426192/192 [==============================] - 1s 3ms/step - loss: 0.2082 - accuracy: 0.9426 - val_loss: 0.3250 - val_accuracy: 0.9372
Epoch 7/20
  1/192 [..............................] - ETA: 0s - loss: 0.1895 - accuracy: 0.9560 24/192 [==>...........................] - ETA: 0s - loss: 0.1741 - accuracy: 0.9484 47/192 [======>.......................] - ETA: 0s - loss: 0.1759 - accuracy: 0.9487 70/192 [=========>....................] - ETA: 0s - loss: 0.1789 - accuracy: 0.9490 93/192 [=============>................] - ETA: 0s - loss: 0.1808 - accuracy: 0.9491116/192 [=================>............] - ETA: 0s - loss: 0.1822 - accuracy: 0.9490139/192 [====================>.........] - ETA: 0s - loss: 0.1834 - accuracy: 0.9488162/192 [========================>.....] - ETA: 0s - loss: 0.1849 - accuracy: 0.9486185/192 [===========================>..] - ETA: 0s - loss: 0.1867 - accuracy: 0.9483192/192 [==============================] - 1s 3ms/step - loss: 0.1871 - accuracy: 0.9483 - val_loss: 0.2830 - val_accuracy: 0.9436
Epoch 8/20
  1/192 [..............................] - ETA: 0s - loss: 0.1320 - accuracy: 0.9600 24/192 [==>...........................] - ETA: 0s - loss: 0.1524 - accuracy: 0.9567 47/192 [======>.......................] - ETA: 0s - loss: 0.1591 - accuracy: 0.9556 70/192 [=========>....................] - ETA: 0s - loss: 0.1615 - accuracy: 0.9547 93/192 [=============>................] - ETA: 0s - loss: 0.1619 - accuracy: 0.9545116/192 [=================>............] - ETA: 0s - loss: 0.1619 - accuracy: 0.9542139/192 [====================>.........] - ETA: 0s - loss: 0.1623 - accuracy: 0.9540162/192 [========================>.....] - ETA: 0s - loss: 0.1627 - accuracy: 0.9539185/192 [===========================>..] - ETA: 0s - loss: 0.1630 - accuracy: 0.9538192/192 [==============================] - 1s 3ms/step - loss: 0.1631 - accuracy: 0.9538 - val_loss: 0.2907 - val_accuracy: 0.9404
Epoch 9/20
  1/192 [..............................] - ETA: 0s - loss: 0.1484 - accuracy: 0.9640 24/192 [==>...........................] - ETA: 0s - loss: 0.1330 - accuracy: 0.9603 47/192 [======>.......................] - ETA: 0s - loss: 0.1380 - accuracy: 0.9595 70/192 [=========>....................] - ETA: 0s - loss: 0.1405 - accuracy: 0.9595 93/192 [=============>................] - ETA: 0s - loss: 0.1422 - accuracy: 0.9593116/192 [=================>............] - ETA: 0s - loss: 0.1425 - accuracy: 0.9593138/192 [====================>.........] - ETA: 0s - loss: 0.1426 - accuracy: 0.9593161/192 [========================>.....] - ETA: 0s - loss: 0.1427 - accuracy: 0.9593184/192 [===========================>..] - ETA: 0s - loss: 0.1426 - accuracy: 0.9593192/192 [==============================] - 1s 3ms/step - loss: 0.1426 - accuracy: 0.9593 - val_loss: 0.2871 - val_accuracy: 0.9434
Epoch 10/20
  1/192 [..............................] - ETA: 0s - loss: 0.1290 - accuracy: 0.9680 23/192 [==>...........................] - ETA: 0s - loss: 0.1562 - accuracy: 0.9533 45/192 [======>.......................] - ETA: 0s - loss: 0.1478 - accuracy: 0.9563 68/192 [=========>....................] - ETA: 0s - loss: 0.1441 - accuracy: 0.9576 91/192 [=============>................] - ETA: 0s - loss: 0.1429 - accuracy: 0.9583114/192 [================>.............] - ETA: 0s - loss: 0.1426 - accuracy: 0.9587137/192 [====================>.........] - ETA: 0s - loss: 0.1422 - accuracy: 0.9590160/192 [========================>.....] - ETA: 0s - loss: 0.1418 - accuracy: 0.9593183/192 [===========================>..] - ETA: 0s - loss: 0.1414 - accuracy: 0.9596192/192 [==============================] - 1s 3ms/step - loss: 0.1413 - accuracy: 0.9597 - val_loss: 0.2566 - val_accuracy: 0.9551
Epoch 11/20
  1/192 [..............................] - ETA: 0s - loss: 0.1432 - accuracy: 0.9600 24/192 [==>...........................] - ETA: 0s - loss: 0.1069 - accuracy: 0.9671 47/192 [======>.......................] - ETA: 0s - loss: 0.1032 - accuracy: 0.9682 70/192 [=========>....................] - ETA: 0s - loss: 0.1037 - accuracy: 0.9685 93/192 [=============>................] - ETA: 0s - loss: 0.1051 - accuracy: 0.9685116/192 [=================>............] - ETA: 0s - loss: 0.1056 - accuracy: 0.9685139/192 [====================>.........] - ETA: 0s - loss: 0.1067 - accuracy: 0.9684162/192 [========================>.....] - ETA: 0s - loss: 0.1078 - accuracy: 0.9683185/192 [===========================>..] - ETA: 0s - loss: 0.1089 - accuracy: 0.9683192/192 [==============================] - 1s 3ms/step - loss: 0.1093 - accuracy: 0.9682 - val_loss: 0.2511 - val_accuracy: 0.9535
Epoch 12/20
  1/192 [..............................] - ETA: 0s - loss: 0.0498 - accuracy: 0.9920 24/192 [==>...........................] - ETA: 0s - loss: 0.1020 - accuracy: 0.9711 47/192 [======>.......................] - ETA: 0s - loss: 0.1051 - accuracy: 0.9700 70/192 [=========>....................] - ETA: 0s - loss: 0.1067 - accuracy: 0.9694 93/192 [=============>................] - ETA: 0s - loss: 0.1085 - accuracy: 0.9691116/192 [=================>............] - ETA: 0s - loss: 0.1094 - accuracy: 0.9690139/192 [====================>.........] - ETA: 0s - loss: 0.1103 - accuracy: 0.9688162/192 [========================>.....] - ETA: 0s - loss: 0.1111 - accuracy: 0.9687185/192 [===========================>..] - ETA: 0s - loss: 0.1115 - accuracy: 0.9686192/192 [==============================] - 1s 3ms/step - loss: 0.1116 - accuracy: 0.9686 - val_loss: 0.2167 - val_accuracy: 0.9571
Epoch 13/20
  1/192 [..............................] - ETA: 0s - loss: 0.0563 - accuracy: 0.9840 24/192 [==>...........................] - ETA: 0s - loss: 0.0950 - accuracy: 0.9753 47/192 [======>.......................] - ETA: 0s - loss: 0.0965 - accuracy: 0.9741 70/192 [=========>....................] - ETA: 0s - loss: 0.0956 - accuracy: 0.9741 93/192 [=============>................] - ETA: 0s - loss: 0.0965 - accuracy: 0.9737116/192 [=================>............] - ETA: 0s - loss: 0.0977 - accuracy: 0.9732139/192 [====================>.........] - ETA: 0s - loss: 0.0985 - accuracy: 0.9729162/192 [========================>.....] - ETA: 0s - loss: 0.0994 - accuracy: 0.9726185/192 [===========================>..] - ETA: 0s - loss: 0.1003 - accuracy: 0.9724192/192 [==============================] - 1s 3ms/step - loss: 0.1006 - accuracy: 0.9723 - val_loss: 0.2388 - val_accuracy: 0.9563
Epoch 14/20
  1/192 [..............................] - ETA: 0s - loss: 0.0811 - accuracy: 0.9720 24/192 [==>...........................] - ETA: 0s - loss: 0.0859 - accuracy: 0.9756 47/192 [======>.......................] - ETA: 0s - loss: 0.0861 - accuracy: 0.9759 70/192 [=========>....................] - ETA: 0s - loss: 0.0869 - accuracy: 0.9757 93/192 [=============>................] - ETA: 0s - loss: 0.0873 - accuracy: 0.9754116/192 [=================>............] - ETA: 0s - loss: 0.0874 - accuracy: 0.9753139/192 [====================>.........] - ETA: 0s - loss: 0.0877 - accuracy: 0.9751162/192 [========================>.....] - ETA: 0s - loss: 0.0879 - accuracy: 0.9750185/192 [===========================>..] - ETA: 0s - loss: 0.0879 - accuracy: 0.9750192/192 [==============================] - 1s 3ms/step - loss: 0.0880 - accuracy: 0.9750 - val_loss: 0.2593 - val_accuracy: 0.9543
Epoch 15/20
  1/192 [..............................] - ETA: 0s - loss: 0.1073 - accuracy: 0.9600 24/192 [==>...........................] - ETA: 0s - loss: 0.0815 - accuracy: 0.9749 46/192 [======>.......................] - ETA: 0s - loss: 0.0884 - accuracy: 0.9747 69/192 [=========>....................] - ETA: 0s - loss: 0.0918 - accuracy: 0.9742 92/192 [=============>................] - ETA: 0s - loss: 0.0934 - accuracy: 0.9740114/192 [================>.............] - ETA: 0s - loss: 0.0938 - accuracy: 0.9740137/192 [====================>.........] - ETA: 0s - loss: 0.0936 - accuracy: 0.9740159/192 [=======================>......] - ETA: 0s - loss: 0.0934 - accuracy: 0.9740182/192 [===========================>..] - ETA: 0s - loss: 0.0934 - accuracy: 0.9740192/192 [==============================] - 1s 3ms/step - loss: 0.0935 - accuracy: 0.9740 - val_loss: 0.2032 - val_accuracy: 0.9613
Epoch 16/20
  1/192 [..............................] - ETA: 0s - loss: 0.0654 - accuracy: 0.9800 24/192 [==>...........................] - ETA: 0s - loss: 0.0587 - accuracy: 0.9818 47/192 [======>.......................] - ETA: 0s - loss: 0.0627 - accuracy: 0.9810 70/192 [=========>....................] - ETA: 0s - loss: 0.0646 - accuracy: 0.9806 93/192 [=============>................] - ETA: 0s - loss: 0.0663 - accuracy: 0.9802116/192 [=================>............] - ETA: 0s - loss: 0.0674 - accuracy: 0.9799139/192 [====================>.........] - ETA: 0s - loss: 0.0682 - accuracy: 0.9797162/192 [========================>.....] - ETA: 0s - loss: 0.0688 - accuracy: 0.9795185/192 [===========================>..] - ETA: 0s - loss: 0.0691 - accuracy: 0.9794192/192 [==============================] - 1s 3ms/step - loss: 0.0693 - accuracy: 0.9794 - val_loss: 0.2293 - val_accuracy: 0.9611
Epoch 17/20
  1/192 [..............................] - ETA: 0s - loss: 0.0281 - accuracy: 0.9920 24/192 [==>...........................] - ETA: 0s - loss: 0.0535 - accuracy: 0.9852 47/192 [======>.......................] - ETA: 0s - loss: 0.0591 - accuracy: 0.9833 70/192 [=========>....................] - ETA: 0s - loss: 0.0609 - accuracy: 0.9826 93/192 [=============>................] - ETA: 0s - loss: 0.0618 - accuracy: 0.9823116/192 [=================>............] - ETA: 0s - loss: 0.0618 - accuracy: 0.9823139/192 [====================>.........] - ETA: 0s - loss: 0.0618 - accuracy: 0.9823162/192 [========================>.....] - ETA: 0s - loss: 0.0618 - accuracy: 0.9822185/192 [===========================>..] - ETA: 0s - loss: 0.0618 - accuracy: 0.9822192/192 [==============================] - 1s 3ms/step - loss: 0.0618 - accuracy: 0.9822 - val_loss: 0.2408 - val_accuracy: 0.9613
Epoch 18/20
  1/192 [..............................] - ETA: 0s - loss: 0.1346 - accuracy: 0.9840 24/192 [==>...........................] - ETA: 0s - loss: 0.0820 - accuracy: 0.9792 47/192 [======>.......................] - ETA: 0s - loss: 0.0732 - accuracy: 0.9802 70/192 [=========>....................] - ETA: 0s - loss: 0.0705 - accuracy: 0.9806 93/192 [=============>................] - ETA: 0s - loss: 0.0694 - accuracy: 0.9807116/192 [=================>............] - ETA: 0s - loss: 0.0683 - accuracy: 0.9809139/192 [====================>.........] - ETA: 0s - loss: 0.0676 - accuracy: 0.9810162/192 [========================>.....] - ETA: 0s - loss: 0.0669 - accuracy: 0.9810185/192 [===========================>..] - ETA: 0s - loss: 0.0663 - accuracy: 0.9811192/192 [==============================] - 1s 3ms/step - loss: 0.0662 - accuracy: 0.9812 - val_loss: 0.2418 - val_accuracy: 0.9613
Epoch 19/20
  1/192 [..............................] - ETA: 0s - loss: 0.0325 - accuracy: 0.9880 24/192 [==>...........................] - ETA: 0s - loss: 0.0535 - accuracy: 0.9837 47/192 [======>.......................] - ETA: 0s - loss: 0.0529 - accuracy: 0.9836 71/192 [==========>...................] - ETA: 0s - loss: 0.0543 - accuracy: 0.9833 94/192 [=============>................] - ETA: 0s - loss: 0.0556 - accuracy: 0.9832117/192 [=================>............] - ETA: 0s - loss: 0.0565 - accuracy: 0.9830140/192 [====================>.........] - ETA: 0s - loss: 0.0575 - accuracy: 0.9829163/192 [========================>.....] - ETA: 0s - loss: 0.0585 - accuracy: 0.9829186/192 [============================>.] - ETA: 0s - loss: 0.0593 - accuracy: 0.9828192/192 [==============================] - 1s 3ms/step - loss: 0.0596 - accuracy: 0.9827 - val_loss: 0.2544 - val_accuracy: 0.9548
Epoch 20/20
  1/192 [..............................] - ETA: 0s - loss: 0.0422 - accuracy: 0.9800 24/192 [==>...........................] - ETA: 0s - loss: 0.0560 - accuracy: 0.9815 48/192 [======>.......................] - ETA: 0s - loss: 0.0602 - accuracy: 0.9819 71/192 [==========>...................] - ETA: 0s - loss: 0.0621 - accuracy: 0.9816 94/192 [=============>................] - ETA: 0s - loss: 0.0626 - accuracy: 0.9816118/192 [=================>............] - ETA: 0s - loss: 0.0622 - accuracy: 0.9818141/192 [=====================>........] - ETA: 0s - loss: 0.0617 - accuracy: 0.9820165/192 [========================>.....] - ETA: 0s - loss: 0.0613 - accuracy: 0.9822189/192 [============================>.] - ETA: 0s - loss: 0.0612 - accuracy: 0.9823192/192 [==============================] - 1s 3ms/step - loss: 0.0611 - accuracy: 0.9823 - val_loss: 0.2606 - val_accuracy: 0.9626
training_time: 0:00:12.017925
  1/313 [..............................] - ETA: 41s - loss: 5.1741e-04 - accuracy: 1.0000 22/313 [=>............................] - ETA: 0s - loss: 0.1872 - accuracy: 0.9702      43/313 [===>..........................] - ETA: 0s - loss: 0.2425 - accuracy: 0.9600 64/313 [=====>........................] - ETA: 0s - loss: 0.3155 - accuracy: 0.9546 86/313 [=======>......................] - ETA: 0s - loss: 0.3364 - accuracy: 0.9539108/313 [=========>....................] - ETA: 0s - loss: 0.3157 - accuracy: 0.9569130/313 [===========>..................] - ETA: 0s - loss: 0.3264 - accuracy: 0.9555152/313 [=============>................] - ETA: 0s - loss: 0.3276 - accuracy: 0.9552174/313 [===============>..............] - ETA: 0s - loss: 0.3054 - accuracy: 0.9578196/313 [=================>............] - ETA: 0s - loss: 0.2987 - accuracy: 0.9577218/313 [===================>..........] - ETA: 0s - loss: 0.3049 - accuracy: 0.9589240/313 [======================>.......] - ETA: 0s - loss: 0.2810 - accuracy: 0.9615262/313 [========================>.....] - ETA: 0s - loss: 0.2684 - accuracy: 0.9625284/313 [==========================>...] - ETA: 0s - loss: 0.2509 - accuracy: 0.9647306/313 [============================>.] - ETA: 0s - loss: 0.2435 - accuracy: 0.9652313/313 [==============================] - 1s 2ms/step - loss: 0.2420 - accuracy: 0.9650
Test results: Loss = 0.2420465648174286, Accuracy = 0.9649999737739563
