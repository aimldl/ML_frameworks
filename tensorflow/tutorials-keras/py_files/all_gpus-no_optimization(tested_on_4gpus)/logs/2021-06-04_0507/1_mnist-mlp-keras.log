Number of devices: 4
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
60000 10000
Epoch 1/20
  1/192 [..............................] - ETA: 2:29 - loss: 185.6489 - accuracy: 0.1320 24/192 [==>...........................] - ETA: 0s - loss: 60.6630 - accuracy: 0.3164    48/192 [======>.......................] - ETA: 0s - loss: 39.2562 - accuracy: 0.3416 72/192 [==========>...................] - ETA: 0s - loss: 29.9414 - accuracy: 0.3400 96/192 [==============>...............] - ETA: 0s - loss: 24.5934 - accuracy: 0.3413119/192 [=================>............] - ETA: 0s - loss: 21.1948 - accuracy: 0.3475143/192 [=====================>........] - ETA: 0s - loss: 18.6458 - accuracy: 0.3571167/192 [=========================>....] - ETA: 0s - loss: 16.7221 - accuracy: 0.3684191/192 [============================>.] - ETA: 0s - loss: 15.2123 - accuracy: 0.3809192/192 [==============================] - 2s 5ms/step - loss: 15.1010 - accuracy: 0.3820 - val_loss: 1.0062 - val_accuracy: 0.7122
Epoch 2/20
  1/192 [..............................] - ETA: 0s - loss: 0.9664 - accuracy: 0.6800 24/192 [==>...........................] - ETA: 0s - loss: 0.9694 - accuracy: 0.7135 48/192 [======>.......................] - ETA: 0s - loss: 0.9604 - accuracy: 0.7194 72/192 [==========>...................] - ETA: 0s - loss: 0.9508 - accuracy: 0.7236 96/192 [==============>...............] - ETA: 0s - loss: 0.9430 - accuracy: 0.7272120/192 [=================>............] - ETA: 0s - loss: 0.9357 - accuracy: 0.7305144/192 [=====================>........] - ETA: 0s - loss: 0.9279 - accuracy: 0.7337168/192 [=========================>....] - ETA: 0s - loss: 0.9206 - accuracy: 0.7366192/192 [==============================] - ETA: 0s - loss: 0.9144 - accuracy: 0.7391192/192 [==============================] - 1s 3ms/step - loss: 0.9141 - accuracy: 0.7392 - val_loss: 0.7868 - val_accuracy: 0.7708
Epoch 3/20
  1/192 [..............................] - ETA: 0s - loss: 0.8332 - accuracy: 0.7640 24/192 [==>...........................] - ETA: 0s - loss: 0.7536 - accuracy: 0.7988 48/192 [======>.......................] - ETA: 0s - loss: 0.7161 - accuracy: 0.8123 71/192 [==========>...................] - ETA: 0s - loss: 0.6974 - accuracy: 0.8173 95/192 [=============>................] - ETA: 0s - loss: 0.6861 - accuracy: 0.8204119/192 [=================>............] - ETA: 0s - loss: 0.6774 - accuracy: 0.8231143/192 [=====================>........] - ETA: 0s - loss: 0.6702 - accuracy: 0.8257167/192 [=========================>....] - ETA: 0s - loss: 0.6644 - accuracy: 0.8280191/192 [============================>.] - ETA: 0s - loss: 0.6588 - accuracy: 0.8303192/192 [==============================] - 1s 3ms/step - loss: 0.6583 - accuracy: 0.8304 - val_loss: 0.5470 - val_accuracy: 0.8967
Epoch 4/20
  1/192 [..............................] - ETA: 0s - loss: 0.4599 - accuracy: 0.9000 25/192 [==>...........................] - ETA: 0s - loss: 0.4482 - accuracy: 0.8931 48/192 [======>.......................] - ETA: 0s - loss: 0.4473 - accuracy: 0.8911 71/192 [==========>...................] - ETA: 0s - loss: 0.4476 - accuracy: 0.8901 94/192 [=============>................] - ETA: 0s - loss: 0.4479 - accuracy: 0.8897117/192 [=================>............] - ETA: 0s - loss: 0.4483 - accuracy: 0.8896140/192 [====================>.........] - ETA: 0s - loss: 0.4481 - accuracy: 0.8897163/192 [========================>.....] - ETA: 0s - loss: 0.4465 - accuracy: 0.8901186/192 [============================>.] - ETA: 0s - loss: 0.4443 - accuracy: 0.8907192/192 [==============================] - 1s 3ms/step - loss: 0.4436 - accuracy: 0.8909 - val_loss: 0.4346 - val_accuracy: 0.9103
Epoch 5/20
  1/192 [..............................] - ETA: 0s - loss: 0.5278 - accuracy: 0.8680 24/192 [==>...........................] - ETA: 0s - loss: 0.3331 - accuracy: 0.9132 47/192 [======>.......................] - ETA: 0s - loss: 0.3270 - accuracy: 0.9158 70/192 [=========>....................] - ETA: 0s - loss: 0.3251 - accuracy: 0.9171 93/192 [=============>................] - ETA: 0s - loss: 0.3239 - accuracy: 0.9176116/192 [=================>............] - ETA: 0s - loss: 0.3238 - accuracy: 0.9179139/192 [====================>.........] - ETA: 0s - loss: 0.3239 - accuracy: 0.9180162/192 [========================>.....] - ETA: 0s - loss: 0.3237 - accuracy: 0.9182185/192 [===========================>..] - ETA: 0s - loss: 0.3237 - accuracy: 0.9184192/192 [==============================] - 1s 3ms/step - loss: 0.3236 - accuracy: 0.9185 - val_loss: 0.4315 - val_accuracy: 0.9209
Epoch 6/20
  1/192 [..............................] - ETA: 0s - loss: 0.2674 - accuracy: 0.9080 24/192 [==>...........................] - ETA: 0s - loss: 0.2791 - accuracy: 0.9248 47/192 [======>.......................] - ETA: 0s - loss: 0.2836 - accuracy: 0.9257 70/192 [=========>....................] - ETA: 0s - loss: 0.2855 - accuracy: 0.9265 93/192 [=============>................] - ETA: 0s - loss: 0.2853 - accuracy: 0.9272116/192 [=================>............] - ETA: 0s - loss: 0.2837 - accuracy: 0.9279139/192 [====================>.........] - ETA: 0s - loss: 0.2814 - accuracy: 0.9286162/192 [========================>.....] - ETA: 0s - loss: 0.2795 - accuracy: 0.9291185/192 [===========================>..] - ETA: 0s - loss: 0.2774 - accuracy: 0.9296192/192 [==============================] - 1s 3ms/step - loss: 0.2768 - accuracy: 0.9298 - val_loss: 0.3316 - val_accuracy: 0.9309
Epoch 7/20
  1/192 [..............................] - ETA: 0s - loss: 0.2835 - accuracy: 0.9280 23/192 [==>...........................] - ETA: 0s - loss: 0.2173 - accuracy: 0.9484 46/192 [======>.......................] - ETA: 0s - loss: 0.2179 - accuracy: 0.9464 69/192 [=========>....................] - ETA: 0s - loss: 0.2152 - accuracy: 0.9462 92/192 [=============>................] - ETA: 0s - loss: 0.2140 - accuracy: 0.9461115/192 [================>.............] - ETA: 0s - loss: 0.2148 - accuracy: 0.9458138/192 [====================>.........] - ETA: 0s - loss: 0.2165 - accuracy: 0.9454161/192 [========================>.....] - ETA: 0s - loss: 0.2181 - accuracy: 0.9449184/192 [===========================>..] - ETA: 0s - loss: 0.2194 - accuracy: 0.9445192/192 [==============================] - 1s 3ms/step - loss: 0.2198 - accuracy: 0.9444 - val_loss: 0.3434 - val_accuracy: 0.9269
Epoch 8/20
  1/192 [..............................] - ETA: 0s - loss: 0.1609 - accuracy: 0.9560 23/192 [==>...........................] - ETA: 0s - loss: 0.1875 - accuracy: 0.9460 46/192 [======>.......................] - ETA: 0s - loss: 0.1868 - accuracy: 0.9470 69/192 [=========>....................] - ETA: 0s - loss: 0.1864 - accuracy: 0.9475 92/192 [=============>................] - ETA: 0s - loss: 0.1861 - accuracy: 0.9480115/192 [================>.............] - ETA: 0s - loss: 0.1862 - accuracy: 0.9483138/192 [====================>.........] - ETA: 0s - loss: 0.1866 - accuracy: 0.9486160/192 [========================>.....] - ETA: 0s - loss: 0.1872 - accuracy: 0.9487183/192 [===========================>..] - ETA: 0s - loss: 0.1879 - accuracy: 0.9487192/192 [==============================] - 1s 3ms/step - loss: 0.1881 - accuracy: 0.9487 - val_loss: 0.3342 - val_accuracy: 0.9432
Epoch 9/20
  1/192 [..............................] - ETA: 0s - loss: 0.2020 - accuracy: 0.9440 24/192 [==>...........................] - ETA: 0s - loss: 0.1566 - accuracy: 0.9559 47/192 [======>.......................] - ETA: 0s - loss: 0.1551 - accuracy: 0.9572 70/192 [=========>....................] - ETA: 0s - loss: 0.1574 - accuracy: 0.9572 93/192 [=============>................] - ETA: 0s - loss: 0.1593 - accuracy: 0.9570116/192 [=================>............] - ETA: 0s - loss: 0.1607 - accuracy: 0.9567139/192 [====================>.........] - ETA: 0s - loss: 0.1620 - accuracy: 0.9564162/192 [========================>.....] - ETA: 0s - loss: 0.1628 - accuracy: 0.9563186/192 [============================>.] - ETA: 0s - loss: 0.1635 - accuracy: 0.9563192/192 [==============================] - 1s 3ms/step - loss: 0.1637 - accuracy: 0.9562 - val_loss: 0.2961 - val_accuracy: 0.9449
Epoch 10/20
  1/192 [..............................] - ETA: 0s - loss: 0.0947 - accuracy: 0.9720 24/192 [==>...........................] - ETA: 0s - loss: 0.1412 - accuracy: 0.9608 47/192 [======>.......................] - ETA: 0s - loss: 0.1414 - accuracy: 0.9610 70/192 [=========>....................] - ETA: 0s - loss: 0.1414 - accuracy: 0.9607 93/192 [=============>................] - ETA: 0s - loss: 0.1427 - accuracy: 0.9601116/192 [=================>............] - ETA: 0s - loss: 0.1437 - accuracy: 0.9598139/192 [====================>.........] - ETA: 0s - loss: 0.1447 - accuracy: 0.9596162/192 [========================>.....] - ETA: 0s - loss: 0.1458 - accuracy: 0.9594185/192 [===========================>..] - ETA: 0s - loss: 0.1466 - accuracy: 0.9593192/192 [==============================] - 1s 3ms/step - loss: 0.1469 - accuracy: 0.9593 - val_loss: 0.3043 - val_accuracy: 0.9431
Epoch 11/20
  1/192 [..............................] - ETA: 0s - loss: 0.1651 - accuracy: 0.9560 24/192 [==>...........................] - ETA: 0s - loss: 0.1390 - accuracy: 0.9636 47/192 [======>.......................] - ETA: 0s - loss: 0.1365 - accuracy: 0.9644 70/192 [=========>....................] - ETA: 0s - loss: 0.1386 - accuracy: 0.9639 94/192 [=============>................] - ETA: 0s - loss: 0.1418 - accuracy: 0.9631118/192 [=================>............] - ETA: 0s - loss: 0.1438 - accuracy: 0.9626142/192 [=====================>........] - ETA: 0s - loss: 0.1456 - accuracy: 0.9621165/192 [========================>.....] - ETA: 0s - loss: 0.1468 - accuracy: 0.9616188/192 [============================>.] - ETA: 0s - loss: 0.1473 - accuracy: 0.9614192/192 [==============================] - 1s 3ms/step - loss: 0.1474 - accuracy: 0.9613 - val_loss: 0.2724 - val_accuracy: 0.9525
Epoch 12/20
  1/192 [..............................] - ETA: 0s - loss: 0.1052 - accuracy: 0.9680 24/192 [==>...........................] - ETA: 0s - loss: 0.1137 - accuracy: 0.9664 47/192 [======>.......................] - ETA: 0s - loss: 0.1199 - accuracy: 0.9659 71/192 [==========>...................] - ETA: 0s - loss: 0.1223 - accuracy: 0.9656 94/192 [=============>................] - ETA: 0s - loss: 0.1242 - accuracy: 0.9653118/192 [=================>............] - ETA: 0s - loss: 0.1258 - accuracy: 0.9649141/192 [=====================>........] - ETA: 0s - loss: 0.1265 - accuracy: 0.9649164/192 [========================>.....] - ETA: 0s - loss: 0.1270 - accuracy: 0.9649187/192 [============================>.] - ETA: 0s - loss: 0.1274 - accuracy: 0.9649192/192 [==============================] - 1s 3ms/step - loss: 0.1274 - accuracy: 0.9649 - val_loss: 0.2556 - val_accuracy: 0.9518
Epoch 13/20
  1/192 [..............................] - ETA: 0s - loss: 0.1350 - accuracy: 0.9640 24/192 [==>...........................] - ETA: 0s - loss: 0.1145 - accuracy: 0.9685 47/192 [======>.......................] - ETA: 0s - loss: 0.1094 - accuracy: 0.9694 71/192 [==========>...................] - ETA: 0s - loss: 0.1091 - accuracy: 0.9696 95/192 [=============>................] - ETA: 0s - loss: 0.1099 - accuracy: 0.9694119/192 [=================>............] - ETA: 0s - loss: 0.1111 - accuracy: 0.9690142/192 [=====================>........] - ETA: 0s - loss: 0.1119 - accuracy: 0.9687166/192 [========================>.....] - ETA: 0s - loss: 0.1123 - accuracy: 0.9685190/192 [============================>.] - ETA: 0s - loss: 0.1127 - accuracy: 0.9684192/192 [==============================] - 1s 3ms/step - loss: 0.1128 - accuracy: 0.9684 - val_loss: 0.2615 - val_accuracy: 0.9517
Epoch 14/20
  1/192 [..............................] - ETA: 0s - loss: 0.1049 - accuracy: 0.9640 25/192 [==>...........................] - ETA: 0s - loss: 0.1073 - accuracy: 0.9682 49/192 [======>.......................] - ETA: 0s - loss: 0.1033 - accuracy: 0.9699 73/192 [==========>...................] - ETA: 0s - loss: 0.1018 - accuracy: 0.9706 97/192 [==============>...............] - ETA: 0s - loss: 0.1012 - accuracy: 0.9709121/192 [=================>............] - ETA: 0s - loss: 0.1014 - accuracy: 0.9709145/192 [=====================>........] - ETA: 0s - loss: 0.1021 - accuracy: 0.9708169/192 [=========================>....] - ETA: 0s - loss: 0.1028 - accuracy: 0.9706192/192 [==============================] - 1s 3ms/step - loss: 0.1036 - accuracy: 0.9704 - val_loss: 0.2662 - val_accuracy: 0.9533
Epoch 15/20
  1/192 [..............................] - ETA: 0s - loss: 0.0622 - accuracy: 0.9800 25/192 [==>...........................] - ETA: 0s - loss: 0.0970 - accuracy: 0.9723 48/192 [======>.......................] - ETA: 0s - loss: 0.1015 - accuracy: 0.9715 71/192 [==========>...................] - ETA: 0s - loss: 0.1030 - accuracy: 0.9712 95/192 [=============>................] - ETA: 0s - loss: 0.1035 - accuracy: 0.9711119/192 [=================>............] - ETA: 0s - loss: 0.1041 - accuracy: 0.9709143/192 [=====================>........] - ETA: 0s - loss: 0.1044 - accuracy: 0.9709166/192 [========================>.....] - ETA: 0s - loss: 0.1050 - accuracy: 0.9708190/192 [============================>.] - ETA: 0s - loss: 0.1059 - accuracy: 0.9707192/192 [==============================] - 1s 3ms/step - loss: 0.1060 - accuracy: 0.9707 - val_loss: 0.2911 - val_accuracy: 0.9433
Epoch 16/20
  1/192 [..............................] - ETA: 0s - loss: 0.0849 - accuracy: 0.9800 25/192 [==>...........................] - ETA: 0s - loss: 0.1412 - accuracy: 0.9617 49/192 [======>.......................] - ETA: 0s - loss: 0.1346 - accuracy: 0.9631 73/192 [==========>...................] - ETA: 0s - loss: 0.1288 - accuracy: 0.9646 97/192 [==============>...............] - ETA: 0s - loss: 0.1241 - accuracy: 0.9658121/192 [=================>............] - ETA: 0s - loss: 0.1220 - accuracy: 0.9665144/192 [=====================>........] - ETA: 0s - loss: 0.1210 - accuracy: 0.9669167/192 [=========================>....] - ETA: 0s - loss: 0.1202 - accuracy: 0.9672191/192 [============================>.] - ETA: 0s - loss: 0.1195 - accuracy: 0.9674192/192 [==============================] - 1s 3ms/step - loss: 0.1194 - accuracy: 0.9674 - val_loss: 0.2381 - val_accuracy: 0.9563
Epoch 17/20
  1/192 [..............................] - ETA: 0s - loss: 0.1320 - accuracy: 0.9600 25/192 [==>...........................] - ETA: 0s - loss: 0.0860 - accuracy: 0.9731 49/192 [======>.......................] - ETA: 0s - loss: 0.0862 - accuracy: 0.9740 73/192 [==========>...................] - ETA: 0s - loss: 0.0877 - accuracy: 0.9740 97/192 [==============>...............] - ETA: 0s - loss: 0.0886 - accuracy: 0.9739121/192 [=================>............] - ETA: 0s - loss: 0.0888 - accuracy: 0.9740145/192 [=====================>........] - ETA: 0s - loss: 0.0885 - accuracy: 0.9742169/192 [=========================>....] - ETA: 0s - loss: 0.0885 - accuracy: 0.9743192/192 [==============================] - 1s 3ms/step - loss: 0.0887 - accuracy: 0.9743 - val_loss: 0.2789 - val_accuracy: 0.9578
Epoch 18/20
  1/192 [..............................] - ETA: 0s - loss: 0.0879 - accuracy: 0.9720 25/192 [==>...........................] - ETA: 0s - loss: 0.0836 - accuracy: 0.9775 49/192 [======>.......................] - ETA: 0s - loss: 0.0862 - accuracy: 0.9766 73/192 [==========>...................] - ETA: 0s - loss: 0.0876 - accuracy: 0.9760 97/192 [==============>...............] - ETA: 0s - loss: 0.0880 - accuracy: 0.9758121/192 [=================>............] - ETA: 0s - loss: 0.0880 - accuracy: 0.9757145/192 [=====================>........] - ETA: 0s - loss: 0.0890 - accuracy: 0.9757169/192 [=========================>....] - ETA: 0s - loss: 0.0898 - accuracy: 0.9756192/192 [==============================] - 1s 3ms/step - loss: 0.0905 - accuracy: 0.9755 - val_loss: 0.2661 - val_accuracy: 0.9566
Epoch 19/20
  1/192 [..............................] - ETA: 0s - loss: 0.1798 - accuracy: 0.9600 25/192 [==>...........................] - ETA: 0s - loss: 0.0810 - accuracy: 0.9791 49/192 [======>.......................] - ETA: 0s - loss: 0.0788 - accuracy: 0.9796 73/192 [==========>...................] - ETA: 0s - loss: 0.0769 - accuracy: 0.9799 97/192 [==============>...............] - ETA: 0s - loss: 0.0763 - accuracy: 0.9799120/192 [=================>............] - ETA: 0s - loss: 0.0765 - accuracy: 0.9798144/192 [=====================>........] - ETA: 0s - loss: 0.0765 - accuracy: 0.9797168/192 [=========================>....] - ETA: 0s - loss: 0.0765 - accuracy: 0.9796192/192 [==============================] - ETA: 0s - loss: 0.0765 - accuracy: 0.9795192/192 [==============================] - 1s 3ms/step - loss: 0.0765 - accuracy: 0.9795 - val_loss: 0.2454 - val_accuracy: 0.9611
Epoch 20/20
  1/192 [..............................] - ETA: 0s - loss: 0.0393 - accuracy: 0.9880 25/192 [==>...........................] - ETA: 0s - loss: 0.0724 - accuracy: 0.9772 49/192 [======>.......................] - ETA: 0s - loss: 0.0758 - accuracy: 0.9777 73/192 [==========>...................] - ETA: 0s - loss: 0.0776 - accuracy: 0.9778 97/192 [==============>...............] - ETA: 0s - loss: 0.0777 - accuracy: 0.9780121/192 [=================>............] - ETA: 0s - loss: 0.0776 - accuracy: 0.9782144/192 [=====================>........] - ETA: 0s - loss: 0.0776 - accuracy: 0.9782168/192 [=========================>....] - ETA: 0s - loss: 0.0777 - accuracy: 0.9783192/192 [==============================] - ETA: 0s - loss: 0.0778 - accuracy: 0.9783192/192 [==============================] - 1s 3ms/step - loss: 0.0778 - accuracy: 0.9783 - val_loss: 0.2564 - val_accuracy: 0.9513
training_time: 0:00:11.838034
  1/313 [..............................] - ETA: 38s - loss: 0.0510 - accuracy: 0.9688 23/313 [=>............................] - ETA: 0s - loss: 0.2817 - accuracy: 0.9524  45/313 [===>..........................] - ETA: 0s - loss: 0.3094 - accuracy: 0.9458 67/313 [=====>........................] - ETA: 0s - loss: 0.3742 - accuracy: 0.9333 89/313 [=======>......................] - ETA: 0s - loss: 0.3775 - accuracy: 0.9354111/313 [=========>....................] - ETA: 0s - loss: 0.3558 - accuracy: 0.9358133/313 [===========>..................] - ETA: 0s - loss: 0.3704 - accuracy: 0.9344155/313 [=============>................] - ETA: 0s - loss: 0.3573 - accuracy: 0.9357177/313 [===============>..............] - ETA: 0s - loss: 0.3339 - accuracy: 0.9398199/313 [==================>...........] - ETA: 0s - loss: 0.3246 - accuracy: 0.9410221/313 [====================>.........] - ETA: 0s - loss: 0.3079 - accuracy: 0.9437243/313 [======================>.......] - ETA: 0s - loss: 0.2853 - accuracy: 0.9475265/313 [========================>.....] - ETA: 0s - loss: 0.2744 - accuracy: 0.9476287/313 [==========================>...] - ETA: 0s - loss: 0.2633 - accuracy: 0.9501309/313 [============================>.] - ETA: 0s - loss: 0.2650 - accuracy: 0.9497313/313 [==============================] - 1s 2ms/step - loss: 0.2650 - accuracy: 0.9497
Test results: Loss = 0.2650168538093567, Accuracy = 0.9496999979019165
