Number of devices: 4
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
60000 10000
Epoch 1/20
  1/192 [..............................] - ETA: 5:20 - loss: 103.3830 - accuracy: 0.1000 24/192 [==>...........................] - ETA: 0s - loss: 37.8306 - accuracy: 0.4290    48/192 [======>.......................] - ETA: 0s - loss: 25.4745 - accuracy: 0.5225 72/192 [==========>...................] - ETA: 0s - loss: 19.8011 - accuracy: 0.5586 96/192 [==============>...............] - ETA: 0s - loss: 16.4412 - accuracy: 0.5813120/192 [=================>............] - ETA: 0s - loss: 14.1860 - accuracy: 0.5993144/192 [=====================>........] - ETA: 0s - loss: 12.5539 - accuracy: 0.6145169/192 [=========================>....] - ETA: 0s - loss: 11.2638 - accuracy: 0.6285192/192 [==============================] - 3s 5ms/step - loss: 10.2882 - accuracy: 0.6405 - val_loss: 0.6573 - val_accuracy: 0.8478
Epoch 2/20
  1/192 [..............................] - ETA: 0s - loss: 0.7128 - accuracy: 0.8240 25/192 [==>...........................] - ETA: 0s - loss: 0.6780 - accuracy: 0.8448 49/192 [======>.......................] - ETA: 0s - loss: 0.6627 - accuracy: 0.8480 74/192 [==========>...................] - ETA: 0s - loss: 0.6452 - accuracy: 0.8512 99/192 [==============>...............] - ETA: 0s - loss: 0.6335 - accuracy: 0.8537124/192 [==================>...........] - ETA: 0s - loss: 0.6231 - accuracy: 0.8559149/192 [======================>.......] - ETA: 0s - loss: 0.6138 - accuracy: 0.8581174/192 [==========================>...] - ETA: 0s - loss: 0.6060 - accuracy: 0.8600192/192 [==============================] - 1s 3ms/step - loss: 0.6007 - accuracy: 0.8612 - val_loss: 0.4702 - val_accuracy: 0.9049
Epoch 3/20
  1/192 [..............................] - ETA: 0s - loss: 0.4223 - accuracy: 0.9120 26/192 [===>..........................] - ETA: 0s - loss: 0.4141 - accuracy: 0.9044 51/192 [======>.......................] - ETA: 0s - loss: 0.4078 - accuracy: 0.9035 75/192 [==========>...................] - ETA: 0s - loss: 0.4040 - accuracy: 0.9037100/192 [==============>...............] - ETA: 0s - loss: 0.3997 - accuracy: 0.9046125/192 [==================>...........] - ETA: 0s - loss: 0.3974 - accuracy: 0.9051150/192 [======================>.......] - ETA: 0s - loss: 0.3955 - accuracy: 0.9056175/192 [==========================>...] - ETA: 0s - loss: 0.3935 - accuracy: 0.9062192/192 [==============================] - 0s 3ms/step - loss: 0.3920 - accuracy: 0.9067 - val_loss: 0.4137 - val_accuracy: 0.9132
Epoch 4/20
  1/192 [..............................] - ETA: 0s - loss: 0.2531 - accuracy: 0.9360 26/192 [===>..........................] - ETA: 0s - loss: 0.3040 - accuracy: 0.9216 51/192 [======>.......................] - ETA: 0s - loss: 0.2992 - accuracy: 0.9232 75/192 [==========>...................] - ETA: 0s - loss: 0.2981 - accuracy: 0.9237100/192 [==============>...............] - ETA: 0s - loss: 0.2986 - accuracy: 0.9239125/192 [==================>...........] - ETA: 0s - loss: 0.3005 - accuracy: 0.9240150/192 [======================>.......] - ETA: 0s - loss: 0.3037 - accuracy: 0.9238175/192 [==========================>...] - ETA: 0s - loss: 0.3063 - accuracy: 0.9235192/192 [==============================] - 1s 3ms/step - loss: 0.3073 - accuracy: 0.9235 - val_loss: 0.3922 - val_accuracy: 0.9337
Epoch 5/20
  1/192 [..............................] - ETA: 0s - loss: 0.1887 - accuracy: 0.9440 25/192 [==>...........................] - ETA: 0s - loss: 0.2592 - accuracy: 0.9361 50/192 [======>.......................] - ETA: 0s - loss: 0.2486 - accuracy: 0.9376 75/192 [==========>...................] - ETA: 0s - loss: 0.2456 - accuracy: 0.9379100/192 [==============>...............] - ETA: 0s - loss: 0.2443 - accuracy: 0.9378125/192 [==================>...........] - ETA: 0s - loss: 0.2437 - accuracy: 0.9375150/192 [======================>.......] - ETA: 0s - loss: 0.2429 - accuracy: 0.9373175/192 [==========================>...] - ETA: 0s - loss: 0.2424 - accuracy: 0.9373192/192 [==============================] - 0s 3ms/step - loss: 0.2421 - accuracy: 0.9373 - val_loss: 0.3483 - val_accuracy: 0.9372
Epoch 6/20
  1/192 [..............................] - ETA: 0s - loss: 0.1668 - accuracy: 0.9520 25/192 [==>...........................] - ETA: 0s - loss: 0.1792 - accuracy: 0.9475 50/192 [======>.......................] - ETA: 0s - loss: 0.1851 - accuracy: 0.9472 75/192 [==========>...................] - ETA: 0s - loss: 0.1918 - accuracy: 0.9462100/192 [==============>...............] - ETA: 0s - loss: 0.1965 - accuracy: 0.9455125/192 [==================>...........] - ETA: 0s - loss: 0.1996 - accuracy: 0.9450150/192 [======================>.......] - ETA: 0s - loss: 0.2013 - accuracy: 0.9448175/192 [==========================>...] - ETA: 0s - loss: 0.2025 - accuracy: 0.9446192/192 [==============================] - 0s 3ms/step - loss: 0.2034 - accuracy: 0.9445 - val_loss: 0.3430 - val_accuracy: 0.9368
Epoch 7/20
  1/192 [..............................] - ETA: 0s - loss: 0.1222 - accuracy: 0.9520 26/192 [===>..........................] - ETA: 0s - loss: 0.1829 - accuracy: 0.9479 51/192 [======>.......................] - ETA: 0s - loss: 0.1840 - accuracy: 0.9495 76/192 [==========>...................] - ETA: 0s - loss: 0.1840 - accuracy: 0.9495101/192 [==============>...............] - ETA: 0s - loss: 0.1851 - accuracy: 0.9493126/192 [==================>...........] - ETA: 0s - loss: 0.1868 - accuracy: 0.9489151/192 [======================>.......] - ETA: 0s - loss: 0.1885 - accuracy: 0.9484176/192 [==========================>...] - ETA: 0s - loss: 0.1892 - accuracy: 0.9482192/192 [==============================] - 0s 3ms/step - loss: 0.1894 - accuracy: 0.9482 - val_loss: 0.3350 - val_accuracy: 0.9405
Epoch 8/20
  1/192 [..............................] - ETA: 0s - loss: 0.1317 - accuracy: 0.9600 26/192 [===>..........................] - ETA: 0s - loss: 0.1423 - accuracy: 0.9597 51/192 [======>.......................] - ETA: 0s - loss: 0.1490 - accuracy: 0.9578 76/192 [==========>...................] - ETA: 0s - loss: 0.1519 - accuracy: 0.9569101/192 [==============>...............] - ETA: 0s - loss: 0.1550 - accuracy: 0.9562126/192 [==================>...........] - ETA: 0s - loss: 0.1563 - accuracy: 0.9559151/192 [======================>.......] - ETA: 0s - loss: 0.1575 - accuracy: 0.9557176/192 [==========================>...] - ETA: 0s - loss: 0.1582 - accuracy: 0.9557192/192 [==============================] - 0s 3ms/step - loss: 0.1587 - accuracy: 0.9556 - val_loss: 0.3277 - val_accuracy: 0.9459
Epoch 9/20
  1/192 [..............................] - ETA: 0s - loss: 0.1319 - accuracy: 0.9600 26/192 [===>..........................] - ETA: 0s - loss: 0.1293 - accuracy: 0.9644 51/192 [======>.......................] - ETA: 0s - loss: 0.1312 - accuracy: 0.9637 76/192 [==========>...................] - ETA: 0s - loss: 0.1324 - accuracy: 0.9635101/192 [==============>...............] - ETA: 0s - loss: 0.1334 - accuracy: 0.9634126/192 [==================>...........] - ETA: 0s - loss: 0.1346 - accuracy: 0.9632151/192 [======================>.......] - ETA: 0s - loss: 0.1356 - accuracy: 0.9631176/192 [==========================>...] - ETA: 0s - loss: 0.1366 - accuracy: 0.9630192/192 [==============================] - 0s 3ms/step - loss: 0.1373 - accuracy: 0.9629 - val_loss: 0.3271 - val_accuracy: 0.9521
Epoch 10/20
  1/192 [..............................] - ETA: 0s - loss: 0.0911 - accuracy: 0.9800 26/192 [===>..........................] - ETA: 0s - loss: 0.1102 - accuracy: 0.9715 51/192 [======>.......................] - ETA: 0s - loss: 0.1176 - accuracy: 0.9682 76/192 [==========>...................] - ETA: 0s - loss: 0.1232 - accuracy: 0.9664101/192 [==============>...............] - ETA: 0s - loss: 0.1261 - accuracy: 0.9655126/192 [==================>...........] - ETA: 0s - loss: 0.1287 - accuracy: 0.9647151/192 [======================>.......] - ETA: 0s - loss: 0.1304 - accuracy: 0.9641176/192 [==========================>...] - ETA: 0s - loss: 0.1320 - accuracy: 0.9637192/192 [==============================] - 1s 3ms/step - loss: 0.1329 - accuracy: 0.9635 - val_loss: 0.3232 - val_accuracy: 0.9503
Epoch 11/20
  1/192 [..............................] - ETA: 0s - loss: 0.0881 - accuracy: 0.9680 25/192 [==>...........................] - ETA: 0s - loss: 0.1189 - accuracy: 0.9662 49/192 [======>.......................] - ETA: 0s - loss: 0.1210 - accuracy: 0.9661 73/192 [==========>...................] - ETA: 0s - loss: 0.1187 - accuracy: 0.9666 97/192 [==============>...............] - ETA: 0s - loss: 0.1168 - accuracy: 0.9671122/192 [==================>...........] - ETA: 0s - loss: 0.1157 - accuracy: 0.9674147/192 [=====================>........] - ETA: 0s - loss: 0.1157 - accuracy: 0.9674172/192 [=========================>....] - ETA: 0s - loss: 0.1164 - accuracy: 0.9672192/192 [==============================] - 1s 3ms/step - loss: 0.1170 - accuracy: 0.9670 - val_loss: 0.3170 - val_accuracy: 0.9450
Epoch 12/20
  1/192 [..............................] - ETA: 0s - loss: 0.1038 - accuracy: 0.9600 26/192 [===>..........................] - ETA: 0s - loss: 0.0985 - accuracy: 0.9671 50/192 [======>.......................] - ETA: 0s - loss: 0.0982 - accuracy: 0.9683 75/192 [==========>...................] - ETA: 0s - loss: 0.0981 - accuracy: 0.9688100/192 [==============>...............] - ETA: 0s - loss: 0.0981 - accuracy: 0.9692125/192 [==================>...........] - ETA: 0s - loss: 0.0989 - accuracy: 0.9694149/192 [======================>.......] - ETA: 0s - loss: 0.0993 - accuracy: 0.9697174/192 [==========================>...] - ETA: 0s - loss: 0.0999 - accuracy: 0.9699192/192 [==============================] - 1s 3ms/step - loss: 0.1005 - accuracy: 0.9699 - val_loss: 0.3122 - val_accuracy: 0.9496
Epoch 13/20
  1/192 [..............................] - ETA: 0s - loss: 0.0633 - accuracy: 0.9760 26/192 [===>..........................] - ETA: 0s - loss: 0.0940 - accuracy: 0.9707 51/192 [======>.......................] - ETA: 0s - loss: 0.0935 - accuracy: 0.9716 76/192 [==========>...................] - ETA: 0s - loss: 0.0954 - accuracy: 0.9717100/192 [==============>...............] - ETA: 0s - loss: 0.0993 - accuracy: 0.9710125/192 [==================>...........] - ETA: 0s - loss: 0.1013 - accuracy: 0.9706150/192 [======================>.......] - ETA: 0s - loss: 0.1025 - accuracy: 0.9703175/192 [==========================>...] - ETA: 0s - loss: 0.1033 - accuracy: 0.9701192/192 [==============================] - 1s 3ms/step - loss: 0.1036 - accuracy: 0.9700 - val_loss: 0.3295 - val_accuracy: 0.9559
Epoch 14/20
  1/192 [..............................] - ETA: 0s - loss: 0.0372 - accuracy: 0.9800 25/192 [==>...........................] - ETA: 0s - loss: 0.0822 - accuracy: 0.9732 49/192 [======>.......................] - ETA: 0s - loss: 0.0853 - accuracy: 0.9735 74/192 [==========>...................] - ETA: 0s - loss: 0.0858 - accuracy: 0.9738 99/192 [==============>...............] - ETA: 0s - loss: 0.0864 - accuracy: 0.9738124/192 [==================>...........] - ETA: 0s - loss: 0.0869 - accuracy: 0.9738149/192 [======================>.......] - ETA: 0s - loss: 0.0869 - accuracy: 0.9739173/192 [==========================>...] - ETA: 0s - loss: 0.0872 - accuracy: 0.9739192/192 [==============================] - 1s 3ms/step - loss: 0.0877 - accuracy: 0.9738 - val_loss: 0.2790 - val_accuracy: 0.9542
Epoch 15/20
  1/192 [..............................] - ETA: 0s - loss: 0.0751 - accuracy: 0.9720 26/192 [===>..........................] - ETA: 0s - loss: 0.0817 - accuracy: 0.9724 51/192 [======>.......................] - ETA: 0s - loss: 0.0892 - accuracy: 0.9721 76/192 [==========>...................] - ETA: 0s - loss: 0.0920 - accuracy: 0.9720101/192 [==============>...............] - ETA: 0s - loss: 0.0931 - accuracy: 0.9721126/192 [==================>...........] - ETA: 0s - loss: 0.0938 - accuracy: 0.9721151/192 [======================>.......] - ETA: 0s - loss: 0.0942 - accuracy: 0.9722176/192 [==========================>...] - ETA: 0s - loss: 0.0943 - accuracy: 0.9722192/192 [==============================] - 0s 3ms/step - loss: 0.0943 - accuracy: 0.9723 - val_loss: 0.3368 - val_accuracy: 0.9564
Epoch 16/20
  1/192 [..............................] - ETA: 0s - loss: 0.0355 - accuracy: 0.9840 26/192 [===>..........................] - ETA: 0s - loss: 0.0837 - accuracy: 0.9765 51/192 [======>.......................] - ETA: 0s - loss: 0.0838 - accuracy: 0.9764 76/192 [==========>...................] - ETA: 0s - loss: 0.0842 - accuracy: 0.9764101/192 [==============>...............] - ETA: 0s - loss: 0.0846 - accuracy: 0.9763126/192 [==================>...........] - ETA: 0s - loss: 0.0847 - accuracy: 0.9762151/192 [======================>.......] - ETA: 0s - loss: 0.0846 - accuracy: 0.9761176/192 [==========================>...] - ETA: 0s - loss: 0.0847 - accuracy: 0.9760192/192 [==============================] - 0s 3ms/step - loss: 0.0849 - accuracy: 0.9759 - val_loss: 0.2813 - val_accuracy: 0.9573
Epoch 17/20
  1/192 [..............................] - ETA: 0s - loss: 0.0422 - accuracy: 0.9880 26/192 [===>..........................] - ETA: 0s - loss: 0.0611 - accuracy: 0.9823 51/192 [======>.......................] - ETA: 0s - loss: 0.0721 - accuracy: 0.9795 76/192 [==========>...................] - ETA: 0s - loss: 0.0785 - accuracy: 0.9779101/192 [==============>...............] - ETA: 0s - loss: 0.0828 - accuracy: 0.9768126/192 [==================>...........] - ETA: 0s - loss: 0.0853 - accuracy: 0.9761151/192 [======================>.......] - ETA: 0s - loss: 0.0866 - accuracy: 0.9758176/192 [==========================>...] - ETA: 0s - loss: 0.0873 - accuracy: 0.9755192/192 [==============================] - 0s 3ms/step - loss: 0.0877 - accuracy: 0.9754 - val_loss: 0.2732 - val_accuracy: 0.9593
Epoch 18/20
  1/192 [..............................] - ETA: 0s - loss: 0.0455 - accuracy: 0.9880 26/192 [===>..........................] - ETA: 0s - loss: 0.0737 - accuracy: 0.9777 51/192 [======>.......................] - ETA: 0s - loss: 0.0722 - accuracy: 0.9784 75/192 [==========>...................] - ETA: 0s - loss: 0.0731 - accuracy: 0.9782100/192 [==============>...............] - ETA: 0s - loss: 0.0741 - accuracy: 0.9781125/192 [==================>...........] - ETA: 0s - loss: 0.0750 - accuracy: 0.9779150/192 [======================>.......] - ETA: 0s - loss: 0.0756 - accuracy: 0.9778175/192 [==========================>...] - ETA: 0s - loss: 0.0758 - accuracy: 0.9777192/192 [==============================] - 1s 3ms/step - loss: 0.0759 - accuracy: 0.9777 - val_loss: 0.3189 - val_accuracy: 0.9556
Epoch 19/20
  1/192 [..............................] - ETA: 0s - loss: 0.2367 - accuracy: 0.9800 25/192 [==>...........................] - ETA: 0s - loss: 0.0948 - accuracy: 0.9809 49/192 [======>.......................] - ETA: 0s - loss: 0.0894 - accuracy: 0.9796 73/192 [==========>...................] - ETA: 0s - loss: 0.0852 - accuracy: 0.9795 97/192 [==============>...............] - ETA: 0s - loss: 0.0822 - accuracy: 0.9795121/192 [=================>............] - ETA: 0s - loss: 0.0810 - accuracy: 0.9793146/192 [=====================>........] - ETA: 0s - loss: 0.0804 - accuracy: 0.9791170/192 [=========================>....] - ETA: 0s - loss: 0.0801 - accuracy: 0.9789192/192 [==============================] - 1s 3ms/step - loss: 0.0800 - accuracy: 0.9788 - val_loss: 0.2966 - val_accuracy: 0.9567
Epoch 20/20
  1/192 [..............................] - ETA: 0s - loss: 0.1390 - accuracy: 0.9760 25/192 [==>...........................] - ETA: 0s - loss: 0.0708 - accuracy: 0.9814 49/192 [======>.......................] - ETA: 0s - loss: 0.0677 - accuracy: 0.9813 74/192 [==========>...................] - ETA: 0s - loss: 0.0676 - accuracy: 0.9808 99/192 [==============>...............] - ETA: 0s - loss: 0.0675 - accuracy: 0.9806123/192 [==================>...........] - ETA: 0s - loss: 0.0680 - accuracy: 0.9805148/192 [======================>.......] - ETA: 0s - loss: 0.0688 - accuracy: 0.9803173/192 [==========================>...] - ETA: 0s - loss: 0.0696 - accuracy: 0.9802192/192 [==============================] - 1s 3ms/step - loss: 0.0701 - accuracy: 0.9800 - val_loss: 0.2987 - val_accuracy: 0.9555
training_time: 0:00:12.188103
  1/313 [..............................] - ETA: 38s - loss: 0.1345 - accuracy: 0.9375 23/313 [=>............................] - ETA: 0s - loss: 0.2665 - accuracy: 0.9565  45/313 [===>..........................] - ETA: 0s - loss: 0.3115 - accuracy: 0.9444 67/313 [=====>........................] - ETA: 0s - loss: 0.3286 - accuracy: 0.9450 89/313 [=======>......................] - ETA: 0s - loss: 0.3437 - accuracy: 0.9466111/313 [=========>....................] - ETA: 0s - loss: 0.3446 - accuracy: 0.9488133/313 [===========>..................] - ETA: 0s - loss: 0.3548 - accuracy: 0.9478154/313 [=============>................] - ETA: 0s - loss: 0.3434 - accuracy: 0.9470176/313 [===============>..............] - ETA: 0s - loss: 0.3116 - accuracy: 0.9512198/313 [=================>............] - ETA: 0s - loss: 0.3232 - accuracy: 0.9498219/313 [===================>..........] - ETA: 0s - loss: 0.3076 - accuracy: 0.9511240/313 [======================>.......] - ETA: 0s - loss: 0.2875 - accuracy: 0.9540262/313 [========================>.....] - ETA: 0s - loss: 0.2777 - accuracy: 0.9555283/313 [==========================>...] - ETA: 0s - loss: 0.2788 - accuracy: 0.9576305/313 [============================>.] - ETA: 0s - loss: 0.2659 - accuracy: 0.9592313/313 [==============================] - 1s 2ms/step - loss: 0.2671 - accuracy: 0.9586
Test results: Loss = 0.26714015007019043, Accuracy = 0.9585999846458435
