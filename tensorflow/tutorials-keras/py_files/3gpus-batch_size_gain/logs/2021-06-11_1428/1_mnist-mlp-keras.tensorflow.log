Number of devices: 2
batch_size_per_replica: 250
batch_size: 500 = 250 * 2
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
60000 10000
Epoch 1/20
 1/96 [..............................] - ETA: 6:00 - loss: 132.8655 - accuracy: 0.126014/96 [===>..........................] - ETA: 0s - loss: 70.6363 - accuracy: 0.3023   28/96 [=======>......................] - ETA: 0s - loss: 48.9640 - accuracy: 0.386342/96 [============>.................] - ETA: 0s - loss: 38.3674 - accuracy: 0.420156/96 [================>.............] - ETA: 0s - loss: 31.9543 - accuracy: 0.435970/96 [====================>.........] - ETA: 0s - loss: 27.6060 - accuracy: 0.447384/96 [=========================>....] - ETA: 0s - loss: 24.4374 - accuracy: 0.458096/96 [==============================] - 6s 21ms/step - loss: 22.1668 - accuracy: 0.4679 - val_loss: 1.0655 - val_accuracy: 0.6995
Epoch 2/20
 1/96 [..............................] - ETA: 0s - loss: 1.0801 - accuracy: 0.696015/96 [===>..........................] - ETA: 0s - loss: 1.0148 - accuracy: 0.703629/96 [========>.....................] - ETA: 0s - loss: 1.0085 - accuracy: 0.705043/96 [============>.................] - ETA: 0s - loss: 1.0068 - accuracy: 0.706857/96 [================>.............] - ETA: 0s - loss: 0.9989 - accuracy: 0.711470/96 [====================>.........] - ETA: 0s - loss: 0.9905 - accuracy: 0.717584/96 [=========================>....] - ETA: 0s - loss: 0.9813 - accuracy: 0.724396/96 [==============================] - 1s 6ms/step - loss: 0.9727 - accuracy: 0.7301 - val_loss: 0.7878 - val_accuracy: 0.8468
Epoch 3/20
 1/96 [..............................] - ETA: 0s - loss: 0.6902 - accuracy: 0.850015/96 [===>..........................] - ETA: 0s - loss: 0.7679 - accuracy: 0.837629/96 [========>.....................] - ETA: 0s - loss: 0.7559 - accuracy: 0.838643/96 [============>.................] - ETA: 0s - loss: 0.7427 - accuracy: 0.840257/96 [================>.............] - ETA: 0s - loss: 0.7329 - accuracy: 0.842071/96 [=====================>........] - ETA: 0s - loss: 0.7265 - accuracy: 0.843185/96 [=========================>....] - ETA: 0s - loss: 0.7213 - accuracy: 0.843696/96 [==============================] - 1s 5ms/step - loss: 0.7174 - accuracy: 0.8439 - val_loss: 0.6711 - val_accuracy: 0.8669
Epoch 4/20
 1/96 [..............................] - ETA: 0s - loss: 0.4615 - accuracy: 0.892015/96 [===>..........................] - ETA: 0s - loss: 0.5590 - accuracy: 0.877529/96 [========>.....................] - ETA: 0s - loss: 0.5671 - accuracy: 0.872043/96 [============>.................] - ETA: 0s - loss: 0.5644 - accuracy: 0.870058/96 [=================>............] - ETA: 0s - loss: 0.5612 - accuracy: 0.868872/96 [=====================>........] - ETA: 0s - loss: 0.5572 - accuracy: 0.868386/96 [=========================>....] - ETA: 0s - loss: 0.5533 - accuracy: 0.868096/96 [==============================] - 1s 5ms/step - loss: 0.5497 - accuracy: 0.8680 - val_loss: 0.5218 - val_accuracy: 0.8842
Epoch 5/20
 1/96 [..............................] - ETA: 0s - loss: 0.4364 - accuracy: 0.884016/96 [====>.........................] - ETA: 0s - loss: 0.4251 - accuracy: 0.882330/96 [========>.....................] - ETA: 0s - loss: 0.4183 - accuracy: 0.885644/96 [============>.................] - ETA: 0s - loss: 0.4133 - accuracy: 0.886958/96 [=================>............] - ETA: 0s - loss: 0.4098 - accuracy: 0.887972/96 [=====================>........] - ETA: 0s - loss: 0.4071 - accuracy: 0.888886/96 [=========================>....] - ETA: 0s - loss: 0.4053 - accuracy: 0.889696/96 [==============================] - 1s 5ms/step - loss: 0.4040 - accuracy: 0.8902 - val_loss: 0.4630 - val_accuracy: 0.8975
Epoch 6/20
 1/96 [..............................] - ETA: 0s - loss: 0.3564 - accuracy: 0.910015/96 [===>..........................] - ETA: 0s - loss: 0.3061 - accuracy: 0.915729/96 [========>.....................] - ETA: 0s - loss: 0.3000 - accuracy: 0.917643/96 [============>.................] - ETA: 0s - loss: 0.3004 - accuracy: 0.918057/96 [================>.............] - ETA: 0s - loss: 0.3015 - accuracy: 0.918171/96 [=====================>........] - ETA: 0s - loss: 0.3033 - accuracy: 0.918085/96 [=========================>....] - ETA: 0s - loss: 0.3040 - accuracy: 0.917996/96 [==============================] - 1s 6ms/step - loss: 0.3046 - accuracy: 0.9179 - val_loss: 0.4029 - val_accuracy: 0.9131
Epoch 7/20
 1/96 [..............................] - ETA: 0s - loss: 0.2433 - accuracy: 0.932015/96 [===>..........................] - ETA: 0s - loss: 0.2429 - accuracy: 0.932629/96 [========>.....................] - ETA: 0s - loss: 0.2460 - accuracy: 0.931943/96 [============>.................] - ETA: 0s - loss: 0.2483 - accuracy: 0.931057/96 [================>.............] - ETA: 0s - loss: 0.2504 - accuracy: 0.930271/96 [=====================>........] - ETA: 0s - loss: 0.2517 - accuracy: 0.929985/96 [=========================>....] - ETA: 0s - loss: 0.2528 - accuracy: 0.929796/96 [==============================] - 1s 5ms/step - loss: 0.2537 - accuracy: 0.9295 - val_loss: 0.3774 - val_accuracy: 0.9224
Epoch 8/20
 1/96 [..............................] - ETA: 0s - loss: 0.2111 - accuracy: 0.938015/96 [===>..........................] - ETA: 0s - loss: 0.2197 - accuracy: 0.934229/96 [========>.....................] - ETA: 0s - loss: 0.2214 - accuracy: 0.933943/96 [============>.................] - ETA: 0s - loss: 0.2203 - accuracy: 0.935057/96 [================>.............] - ETA: 0s - loss: 0.2192 - accuracy: 0.935871/96 [=====================>........] - ETA: 0s - loss: 0.2186 - accuracy: 0.936385/96 [=========================>....] - ETA: 0s - loss: 0.2184 - accuracy: 0.936796/96 [==============================] - 1s 6ms/step - loss: 0.2183 - accuracy: 0.9369 - val_loss: 0.3582 - val_accuracy: 0.9309
Epoch 9/20
 1/96 [..............................] - ETA: 0s - loss: 0.2292 - accuracy: 0.938015/96 [===>..........................] - ETA: 0s - loss: 0.1805 - accuracy: 0.949129/96 [========>.....................] - ETA: 0s - loss: 0.1813 - accuracy: 0.948343/96 [============>.................] - ETA: 0s - loss: 0.1826 - accuracy: 0.947757/96 [================>.............] - ETA: 0s - loss: 0.1845 - accuracy: 0.947071/96 [=====================>........] - ETA: 0s - loss: 0.1861 - accuracy: 0.946585/96 [=========================>....] - ETA: 0s - loss: 0.1873 - accuracy: 0.946296/96 [==============================] - 1s 5ms/step - loss: 0.1882 - accuracy: 0.9461 - val_loss: 0.3445 - val_accuracy: 0.9367
Epoch 10/20
 1/96 [..............................] - ETA: 0s - loss: 0.1942 - accuracy: 0.952015/96 [===>..........................] - ETA: 0s - loss: 0.1784 - accuracy: 0.951029/96 [========>.....................] - ETA: 0s - loss: 0.1752 - accuracy: 0.950743/96 [============>.................] - ETA: 0s - loss: 0.1747 - accuracy: 0.950357/96 [================>.............] - ETA: 0s - loss: 0.1744 - accuracy: 0.950272/96 [=====================>........] - ETA: 0s - loss: 0.1741 - accuracy: 0.950186/96 [=========================>....] - ETA: 0s - loss: 0.1742 - accuracy: 0.950196/96 [==============================] - 1s 5ms/step - loss: 0.1743 - accuracy: 0.9501 - val_loss: 0.3419 - val_accuracy: 0.9399
Epoch 11/20
 1/96 [..............................] - ETA: 0s - loss: 0.1293 - accuracy: 0.964015/96 [===>..........................] - ETA: 0s - loss: 0.1518 - accuracy: 0.956729/96 [========>.....................] - ETA: 0s - loss: 0.1526 - accuracy: 0.955743/96 [============>.................] - ETA: 0s - loss: 0.1506 - accuracy: 0.955957/96 [================>.............] - ETA: 0s - loss: 0.1497 - accuracy: 0.956071/96 [=====================>........] - ETA: 0s - loss: 0.1494 - accuracy: 0.955985/96 [=========================>....] - ETA: 0s - loss: 0.1488 - accuracy: 0.956196/96 [==============================] - 1s 6ms/step - loss: 0.1486 - accuracy: 0.9561 - val_loss: 0.3280 - val_accuracy: 0.9361
Epoch 12/20
 1/96 [..............................] - ETA: 0s - loss: 0.1896 - accuracy: 0.950015/96 [===>..........................] - ETA: 0s - loss: 0.1437 - accuracy: 0.956329/96 [========>.....................] - ETA: 0s - loss: 0.1414 - accuracy: 0.956943/96 [============>.................] - ETA: 0s - loss: 0.1414 - accuracy: 0.957057/96 [================>.............] - ETA: 0s - loss: 0.1411 - accuracy: 0.957171/96 [=====================>........] - ETA: 0s - loss: 0.1408 - accuracy: 0.957385/96 [=========================>....] - ETA: 0s - loss: 0.1407 - accuracy: 0.957496/96 [==============================] - 1s 6ms/step - loss: 0.1407 - accuracy: 0.9575 - val_loss: 0.3248 - val_accuracy: 0.9383
Epoch 13/20
 1/96 [..............................] - ETA: 0s - loss: 0.1323 - accuracy: 0.956015/96 [===>..........................] - ETA: 0s - loss: 0.1157 - accuracy: 0.963629/96 [========>.....................] - ETA: 0s - loss: 0.1161 - accuracy: 0.963743/96 [============>.................] - ETA: 0s - loss: 0.1172 - accuracy: 0.963558/96 [=================>............] - ETA: 0s - loss: 0.1182 - accuracy: 0.963372/96 [=====================>........] - ETA: 0s - loss: 0.1188 - accuracy: 0.963286/96 [=========================>....] - ETA: 0s - loss: 0.1191 - accuracy: 0.963196/96 [==============================] - 1s 6ms/step - loss: 0.1194 - accuracy: 0.9631 - val_loss: 0.3019 - val_accuracy: 0.9452
Epoch 14/20
 1/96 [..............................] - ETA: 0s - loss: 0.0842 - accuracy: 0.974015/96 [===>..........................] - ETA: 0s - loss: 0.0888 - accuracy: 0.971829/96 [========>.....................] - ETA: 0s - loss: 0.0982 - accuracy: 0.969443/96 [============>.................] - ETA: 0s - loss: 0.1020 - accuracy: 0.968357/96 [================>.............] - ETA: 0s - loss: 0.1041 - accuracy: 0.967772/96 [=====================>........] - ETA: 0s - loss: 0.1056 - accuracy: 0.967387/96 [==========================>...] - ETA: 0s - loss: 0.1067 - accuracy: 0.967196/96 [==============================] - 1s 5ms/step - loss: 0.1073 - accuracy: 0.9669 - val_loss: 0.3328 - val_accuracy: 0.9445
Epoch 15/20
 1/96 [..............................] - ETA: 0s - loss: 0.0879 - accuracy: 0.974015/96 [===>..........................] - ETA: 0s - loss: 0.1110 - accuracy: 0.968629/96 [========>.....................] - ETA: 0s - loss: 0.1078 - accuracy: 0.968743/96 [============>.................] - ETA: 0s - loss: 0.1056 - accuracy: 0.969057/96 [================>.............] - ETA: 0s - loss: 0.1044 - accuracy: 0.969171/96 [=====================>........] - ETA: 0s - loss: 0.1040 - accuracy: 0.969185/96 [=========================>....] - ETA: 0s - loss: 0.1041 - accuracy: 0.969096/96 [==============================] - 1s 6ms/step - loss: 0.1043 - accuracy: 0.9689 - val_loss: 0.3209 - val_accuracy: 0.9430
Epoch 16/20
 1/96 [..............................] - ETA: 0s - loss: 0.1075 - accuracy: 0.956015/96 [===>..........................] - ETA: 0s - loss: 0.1058 - accuracy: 0.964729/96 [========>.....................] - ETA: 0s - loss: 0.1019 - accuracy: 0.967343/96 [============>.................] - ETA: 0s - loss: 0.1017 - accuracy: 0.967757/96 [================>.............] - ETA: 0s - loss: 0.1022 - accuracy: 0.967971/96 [=====================>........] - ETA: 0s - loss: 0.1025 - accuracy: 0.968185/96 [=========================>....] - ETA: 0s - loss: 0.1027 - accuracy: 0.968296/96 [==============================] - 1s 6ms/step - loss: 0.1029 - accuracy: 0.9682 - val_loss: 0.3127 - val_accuracy: 0.9457
Epoch 17/20
 1/96 [..............................] - ETA: 0s - loss: 0.1275 - accuracy: 0.958015/96 [===>..........................] - ETA: 0s - loss: 0.1064 - accuracy: 0.966229/96 [========>.....................] - ETA: 0s - loss: 0.1033 - accuracy: 0.967243/96 [============>.................] - ETA: 0s - loss: 0.1009 - accuracy: 0.968057/96 [================>.............] - ETA: 0s - loss: 0.0990 - accuracy: 0.968671/96 [=====================>........] - ETA: 0s - loss: 0.0977 - accuracy: 0.969085/96 [=========================>....] - ETA: 0s - loss: 0.0970 - accuracy: 0.969296/96 [==============================] - 1s 6ms/step - loss: 0.0966 - accuracy: 0.9694 - val_loss: 0.3141 - val_accuracy: 0.9534
Epoch 18/20
 1/96 [..............................] - ETA: 0s - loss: 0.0719 - accuracy: 0.978015/96 [===>..........................] - ETA: 0s - loss: 0.0885 - accuracy: 0.972129/96 [========>.....................] - ETA: 0s - loss: 0.0869 - accuracy: 0.972443/96 [============>.................] - ETA: 0s - loss: 0.0849 - accuracy: 0.972757/96 [================>.............] - ETA: 0s - loss: 0.0843 - accuracy: 0.973071/96 [=====================>........] - ETA: 0s - loss: 0.0841 - accuracy: 0.973185/96 [=========================>....] - ETA: 0s - loss: 0.0842 - accuracy: 0.973196/96 [==============================] - 1s 5ms/step - loss: 0.0844 - accuracy: 0.9732 - val_loss: 0.2851 - val_accuracy: 0.9516
Epoch 19/20
 1/96 [..............................] - ETA: 0s - loss: 0.0535 - accuracy: 0.982015/96 [===>..........................] - ETA: 0s - loss: 0.0651 - accuracy: 0.980629/96 [========>.....................] - ETA: 0s - loss: 0.0663 - accuracy: 0.980343/96 [============>.................] - ETA: 0s - loss: 0.0676 - accuracy: 0.979657/96 [================>.............] - ETA: 0s - loss: 0.0691 - accuracy: 0.979071/96 [=====================>........] - ETA: 0s - loss: 0.0701 - accuracy: 0.978685/96 [=========================>....] - ETA: 0s - loss: 0.0708 - accuracy: 0.978396/96 [==============================] - 1s 6ms/step - loss: 0.0714 - accuracy: 0.9781 - val_loss: 0.2844 - val_accuracy: 0.9571
Epoch 20/20
 1/96 [..............................] - ETA: 0s - loss: 0.0587 - accuracy: 0.980015/96 [===>..........................] - ETA: 0s - loss: 0.0683 - accuracy: 0.977929/96 [========>.....................] - ETA: 0s - loss: 0.0677 - accuracy: 0.978143/96 [============>.................] - ETA: 0s - loss: 0.0677 - accuracy: 0.978158/96 [=================>............] - ETA: 0s - loss: 0.0673 - accuracy: 0.978272/96 [=====================>........] - ETA: 0s - loss: 0.0672 - accuracy: 0.978386/96 [=========================>....] - ETA: 0s - loss: 0.0673 - accuracy: 0.978496/96 [==============================] - 1s 5ms/step - loss: 0.0674 - accuracy: 0.9784 - val_loss: 0.3021 - val_accuracy: 0.9547
training_time: 0:00:16.197103
  1/313 [..............................] - ETA: 7:54 - loss: 0.1229 - accuracy: 0.9375 14/313 [>.............................] - ETA: 1s - loss: 0.2514 - accuracy: 0.9554   27/313 [=>............................] - ETA: 1s - loss: 0.2771 - accuracy: 0.9468 40/313 [==>...........................] - ETA: 1s - loss: 0.3325 - accuracy: 0.9398 53/313 [====>.........................] - ETA: 1s - loss: 0.3841 - accuracy: 0.9357 66/313 [=====>........................] - ETA: 0s - loss: 0.3989 - accuracy: 0.9323 80/313 [======>.......................] - ETA: 0s - loss: 0.3849 - accuracy: 0.9332 93/313 [=======>......................] - ETA: 0s - loss: 0.3841 - accuracy: 0.9348107/313 [=========>....................] - ETA: 0s - loss: 0.3798 - accuracy: 0.9369121/313 [==========>...................] - ETA: 0s - loss: 0.3888 - accuracy: 0.9365135/313 [===========>..................] - ETA: 0s - loss: 0.4035 - accuracy: 0.9366148/313 [=============>................] - ETA: 0s - loss: 0.3889 - accuracy: 0.9379161/313 [==============>...............] - ETA: 0s - loss: 0.3804 - accuracy: 0.9387174/313 [===============>..............] - ETA: 0s - loss: 0.3581 - accuracy: 0.9422188/313 [=================>............] - ETA: 0s - loss: 0.3550 - accuracy: 0.9428202/313 [==================>...........] - ETA: 0s - loss: 0.3448 - accuracy: 0.9429215/313 [===================>..........] - ETA: 0s - loss: 0.3440 - accuracy: 0.9438229/313 [====================>.........] - ETA: 0s - loss: 0.3247 - accuracy: 0.9466243/313 [======================>.......] - ETA: 0s - loss: 0.3096 - accuracy: 0.9486257/313 [=======================>......] - ETA: 0s - loss: 0.3021 - accuracy: 0.9495271/313 [========================>.....] - ETA: 0s - loss: 0.2924 - accuracy: 0.9503284/313 [==========================>...] - ETA: 0s - loss: 0.2828 - accuracy: 0.9518297/313 [===========================>..] - ETA: 0s - loss: 0.2760 - accuracy: 0.9533311/313 [============================>.] - ETA: 0s - loss: 0.2761 - accuracy: 0.9531313/313 [==============================] - 3s 4ms/step - loss: 0.2750 - accuracy: 0.9532
Test results: Loss = 0.27498945593833923, Accuracy = 0.9531999826431274
