Number of devices: 2
batch_size_per_replica: 250
batch_size: 500 = 250 * 2
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
60000 10000
Epoch 1/20
 1/96 [..............................] - ETA: 4:25 - loss: 138.8691 - accuracy: 0.086015/96 [===>..........................] - ETA: 0s - loss: 60.1358 - accuracy: 0.3185   29/96 [========>.....................] - ETA: 0s - loss: 41.6413 - accuracy: 0.407643/96 [============>.................] - ETA: 0s - loss: 32.6748 - accuracy: 0.438458/96 [=================>............] - ETA: 0s - loss: 26.9457 - accuracy: 0.452873/96 [=====================>........] - ETA: 0s - loss: 23.1385 - accuracy: 0.466687/96 [==========================>...] - ETA: 0s - loss: 20.5579 - accuracy: 0.479596/96 [==============================] - 5s 22ms/step - loss: 19.0897 - accuracy: 0.4884 - val_loss: 0.9802 - val_accuracy: 0.7393
Epoch 2/20
 1/96 [..............................] - ETA: 0s - loss: 0.9267 - accuracy: 0.758015/96 [===>..........................] - ETA: 0s - loss: 0.9824 - accuracy: 0.739229/96 [========>.....................] - ETA: 0s - loss: 0.9525 - accuracy: 0.742244/96 [============>.................] - ETA: 0s - loss: 0.9305 - accuracy: 0.745758/96 [=================>............] - ETA: 0s - loss: 0.9149 - accuracy: 0.748272/96 [=====================>........] - ETA: 0s - loss: 0.9004 - accuracy: 0.751087/96 [==========================>...] - ETA: 0s - loss: 0.8873 - accuracy: 0.754096/96 [==============================] - 1s 5ms/step - loss: 0.8793 - accuracy: 0.7561 - val_loss: 0.6957 - val_accuracy: 0.8070
Epoch 3/20
 1/96 [..............................] - ETA: 0s - loss: 0.8243 - accuracy: 0.794016/96 [====>.........................] - ETA: 0s - loss: 0.6637 - accuracy: 0.807731/96 [========>.....................] - ETA: 0s - loss: 0.6457 - accuracy: 0.814945/96 [=============>................] - ETA: 0s - loss: 0.6332 - accuracy: 0.820159/96 [=================>............] - ETA: 0s - loss: 0.6238 - accuracy: 0.824073/96 [=====================>........] - ETA: 0s - loss: 0.6168 - accuracy: 0.827087/96 [==========================>...] - ETA: 0s - loss: 0.6115 - accuracy: 0.829396/96 [==============================] - 1s 5ms/step - loss: 0.6084 - accuracy: 0.8306 - val_loss: 0.5820 - val_accuracy: 0.8635
Epoch 4/20
 1/96 [..............................] - ETA: 0s - loss: 0.4554 - accuracy: 0.870016/96 [====>.........................] - ETA: 0s - loss: 0.4844 - accuracy: 0.861831/96 [========>.....................] - ETA: 0s - loss: 0.4736 - accuracy: 0.865246/96 [=============>................] - ETA: 0s - loss: 0.4661 - accuracy: 0.867560/96 [=================>............] - ETA: 0s - loss: 0.4606 - accuracy: 0.869275/96 [======================>.......] - ETA: 0s - loss: 0.4574 - accuracy: 0.870590/96 [===========================>..] - ETA: 0s - loss: 0.4555 - accuracy: 0.871596/96 [==============================] - 1s 5ms/step - loss: 0.4546 - accuracy: 0.8719 - val_loss: 0.5019 - val_accuracy: 0.8915
Epoch 5/20
 1/96 [..............................] - ETA: 0s - loss: 0.3876 - accuracy: 0.892016/96 [====>.........................] - ETA: 0s - loss: 0.3703 - accuracy: 0.895930/96 [========>.....................] - ETA: 0s - loss: 0.3681 - accuracy: 0.897144/96 [============>.................] - ETA: 0s - loss: 0.3651 - accuracy: 0.898458/96 [=================>............] - ETA: 0s - loss: 0.3628 - accuracy: 0.899272/96 [=====================>........] - ETA: 0s - loss: 0.3628 - accuracy: 0.899486/96 [=========================>....] - ETA: 0s - loss: 0.3627 - accuracy: 0.899596/96 [==============================] - 1s 5ms/step - loss: 0.3623 - accuracy: 0.8996 - val_loss: 0.4586 - val_accuracy: 0.8903
Epoch 6/20
 1/96 [..............................] - ETA: 0s - loss: 0.2980 - accuracy: 0.908016/96 [====>.........................] - ETA: 0s - loss: 0.3353 - accuracy: 0.903931/96 [========>.....................] - ETA: 0s - loss: 0.3303 - accuracy: 0.907346/96 [=============>................] - ETA: 0s - loss: 0.3246 - accuracy: 0.909261/96 [==================>...........] - ETA: 0s - loss: 0.3213 - accuracy: 0.910475/96 [======================>.......] - ETA: 0s - loss: 0.3187 - accuracy: 0.911489/96 [==========================>...] - ETA: 0s - loss: 0.3166 - accuracy: 0.912196/96 [==============================] - 1s 5ms/step - loss: 0.3156 - accuracy: 0.9124 - val_loss: 0.3870 - val_accuracy: 0.9139
Epoch 7/20
 1/96 [..............................] - ETA: 0s - loss: 0.2432 - accuracy: 0.926015/96 [===>..........................] - ETA: 0s - loss: 0.2480 - accuracy: 0.927729/96 [========>.....................] - ETA: 0s - loss: 0.2539 - accuracy: 0.928043/96 [============>.................] - ETA: 0s - loss: 0.2581 - accuracy: 0.927257/96 [================>.............] - ETA: 0s - loss: 0.2599 - accuracy: 0.927171/96 [=====================>........] - ETA: 0s - loss: 0.2611 - accuracy: 0.926985/96 [=========================>....] - ETA: 0s - loss: 0.2617 - accuracy: 0.926796/96 [==============================] - 1s 5ms/step - loss: 0.2619 - accuracy: 0.9268 - val_loss: 0.3615 - val_accuracy: 0.9186
Epoch 8/20
 1/96 [..............................] - ETA: 0s - loss: 0.1940 - accuracy: 0.940015/96 [===>..........................] - ETA: 0s - loss: 0.2088 - accuracy: 0.937129/96 [========>.....................] - ETA: 0s - loss: 0.2126 - accuracy: 0.937143/96 [============>.................] - ETA: 0s - loss: 0.2151 - accuracy: 0.936757/96 [================>.............] - ETA: 0s - loss: 0.2164 - accuracy: 0.936871/96 [=====================>........] - ETA: 0s - loss: 0.2173 - accuracy: 0.936885/96 [=========================>....] - ETA: 0s - loss: 0.2183 - accuracy: 0.936896/96 [==============================] - 1s 6ms/step - loss: 0.2190 - accuracy: 0.9368 - val_loss: 0.3687 - val_accuracy: 0.9280
Epoch 9/20
 1/96 [..............................] - ETA: 0s - loss: 0.1610 - accuracy: 0.940015/96 [===>..........................] - ETA: 0s - loss: 0.1895 - accuracy: 0.941729/96 [========>.....................] - ETA: 0s - loss: 0.1897 - accuracy: 0.943444/96 [============>.................] - ETA: 0s - loss: 0.1892 - accuracy: 0.944259/96 [=================>............] - ETA: 0s - loss: 0.1888 - accuracy: 0.944574/96 [======================>.......] - ETA: 0s - loss: 0.1886 - accuracy: 0.944788/96 [==========================>...] - ETA: 0s - loss: 0.1881 - accuracy: 0.944996/96 [==============================] - 1s 5ms/step - loss: 0.1881 - accuracy: 0.9450 - val_loss: 0.3488 - val_accuracy: 0.9302
Epoch 10/20
 1/96 [..............................] - ETA: 0s - loss: 0.1610 - accuracy: 0.950015/96 [===>..........................] - ETA: 0s - loss: 0.1698 - accuracy: 0.952430/96 [========>.....................] - ETA: 0s - loss: 0.1632 - accuracy: 0.953244/96 [============>.................] - ETA: 0s - loss: 0.1595 - accuracy: 0.954058/96 [=================>............] - ETA: 0s - loss: 0.1580 - accuracy: 0.954272/96 [=====================>........] - ETA: 0s - loss: 0.1575 - accuracy: 0.954286/96 [=========================>....] - ETA: 0s - loss: 0.1577 - accuracy: 0.954196/96 [==============================] - 1s 5ms/step - loss: 0.1579 - accuracy: 0.9540 - val_loss: 0.3411 - val_accuracy: 0.9362
Epoch 11/20
 1/96 [..............................] - ETA: 0s - loss: 0.1948 - accuracy: 0.934015/96 [===>..........................] - ETA: 0s - loss: 0.1465 - accuracy: 0.952729/96 [========>.....................] - ETA: 0s - loss: 0.1425 - accuracy: 0.955243/96 [============>.................] - ETA: 0s - loss: 0.1432 - accuracy: 0.955757/96 [================>.............] - ETA: 0s - loss: 0.1433 - accuracy: 0.956071/96 [=====================>........] - ETA: 0s - loss: 0.1434 - accuracy: 0.956185/96 [=========================>....] - ETA: 0s - loss: 0.1435 - accuracy: 0.956296/96 [==============================] - 1s 5ms/step - loss: 0.1436 - accuracy: 0.9563 - val_loss: 0.3361 - val_accuracy: 0.9361
Epoch 12/20
 1/96 [..............................] - ETA: 0s - loss: 0.0965 - accuracy: 0.966015/96 [===>..........................] - ETA: 0s - loss: 0.1260 - accuracy: 0.959429/96 [========>.....................] - ETA: 0s - loss: 0.1287 - accuracy: 0.959643/96 [============>.................] - ETA: 0s - loss: 0.1295 - accuracy: 0.960057/96 [================>.............] - ETA: 0s - loss: 0.1304 - accuracy: 0.960172/96 [=====================>........] - ETA: 0s - loss: 0.1311 - accuracy: 0.960186/96 [=========================>....] - ETA: 0s - loss: 0.1320 - accuracy: 0.959996/96 [==============================] - 1s 6ms/step - loss: 0.1326 - accuracy: 0.9598 - val_loss: 0.3058 - val_accuracy: 0.9397
Epoch 13/20
 1/96 [..............................] - ETA: 0s - loss: 0.0908 - accuracy: 0.972015/96 [===>..........................] - ETA: 0s - loss: 0.1249 - accuracy: 0.960630/96 [========>.....................] - ETA: 0s - loss: 0.1261 - accuracy: 0.960545/96 [=============>................] - ETA: 0s - loss: 0.1270 - accuracy: 0.960560/96 [=================>............] - ETA: 0s - loss: 0.1271 - accuracy: 0.960775/96 [======================>.......] - ETA: 0s - loss: 0.1271 - accuracy: 0.960990/96 [===========================>..] - ETA: 0s - loss: 0.1272 - accuracy: 0.961196/96 [==============================] - 1s 5ms/step - loss: 0.1273 - accuracy: 0.9612 - val_loss: 0.3234 - val_accuracy: 0.9451
Epoch 14/20
 1/96 [..............................] - ETA: 0s - loss: 0.0971 - accuracy: 0.966016/96 [====>.........................] - ETA: 0s - loss: 0.1077 - accuracy: 0.966930/96 [========>.....................] - ETA: 0s - loss: 0.1076 - accuracy: 0.966845/96 [=============>................] - ETA: 0s - loss: 0.1083 - accuracy: 0.966660/96 [=================>............] - ETA: 0s - loss: 0.1094 - accuracy: 0.966475/96 [======================>.......] - ETA: 0s - loss: 0.1102 - accuracy: 0.966189/96 [==========================>...] - ETA: 0s - loss: 0.1109 - accuracy: 0.966096/96 [==============================] - 1s 5ms/step - loss: 0.1112 - accuracy: 0.9659 - val_loss: 0.3152 - val_accuracy: 0.9450
Epoch 15/20
 1/96 [..............................] - ETA: 0s - loss: 0.1272 - accuracy: 0.960015/96 [===>..........................] - ETA: 0s - loss: 0.1102 - accuracy: 0.964629/96 [========>.....................] - ETA: 0s - loss: 0.1048 - accuracy: 0.966943/96 [============>.................] - ETA: 0s - loss: 0.1023 - accuracy: 0.967957/96 [================>.............] - ETA: 0s - loss: 0.1015 - accuracy: 0.968371/96 [=====================>........] - ETA: 0s - loss: 0.1017 - accuracy: 0.968485/96 [=========================>....] - ETA: 0s - loss: 0.1018 - accuracy: 0.968496/96 [==============================] - 1s 6ms/step - loss: 0.1018 - accuracy: 0.9685 - val_loss: 0.3022 - val_accuracy: 0.9492
Epoch 16/20
 1/96 [..............................] - ETA: 0s - loss: 0.0684 - accuracy: 0.978015/96 [===>..........................] - ETA: 0s - loss: 0.0822 - accuracy: 0.973630/96 [========>.....................] - ETA: 0s - loss: 0.0868 - accuracy: 0.972344/96 [============>.................] - ETA: 0s - loss: 0.0899 - accuracy: 0.971659/96 [=================>............] - ETA: 0s - loss: 0.0913 - accuracy: 0.971473/96 [=====================>........] - ETA: 0s - loss: 0.0924 - accuracy: 0.971187/96 [==========================>...] - ETA: 0s - loss: 0.0935 - accuracy: 0.970996/96 [==============================] - 1s 5ms/step - loss: 0.0942 - accuracy: 0.9707 - val_loss: 0.3218 - val_accuracy: 0.9424
Epoch 17/20
 1/96 [..............................] - ETA: 0s - loss: 0.1002 - accuracy: 0.972016/96 [====>.........................] - ETA: 0s - loss: 0.1077 - accuracy: 0.970130/96 [========>.....................] - ETA: 0s - loss: 0.1022 - accuracy: 0.970845/96 [=============>................] - ETA: 0s - loss: 0.0995 - accuracy: 0.971259/96 [=================>............] - ETA: 0s - loss: 0.0981 - accuracy: 0.971374/96 [======================>.......] - ETA: 0s - loss: 0.0967 - accuracy: 0.971688/96 [==========================>...] - ETA: 0s - loss: 0.0957 - accuracy: 0.971796/96 [==============================] - 1s 5ms/step - loss: 0.0954 - accuracy: 0.9718 - val_loss: 0.3106 - val_accuracy: 0.9507
Epoch 18/20
 1/96 [..............................] - ETA: 0s - loss: 0.1793 - accuracy: 0.948015/96 [===>..........................] - ETA: 0s - loss: 0.1095 - accuracy: 0.966429/96 [========>.....................] - ETA: 0s - loss: 0.1001 - accuracy: 0.968644/96 [============>.................] - ETA: 0s - loss: 0.0954 - accuracy: 0.969958/96 [=================>............] - ETA: 0s - loss: 0.0946 - accuracy: 0.970272/96 [=====================>........] - ETA: 0s - loss: 0.0942 - accuracy: 0.970386/96 [=========================>....] - ETA: 0s - loss: 0.0938 - accuracy: 0.970596/96 [==============================] - 1s 5ms/step - loss: 0.0937 - accuracy: 0.9706 - val_loss: 0.2808 - val_accuracy: 0.9511
Epoch 19/20
 1/96 [..............................] - ETA: 0s - loss: 0.0697 - accuracy: 0.974015/96 [===>..........................] - ETA: 0s - loss: 0.0756 - accuracy: 0.972529/96 [========>.....................] - ETA: 0s - loss: 0.0793 - accuracy: 0.972944/96 [============>.................] - ETA: 0s - loss: 0.0797 - accuracy: 0.973458/96 [=================>............] - ETA: 0s - loss: 0.0799 - accuracy: 0.973672/96 [=====================>........] - ETA: 0s - loss: 0.0802 - accuracy: 0.973886/96 [=========================>....] - ETA: 0s - loss: 0.0804 - accuracy: 0.973996/96 [==============================] - 1s 5ms/step - loss: 0.0806 - accuracy: 0.9739 - val_loss: 0.3010 - val_accuracy: 0.9558
Epoch 20/20
 1/96 [..............................] - ETA: 0s - loss: 0.0751 - accuracy: 0.972015/96 [===>..........................] - ETA: 0s - loss: 0.0645 - accuracy: 0.978630/96 [========>.....................] - ETA: 0s - loss: 0.0671 - accuracy: 0.978045/96 [=============>................] - ETA: 0s - loss: 0.0683 - accuracy: 0.977759/96 [=================>............] - ETA: 0s - loss: 0.0688 - accuracy: 0.977574/96 [======================>.......] - ETA: 0s - loss: 0.0694 - accuracy: 0.977389/96 [==========================>...] - ETA: 0s - loss: 0.0703 - accuracy: 0.977196/96 [==============================] - 1s 5ms/step - loss: 0.0708 - accuracy: 0.9771 - val_loss: 0.2860 - val_accuracy: 0.9537
training_time: 0:00:15.098412
  1/313 [..............................] - ETA: 7:45 - loss: 0.0344 - accuracy: 1.0000 15/313 [>.............................] - ETA: 1s - loss: 0.1646 - accuracy: 0.9688   29/313 [=>............................] - ETA: 1s - loss: 0.1708 - accuracy: 0.9591 42/313 [===>..........................] - ETA: 1s - loss: 0.3125 - accuracy: 0.9494 55/313 [====>.........................] - ETA: 0s - loss: 0.3363 - accuracy: 0.9460 68/313 [=====>........................] - ETA: 0s - loss: 0.3589 - accuracy: 0.9416 82/313 [======>.......................] - ETA: 0s - loss: 0.3483 - accuracy: 0.9421 96/313 [========>.....................] - ETA: 0s - loss: 0.3451 - accuracy: 0.9424110/313 [=========>....................] - ETA: 0s - loss: 0.3363 - accuracy: 0.9440123/313 [==========>...................] - ETA: 0s - loss: 0.3618 - accuracy: 0.9441137/313 [============>.................] - ETA: 0s - loss: 0.3768 - accuracy: 0.9411151/313 [=============>................] - ETA: 0s - loss: 0.3597 - accuracy: 0.9431165/313 [==============>...............] - ETA: 0s - loss: 0.3505 - accuracy: 0.9432179/313 [================>.............] - ETA: 0s - loss: 0.3433 - accuracy: 0.9459193/313 [=================>............] - ETA: 0s - loss: 0.3482 - accuracy: 0.9449207/313 [==================>...........] - ETA: 0s - loss: 0.3513 - accuracy: 0.9461221/313 [====================>.........] - ETA: 0s - loss: 0.3448 - accuracy: 0.9478235/313 [=====================>........] - ETA: 0s - loss: 0.3310 - accuracy: 0.9497249/313 [======================>.......] - ETA: 0s - loss: 0.3194 - accuracy: 0.9508263/313 [========================>.....] - ETA: 0s - loss: 0.3106 - accuracy: 0.9514276/313 [=========================>....] - ETA: 0s - loss: 0.3020 - accuracy: 0.9528289/313 [==========================>...] - ETA: 0s - loss: 0.2935 - accuracy: 0.9542302/313 [===========================>..] - ETA: 0s - loss: 0.2849 - accuracy: 0.9550313/313 [==============================] - 3s 4ms/step - loss: 0.2889 - accuracy: 0.9545
Test results: Loss = 0.2889251112937927, Accuracy = 0.9545000195503235
