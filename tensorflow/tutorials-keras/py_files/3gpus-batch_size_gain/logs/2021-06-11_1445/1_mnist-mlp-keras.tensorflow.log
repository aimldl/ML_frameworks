Number of devices: 2
batch_size_per_replica: 250
batch_size: 500 = 250 * 2
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
60000 10000
Epoch 1/20
 1/96 [..............................] - ETA: 5:59 - loss: 112.0042 - accuracy: 0.142015/96 [===>..........................] - ETA: 0s - loss: 54.6986 - accuracy: 0.3240   29/96 [========>.....................] - ETA: 0s - loss: 38.3854 - accuracy: 0.433743/96 [============>.................] - ETA: 0s - loss: 30.3297 - accuracy: 0.476657/96 [================>.............] - ETA: 0s - loss: 25.3996 - accuracy: 0.494471/96 [=====================>........] - ETA: 0s - loss: 22.0278 - accuracy: 0.507385/96 [=========================>....] - ETA: 0s - loss: 19.5537 - accuracy: 0.520196/96 [==============================] - 6s 21ms/step - loss: 17.8955 - accuracy: 0.5311 - val_loss: 0.8386 - val_accuracy: 0.7881
Epoch 2/20
 1/96 [..............................] - ETA: 0s - loss: 0.8292 - accuracy: 0.734016/96 [====>.........................] - ETA: 0s - loss: 0.8499 - accuracy: 0.769931/96 [========>.....................] - ETA: 0s - loss: 0.8321 - accuracy: 0.779246/96 [=============>................] - ETA: 0s - loss: 0.8165 - accuracy: 0.785161/96 [==================>...........] - ETA: 0s - loss: 0.8017 - accuracy: 0.789676/96 [======================>.......] - ETA: 0s - loss: 0.7905 - accuracy: 0.793791/96 [===========================>..] - ETA: 0s - loss: 0.7800 - accuracy: 0.797496/96 [==============================] - 1s 6ms/step - loss: 0.7758 - accuracy: 0.7989 - val_loss: 0.5550 - val_accuracy: 0.8668
Epoch 3/20
 1/96 [..............................] - ETA: 0s - loss: 0.5739 - accuracy: 0.864016/96 [====>.........................] - ETA: 0s - loss: 0.5298 - accuracy: 0.862930/96 [========>.....................] - ETA: 0s - loss: 0.5249 - accuracy: 0.865844/96 [============>.................] - ETA: 0s - loss: 0.5241 - accuracy: 0.867058/96 [=================>............] - ETA: 0s - loss: 0.5210 - accuracy: 0.868273/96 [=====================>........] - ETA: 0s - loss: 0.5165 - accuracy: 0.869588/96 [==========================>...] - ETA: 0s - loss: 0.5122 - accuracy: 0.870696/96 [==============================] - 1s 5ms/step - loss: 0.5105 - accuracy: 0.8712 - val_loss: 0.4833 - val_accuracy: 0.8934
Epoch 4/20
 1/96 [..............................] - ETA: 0s - loss: 0.4911 - accuracy: 0.894015/96 [===>..........................] - ETA: 0s - loss: 0.4204 - accuracy: 0.892230/96 [========>.....................] - ETA: 0s - loss: 0.4095 - accuracy: 0.893345/96 [=============>................] - ETA: 0s - loss: 0.4029 - accuracy: 0.895260/96 [=================>............] - ETA: 0s - loss: 0.3975 - accuracy: 0.896675/96 [======================>.......] - ETA: 0s - loss: 0.3937 - accuracy: 0.897789/96 [==========================>...] - ETA: 0s - loss: 0.3911 - accuracy: 0.898496/96 [==============================] - 1s 5ms/step - loss: 0.3902 - accuracy: 0.8988 - val_loss: 0.4282 - val_accuracy: 0.9018
Epoch 5/20
 1/96 [..............................] - ETA: 0s - loss: 0.3404 - accuracy: 0.916016/96 [====>.........................] - ETA: 0s - loss: 0.3015 - accuracy: 0.918830/96 [========>.....................] - ETA: 0s - loss: 0.2959 - accuracy: 0.919744/96 [============>.................] - ETA: 0s - loss: 0.2960 - accuracy: 0.920058/96 [=================>............] - ETA: 0s - loss: 0.2972 - accuracy: 0.920173/96 [=====================>........] - ETA: 0s - loss: 0.2985 - accuracy: 0.920187/96 [==========================>...] - ETA: 0s - loss: 0.2996 - accuracy: 0.920196/96 [==============================] - 1s 5ms/step - loss: 0.3002 - accuracy: 0.9201 - val_loss: 0.3831 - val_accuracy: 0.9218
Epoch 6/20
 1/96 [..............................] - ETA: 0s - loss: 0.2178 - accuracy: 0.942015/96 [===>..........................] - ETA: 0s - loss: 0.2536 - accuracy: 0.935329/96 [========>.....................] - ETA: 0s - loss: 0.2463 - accuracy: 0.935044/96 [============>.................] - ETA: 0s - loss: 0.2436 - accuracy: 0.934858/96 [=================>............] - ETA: 0s - loss: 0.2433 - accuracy: 0.934472/96 [=====================>........] - ETA: 0s - loss: 0.2431 - accuracy: 0.934386/96 [=========================>....] - ETA: 0s - loss: 0.2433 - accuracy: 0.934096/96 [==============================] - 1s 5ms/step - loss: 0.2435 - accuracy: 0.9338 - val_loss: 0.3490 - val_accuracy: 0.9255
Epoch 7/20
 1/96 [..............................] - ETA: 0s - loss: 0.1190 - accuracy: 0.964015/96 [===>..........................] - ETA: 0s - loss: 0.1855 - accuracy: 0.945429/96 [========>.....................] - ETA: 0s - loss: 0.1890 - accuracy: 0.944143/96 [============>.................] - ETA: 0s - loss: 0.1918 - accuracy: 0.943457/96 [================>.............] - ETA: 0s - loss: 0.1935 - accuracy: 0.943172/96 [=====================>........] - ETA: 0s - loss: 0.1953 - accuracy: 0.942787/96 [==========================>...] - ETA: 0s - loss: 0.1972 - accuracy: 0.942396/96 [==============================] - 1s 5ms/step - loss: 0.1982 - accuracy: 0.9420 - val_loss: 0.3458 - val_accuracy: 0.9297
Epoch 8/20
 1/96 [..............................] - ETA: 0s - loss: 0.2279 - accuracy: 0.930015/96 [===>..........................] - ETA: 0s - loss: 0.1959 - accuracy: 0.939929/96 [========>.....................] - ETA: 0s - loss: 0.1967 - accuracy: 0.941344/96 [============>.................] - ETA: 0s - loss: 0.1964 - accuracy: 0.941758/96 [=================>............] - ETA: 0s - loss: 0.1956 - accuracy: 0.942072/96 [=====================>........] - ETA: 0s - loss: 0.1953 - accuracy: 0.942387/96 [==========================>...] - ETA: 0s - loss: 0.1952 - accuracy: 0.942596/96 [==============================] - 1s 5ms/step - loss: 0.1952 - accuracy: 0.9426 - val_loss: 0.3584 - val_accuracy: 0.9285
Epoch 9/20
 1/96 [..............................] - ETA: 0s - loss: 0.1596 - accuracy: 0.952015/96 [===>..........................] - ETA: 0s - loss: 0.1672 - accuracy: 0.947329/96 [========>.....................] - ETA: 0s - loss: 0.1678 - accuracy: 0.948643/96 [============>.................] - ETA: 0s - loss: 0.1666 - accuracy: 0.949357/96 [================>.............] - ETA: 0s - loss: 0.1655 - accuracy: 0.949871/96 [=====================>........] - ETA: 0s - loss: 0.1644 - accuracy: 0.950486/96 [=========================>....] - ETA: 0s - loss: 0.1641 - accuracy: 0.950796/96 [==============================] - 1s 6ms/step - loss: 0.1642 - accuracy: 0.9508 - val_loss: 0.3452 - val_accuracy: 0.9352
Epoch 10/20
 1/96 [..............................] - ETA: 0s - loss: 0.1772 - accuracy: 0.932015/96 [===>..........................] - ETA: 0s - loss: 0.1591 - accuracy: 0.946229/96 [========>.....................] - ETA: 0s - loss: 0.1563 - accuracy: 0.949644/96 [============>.................] - ETA: 0s - loss: 0.1528 - accuracy: 0.952158/96 [=================>............] - ETA: 0s - loss: 0.1512 - accuracy: 0.953173/96 [=====================>........] - ETA: 0s - loss: 0.1495 - accuracy: 0.953988/96 [==========================>...] - ETA: 0s - loss: 0.1484 - accuracy: 0.954596/96 [==============================] - 1s 5ms/step - loss: 0.1480 - accuracy: 0.9547 - val_loss: 0.3105 - val_accuracy: 0.9404
Epoch 11/20
 1/96 [..............................] - ETA: 0s - loss: 0.1493 - accuracy: 0.962015/96 [===>..........................] - ETA: 0s - loss: 0.1446 - accuracy: 0.955329/96 [========>.....................] - ETA: 0s - loss: 0.1385 - accuracy: 0.957543/96 [============>.................] - ETA: 0s - loss: 0.1345 - accuracy: 0.959057/96 [================>.............] - ETA: 0s - loss: 0.1319 - accuracy: 0.959871/96 [=====================>........] - ETA: 0s - loss: 0.1308 - accuracy: 0.960286/96 [=========================>....] - ETA: 0s - loss: 0.1302 - accuracy: 0.960496/96 [==============================] - 1s 5ms/step - loss: 0.1301 - accuracy: 0.9605 - val_loss: 0.3107 - val_accuracy: 0.9407
Epoch 12/20
 1/96 [..............................] - ETA: 0s - loss: 0.0996 - accuracy: 0.958016/96 [====>.........................] - ETA: 0s - loss: 0.1086 - accuracy: 0.962831/96 [========>.....................] - ETA: 0s - loss: 0.1083 - accuracy: 0.963845/96 [=============>................] - ETA: 0s - loss: 0.1082 - accuracy: 0.964260/96 [=================>............] - ETA: 0s - loss: 0.1086 - accuracy: 0.964475/96 [======================>.......] - ETA: 0s - loss: 0.1093 - accuracy: 0.964389/96 [==========================>...] - ETA: 0s - loss: 0.1100 - accuracy: 0.964496/96 [==============================] - 1s 5ms/step - loss: 0.1104 - accuracy: 0.9643 - val_loss: 0.2963 - val_accuracy: 0.9457
Epoch 13/20
 1/96 [..............................] - ETA: 0s - loss: 0.0946 - accuracy: 0.974016/96 [====>.........................] - ETA: 0s - loss: 0.1087 - accuracy: 0.967630/96 [========>.....................] - ETA: 0s - loss: 0.1072 - accuracy: 0.967745/96 [=============>................] - ETA: 0s - loss: 0.1067 - accuracy: 0.967859/96 [=================>............] - ETA: 0s - loss: 0.1062 - accuracy: 0.967974/96 [======================>.......] - ETA: 0s - loss: 0.1063 - accuracy: 0.967889/96 [==========================>...] - ETA: 0s - loss: 0.1067 - accuracy: 0.967696/96 [==============================] - 1s 5ms/step - loss: 0.1068 - accuracy: 0.9676 - val_loss: 0.3071 - val_accuracy: 0.9465
Epoch 14/20
 1/96 [..............................] - ETA: 0s - loss: 0.1236 - accuracy: 0.962015/96 [===>..........................] - ETA: 0s - loss: 0.0980 - accuracy: 0.965729/96 [========>.....................] - ETA: 0s - loss: 0.0984 - accuracy: 0.966443/96 [============>.................] - ETA: 0s - loss: 0.0980 - accuracy: 0.967157/96 [================>.............] - ETA: 0s - loss: 0.0970 - accuracy: 0.967872/96 [=====================>........] - ETA: 0s - loss: 0.0968 - accuracy: 0.968187/96 [==========================>...] - ETA: 0s - loss: 0.0967 - accuracy: 0.968396/96 [==============================] - 1s 5ms/step - loss: 0.0967 - accuracy: 0.9684 - val_loss: 0.3050 - val_accuracy: 0.9487
Epoch 15/20
 1/96 [..............................] - ETA: 0s - loss: 0.0682 - accuracy: 0.978015/96 [===>..........................] - ETA: 0s - loss: 0.0771 - accuracy: 0.975330/96 [========>.....................] - ETA: 0s - loss: 0.0804 - accuracy: 0.974144/96 [============>.................] - ETA: 0s - loss: 0.0817 - accuracy: 0.973659/96 [=================>............] - ETA: 0s - loss: 0.0829 - accuracy: 0.973374/96 [======================>.......] - ETA: 0s - loss: 0.0837 - accuracy: 0.973189/96 [==========================>...] - ETA: 0s - loss: 0.0846 - accuracy: 0.972896/96 [==============================] - 1s 5ms/step - loss: 0.0850 - accuracy: 0.9727 - val_loss: 0.3225 - val_accuracy: 0.9510
Epoch 16/20
 1/96 [..............................] - ETA: 0s - loss: 0.0618 - accuracy: 0.978015/96 [===>..........................] - ETA: 0s - loss: 0.0788 - accuracy: 0.974229/96 [========>.....................] - ETA: 0s - loss: 0.0789 - accuracy: 0.973943/96 [============>.................] - ETA: 0s - loss: 0.0792 - accuracy: 0.973758/96 [=================>............] - ETA: 0s - loss: 0.0794 - accuracy: 0.973772/96 [=====================>........] - ETA: 0s - loss: 0.0795 - accuracy: 0.973786/96 [=========================>....] - ETA: 0s - loss: 0.0797 - accuracy: 0.973796/96 [==============================] - 1s 5ms/step - loss: 0.0800 - accuracy: 0.9737 - val_loss: 0.2918 - val_accuracy: 0.9473
Epoch 17/20
 1/96 [..............................] - ETA: 0s - loss: 0.0864 - accuracy: 0.962015/96 [===>..........................] - ETA: 0s - loss: 0.0831 - accuracy: 0.974630/96 [========>.....................] - ETA: 0s - loss: 0.0837 - accuracy: 0.975145/96 [=============>................] - ETA: 0s - loss: 0.0827 - accuracy: 0.975359/96 [=================>............] - ETA: 0s - loss: 0.0819 - accuracy: 0.975374/96 [======================>.......] - ETA: 0s - loss: 0.0817 - accuracy: 0.975388/96 [==========================>...] - ETA: 0s - loss: 0.0814 - accuracy: 0.975396/96 [==============================] - 1s 5ms/step - loss: 0.0813 - accuracy: 0.9753 - val_loss: 0.2981 - val_accuracy: 0.9555
Epoch 18/20
 1/96 [..............................] - ETA: 0s - loss: 0.0428 - accuracy: 0.982016/96 [====>.........................] - ETA: 0s - loss: 0.0553 - accuracy: 0.980730/96 [========>.....................] - ETA: 0s - loss: 0.0613 - accuracy: 0.979844/96 [============>.................] - ETA: 0s - loss: 0.0653 - accuracy: 0.979159/96 [=================>............] - ETA: 0s - loss: 0.0679 - accuracy: 0.978673/96 [=====================>........] - ETA: 0s - loss: 0.0694 - accuracy: 0.978388/96 [==========================>...] - ETA: 0s - loss: 0.0705 - accuracy: 0.978096/96 [==============================] - 1s 5ms/step - loss: 0.0711 - accuracy: 0.9779 - val_loss: 0.3056 - val_accuracy: 0.9496
Epoch 19/20
 1/96 [..............................] - ETA: 0s - loss: 0.0596 - accuracy: 0.976016/96 [====>.........................] - ETA: 0s - loss: 0.0672 - accuracy: 0.978131/96 [========>.....................] - ETA: 0s - loss: 0.0648 - accuracy: 0.979346/96 [=============>................] - ETA: 0s - loss: 0.0643 - accuracy: 0.979760/96 [=================>............] - ETA: 0s - loss: 0.0646 - accuracy: 0.979775/96 [======================>.......] - ETA: 0s - loss: 0.0649 - accuracy: 0.979790/96 [===========================>..] - ETA: 0s - loss: 0.0654 - accuracy: 0.979596/96 [==============================] - 1s 5ms/step - loss: 0.0656 - accuracy: 0.9795 - val_loss: 0.2993 - val_accuracy: 0.9562
Epoch 20/20
 1/96 [..............................] - ETA: 0s - loss: 0.0620 - accuracy: 0.980016/96 [====>.........................] - ETA: 0s - loss: 0.0542 - accuracy: 0.982530/96 [========>.....................] - ETA: 0s - loss: 0.0556 - accuracy: 0.982545/96 [=============>................] - ETA: 0s - loss: 0.0577 - accuracy: 0.981960/96 [=================>............] - ETA: 0s - loss: 0.0593 - accuracy: 0.981375/96 [======================>.......] - ETA: 0s - loss: 0.0606 - accuracy: 0.980989/96 [==========================>...] - ETA: 0s - loss: 0.0617 - accuracy: 0.980696/96 [==============================] - 1s 5ms/step - loss: 0.0622 - accuracy: 0.9805 - val_loss: 0.3204 - val_accuracy: 0.9531
training_time: 0:00:15.997499
  1/313 [..............................] - ETA: 7:49 - loss: 0.1143 - accuracy: 0.9688 14/313 [>.............................] - ETA: 1s - loss: 0.2689 - accuracy: 0.9688   27/313 [=>............................] - ETA: 1s - loss: 0.2732 - accuracy: 0.9549 40/313 [==>...........................] - ETA: 1s - loss: 0.3904 - accuracy: 0.9398 53/313 [====>.........................] - ETA: 1s - loss: 0.4158 - accuracy: 0.9404 66/313 [=====>........................] - ETA: 0s - loss: 0.4560 - accuracy: 0.9361 79/313 [======>.......................] - ETA: 0s - loss: 0.4569 - accuracy: 0.9363 92/313 [=======>......................] - ETA: 0s - loss: 0.4446 - accuracy: 0.9402105/313 [=========>....................] - ETA: 0s - loss: 0.4570 - accuracy: 0.9423119/313 [==========>...................] - ETA: 0s - loss: 0.4612 - accuracy: 0.9425133/313 [===========>..................] - ETA: 0s - loss: 0.4769 - accuracy: 0.9417147/313 [=============>................] - ETA: 0s - loss: 0.4772 - accuracy: 0.9413160/313 [==============>...............] - ETA: 0s - loss: 0.4606 - accuracy: 0.9420174/313 [===============>..............] - ETA: 0s - loss: 0.4308 - accuracy: 0.9452187/313 [================>.............] - ETA: 0s - loss: 0.4297 - accuracy: 0.9457200/313 [==================>...........] - ETA: 0s - loss: 0.4208 - accuracy: 0.9458214/313 [===================>..........] - ETA: 0s - loss: 0.4156 - accuracy: 0.9466227/313 [====================>.........] - ETA: 0s - loss: 0.3942 - accuracy: 0.9488240/313 [======================>.......] - ETA: 0s - loss: 0.3754 - accuracy: 0.9505253/313 [=======================>......] - ETA: 0s - loss: 0.3630 - accuracy: 0.9512267/313 [========================>.....] - ETA: 0s - loss: 0.3517 - accuracy: 0.9514281/313 [=========================>....] - ETA: 0s - loss: 0.3352 - accuracy: 0.9536295/313 [===========================>..] - ETA: 0s - loss: 0.3305 - accuracy: 0.9548309/313 [============================>.] - ETA: 0s - loss: 0.3439 - accuracy: 0.9546313/313 [==============================] - 3s 4ms/step - loss: 0.3427 - accuracy: 0.9543
Test results: Loss = 0.34267929196357727, Accuracy = 0.9542999863624573
