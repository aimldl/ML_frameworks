Number of devices: 2
batch_size_per_replica: 512
batch_size: 1024 = 512 * 2
8982 training samples
2246 test samples
11228 total samples
8982 training labels, 2246 test labels
? period ended december 31 shr profit 11 cts vs loss 24 cts net profit 224 271 vs loss 511 349 revs 7 258 688 vs 7 200 349 reuter 3
x_train (8982, 10000)
x_test  (2246, 10000)
y_train_dummy (8982, 46)
y_test_dummy  (2246, 46)
3 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
4 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
y_train (8982, 46)
y_test  (2246, 46)
3 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
4 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
x_val  (1000, 10000)
y_val  (1000, 46)
partial_x_train  (7982, 10000)
partial_y_train  (7982, 46)
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense (Dense)                (None, 64)                640064    
_________________________________________________________________
dense_1 (Dense)              (None, 64)                4160      
_________________________________________________________________
dense_2 (Dense)              (None, 46)                2990      
=================================================================
Total params: 647,214
Trainable params: 647,214
Non-trainable params: 0
_________________________________________________________________
Epoch 1/10
1/8 [==>...........................] - ETA: 28s - loss: 3.8463 - accuracy: 0.02546/8 [=====================>........] - ETA: 0s - loss: 3.6163 - accuracy: 0.2713 8/8 [==============================] - 6s 269ms/step - loss: 3.4869 - accuracy: 0.3289 - val_loss: 2.4376 - val_accuracy: 0.6040
Epoch 2/10
1/8 [==>...........................] - ETA: 0s - loss: 2.3760 - accuracy: 0.60646/8 [=====================>........] - ETA: 0s - loss: 2.2389 - accuracy: 0.62918/8 [==============================] - 0s 29ms/step - loss: 2.1734 - accuracy: 0.6379 - val_loss: 1.7329 - val_accuracy: 0.6630
Epoch 3/10
1/8 [==>...........................] - ETA: 0s - loss: 1.5917 - accuracy: 0.72176/8 [=====================>........] - ETA: 0s - loss: 1.5362 - accuracy: 0.71788/8 [==============================] - 0s 28ms/step - loss: 1.5083 - accuracy: 0.7201 - val_loss: 1.4100 - val_accuracy: 0.7240
Epoch 4/10
1/8 [==>...........................] - ETA: 0s - loss: 1.2420 - accuracy: 0.75686/8 [=====================>........] - ETA: 0s - loss: 1.1921 - accuracy: 0.76328/8 [==============================] - 0s 28ms/step - loss: 1.1758 - accuracy: 0.7659 - val_loss: 1.2383 - val_accuracy: 0.7420
Epoch 5/10
1/8 [==>...........................] - ETA: 0s - loss: 0.9925 - accuracy: 0.80666/8 [=====================>........] - ETA: 0s - loss: 0.9604 - accuracy: 0.81058/8 [==============================] - 0s 28ms/step - loss: 0.9545 - accuracy: 0.8114 - val_loss: 1.1306 - val_accuracy: 0.7490
Epoch 6/10
1/8 [==>...........................] - ETA: 0s - loss: 0.8733 - accuracy: 0.81356/8 [=====================>........] - ETA: 0s - loss: 0.8371 - accuracy: 0.82858/8 [==============================] - 0s 28ms/step - loss: 0.8219 - accuracy: 0.8330 - val_loss: 1.0600 - val_accuracy: 0.7760
Epoch 7/10
1/8 [==>...........................] - ETA: 0s - loss: 0.6709 - accuracy: 0.87117/8 [=========================>....] - ETA: 0s - loss: 0.6819 - accuracy: 0.86938/8 [==============================] - 0s 27ms/step - loss: 0.6804 - accuracy: 0.8689 - val_loss: 1.0190 - val_accuracy: 0.7930
Epoch 8/10
1/8 [==>...........................] - ETA: 0s - loss: 0.5568 - accuracy: 0.89367/8 [=========================>....] - ETA: 0s - loss: 0.5670 - accuracy: 0.89028/8 [==============================] - 0s 27ms/step - loss: 0.5683 - accuracy: 0.8895 - val_loss: 0.9681 - val_accuracy: 0.7970
Epoch 9/10
1/8 [==>...........................] - ETA: 0s - loss: 0.4720 - accuracy: 0.90537/8 [=========================>....] - ETA: 0s - loss: 0.4779 - accuracy: 0.90588/8 [==============================] - 0s 26ms/step - loss: 0.4806 - accuracy: 0.9051 - val_loss: 0.9471 - val_accuracy: 0.8000
Epoch 10/10
1/8 [==>...........................] - ETA: 0s - loss: 0.3779 - accuracy: 0.92387/8 [=========================>....] - ETA: 0s - loss: 0.4115 - accuracy: 0.91808/8 [==============================] - 0s 27ms/step - loss: 0.4142 - accuracy: 0.9172 - val_loss: 0.9162 - val_accuracy: 0.8030
/home/ubuntu/anaconda3/envs/tensorflow2_latest_p37/gpu_cuda11.0/lib/python3.7/site-packages/tensorflow/python/keras/datasets/reuters.py:148: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/ubuntu/anaconda3/envs/tensorflow2_latest_p37/gpu_cuda11.0/lib/python3.7/site-packages/tensorflow/python/keras/datasets/reuters.py:149: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
training_time: 0:00:08.897774
