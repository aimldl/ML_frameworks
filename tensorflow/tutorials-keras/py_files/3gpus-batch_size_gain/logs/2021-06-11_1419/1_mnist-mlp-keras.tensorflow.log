Number of devices: 2
batch_size_per_replica: 250
batch_size: 500 = 250 * 2
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
60000 10000
Epoch 1/20
 1/96 [..............................] - ETA: 5:59 - loss: 114.9876 - accuracy: 0.094014/96 [===>..........................] - ETA: 0s - loss: 50.2098 - accuracy: 0.3007   28/96 [=======>......................] - ETA: 0s - loss: 34.2058 - accuracy: 0.392342/96 [============>.................] - ETA: 0s - loss: 26.6550 - accuracy: 0.418256/96 [================>.............] - ETA: 0s - loss: 22.1582 - accuracy: 0.432371/96 [=====================>........] - ETA: 0s - loss: 18.9523 - accuracy: 0.449185/96 [=========================>....] - ETA: 0s - loss: 16.8022 - accuracy: 0.464696/96 [==============================] - 6s 21ms/step - loss: 15.3676 - accuracy: 0.4776 - val_loss: 0.8954 - val_accuracy: 0.7627
Epoch 2/20
 1/96 [..............................] - ETA: 0s - loss: 0.7479 - accuracy: 0.766015/96 [===>..........................] - ETA: 0s - loss: 0.8436 - accuracy: 0.767329/96 [========>.....................] - ETA: 0s - loss: 0.8363 - accuracy: 0.774144/96 [============>.................] - ETA: 0s - loss: 0.8268 - accuracy: 0.778658/96 [=================>............] - ETA: 0s - loss: 0.8175 - accuracy: 0.782572/96 [=====================>........] - ETA: 0s - loss: 0.8104 - accuracy: 0.785686/96 [=========================>....] - ETA: 0s - loss: 0.8040 - accuracy: 0.788296/96 [==============================] - 1s 5ms/step - loss: 0.7987 - accuracy: 0.7903 - val_loss: 0.6228 - val_accuracy: 0.8560
Epoch 3/20
 1/96 [..............................] - ETA: 0s - loss: 0.5143 - accuracy: 0.856015/96 [===>..........................] - ETA: 0s - loss: 0.5625 - accuracy: 0.859529/96 [========>.....................] - ETA: 0s - loss: 0.5560 - accuracy: 0.857643/96 [============>.................] - ETA: 0s - loss: 0.5507 - accuracy: 0.857957/96 [================>.............] - ETA: 0s - loss: 0.5465 - accuracy: 0.858871/96 [=====================>........] - ETA: 0s - loss: 0.5431 - accuracy: 0.859685/96 [=========================>....] - ETA: 0s - loss: 0.5404 - accuracy: 0.860396/96 [==============================] - 1s 6ms/step - loss: 0.5378 - accuracy: 0.8612 - val_loss: 0.4944 - val_accuracy: 0.8858
Epoch 4/20
 1/96 [..............................] - ETA: 0s - loss: 0.4298 - accuracy: 0.878015/96 [===>..........................] - ETA: 0s - loss: 0.4360 - accuracy: 0.879529/96 [========>.....................] - ETA: 0s - loss: 0.4255 - accuracy: 0.882343/96 [============>.................] - ETA: 0s - loss: 0.4171 - accuracy: 0.884857/96 [================>.............] - ETA: 0s - loss: 0.4122 - accuracy: 0.886671/96 [=====================>........] - ETA: 0s - loss: 0.4077 - accuracy: 0.888285/96 [=========================>....] - ETA: 0s - loss: 0.4049 - accuracy: 0.889196/96 [==============================] - 1s 5ms/step - loss: 0.4033 - accuracy: 0.8898 - val_loss: 0.4420 - val_accuracy: 0.9041
Epoch 5/20
 1/96 [..............................] - ETA: 0s - loss: 0.3839 - accuracy: 0.900015/96 [===>..........................] - ETA: 0s - loss: 0.3350 - accuracy: 0.909929/96 [========>.....................] - ETA: 0s - loss: 0.3297 - accuracy: 0.910043/96 [============>.................] - ETA: 0s - loss: 0.3289 - accuracy: 0.910157/96 [================>.............] - ETA: 0s - loss: 0.3279 - accuracy: 0.910571/96 [=====================>........] - ETA: 0s - loss: 0.3266 - accuracy: 0.911085/96 [=========================>....] - ETA: 0s - loss: 0.3251 - accuracy: 0.911596/96 [==============================] - 1s 6ms/step - loss: 0.3240 - accuracy: 0.9119 - val_loss: 0.3971 - val_accuracy: 0.9176
Epoch 6/20
 1/96 [..............................] - ETA: 0s - loss: 0.2335 - accuracy: 0.936015/96 [===>..........................] - ETA: 0s - loss: 0.2540 - accuracy: 0.925029/96 [========>.....................] - ETA: 0s - loss: 0.2540 - accuracy: 0.924543/96 [============>.................] - ETA: 0s - loss: 0.2541 - accuracy: 0.925257/96 [================>.............] - ETA: 0s - loss: 0.2551 - accuracy: 0.925571/96 [=====================>........] - ETA: 0s - loss: 0.2557 - accuracy: 0.925985/96 [=========================>....] - ETA: 0s - loss: 0.2567 - accuracy: 0.926096/96 [==============================] - 1s 5ms/step - loss: 0.2573 - accuracy: 0.9261 - val_loss: 0.3786 - val_accuracy: 0.9218
Epoch 7/20
 1/96 [..............................] - ETA: 0s - loss: 0.1973 - accuracy: 0.944015/96 [===>..........................] - ETA: 0s - loss: 0.2133 - accuracy: 0.937929/96 [========>.....................] - ETA: 0s - loss: 0.2138 - accuracy: 0.937843/96 [============>.................] - ETA: 0s - loss: 0.2182 - accuracy: 0.937657/96 [================>.............] - ETA: 0s - loss: 0.2223 - accuracy: 0.937371/96 [=====================>........] - ETA: 0s - loss: 0.2244 - accuracy: 0.937185/96 [=========================>....] - ETA: 0s - loss: 0.2255 - accuracy: 0.937096/96 [==============================] - 1s 6ms/step - loss: 0.2262 - accuracy: 0.9369 - val_loss: 0.3690 - val_accuracy: 0.9258
Epoch 8/20
 1/96 [..............................] - ETA: 0s - loss: 0.1821 - accuracy: 0.938015/96 [===>..........................] - ETA: 0s - loss: 0.1913 - accuracy: 0.942529/96 [========>.....................] - ETA: 0s - loss: 0.1932 - accuracy: 0.943443/96 [============>.................] - ETA: 0s - loss: 0.1934 - accuracy: 0.944158/96 [=================>............] - ETA: 0s - loss: 0.1933 - accuracy: 0.944672/96 [=====================>........] - ETA: 0s - loss: 0.1929 - accuracy: 0.944986/96 [=========================>....] - ETA: 0s - loss: 0.1925 - accuracy: 0.945196/96 [==============================] - 1s 5ms/step - loss: 0.1926 - accuracy: 0.9451 - val_loss: 0.3591 - val_accuracy: 0.9315
Epoch 9/20
 1/96 [..............................] - ETA: 0s - loss: 0.1901 - accuracy: 0.944015/96 [===>..........................] - ETA: 0s - loss: 0.1823 - accuracy: 0.944429/96 [========>.....................] - ETA: 0s - loss: 0.1752 - accuracy: 0.946543/96 [============>.................] - ETA: 0s - loss: 0.1720 - accuracy: 0.947457/96 [================>.............] - ETA: 0s - loss: 0.1702 - accuracy: 0.948172/96 [=====================>........] - ETA: 0s - loss: 0.1691 - accuracy: 0.948586/96 [=========================>....] - ETA: 0s - loss: 0.1688 - accuracy: 0.948796/96 [==============================] - 1s 5ms/step - loss: 0.1688 - accuracy: 0.9488 - val_loss: 0.3607 - val_accuracy: 0.9388
Epoch 10/20
 1/96 [..............................] - ETA: 0s - loss: 0.1696 - accuracy: 0.958015/96 [===>..........................] - ETA: 0s - loss: 0.1549 - accuracy: 0.954029/96 [========>.....................] - ETA: 0s - loss: 0.1561 - accuracy: 0.954144/96 [============>.................] - ETA: 0s - loss: 0.1564 - accuracy: 0.954258/96 [=================>............] - ETA: 0s - loss: 0.1561 - accuracy: 0.954273/96 [=====================>........] - ETA: 0s - loss: 0.1564 - accuracy: 0.954087/96 [==========================>...] - ETA: 0s - loss: 0.1571 - accuracy: 0.953896/96 [==============================] - 1s 5ms/step - loss: 0.1574 - accuracy: 0.9537 - val_loss: 0.3433 - val_accuracy: 0.9400
Epoch 11/20
 1/96 [..............................] - ETA: 0s - loss: 0.1188 - accuracy: 0.960015/96 [===>..........................] - ETA: 0s - loss: 0.1371 - accuracy: 0.958429/96 [========>.....................] - ETA: 0s - loss: 0.1383 - accuracy: 0.957743/96 [============>.................] - ETA: 0s - loss: 0.1375 - accuracy: 0.957657/96 [================>.............] - ETA: 0s - loss: 0.1369 - accuracy: 0.957671/96 [=====================>........] - ETA: 0s - loss: 0.1378 - accuracy: 0.957585/96 [=========================>....] - ETA: 0s - loss: 0.1393 - accuracy: 0.957296/96 [==============================] - 1s 6ms/step - loss: 0.1406 - accuracy: 0.9569 - val_loss: 0.3429 - val_accuracy: 0.9389
Epoch 12/20
 1/96 [..............................] - ETA: 0s - loss: 0.1650 - accuracy: 0.952015/96 [===>..........................] - ETA: 0s - loss: 0.1424 - accuracy: 0.955829/96 [========>.....................] - ETA: 0s - loss: 0.1377 - accuracy: 0.957043/96 [============>.................] - ETA: 0s - loss: 0.1356 - accuracy: 0.957657/96 [================>.............] - ETA: 0s - loss: 0.1349 - accuracy: 0.958171/96 [=====================>........] - ETA: 0s - loss: 0.1349 - accuracy: 0.958585/96 [=========================>....] - ETA: 0s - loss: 0.1350 - accuracy: 0.958696/96 [==============================] - 1s 6ms/step - loss: 0.1347 - accuracy: 0.9588 - val_loss: 0.3477 - val_accuracy: 0.9452
Epoch 13/20
 1/96 [..............................] - ETA: 0s - loss: 0.0800 - accuracy: 0.964015/96 [===>..........................] - ETA: 0s - loss: 0.0995 - accuracy: 0.966629/96 [========>.....................] - ETA: 0s - loss: 0.1022 - accuracy: 0.966343/96 [============>.................] - ETA: 0s - loss: 0.1046 - accuracy: 0.965757/96 [================>.............] - ETA: 0s - loss: 0.1065 - accuracy: 0.965371/96 [=====================>........] - ETA: 0s - loss: 0.1079 - accuracy: 0.965085/96 [=========================>....] - ETA: 0s - loss: 0.1087 - accuracy: 0.964996/96 [==============================] - 1s 6ms/step - loss: 0.1094 - accuracy: 0.9648 - val_loss: 0.3316 - val_accuracy: 0.9453
Epoch 14/20
 1/96 [..............................] - ETA: 0s - loss: 0.1026 - accuracy: 0.966015/96 [===>..........................] - ETA: 0s - loss: 0.0936 - accuracy: 0.969629/96 [========>.....................] - ETA: 0s - loss: 0.0965 - accuracy: 0.969243/96 [============>.................] - ETA: 0s - loss: 0.0978 - accuracy: 0.969058/96 [=================>............] - ETA: 0s - loss: 0.0986 - accuracy: 0.968973/96 [=====================>........] - ETA: 0s - loss: 0.0995 - accuracy: 0.968687/96 [==========================>...] - ETA: 0s - loss: 0.1003 - accuracy: 0.968496/96 [==============================] - 1s 5ms/step - loss: 0.1007 - accuracy: 0.9684 - val_loss: 0.3081 - val_accuracy: 0.9496
Epoch 15/20
 1/96 [..............................] - ETA: 0s - loss: 0.0834 - accuracy: 0.968016/96 [====>.........................] - ETA: 0s - loss: 0.0872 - accuracy: 0.968630/96 [========>.....................] - ETA: 0s - loss: 0.0928 - accuracy: 0.968144/96 [============>.................] - ETA: 0s - loss: 0.0947 - accuracy: 0.968258/96 [=================>............] - ETA: 0s - loss: 0.0949 - accuracy: 0.968373/96 [=====================>........] - ETA: 0s - loss: 0.0952 - accuracy: 0.968487/96 [==========================>...] - ETA: 0s - loss: 0.0953 - accuracy: 0.968696/96 [==============================] - 1s 5ms/step - loss: 0.0954 - accuracy: 0.9686 - val_loss: 0.3100 - val_accuracy: 0.9481
Epoch 16/20
 1/96 [..............................] - ETA: 0s - loss: 0.0828 - accuracy: 0.978015/96 [===>..........................] - ETA: 0s - loss: 0.0908 - accuracy: 0.971529/96 [========>.....................] - ETA: 0s - loss: 0.0892 - accuracy: 0.971443/96 [============>.................] - ETA: 0s - loss: 0.0878 - accuracy: 0.971757/96 [================>.............] - ETA: 0s - loss: 0.0877 - accuracy: 0.971871/96 [=====================>........] - ETA: 0s - loss: 0.0875 - accuracy: 0.971985/96 [=========================>....] - ETA: 0s - loss: 0.0877 - accuracy: 0.972096/96 [==============================] - 1s 6ms/step - loss: 0.0882 - accuracy: 0.9720 - val_loss: 0.2943 - val_accuracy: 0.9538
Epoch 17/20
 1/96 [..............................] - ETA: 0s - loss: 0.0677 - accuracy: 0.978015/96 [===>..........................] - ETA: 0s - loss: 0.0777 - accuracy: 0.975629/96 [========>.....................] - ETA: 0s - loss: 0.0819 - accuracy: 0.974843/96 [============>.................] - ETA: 0s - loss: 0.0825 - accuracy: 0.974557/96 [================>.............] - ETA: 0s - loss: 0.0826 - accuracy: 0.974571/96 [=====================>........] - ETA: 0s - loss: 0.0825 - accuracy: 0.974485/96 [=========================>....] - ETA: 0s - loss: 0.0823 - accuracy: 0.974596/96 [==============================] - 1s 5ms/step - loss: 0.0822 - accuracy: 0.9745 - val_loss: 0.2996 - val_accuracy: 0.9542
Epoch 18/20
 1/96 [..............................] - ETA: 0s - loss: 0.0540 - accuracy: 0.978016/96 [====>.........................] - ETA: 0s - loss: 0.0617 - accuracy: 0.979530/96 [========>.....................] - ETA: 0s - loss: 0.0648 - accuracy: 0.979144/96 [============>.................] - ETA: 0s - loss: 0.0674 - accuracy: 0.978558/96 [=================>............] - ETA: 0s - loss: 0.0694 - accuracy: 0.978072/96 [=====================>........] - ETA: 0s - loss: 0.0709 - accuracy: 0.977687/96 [==========================>...] - ETA: 0s - loss: 0.0717 - accuracy: 0.977396/96 [==============================] - 1s 5ms/step - loss: 0.0722 - accuracy: 0.9772 - val_loss: 0.3062 - val_accuracy: 0.9534
Epoch 19/20
 1/96 [..............................] - ETA: 0s - loss: 0.0479 - accuracy: 0.986015/96 [===>..........................] - ETA: 0s - loss: 0.0732 - accuracy: 0.977229/96 [========>.....................] - ETA: 0s - loss: 0.0741 - accuracy: 0.977243/96 [============>.................] - ETA: 0s - loss: 0.0730 - accuracy: 0.977457/96 [================>.............] - ETA: 0s - loss: 0.0726 - accuracy: 0.977671/96 [=====================>........] - ETA: 0s - loss: 0.0725 - accuracy: 0.977685/96 [=========================>....] - ETA: 0s - loss: 0.0724 - accuracy: 0.977796/96 [==============================] - 1s 6ms/step - loss: 0.0723 - accuracy: 0.9777 - val_loss: 0.3019 - val_accuracy: 0.9538
Epoch 20/20
 1/96 [..............................] - ETA: 0s - loss: 0.0829 - accuracy: 0.978015/96 [===>..........................] - ETA: 0s - loss: 0.0791 - accuracy: 0.975030/96 [========>.....................] - ETA: 0s - loss: 0.0723 - accuracy: 0.976744/96 [============>.................] - ETA: 0s - loss: 0.0699 - accuracy: 0.977559/96 [=================>............] - ETA: 0s - loss: 0.0690 - accuracy: 0.977874/96 [======================>.......] - ETA: 0s - loss: 0.0689 - accuracy: 0.977989/96 [==========================>...] - ETA: 0s - loss: 0.0690 - accuracy: 0.978096/96 [==============================] - 1s 5ms/step - loss: 0.0690 - accuracy: 0.9780 - val_loss: 0.3040 - val_accuracy: 0.9555
training_time: 0:00:16.147782
  1/313 [..............................] - ETA: 7:44 - loss: 0.0449 - accuracy: 0.9688 15/313 [>.............................] - ETA: 1s - loss: 0.2227 - accuracy: 0.9563   28/313 [=>............................] - ETA: 1s - loss: 0.3119 - accuracy: 0.9554 42/313 [===>..........................] - ETA: 1s - loss: 0.4055 - accuracy: 0.9449 56/313 [====>.........................] - ETA: 0s - loss: 0.4266 - accuracy: 0.9431 70/313 [=====>........................] - ETA: 0s - loss: 0.4284 - accuracy: 0.9429 84/313 [=======>......................] - ETA: 0s - loss: 0.3983 - accuracy: 0.9449 97/313 [========>.....................] - ETA: 0s - loss: 0.3898 - accuracy: 0.9462110/313 [=========>....................] - ETA: 0s - loss: 0.3617 - accuracy: 0.9491123/313 [==========>...................] - ETA: 0s - loss: 0.4054 - accuracy: 0.9472136/313 [============>.................] - ETA: 0s - loss: 0.3903 - accuracy: 0.9462149/313 [=============>................] - ETA: 0s - loss: 0.3786 - accuracy: 0.9457162/313 [==============>...............] - ETA: 0s - loss: 0.3738 - accuracy: 0.9462176/313 [===============>..............] - ETA: 0s - loss: 0.3518 - accuracy: 0.9499190/313 [=================>............] - ETA: 0s - loss: 0.3505 - accuracy: 0.9488203/313 [==================>...........] - ETA: 0s - loss: 0.3324 - accuracy: 0.9506217/313 [===================>..........] - ETA: 0s - loss: 0.3279 - accuracy: 0.9512231/313 [=====================>........] - ETA: 0s - loss: 0.3103 - accuracy: 0.9536245/313 [======================>.......] - ETA: 0s - loss: 0.2998 - accuracy: 0.9547259/313 [=======================>......] - ETA: 0s - loss: 0.2910 - accuracy: 0.9554273/313 [=========================>....] - ETA: 0s - loss: 0.2810 - accuracy: 0.9564286/313 [==========================>...] - ETA: 0s - loss: 0.2789 - accuracy: 0.9576299/313 [===========================>..] - ETA: 0s - loss: 0.2686 - accuracy: 0.9588312/313 [============================>.] - ETA: 0s - loss: 0.2746 - accuracy: 0.9577313/313 [==============================] - 3s 4ms/step - loss: 0.2742 - accuracy: 0.9578
Test results: Loss = 0.27420204877853394, Accuracy = 0.9577999711036682
