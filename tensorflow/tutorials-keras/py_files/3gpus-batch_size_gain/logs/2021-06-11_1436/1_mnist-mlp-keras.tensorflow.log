Number of devices: 2
batch_size_per_replica: 250
batch_size: 500 = 250 * 2
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
60000 10000
Epoch 1/20
 1/96 [..............................] - ETA: 5:59 - loss: 112.0495 - accuracy: 0.052015/96 [===>..........................] - ETA: 0s - loss: 43.1100 - accuracy: 0.3495   29/96 [========>.....................] - ETA: 0s - loss: 29.5607 - accuracy: 0.451943/96 [============>.................] - ETA: 0s - loss: 23.1532 - accuracy: 0.499058/96 [=================>............] - ETA: 0s - loss: 19.0797 - accuracy: 0.526973/96 [=====================>........] - ETA: 0s - loss: 16.3811 - accuracy: 0.549088/96 [==========================>...] - ETA: 0s - loss: 14.4433 - accuracy: 0.567796/96 [==============================] - 6s 21ms/step - loss: 13.5185 - accuracy: 0.5777 - val_loss: 0.7853 - val_accuracy: 0.8246
Epoch 2/20
 1/96 [..............................] - ETA: 0s - loss: 0.7123 - accuracy: 0.836015/96 [===>..........................] - ETA: 0s - loss: 0.6993 - accuracy: 0.832729/96 [========>.....................] - ETA: 0s - loss: 0.7072 - accuracy: 0.829343/96 [============>.................] - ETA: 0s - loss: 0.7021 - accuracy: 0.829358/96 [=================>............] - ETA: 0s - loss: 0.6946 - accuracy: 0.830872/96 [=====================>........] - ETA: 0s - loss: 0.6874 - accuracy: 0.832486/96 [=========================>....] - ETA: 0s - loss: 0.6802 - accuracy: 0.833996/96 [==============================] - 1s 6ms/step - loss: 0.6741 - accuracy: 0.8351 - val_loss: 0.5511 - val_accuracy: 0.8758
Epoch 3/20
 1/96 [..............................] - ETA: 0s - loss: 0.5442 - accuracy: 0.874015/96 [===>..........................] - ETA: 0s - loss: 0.4711 - accuracy: 0.870629/96 [========>.....................] - ETA: 0s - loss: 0.4641 - accuracy: 0.872943/96 [============>.................] - ETA: 0s - loss: 0.4596 - accuracy: 0.874257/96 [================>.............] - ETA: 0s - loss: 0.4551 - accuracy: 0.875871/96 [=====================>........] - ETA: 0s - loss: 0.4515 - accuracy: 0.877185/96 [=========================>....] - ETA: 0s - loss: 0.4487 - accuracy: 0.878296/96 [==============================] - 1s 5ms/step - loss: 0.4463 - accuracy: 0.8790 - val_loss: 0.4614 - val_accuracy: 0.9066
Epoch 4/20
 1/96 [..............................] - ETA: 0s - loss: 0.3216 - accuracy: 0.906015/96 [===>..........................] - ETA: 0s - loss: 0.3246 - accuracy: 0.909030/96 [========>.....................] - ETA: 0s - loss: 0.3176 - accuracy: 0.909944/96 [============>.................] - ETA: 0s - loss: 0.3163 - accuracy: 0.910258/96 [=================>............] - ETA: 0s - loss: 0.3161 - accuracy: 0.910472/96 [=====================>........] - ETA: 0s - loss: 0.3171 - accuracy: 0.910487/96 [==========================>...] - ETA: 0s - loss: 0.3191 - accuracy: 0.910196/96 [==============================] - 1s 5ms/step - loss: 0.3203 - accuracy: 0.9101 - val_loss: 0.4228 - val_accuracy: 0.9104
Epoch 5/20
 1/96 [..............................] - ETA: 0s - loss: 0.2491 - accuracy: 0.922015/96 [===>..........................] - ETA: 0s - loss: 0.2681 - accuracy: 0.919730/96 [========>.....................] - ETA: 0s - loss: 0.2679 - accuracy: 0.922744/96 [============>.................] - ETA: 0s - loss: 0.2675 - accuracy: 0.923959/96 [=================>............] - ETA: 0s - loss: 0.2673 - accuracy: 0.924673/96 [=====================>........] - ETA: 0s - loss: 0.2682 - accuracy: 0.924887/96 [==========================>...] - ETA: 0s - loss: 0.2689 - accuracy: 0.924996/96 [==============================] - 1s 5ms/step - loss: 0.2693 - accuracy: 0.9250 - val_loss: 0.3774 - val_accuracy: 0.9272
Epoch 6/20
 1/96 [..............................] - ETA: 0s - loss: 0.2048 - accuracy: 0.946015/96 [===>..........................] - ETA: 0s - loss: 0.2152 - accuracy: 0.940029/96 [========>.....................] - ETA: 0s - loss: 0.2192 - accuracy: 0.938343/96 [============>.................] - ETA: 0s - loss: 0.2209 - accuracy: 0.937758/96 [=================>............] - ETA: 0s - loss: 0.2219 - accuracy: 0.937173/96 [=====================>........] - ETA: 0s - loss: 0.2221 - accuracy: 0.936788/96 [==========================>...] - ETA: 0s - loss: 0.2220 - accuracy: 0.936696/96 [==============================] - 1s 5ms/step - loss: 0.2220 - accuracy: 0.9365 - val_loss: 0.3475 - val_accuracy: 0.9328
Epoch 7/20
 1/96 [..............................] - ETA: 0s - loss: 0.2070 - accuracy: 0.948015/96 [===>..........................] - ETA: 0s - loss: 0.1731 - accuracy: 0.946929/96 [========>.....................] - ETA: 0s - loss: 0.1712 - accuracy: 0.947144/96 [============>.................] - ETA: 0s - loss: 0.1735 - accuracy: 0.946958/96 [=================>............] - ETA: 0s - loss: 0.1758 - accuracy: 0.946772/96 [=====================>........] - ETA: 0s - loss: 0.1775 - accuracy: 0.946587/96 [==========================>...] - ETA: 0s - loss: 0.1787 - accuracy: 0.946396/96 [==============================] - 1s 5ms/step - loss: 0.1791 - accuracy: 0.9463 - val_loss: 0.3245 - val_accuracy: 0.9366
Epoch 8/20
 1/96 [..............................] - ETA: 0s - loss: 0.1512 - accuracy: 0.952015/96 [===>..........................] - ETA: 0s - loss: 0.1453 - accuracy: 0.954529/96 [========>.....................] - ETA: 0s - loss: 0.1518 - accuracy: 0.954043/96 [============>.................] - ETA: 0s - loss: 0.1557 - accuracy: 0.953257/96 [================>.............] - ETA: 0s - loss: 0.1571 - accuracy: 0.953072/96 [=====================>........] - ETA: 0s - loss: 0.1585 - accuracy: 0.952986/96 [=========================>....] - ETA: 0s - loss: 0.1596 - accuracy: 0.952896/96 [==============================] - 1s 5ms/step - loss: 0.1603 - accuracy: 0.9526 - val_loss: 0.3447 - val_accuracy: 0.9389
Epoch 9/20
 1/96 [..............................] - ETA: 0s - loss: 0.1554 - accuracy: 0.954016/96 [====>.........................] - ETA: 0s - loss: 0.1403 - accuracy: 0.958431/96 [========>.....................] - ETA: 0s - loss: 0.1364 - accuracy: 0.960346/96 [=============>................] - ETA: 0s - loss: 0.1363 - accuracy: 0.960561/96 [==================>...........] - ETA: 0s - loss: 0.1370 - accuracy: 0.960176/96 [======================>.......] - ETA: 0s - loss: 0.1377 - accuracy: 0.959691/96 [===========================>..] - ETA: 0s - loss: 0.1387 - accuracy: 0.959296/96 [==============================] - 1s 5ms/step - loss: 0.1391 - accuracy: 0.9590 - val_loss: 0.3448 - val_accuracy: 0.9435
Epoch 10/20
 1/96 [..............................] - ETA: 0s - loss: 0.1130 - accuracy: 0.962015/96 [===>..........................] - ETA: 0s - loss: 0.1183 - accuracy: 0.963730/96 [========>.....................] - ETA: 0s - loss: 0.1210 - accuracy: 0.964044/96 [============>.................] - ETA: 0s - loss: 0.1213 - accuracy: 0.964058/96 [=================>............] - ETA: 0s - loss: 0.1211 - accuracy: 0.963973/96 [=====================>........] - ETA: 0s - loss: 0.1216 - accuracy: 0.963888/96 [==========================>...] - ETA: 0s - loss: 0.1223 - accuracy: 0.963596/96 [==============================] - 1s 5ms/step - loss: 0.1229 - accuracy: 0.9633 - val_loss: 0.3395 - val_accuracy: 0.9399
Epoch 11/20
 1/96 [..............................] - ETA: 0s - loss: 0.1409 - accuracy: 0.954015/96 [===>..........................] - ETA: 0s - loss: 0.1317 - accuracy: 0.960129/96 [========>.....................] - ETA: 0s - loss: 0.1310 - accuracy: 0.961243/96 [============>.................] - ETA: 0s - loss: 0.1305 - accuracy: 0.961758/96 [=================>............] - ETA: 0s - loss: 0.1297 - accuracy: 0.962073/96 [=====================>........] - ETA: 0s - loss: 0.1289 - accuracy: 0.962288/96 [==========================>...] - ETA: 0s - loss: 0.1287 - accuracy: 0.962296/96 [==============================] - 1s 5ms/step - loss: 0.1288 - accuracy: 0.9622 - val_loss: 0.3294 - val_accuracy: 0.9504
Epoch 12/20
 1/96 [..............................] - ETA: 0s - loss: 0.0814 - accuracy: 0.974016/96 [====>.........................] - ETA: 0s - loss: 0.1030 - accuracy: 0.968730/96 [========>.....................] - ETA: 0s - loss: 0.1063 - accuracy: 0.968044/96 [============>.................] - ETA: 0s - loss: 0.1109 - accuracy: 0.966859/96 [=================>............] - ETA: 0s - loss: 0.1136 - accuracy: 0.966174/96 [======================>.......] - ETA: 0s - loss: 0.1147 - accuracy: 0.965788/96 [==========================>...] - ETA: 0s - loss: 0.1149 - accuracy: 0.965696/96 [==============================] - 1s 6ms/step - loss: 0.1147 - accuracy: 0.9657 - val_loss: 0.3280 - val_accuracy: 0.9510
Epoch 13/20
 1/96 [..............................] - ETA: 0s - loss: 0.0842 - accuracy: 0.976016/96 [====>.........................] - ETA: 0s - loss: 0.0805 - accuracy: 0.974431/96 [========>.....................] - ETA: 0s - loss: 0.0807 - accuracy: 0.974546/96 [=============>................] - ETA: 0s - loss: 0.0832 - accuracy: 0.973860/96 [=================>............] - ETA: 0s - loss: 0.0859 - accuracy: 0.973274/96 [======================>.......] - ETA: 0s - loss: 0.0877 - accuracy: 0.972788/96 [==========================>...] - ETA: 0s - loss: 0.0887 - accuracy: 0.972396/96 [==============================] - 1s 5ms/step - loss: 0.0892 - accuracy: 0.9721 - val_loss: 0.3400 - val_accuracy: 0.9510
Epoch 14/20
 1/96 [..............................] - ETA: 0s - loss: 0.0899 - accuracy: 0.978016/96 [====>.........................] - ETA: 0s - loss: 0.0897 - accuracy: 0.972630/96 [========>.....................] - ETA: 0s - loss: 0.0923 - accuracy: 0.972444/96 [============>.................] - ETA: 0s - loss: 0.0947 - accuracy: 0.972058/96 [=================>............] - ETA: 0s - loss: 0.0960 - accuracy: 0.971872/96 [=====================>........] - ETA: 0s - loss: 0.0971 - accuracy: 0.971587/96 [==========================>...] - ETA: 0s - loss: 0.0977 - accuracy: 0.971396/96 [==============================] - 1s 5ms/step - loss: 0.0979 - accuracy: 0.9712 - val_loss: 0.2970 - val_accuracy: 0.9520
Epoch 15/20
 1/96 [..............................] - ETA: 0s - loss: 0.0664 - accuracy: 0.970015/96 [===>..........................] - ETA: 0s - loss: 0.0717 - accuracy: 0.975329/96 [========>.....................] - ETA: 0s - loss: 0.0707 - accuracy: 0.975843/96 [============>.................] - ETA: 0s - loss: 0.0711 - accuracy: 0.975757/96 [================>.............] - ETA: 0s - loss: 0.0721 - accuracy: 0.975671/96 [=====================>........] - ETA: 0s - loss: 0.0728 - accuracy: 0.975585/96 [=========================>....] - ETA: 0s - loss: 0.0737 - accuracy: 0.975496/96 [==============================] - 1s 5ms/step - loss: 0.0742 - accuracy: 0.9753 - val_loss: 0.2963 - val_accuracy: 0.9532
Epoch 16/20
 1/96 [..............................] - ETA: 0s - loss: 0.0607 - accuracy: 0.976016/96 [====>.........................] - ETA: 0s - loss: 0.0673 - accuracy: 0.977830/96 [========>.....................] - ETA: 0s - loss: 0.0650 - accuracy: 0.978844/96 [============>.................] - ETA: 0s - loss: 0.0641 - accuracy: 0.979358/96 [=================>............] - ETA: 0s - loss: 0.0638 - accuracy: 0.979473/96 [=====================>........] - ETA: 0s - loss: 0.0640 - accuracy: 0.979388/96 [==========================>...] - ETA: 0s - loss: 0.0644 - accuracy: 0.979196/96 [==============================] - 1s 5ms/step - loss: 0.0649 - accuracy: 0.9790 - val_loss: 0.3108 - val_accuracy: 0.9532
Epoch 17/20
 1/96 [..............................] - ETA: 0s - loss: 0.0587 - accuracy: 0.980015/96 [===>..........................] - ETA: 0s - loss: 0.0678 - accuracy: 0.976630/96 [========>.....................] - ETA: 0s - loss: 0.0642 - accuracy: 0.977945/96 [=============>................] - ETA: 0s - loss: 0.0628 - accuracy: 0.978659/96 [=================>............] - ETA: 0s - loss: 0.0621 - accuracy: 0.979073/96 [=====================>........] - ETA: 0s - loss: 0.0620 - accuracy: 0.979188/96 [==========================>...] - ETA: 0s - loss: 0.0623 - accuracy: 0.979196/96 [==============================] - 1s 5ms/step - loss: 0.0626 - accuracy: 0.9791 - val_loss: 0.3177 - val_accuracy: 0.9567
Epoch 18/20
 1/96 [..............................] - ETA: 0s - loss: 0.0606 - accuracy: 0.972016/96 [====>.........................] - ETA: 0s - loss: 0.0649 - accuracy: 0.977530/96 [========>.....................] - ETA: 0s - loss: 0.0660 - accuracy: 0.977844/96 [============>.................] - ETA: 0s - loss: 0.0659 - accuracy: 0.978158/96 [=================>............] - ETA: 0s - loss: 0.0657 - accuracy: 0.978472/96 [=====================>........] - ETA: 0s - loss: 0.0654 - accuracy: 0.978586/96 [=========================>....] - ETA: 0s - loss: 0.0651 - accuracy: 0.978796/96 [==============================] - 1s 5ms/step - loss: 0.0650 - accuracy: 0.9788 - val_loss: 0.3400 - val_accuracy: 0.9565
Epoch 19/20
 1/96 [..............................] - ETA: 0s - loss: 0.0477 - accuracy: 0.982015/96 [===>..........................] - ETA: 0s - loss: 0.0651 - accuracy: 0.976129/96 [========>.....................] - ETA: 0s - loss: 0.0623 - accuracy: 0.978343/96 [============>.................] - ETA: 0s - loss: 0.0611 - accuracy: 0.979258/96 [=================>............] - ETA: 0s - loss: 0.0605 - accuracy: 0.979773/96 [=====================>........] - ETA: 0s - loss: 0.0610 - accuracy: 0.979787/96 [==========================>...] - ETA: 0s - loss: 0.0617 - accuracy: 0.979696/96 [==============================] - 1s 5ms/step - loss: 0.0622 - accuracy: 0.9795 - val_loss: 0.3218 - val_accuracy: 0.9576
Epoch 20/20
 1/96 [..............................] - ETA: 0s - loss: 0.0279 - accuracy: 0.992016/96 [====>.........................] - ETA: 0s - loss: 0.0617 - accuracy: 0.979531/96 [========>.....................] - ETA: 0s - loss: 0.0635 - accuracy: 0.978846/96 [=============>................] - ETA: 0s - loss: 0.0630 - accuracy: 0.979161/96 [==================>...........] - ETA: 0s - loss: 0.0626 - accuracy: 0.979376/96 [======================>.......] - ETA: 0s - loss: 0.0623 - accuracy: 0.979491/96 [===========================>..] - ETA: 0s - loss: 0.0621 - accuracy: 0.979596/96 [==============================] - 1s 5ms/step - loss: 0.0621 - accuracy: 0.9795 - val_loss: 0.3183 - val_accuracy: 0.9593
training_time: 0:00:16.030349
  1/313 [..............................] - ETA: 7:44 - loss: 0.1070 - accuracy: 0.9688 14/313 [>.............................] - ETA: 1s - loss: 0.3128 - accuracy: 0.9598   28/313 [=>............................] - ETA: 1s - loss: 0.2893 - accuracy: 0.9542 42/313 [===>..........................] - ETA: 1s - loss: 0.3605 - accuracy: 0.9464 56/313 [====>.........................] - ETA: 0s - loss: 0.4428 - accuracy: 0.9392 70/313 [=====>........................] - ETA: 0s - loss: 0.4663 - accuracy: 0.9371 84/313 [=======>......................] - ETA: 0s - loss: 0.4707 - accuracy: 0.9368 98/313 [========>.....................] - ETA: 0s - loss: 0.4634 - accuracy: 0.9375112/313 [=========>....................] - ETA: 0s - loss: 0.4592 - accuracy: 0.9403126/313 [===========>..................] - ETA: 0s - loss: 0.4661 - accuracy: 0.9407140/313 [============>.................] - ETA: 0s - loss: 0.4523 - accuracy: 0.9408153/313 [=============>................] - ETA: 0s - loss: 0.4473 - accuracy: 0.9397167/313 [===============>..............] - ETA: 0s - loss: 0.4245 - accuracy: 0.9429181/313 [================>.............] - ETA: 0s - loss: 0.4023 - accuracy: 0.9460195/313 [=================>............] - ETA: 0s - loss: 0.4039 - accuracy: 0.9460209/313 [===================>..........] - ETA: 0s - loss: 0.3986 - accuracy: 0.9474223/313 [====================>.........] - ETA: 0s - loss: 0.3797 - accuracy: 0.9501237/313 [=====================>........] - ETA: 0s - loss: 0.3611 - accuracy: 0.9521251/313 [=======================>......] - ETA: 0s - loss: 0.3435 - accuracy: 0.9541265/313 [========================>.....] - ETA: 0s - loss: 0.3348 - accuracy: 0.9550279/313 [=========================>....] - ETA: 0s - loss: 0.3198 - accuracy: 0.9567293/313 [===========================>..] - ETA: 0s - loss: 0.3234 - accuracy: 0.9580307/313 [============================>.] - ETA: 0s - loss: 0.3249 - accuracy: 0.9577313/313 [==============================] - 3s 4ms/step - loss: 0.3247 - accuracy: 0.9574
Test results: Loss = 0.32465654611587524, Accuracy = 0.9574000239372253
