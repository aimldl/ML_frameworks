Number of devices: 7
batch_size_per_replica: 128
batch_size: 896 = 128 * 7
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
x_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
<class 'numpy.ndarray'> <class 'numpy.ndarray'>
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 26, 26, 32)        320       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 13, 13, 32)        0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 11, 11, 64)        18496     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 5, 5, 64)          0         
_________________________________________________________________
flatten (Flatten)            (None, 1600)              0         
_________________________________________________________________
dropout (Dropout)            (None, 1600)              0         
_________________________________________________________________
dense (Dense)                (None, 10)                16010     
=================================================================
Total params: 34,826
Trainable params: 34,826
Non-trainable params: 0
_________________________________________________________________
Epoch 1/15
 1/61 [..............................] - ETA: 2:40 - loss: 2.3211 - accuracy: 0.0859 2/61 [..............................] - ETA: 6s - loss: 2.3111 - accuracy: 0.1024   3/61 [>.............................] - ETA: 5s - loss: 2.3021 - accuracy: 0.1174 4/61 [>.............................] - ETA: 5s - loss: 2.2944 - accuracy: 0.1311 5/61 [=>............................] - ETA: 4s - loss: 2.2866 - accuracy: 0.1435 6/61 [=>............................] - ETA: 4s - loss: 2.2790 - accuracy: 0.1548 8/61 [==>...........................] - ETA: 3s - loss: 2.2640 - accuracy: 0.176110/61 [===>..........................] - ETA: 3s - loss: 2.2480 - accuracy: 0.197512/61 [====>.........................] - ETA: 2s - loss: 2.2310 - accuracy: 0.217814/61 [=====>........................] - ETA: 2s - loss: 2.2125 - accuracy: 0.237822/61 [=========>....................] - ETA: 1s - loss: 2.1220 - accuracy: 0.306930/61 [=============>................] - ETA: 0s - loss: 2.0140 - accuracy: 0.360638/61 [=================>............] - ETA: 0s - loss: 1.9066 - accuracy: 0.403446/61 [=====================>........] - ETA: 0s - loss: 1.8070 - accuracy: 0.439354/61 [=========================>....] - ETA: 0s - loss: 1.7170 - accuracy: 0.470261/61 [==============================] - ETA: 0s - loss: 1.6462 - accuracy: 0.493961/61 [==============================] - 4s 27ms/step - loss: 1.6369 - accuracy: 0.4970 - val_loss: 0.2338 - val_accuracy: 0.9400
Epoch 2/15
 1/61 [..............................] - ETA: 0s - loss: 0.3923 - accuracy: 0.8772 9/61 [===>..........................] - ETA: 0s - loss: 0.3684 - accuracy: 0.887217/61 [=======>......................] - ETA: 0s - loss: 0.3515 - accuracy: 0.894025/61 [===========>..................] - ETA: 0s - loss: 0.3405 - accuracy: 0.897733/61 [===============>..............] - ETA: 0s - loss: 0.3308 - accuracy: 0.900841/61 [===================>..........] - ETA: 0s - loss: 0.3226 - accuracy: 0.903549/61 [=======================>......] - ETA: 0s - loss: 0.3153 - accuracy: 0.905857/61 [===========================>..] - ETA: 0s - loss: 0.3087 - accuracy: 0.907861/61 [==============================] - ETA: 0s - loss: 0.3055 - accuracy: 0.908861/61 [==============================] - 1s 9ms/step - loss: 0.3048 - accuracy: 0.9090 - val_loss: 0.1232 - val_accuracy: 0.9687
Epoch 3/15
 1/61 [..............................] - ETA: 0s - loss: 0.1527 - accuracy: 0.9531 9/61 [===>..........................] - ETA: 0s - loss: 0.1768 - accuracy: 0.947117/61 [=======>......................] - ETA: 0s - loss: 0.1806 - accuracy: 0.946325/61 [===========>..................] - ETA: 0s - loss: 0.1806 - accuracy: 0.946533/61 [===============>..............] - ETA: 0s - loss: 0.1806 - accuracy: 0.946641/61 [===================>..........] - ETA: 0s - loss: 0.1796 - accuracy: 0.947049/61 [=======================>......] - ETA: 0s - loss: 0.1786 - accuracy: 0.947357/61 [===========================>..] - ETA: 0s - loss: 0.1775 - accuracy: 0.947761/61 [==============================] - ETA: 0s - loss: 0.1769 - accuracy: 0.947961/61 [==============================] - 1s 9ms/step - loss: 0.1767 - accuracy: 0.9479 - val_loss: 0.0909 - val_accuracy: 0.9757
Epoch 4/15
 1/61 [..............................] - ETA: 0s - loss: 0.1664 - accuracy: 0.9464 9/61 [===>..........................] - ETA: 0s - loss: 0.1525 - accuracy: 0.952017/61 [=======>......................] - ETA: 0s - loss: 0.1507 - accuracy: 0.952725/61 [===========>..................] - ETA: 0s - loss: 0.1499 - accuracy: 0.953133/61 [===============>..............] - ETA: 0s - loss: 0.1482 - accuracy: 0.953841/61 [===================>..........] - ETA: 0s - loss: 0.1466 - accuracy: 0.954349/61 [=======================>......] - ETA: 0s - loss: 0.1450 - accuracy: 0.954957/61 [===========================>..] - ETA: 0s - loss: 0.1437 - accuracy: 0.955461/61 [==============================] - ETA: 0s - loss: 0.1430 - accuracy: 0.955761/61 [==============================] - 1s 10ms/step - loss: 0.1428 - accuracy: 0.9557 - val_loss: 0.0755 - val_accuracy: 0.9802
Epoch 5/15
 1/61 [..............................] - ETA: 0s - loss: 0.1438 - accuracy: 0.9665 9/61 [===>..........................] - ETA: 0s - loss: 0.1178 - accuracy: 0.967016/61 [======>.......................] - ETA: 0s - loss: 0.1155 - accuracy: 0.967121/61 [=========>....................] - ETA: 0s - loss: 0.1149 - accuracy: 0.967127/61 [============>.................] - ETA: 0s - loss: 0.1147 - accuracy: 0.967135/61 [================>.............] - ETA: 0s - loss: 0.1146 - accuracy: 0.966941/61 [===================>..........] - ETA: 0s - loss: 0.1147 - accuracy: 0.966849/61 [=======================>......] - ETA: 0s - loss: 0.1143 - accuracy: 0.966757/61 [===========================>..] - ETA: 0s - loss: 0.1139 - accuracy: 0.966661/61 [==============================] - ETA: 0s - loss: 0.1137 - accuracy: 0.966661/61 [==============================] - 1s 9ms/step - loss: 0.1136 - accuracy: 0.9666 - val_loss: 0.0643 - val_accuracy: 0.9822
Epoch 6/15
 1/61 [..............................] - ETA: 0s - loss: 0.0802 - accuracy: 0.9754 9/61 [===>..........................] - ETA: 0s - loss: 0.0969 - accuracy: 0.971617/61 [=======>......................] - ETA: 0s - loss: 0.0987 - accuracy: 0.970725/61 [===========>..................] - ETA: 0s - loss: 0.0987 - accuracy: 0.970532/61 [==============>...............] - ETA: 0s - loss: 0.0989 - accuracy: 0.970434/61 [===============>..............] - ETA: 0s - loss: 0.0990 - accuracy: 0.970338/61 [=================>............] - ETA: 0s - loss: 0.0991 - accuracy: 0.970344/61 [====================>.........] - ETA: 0s - loss: 0.0993 - accuracy: 0.970250/61 [=======================>......] - ETA: 0s - loss: 0.0993 - accuracy: 0.970156/61 [==========================>...] - ETA: 0s - loss: 0.0993 - accuracy: 0.970160/61 [============================>.] - ETA: 0s - loss: 0.0992 - accuracy: 0.970161/61 [==============================] - 1s 13ms/step - loss: 0.0992 - accuracy: 0.9701 - val_loss: 0.0583 - val_accuracy: 0.9847
Epoch 7/15
 1/61 [..............................] - ETA: 3s - loss: 0.0720 - accuracy: 0.9788 3/61 [>.............................] - ETA: 1s - loss: 0.0816 - accuracy: 0.9740 4/61 [>.............................] - ETA: 2s - loss: 0.0829 - accuracy: 0.9733 9/61 [===>..........................] - ETA: 1s - loss: 0.0866 - accuracy: 0.972710/61 [===>..........................] - ETA: 1s - loss: 0.0868 - accuracy: 0.972714/61 [=====>........................] - ETA: 1s - loss: 0.0873 - accuracy: 0.972816/61 [======>.......................] - ETA: 1s - loss: 0.0876 - accuracy: 0.972821/61 [=========>....................] - ETA: 0s - loss: 0.0881 - accuracy: 0.972926/61 [===========>..................] - ETA: 0s - loss: 0.0885 - accuracy: 0.973127/61 [============>.................] - ETA: 0s - loss: 0.0886 - accuracy: 0.973129/61 [=============>................] - ETA: 0s - loss: 0.0887 - accuracy: 0.973230/61 [=============>................] - ETA: 0s - loss: 0.0887 - accuracy: 0.973231/61 [==============>...............] - ETA: 0s - loss: 0.0887 - accuracy: 0.973232/61 [==============>...............] - ETA: 0s - loss: 0.0888 - accuracy: 0.973234/61 [===============>..............] - ETA: 0s - loss: 0.0889 - accuracy: 0.973341/61 [===================>..........] - ETA: 0s - loss: 0.0892 - accuracy: 0.973347/61 [======================>.......] - ETA: 0s - loss: 0.0892 - accuracy: 0.973348/61 [======================>.......] - ETA: 0s - loss: 0.0892 - accuracy: 0.973350/61 [=======================>......] - ETA: 0s - loss: 0.0891 - accuracy: 0.973357/61 [===========================>..] - ETA: 0s - loss: 0.0889 - accuracy: 0.973461/61 [==============================] - 2s 26ms/step - loss: 0.0887 - accuracy: 0.9735 - val_loss: 0.0534 - val_accuracy: 0.9857
Epoch 8/15
 1/61 [..............................] - ETA: 0s - loss: 0.1356 - accuracy: 0.9699 5/61 [=>............................] - ETA: 0s - loss: 0.1060 - accuracy: 0.975112/61 [====>.........................] - ETA: 0s - loss: 0.0936 - accuracy: 0.976519/61 [========>.....................] - ETA: 0s - loss: 0.0895 - accuracy: 0.976224/61 [==========>...................] - ETA: 0s - loss: 0.0885 - accuracy: 0.975732/61 [==============>...............] - ETA: 0s - loss: 0.0874 - accuracy: 0.975440/61 [==================>...........] - ETA: 0s - loss: 0.0865 - accuracy: 0.975248/61 [======================>.......] - ETA: 0s - loss: 0.0856 - accuracy: 0.975256/61 [==========================>...] - ETA: 0s - loss: 0.0848 - accuracy: 0.975361/61 [==============================] - ETA: 0s - loss: 0.0844 - accuracy: 0.975261/61 [==============================] - 1s 10ms/step - loss: 0.0844 - accuracy: 0.9752 - val_loss: 0.0512 - val_accuracy: 0.9867
Epoch 9/15
 1/61 [..............................] - ETA: 0s - loss: 0.0726 - accuracy: 0.9810 6/61 [=>............................] - ETA: 0s - loss: 0.0701 - accuracy: 0.981212/61 [====>.........................] - ETA: 0s - loss: 0.0723 - accuracy: 0.980017/61 [=======>......................] - ETA: 0s - loss: 0.0726 - accuracy: 0.979621/61 [=========>....................] - ETA: 0s - loss: 0.0727 - accuracy: 0.979623/61 [==========>...................] - ETA: 0s - loss: 0.0728 - accuracy: 0.979527/61 [============>.................] - ETA: 0s - loss: 0.0730 - accuracy: 0.979433/61 [===============>..............] - ETA: 0s - loss: 0.0731 - accuracy: 0.979336/61 [================>.............] - ETA: 0s - loss: 0.0732 - accuracy: 0.979243/61 [====================>.........] - ETA: 0s - loss: 0.0733 - accuracy: 0.979149/61 [=======================>......] - ETA: 0s - loss: 0.0735 - accuracy: 0.978952/61 [========================>.....] - ETA: 0s - loss: 0.0735 - accuracy: 0.978960/61 [============================>.] - ETA: 0s - loss: 0.0737 - accuracy: 0.978761/61 [==============================] - 1s 14ms/step - loss: 0.0737 - accuracy: 0.9787 - val_loss: 0.0493 - val_accuracy: 0.9870
Epoch 10/15
 1/61 [..............................] - ETA: 0s - loss: 0.0869 - accuracy: 0.9799 9/61 [===>..........................] - ETA: 0s - loss: 0.0768 - accuracy: 0.978315/61 [======>.......................] - ETA: 0s - loss: 0.0759 - accuracy: 0.977323/61 [==========>...................] - ETA: 0s - loss: 0.0744 - accuracy: 0.977229/61 [=============>................] - ETA: 0s - loss: 0.0741 - accuracy: 0.977234/61 [===============>..............] - ETA: 0s - loss: 0.0739 - accuracy: 0.977239/61 [==================>...........] - ETA: 0s - loss: 0.0737 - accuracy: 0.977246/61 [=====================>........] - ETA: 0s - loss: 0.0733 - accuracy: 0.977351/61 [========================>.....] - ETA: 0s - loss: 0.0730 - accuracy: 0.977358/61 [===========================>..] - ETA: 0s - loss: 0.0727 - accuracy: 0.977461/61 [==============================] - 1s 12ms/step - loss: 0.0726 - accuracy: 0.9774 - val_loss: 0.0448 - val_accuracy: 0.9875
Epoch 11/15
 1/61 [..............................] - ETA: 0s - loss: 0.0616 - accuracy: 0.9799 9/61 [===>..........................] - ETA: 0s - loss: 0.0692 - accuracy: 0.978817/61 [=======>......................] - ETA: 0s - loss: 0.0694 - accuracy: 0.978825/61 [===========>..................] - ETA: 0s - loss: 0.0687 - accuracy: 0.979031/61 [==============>...............] - ETA: 0s - loss: 0.0683 - accuracy: 0.979138/61 [=================>............] - ETA: 0s - loss: 0.0680 - accuracy: 0.979342/61 [===================>..........] - ETA: 0s - loss: 0.0678 - accuracy: 0.979445/61 [=====================>........] - ETA: 0s - loss: 0.0677 - accuracy: 0.979449/61 [=======================>......] - ETA: 0s - loss: 0.0676 - accuracy: 0.979556/61 [==========================>...] - ETA: 0s - loss: 0.0676 - accuracy: 0.979561/61 [==============================] - ETA: 0s - loss: 0.0676 - accuracy: 0.979561/61 [==============================] - 1s 11ms/step - loss: 0.0676 - accuracy: 0.9795 - val_loss: 0.0420 - val_accuracy: 0.9897
Epoch 12/15
 1/61 [..............................] - ETA: 0s - loss: 0.0578 - accuracy: 0.9855 7/61 [==>...........................] - ETA: 0s - loss: 0.0589 - accuracy: 0.982910/61 [===>..........................] - ETA: 0s - loss: 0.0581 - accuracy: 0.982915/61 [======>.......................] - ETA: 0s - loss: 0.0575 - accuracy: 0.982821/61 [=========>....................] - ETA: 0s - loss: 0.0578 - accuracy: 0.982425/61 [===========>..................] - ETA: 0s - loss: 0.0583 - accuracy: 0.982230/61 [=============>................] - ETA: 0s - loss: 0.0590 - accuracy: 0.981936/61 [================>.............] - ETA: 0s - loss: 0.0599 - accuracy: 0.981542/61 [===================>..........] - ETA: 0s - loss: 0.0605 - accuracy: 0.981349/61 [=======================>......] - ETA: 0s - loss: 0.0610 - accuracy: 0.981155/61 [==========================>...] - ETA: 0s - loss: 0.0614 - accuracy: 0.981060/61 [============================>.] - ETA: 0s - loss: 0.0617 - accuracy: 0.980961/61 [==============================] - 1s 13ms/step - loss: 0.0617 - accuracy: 0.9808 - val_loss: 0.0430 - val_accuracy: 0.9888
Epoch 13/15
 1/61 [..............................] - ETA: 0s - loss: 0.0811 - accuracy: 0.9777 8/61 [==>...........................] - ETA: 0s - loss: 0.0659 - accuracy: 0.981416/61 [======>.......................] - ETA: 0s - loss: 0.0627 - accuracy: 0.981924/61 [==========>...................] - ETA: 0s - loss: 0.0614 - accuracy: 0.981930/61 [=============>................] - ETA: 0s - loss: 0.0611 - accuracy: 0.981838/61 [=================>............] - ETA: 0s - loss: 0.0609 - accuracy: 0.981946/61 [=====================>........] - ETA: 0s - loss: 0.0608 - accuracy: 0.981952/61 [========================>.....] - ETA: 0s - loss: 0.0608 - accuracy: 0.981957/61 [===========================>..] - ETA: 0s - loss: 0.0607 - accuracy: 0.981961/61 [==============================] - 1s 10ms/step - loss: 0.0607 - accuracy: 0.9818 - val_loss: 0.0403 - val_accuracy: 0.9890
Epoch 14/15
 1/61 [..............................] - ETA: 0s - loss: 0.0415 - accuracy: 0.9855 6/61 [=>............................] - ETA: 0s - loss: 0.0485 - accuracy: 0.983712/61 [====>.........................] - ETA: 0s - loss: 0.0511 - accuracy: 0.983315/61 [======>.......................] - ETA: 0s - loss: 0.0518 - accuracy: 0.983223/61 [==========>...................] - ETA: 0s - loss: 0.0537 - accuracy: 0.983031/61 [==============>...............] - ETA: 0s - loss: 0.0545 - accuracy: 0.982938/61 [=================>............] - ETA: 0s - loss: 0.0549 - accuracy: 0.982943/61 [====================>.........] - ETA: 0s - loss: 0.0551 - accuracy: 0.982950/61 [=======================>......] - ETA: 0s - loss: 0.0554 - accuracy: 0.982858/61 [===========================>..] - ETA: 0s - loss: 0.0558 - accuracy: 0.982761/61 [==============================] - 1s 10ms/step - loss: 0.0559 - accuracy: 0.9826 - val_loss: 0.0388 - val_accuracy: 0.9902
Epoch 15/15
 1/61 [..............................] - ETA: 0s - loss: 0.0459 - accuracy: 0.9844 9/61 [===>..........................] - ETA: 0s - loss: 0.0482 - accuracy: 0.983916/61 [======>.......................] - ETA: 0s - loss: 0.0503 - accuracy: 0.983524/61 [==========>...................] - ETA: 0s - loss: 0.0516 - accuracy: 0.983432/61 [==============>...............] - ETA: 0s - loss: 0.0527 - accuracy: 0.983340/61 [==================>...........] - ETA: 0s - loss: 0.0533 - accuracy: 0.983248/61 [======================>.......] - ETA: 0s - loss: 0.0537 - accuracy: 0.983156/61 [==========================>...] - ETA: 0s - loss: 0.0541 - accuracy: 0.983161/61 [==============================] - 1s 9ms/step - loss: 0.0544 - accuracy: 0.9830 - val_loss: 0.0382 - val_accuracy: 0.9908
training_time: 0:00:14.616724
Test loss: 0.03578576445579529
Test accuracy: 0.9876999855041504
