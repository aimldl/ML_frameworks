Number of devices: 7
batch_size_per_replica: 128
batch_size: 896 = 128 * 7
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
x_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
<class 'numpy.ndarray'> <class 'numpy.ndarray'>
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 26, 26, 32)        320       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 13, 13, 32)        0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 11, 11, 64)        18496     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 5, 5, 64)          0         
_________________________________________________________________
flatten (Flatten)            (None, 1600)              0         
_________________________________________________________________
dropout (Dropout)            (None, 1600)              0         
_________________________________________________________________
dense (Dense)                (None, 10)                16010     
=================================================================
Total params: 34,826
Trainable params: 34,826
Non-trainable params: 0
_________________________________________________________________
Epoch 1/15
 1/61 [..............................] - ETA: 2:40 - loss: 2.3093 - accuracy: 0.1205 2/61 [..............................] - ETA: 5s - loss: 2.3012 - accuracy: 0.1289   3/61 [>.............................] - ETA: 5s - loss: 2.2933 - accuracy: 0.1385 4/61 [>.............................] - ETA: 5s - loss: 2.2855 - accuracy: 0.1501 5/61 [=>............................] - ETA: 4s - loss: 2.2769 - accuracy: 0.1632 6/61 [=>............................] - ETA: 4s - loss: 2.2682 - accuracy: 0.1758 7/61 [==>...........................] - ETA: 4s - loss: 2.2594 - accuracy: 0.1872 8/61 [==>...........................] - ETA: 4s - loss: 2.2504 - accuracy: 0.197811/61 [====>.........................] - ETA: 3s - loss: 2.2213 - accuracy: 0.225617/61 [=======>......................] - ETA: 1s - loss: 2.1530 - accuracy: 0.269624/61 [==========>...................] - ETA: 1s - loss: 2.0628 - accuracy: 0.308432/61 [==============>...............] - ETA: 0s - loss: 1.9605 - accuracy: 0.344040/61 [==================>...........] - ETA: 0s - loss: 1.8689 - accuracy: 0.373748/61 [======================>.......] - ETA: 0s - loss: 1.7884 - accuracy: 0.399456/61 [==========================>...] - ETA: 0s - loss: 1.7177 - accuracy: 0.421961/61 [==============================] - ETA: 0s - loss: 1.6777 - accuracy: 0.434661/61 [==============================] - 4s 28ms/step - loss: 1.6703 - accuracy: 0.4370 - val_loss: 0.6352 - val_accuracy: 0.7622
Epoch 2/15
 1/61 [..............................] - ETA: 0s - loss: 0.6749 - accuracy: 0.7600 9/61 [===>..........................] - ETA: 0s - loss: 0.6787 - accuracy: 0.755217/61 [=======>......................] - ETA: 0s - loss: 0.6766 - accuracy: 0.754325/61 [===========>..................] - ETA: 0s - loss: 0.6715 - accuracy: 0.755933/61 [===============>..............] - ETA: 0s - loss: 0.6659 - accuracy: 0.757541/61 [===================>..........] - ETA: 0s - loss: 0.6606 - accuracy: 0.759149/61 [=======================>......] - ETA: 0s - loss: 0.6555 - accuracy: 0.760757/61 [===========================>..] - ETA: 0s - loss: 0.6506 - accuracy: 0.762161/61 [==============================] - ETA: 0s - loss: 0.6483 - accuracy: 0.762961/61 [==============================] - 1s 9ms/step - loss: 0.6478 - accuracy: 0.7631 - val_loss: 0.5054 - val_accuracy: 0.8133
Epoch 3/15
 1/61 [..............................] - ETA: 0s - loss: 0.5825 - accuracy: 0.8025 9/61 [===>..........................] - ETA: 0s - loss: 0.5592 - accuracy: 0.798417/61 [=======>......................] - ETA: 0s - loss: 0.5553 - accuracy: 0.799125/61 [===========>..................] - ETA: 0s - loss: 0.5526 - accuracy: 0.799833/61 [===============>..............] - ETA: 0s - loss: 0.5508 - accuracy: 0.800041/61 [===================>..........] - ETA: 0s - loss: 0.5493 - accuracy: 0.800449/61 [=======================>......] - ETA: 0s - loss: 0.5478 - accuracy: 0.800957/61 [===========================>..] - ETA: 0s - loss: 0.5461 - accuracy: 0.801461/61 [==============================] - ETA: 0s - loss: 0.5452 - accuracy: 0.801761/61 [==============================] - 1s 9ms/step - loss: 0.5449 - accuracy: 0.8017 - val_loss: 0.4637 - val_accuracy: 0.8365
Epoch 4/15
 1/61 [..............................] - ETA: 0s - loss: 0.4870 - accuracy: 0.8058 9/61 [===>..........................] - ETA: 0s - loss: 0.4918 - accuracy: 0.818417/61 [=======>......................] - ETA: 0s - loss: 0.4935 - accuracy: 0.820125/61 [===========>..................] - ETA: 0s - loss: 0.4950 - accuracy: 0.820633/61 [===============>..............] - ETA: 0s - loss: 0.4957 - accuracy: 0.820741/61 [===================>..........] - ETA: 0s - loss: 0.4953 - accuracy: 0.821149/61 [=======================>......] - ETA: 0s - loss: 0.4952 - accuracy: 0.821357/61 [===========================>..] - ETA: 0s - loss: 0.4947 - accuracy: 0.821661/61 [==============================] - ETA: 0s - loss: 0.4943 - accuracy: 0.821861/61 [==============================] - 1s 9ms/step - loss: 0.4942 - accuracy: 0.8218 - val_loss: 0.4377 - val_accuracy: 0.8445
Epoch 5/15
 1/61 [..............................] - ETA: 0s - loss: 0.4844 - accuracy: 0.8248 9/61 [===>..........................] - ETA: 0s - loss: 0.4684 - accuracy: 0.827817/61 [=======>......................] - ETA: 0s - loss: 0.4698 - accuracy: 0.828025/61 [===========>..................] - ETA: 0s - loss: 0.4703 - accuracy: 0.828533/61 [===============>..............] - ETA: 0s - loss: 0.4703 - accuracy: 0.829141/61 [===================>..........] - ETA: 0s - loss: 0.4697 - accuracy: 0.829949/61 [=======================>......] - ETA: 0s - loss: 0.4689 - accuracy: 0.830757/61 [===========================>..] - ETA: 0s - loss: 0.4681 - accuracy: 0.831361/61 [==============================] - 1s 8ms/step - loss: 0.4676 - accuracy: 0.8316 - val_loss: 0.4147 - val_accuracy: 0.8497
Epoch 6/15
 1/61 [..............................] - ETA: 0s - loss: 0.4480 - accuracy: 0.8449 8/61 [==>...........................] - ETA: 0s - loss: 0.4434 - accuracy: 0.841116/61 [======>.......................] - ETA: 0s - loss: 0.4455 - accuracy: 0.841624/61 [==========>...................] - ETA: 0s - loss: 0.4466 - accuracy: 0.841732/61 [==============>...............] - ETA: 0s - loss: 0.4471 - accuracy: 0.841640/61 [==================>...........] - ETA: 0s - loss: 0.4474 - accuracy: 0.841548/61 [======================>.......] - ETA: 0s - loss: 0.4471 - accuracy: 0.841553/61 [=========================>....] - ETA: 0s - loss: 0.4467 - accuracy: 0.841659/61 [============================>.] - ETA: 0s - loss: 0.4461 - accuracy: 0.841761/61 [==============================] - 1s 10ms/step - loss: 0.4458 - accuracy: 0.8418 - val_loss: 0.4012 - val_accuracy: 0.8592
Epoch 7/15
 1/61 [..............................] - ETA: 0s - loss: 0.4557 - accuracy: 0.8449 7/61 [==>...........................] - ETA: 0s - loss: 0.4278 - accuracy: 0.848915/61 [======>.......................] - ETA: 0s - loss: 0.4270 - accuracy: 0.848619/61 [========>.....................] - ETA: 0s - loss: 0.4272 - accuracy: 0.848727/61 [============>.................] - ETA: 0s - loss: 0.4265 - accuracy: 0.849134/61 [===============>..............] - ETA: 0s - loss: 0.4259 - accuracy: 0.849536/61 [================>.............] - ETA: 0s - loss: 0.4257 - accuracy: 0.849542/61 [===================>..........] - ETA: 0s - loss: 0.4251 - accuracy: 0.849746/61 [=====================>........] - ETA: 0s - loss: 0.4248 - accuracy: 0.849850/61 [=======================>......] - ETA: 0s - loss: 0.4245 - accuracy: 0.850051/61 [========================>.....] - ETA: 0s - loss: 0.4245 - accuracy: 0.850052/61 [========================>.....] - ETA: 0s - loss: 0.4244 - accuracy: 0.850154/61 [=========================>....] - ETA: 0s - loss: 0.4243 - accuracy: 0.850157/61 [===========================>..] - ETA: 0s - loss: 0.4242 - accuracy: 0.850260/61 [============================>.] - ETA: 0s - loss: 0.4240 - accuracy: 0.850261/61 [==============================] - 1s 19ms/step - loss: 0.4239 - accuracy: 0.8503 - val_loss: 0.3839 - val_accuracy: 0.8615
Epoch 8/15
 1/61 [..............................] - ETA: 0s - loss: 0.4281 - accuracy: 0.8482 2/61 [..............................] - ETA: 3s - loss: 0.4206 - accuracy: 0.8504 6/61 [=>............................] - ETA: 1s - loss: 0.4199 - accuracy: 0.8502 8/61 [==>...........................] - ETA: 1s - loss: 0.4211 - accuracy: 0.8498 9/61 [===>..........................] - ETA: 1s - loss: 0.4213 - accuracy: 0.849811/61 [====>.........................] - ETA: 1s - loss: 0.4219 - accuracy: 0.849712/61 [====>.........................] - ETA: 1s - loss: 0.4220 - accuracy: 0.849613/61 [=====>........................] - ETA: 1s - loss: 0.4220 - accuracy: 0.849514/61 [=====>........................] - ETA: 1s - loss: 0.4219 - accuracy: 0.849515/61 [======>.......................] - ETA: 1s - loss: 0.4217 - accuracy: 0.849517/61 [=======>......................] - ETA: 1s - loss: 0.4217 - accuracy: 0.849519/61 [========>.....................] - ETA: 1s - loss: 0.4217 - accuracy: 0.849622/61 [=========>....................] - ETA: 1s - loss: 0.4216 - accuracy: 0.849924/61 [==========>...................] - ETA: 1s - loss: 0.4212 - accuracy: 0.850126/61 [===========>..................] - ETA: 1s - loss: 0.4209 - accuracy: 0.850227/61 [============>.................] - ETA: 1s - loss: 0.4207 - accuracy: 0.850328/61 [============>.................] - ETA: 1s - loss: 0.4206 - accuracy: 0.850329/61 [=============>................] - ETA: 1s - loss: 0.4204 - accuracy: 0.850431/61 [==============>...............] - ETA: 1s - loss: 0.4200 - accuracy: 0.850538/61 [=================>............] - ETA: 0s - loss: 0.4190 - accuracy: 0.850943/61 [====================>.........] - ETA: 0s - loss: 0.4183 - accuracy: 0.851247/61 [======================>.......] - ETA: 0s - loss: 0.4176 - accuracy: 0.851454/61 [=========================>....] - ETA: 0s - loss: 0.4165 - accuracy: 0.851857/61 [===========================>..] - ETA: 0s - loss: 0.4161 - accuracy: 0.851959/61 [============================>.] - ETA: 0s - loss: 0.4159 - accuracy: 0.852061/61 [==============================] - 2s 28ms/step - loss: 0.4155 - accuracy: 0.8521 - val_loss: 0.3707 - val_accuracy: 0.8673
Epoch 9/15
 1/61 [..............................] - ETA: 0s - loss: 0.4273 - accuracy: 0.8482 3/61 [>.............................] - ETA: 1s - loss: 0.4083 - accuracy: 0.8517 6/61 [=>............................] - ETA: 1s - loss: 0.4093 - accuracy: 0.850411/61 [====>.........................] - ETA: 0s - loss: 0.4067 - accuracy: 0.852415/61 [======>.......................] - ETA: 0s - loss: 0.4061 - accuracy: 0.853219/61 [========>.....................] - ETA: 0s - loss: 0.4051 - accuracy: 0.854322/61 [=========>....................] - ETA: 0s - loss: 0.4044 - accuracy: 0.854927/61 [============>.................] - ETA: 0s - loss: 0.4038 - accuracy: 0.855530/61 [=============>................] - ETA: 0s - loss: 0.4037 - accuracy: 0.855732/61 [==============>...............] - ETA: 0s - loss: 0.4035 - accuracy: 0.855833/61 [===============>..............] - ETA: 0s - loss: 0.4034 - accuracy: 0.855936/61 [================>.............] - ETA: 0s - loss: 0.4030 - accuracy: 0.856140/61 [==================>...........] - ETA: 0s - loss: 0.4029 - accuracy: 0.856243/61 [====================>.........] - ETA: 0s - loss: 0.4028 - accuracy: 0.856350/61 [=======================>......] - ETA: 0s - loss: 0.4022 - accuracy: 0.856657/61 [===========================>..] - ETA: 0s - loss: 0.4016 - accuracy: 0.856961/61 [==============================] - 1s 18ms/step - loss: 0.4014 - accuracy: 0.8570 - val_loss: 0.3687 - val_accuracy: 0.8675
Epoch 10/15
 1/61 [..............................] - ETA: 0s - loss: 0.3591 - accuracy: 0.8884 9/61 [===>..........................] - ETA: 0s - loss: 0.3859 - accuracy: 0.867817/61 [=======>......................] - ETA: 0s - loss: 0.3899 - accuracy: 0.863825/61 [===========>..................] - ETA: 0s - loss: 0.3916 - accuracy: 0.861933/61 [===============>..............] - ETA: 0s - loss: 0.3927 - accuracy: 0.861039/61 [==================>...........] - ETA: 0s - loss: 0.3930 - accuracy: 0.860747/61 [======================>.......] - ETA: 0s - loss: 0.3932 - accuracy: 0.860454/61 [=========================>....] - ETA: 0s - loss: 0.3932 - accuracy: 0.860261/61 [==============================] - ETA: 0s - loss: 0.3932 - accuracy: 0.860261/61 [==============================] - 1s 10ms/step - loss: 0.3931 - accuracy: 0.8602 - val_loss: 0.3549 - val_accuracy: 0.8720
Epoch 11/15
 1/61 [..............................] - ETA: 0s - loss: 0.4009 - accuracy: 0.8616 6/61 [=>............................] - ETA: 0s - loss: 0.3952 - accuracy: 0.8624 9/61 [===>..........................] - ETA: 0s - loss: 0.3966 - accuracy: 0.861014/61 [=====>........................] - ETA: 0s - loss: 0.3955 - accuracy: 0.860320/61 [========>.....................] - ETA: 0s - loss: 0.3939 - accuracy: 0.860325/61 [===========>..................] - ETA: 0s - loss: 0.3925 - accuracy: 0.860533/61 [===============>..............] - ETA: 0s - loss: 0.3905 - accuracy: 0.861141/61 [===================>..........] - ETA: 0s - loss: 0.3884 - accuracy: 0.861649/61 [=======================>......] - ETA: 0s - loss: 0.3874 - accuracy: 0.861955/61 [==========================>...] - ETA: 0s - loss: 0.3868 - accuracy: 0.862161/61 [==============================] - ETA: 0s - loss: 0.3863 - accuracy: 0.862361/61 [==============================] - 1s 10ms/step - loss: 0.3862 - accuracy: 0.8623 - val_loss: 0.3504 - val_accuracy: 0.8753
Epoch 12/15
 1/61 [..............................] - ETA: 0s - loss: 0.3356 - accuracy: 0.8895 6/61 [=>............................] - ETA: 0s - loss: 0.3655 - accuracy: 0.876814/61 [=====>........................] - ETA: 0s - loss: 0.3721 - accuracy: 0.871722/61 [=========>....................] - ETA: 0s - loss: 0.3764 - accuracy: 0.869030/61 [=============>................] - ETA: 0s - loss: 0.3779 - accuracy: 0.867838/61 [=================>............] - ETA: 0s - loss: 0.3778 - accuracy: 0.867546/61 [=====================>........] - ETA: 0s - loss: 0.3771 - accuracy: 0.867454/61 [=========================>....] - ETA: 0s - loss: 0.3766 - accuracy: 0.867361/61 [==============================] - ETA: 0s - loss: 0.3763 - accuracy: 0.867361/61 [==============================] - 1s 8ms/step - loss: 0.3762 - accuracy: 0.8673 - val_loss: 0.3495 - val_accuracy: 0.8763
Epoch 13/15
 1/61 [..............................] - ETA: 0s - loss: 0.3934 - accuracy: 0.8650 9/61 [===>..........................] - ETA: 0s - loss: 0.3819 - accuracy: 0.866117/61 [=======>......................] - ETA: 0s - loss: 0.3813 - accuracy: 0.865325/61 [===========>..................] - ETA: 0s - loss: 0.3807 - accuracy: 0.865032/61 [==============>...............] - ETA: 0s - loss: 0.3795 - accuracy: 0.865340/61 [==================>...........] - ETA: 0s - loss: 0.3781 - accuracy: 0.865745/61 [=====================>........] - ETA: 0s - loss: 0.3773 - accuracy: 0.865853/61 [=========================>....] - ETA: 0s - loss: 0.3761 - accuracy: 0.866061/61 [==============================] - 1s 8ms/step - loss: 0.3747 - accuracy: 0.8664 - val_loss: 0.3327 - val_accuracy: 0.8795
Epoch 14/15
 1/61 [..............................] - ETA: 0s - loss: 0.3347 - accuracy: 0.8862 9/61 [===>..........................] - ETA: 0s - loss: 0.3597 - accuracy: 0.874715/61 [======>.......................] - ETA: 0s - loss: 0.3624 - accuracy: 0.872823/61 [==========>...................] - ETA: 0s - loss: 0.3637 - accuracy: 0.871429/61 [=============>................] - ETA: 0s - loss: 0.3637 - accuracy: 0.871134/61 [===============>..............] - ETA: 0s - loss: 0.3638 - accuracy: 0.870839/61 [==================>...........] - ETA: 0s - loss: 0.3638 - accuracy: 0.870644/61 [====================>.........] - ETA: 0s - loss: 0.3635 - accuracy: 0.870652/61 [========================>.....] - ETA: 0s - loss: 0.3630 - accuracy: 0.870758/61 [===========================>..] - ETA: 0s - loss: 0.3627 - accuracy: 0.870861/61 [==============================] - 1s 11ms/step - loss: 0.3625 - accuracy: 0.8709 - val_loss: 0.3332 - val_accuracy: 0.8805
Epoch 15/15
 1/61 [..............................] - ETA: 0s - loss: 0.4111 - accuracy: 0.8650 9/61 [===>..........................] - ETA: 0s - loss: 0.3708 - accuracy: 0.871317/61 [=======>......................] - ETA: 0s - loss: 0.3670 - accuracy: 0.871525/61 [===========>..................] - ETA: 0s - loss: 0.3637 - accuracy: 0.872233/61 [===============>..............] - ETA: 0s - loss: 0.3616 - accuracy: 0.872741/61 [===================>..........] - ETA: 0s - loss: 0.3604 - accuracy: 0.872949/61 [=======================>......] - ETA: 0s - loss: 0.3594 - accuracy: 0.873157/61 [===========================>..] - ETA: 0s - loss: 0.3586 - accuracy: 0.873461/61 [==============================] - 0s 8ms/step - loss: 0.3582 - accuracy: 0.8734 - val_loss: 0.3283 - val_accuracy: 0.8823
training_time: 0:00:14.598495
Test loss: 0.3399375379085541
Test accuracy: 0.8797000050544739
