Number of devices: 7
batch_size_per_replica: 128
batch_size: 896 = 128 * 7
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
x_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
<class 'numpy.ndarray'> <class 'numpy.ndarray'>
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 26, 26, 32)        320       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 13, 13, 32)        0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 11, 11, 64)        18496     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 5, 5, 64)          0         
_________________________________________________________________
flatten (Flatten)            (None, 1600)              0         
_________________________________________________________________
dropout (Dropout)            (None, 1600)              0         
_________________________________________________________________
dense (Dense)                (None, 10)                16010     
=================================================================
Total params: 34,826
Trainable params: 34,826
Non-trainable params: 0
_________________________________________________________________
Epoch 1/15
 1/61 [..............................] - ETA: 2:37 - loss: 2.3151 - accuracy: 0.0993 2/61 [..............................] - ETA: 6s - loss: 2.3063 - accuracy: 0.1172   3/61 [>.............................] - ETA: 5s - loss: 2.2979 - accuracy: 0.1328 4/61 [>.............................] - ETA: 4s - loss: 2.2895 - accuracy: 0.1470 6/61 [=>............................] - ETA: 3s - loss: 2.2730 - accuracy: 0.1754 8/61 [==>...........................] - ETA: 3s - loss: 2.2561 - accuracy: 0.201310/61 [===>..........................] - ETA: 2s - loss: 2.2386 - accuracy: 0.224218/61 [=======>......................] - ETA: 1s - loss: 2.1530 - accuracy: 0.301826/61 [===========>..................] - ETA: 0s - loss: 2.0463 - accuracy: 0.359734/61 [===============>..............] - ETA: 0s - loss: 1.9336 - accuracy: 0.405142/61 [===================>..........] - ETA: 0s - loss: 1.8278 - accuracy: 0.442649/61 [=======================>......] - ETA: 0s - loss: 1.7438 - accuracy: 0.470857/61 [===========================>..] - ETA: 0s - loss: 1.6574 - accuracy: 0.498861/61 [==============================] - ETA: 0s - loss: 1.6180 - accuracy: 0.511461/61 [==============================] - 4s 24ms/step - loss: 1.6088 - accuracy: 0.5143 - val_loss: 0.2345 - val_accuracy: 0.9352
Epoch 2/15
 1/61 [..............................] - ETA: 0s - loss: 0.3739 - accuracy: 0.8962 9/61 [===>..........................] - ETA: 0s - loss: 0.3592 - accuracy: 0.894817/61 [=======>......................] - ETA: 0s - loss: 0.3471 - accuracy: 0.895725/61 [===========>..................] - ETA: 0s - loss: 0.3378 - accuracy: 0.897933/61 [===============>..............] - ETA: 0s - loss: 0.3303 - accuracy: 0.899741/61 [===================>..........] - ETA: 0s - loss: 0.3237 - accuracy: 0.901749/61 [=======================>......] - ETA: 0s - loss: 0.3174 - accuracy: 0.903657/61 [===========================>..] - ETA: 0s - loss: 0.3115 - accuracy: 0.905461/61 [==============================] - ETA: 0s - loss: 0.3086 - accuracy: 0.906361/61 [==============================] - 1s 9ms/step - loss: 0.3079 - accuracy: 0.9065 - val_loss: 0.1192 - val_accuracy: 0.9693
Epoch 3/15
 1/61 [..............................] - ETA: 0s - loss: 0.2258 - accuracy: 0.9386 9/61 [===>..........................] - ETA: 0s - loss: 0.1987 - accuracy: 0.939017/61 [=======>......................] - ETA: 0s - loss: 0.1940 - accuracy: 0.940325/61 [===========>..................] - ETA: 0s - loss: 0.1905 - accuracy: 0.941333/61 [===============>..............] - ETA: 0s - loss: 0.1879 - accuracy: 0.942041/61 [===================>..........] - ETA: 0s - loss: 0.1857 - accuracy: 0.942749/61 [=======================>......] - ETA: 0s - loss: 0.1837 - accuracy: 0.943457/61 [===========================>..] - ETA: 0s - loss: 0.1818 - accuracy: 0.944061/61 [==============================] - 0s 8ms/step - loss: 0.1807 - accuracy: 0.9443 - val_loss: 0.0878 - val_accuracy: 0.9775
Epoch 4/15
 1/61 [..............................] - ETA: 0s - loss: 0.1490 - accuracy: 0.9565 9/61 [===>..........................] - ETA: 0s - loss: 0.1412 - accuracy: 0.957517/61 [=======>......................] - ETA: 0s - loss: 0.1410 - accuracy: 0.956625/61 [===========>..................] - ETA: 0s - loss: 0.1400 - accuracy: 0.956733/61 [===============>..............] - ETA: 0s - loss: 0.1393 - accuracy: 0.957041/61 [===================>..........] - ETA: 0s - loss: 0.1384 - accuracy: 0.957349/61 [=======================>......] - ETA: 0s - loss: 0.1373 - accuracy: 0.957757/61 [===========================>..] - ETA: 0s - loss: 0.1365 - accuracy: 0.958061/61 [==============================] - 1s 9ms/step - loss: 0.1360 - accuracy: 0.9582 - val_loss: 0.0711 - val_accuracy: 0.9807
Epoch 5/15
 1/61 [..............................] - ETA: 0s - loss: 0.1132 - accuracy: 0.9665 7/61 [==>...........................] - ETA: 0s - loss: 0.1087 - accuracy: 0.965115/61 [======>.......................] - ETA: 0s - loss: 0.1081 - accuracy: 0.965517/61 [=======>......................] - ETA: 0s - loss: 0.1085 - accuracy: 0.965525/61 [===========>..................] - ETA: 0s - loss: 0.1093 - accuracy: 0.965832/61 [==============>...............] - ETA: 0s - loss: 0.1099 - accuracy: 0.965739/61 [==================>...........] - ETA: 0s - loss: 0.1100 - accuracy: 0.965847/61 [======================>.......] - ETA: 0s - loss: 0.1098 - accuracy: 0.966055/61 [==========================>...] - ETA: 0s - loss: 0.1096 - accuracy: 0.966161/61 [==============================] - 1s 10ms/step - loss: 0.1095 - accuracy: 0.9662 - val_loss: 0.0625 - val_accuracy: 0.9830
Epoch 6/15
 1/61 [..............................] - ETA: 0s - loss: 0.0917 - accuracy: 0.9766 9/61 [===>..........................] - ETA: 0s - loss: 0.0994 - accuracy: 0.971616/61 [======>.......................] - ETA: 0s - loss: 0.0989 - accuracy: 0.970623/61 [==========>...................] - ETA: 0s - loss: 0.0994 - accuracy: 0.970131/61 [==============>...............] - ETA: 0s - loss: 0.1000 - accuracy: 0.969735/61 [================>.............] - ETA: 0s - loss: 0.1003 - accuracy: 0.969537/61 [=================>............] - ETA: 0s - loss: 0.1004 - accuracy: 0.969541/61 [===================>..........] - ETA: 0s - loss: 0.1005 - accuracy: 0.969445/61 [=====================>........] - ETA: 0s - loss: 0.1004 - accuracy: 0.969450/61 [=======================>......] - ETA: 0s - loss: 0.1004 - accuracy: 0.969456/61 [==========================>...] - ETA: 0s - loss: 0.1003 - accuracy: 0.969459/61 [============================>.] - ETA: 0s - loss: 0.1002 - accuracy: 0.969461/61 [==============================] - ETA: 0s - loss: 0.1001 - accuracy: 0.969461/61 [==============================] - 1s 15ms/step - loss: 0.1001 - accuracy: 0.9694 - val_loss: 0.0579 - val_accuracy: 0.9837
Epoch 7/15
 1/61 [..............................] - ETA: 0s - loss: 0.0791 - accuracy: 0.9743 4/61 [>.............................] - ETA: 1s - loss: 0.0886 - accuracy: 0.9737 9/61 [===>..........................] - ETA: 1s - loss: 0.0911 - accuracy: 0.973212/61 [====>.........................] - ETA: 1s - loss: 0.0904 - accuracy: 0.973514/61 [=====>........................] - ETA: 1s - loss: 0.0900 - accuracy: 0.973721/61 [=========>....................] - ETA: 0s - loss: 0.0902 - accuracy: 0.973726/61 [===========>..................] - ETA: 0s - loss: 0.0906 - accuracy: 0.973632/61 [==============>...............] - ETA: 0s - loss: 0.0907 - accuracy: 0.973637/61 [=================>............] - ETA: 0s - loss: 0.0906 - accuracy: 0.973642/61 [===================>..........] - ETA: 0s - loss: 0.0904 - accuracy: 0.973648/61 [======================>.......] - ETA: 0s - loss: 0.0901 - accuracy: 0.973656/61 [==========================>...] - ETA: 0s - loss: 0.0896 - accuracy: 0.973761/61 [==============================] - 1s 15ms/step - loss: 0.0894 - accuracy: 0.9737 - val_loss: 0.0529 - val_accuracy: 0.9858
Epoch 8/15
 1/61 [..............................] - ETA: 0s - loss: 0.0660 - accuracy: 0.9754 6/61 [=>............................] - ETA: 0s - loss: 0.0672 - accuracy: 0.976711/61 [====>.........................] - ETA: 0s - loss: 0.0723 - accuracy: 0.975118/61 [=======>......................] - ETA: 0s - loss: 0.0749 - accuracy: 0.974525/61 [===========>..................] - ETA: 0s - loss: 0.0761 - accuracy: 0.974431/61 [==============>...............] - ETA: 0s - loss: 0.0768 - accuracy: 0.974537/61 [=================>............] - ETA: 0s - loss: 0.0773 - accuracy: 0.974542/61 [===================>..........] - ETA: 0s - loss: 0.0776 - accuracy: 0.974546/61 [=====================>........] - ETA: 0s - loss: 0.0778 - accuracy: 0.974550/61 [=======================>......] - ETA: 0s - loss: 0.0779 - accuracy: 0.974555/61 [==========================>...] - ETA: 0s - loss: 0.0781 - accuracy: 0.974661/61 [==============================] - ETA: 0s - loss: 0.0782 - accuracy: 0.974661/61 [==============================] - 1s 13ms/step - loss: 0.0782 - accuracy: 0.9747 - val_loss: 0.0499 - val_accuracy: 0.9868
Epoch 9/15
 1/61 [..............................] - ETA: 1s - loss: 0.0782 - accuracy: 0.9732 6/61 [=>............................] - ETA: 0s - loss: 0.0769 - accuracy: 0.976212/61 [====>.........................] - ETA: 0s - loss: 0.0770 - accuracy: 0.976817/61 [=======>......................] - ETA: 0s - loss: 0.0773 - accuracy: 0.976823/61 [==========>...................] - ETA: 0s - loss: 0.0770 - accuracy: 0.977029/61 [=============>................] - ETA: 0s - loss: 0.0766 - accuracy: 0.977235/61 [================>.............] - ETA: 0s - loss: 0.0761 - accuracy: 0.977441/61 [===================>..........] - ETA: 0s - loss: 0.0756 - accuracy: 0.977543/61 [====================>.........] - ETA: 0s - loss: 0.0755 - accuracy: 0.977546/61 [=====================>........] - ETA: 0s - loss: 0.0753 - accuracy: 0.977653/61 [=========================>....] - ETA: 0s - loss: 0.0749 - accuracy: 0.977760/61 [============================>.] - ETA: 0s - loss: 0.0747 - accuracy: 0.977761/61 [==============================] - 1s 12ms/step - loss: 0.0747 - accuracy: 0.9777 - val_loss: 0.0456 - val_accuracy: 0.9885
Epoch 10/15
 1/61 [..............................] - ETA: 0s - loss: 0.0794 - accuracy: 0.9777 9/61 [===>..........................] - ETA: 0s - loss: 0.0732 - accuracy: 0.978312/61 [====>.........................] - ETA: 0s - loss: 0.0731 - accuracy: 0.978116/61 [======>.......................] - ETA: 0s - loss: 0.0726 - accuracy: 0.977919/61 [========>.....................] - ETA: 0s - loss: 0.0723 - accuracy: 0.977923/61 [==========>...................] - ETA: 0s - loss: 0.0721 - accuracy: 0.977830/61 [=============>................] - ETA: 0s - loss: 0.0720 - accuracy: 0.977738/61 [=================>............] - ETA: 0s - loss: 0.0716 - accuracy: 0.977846/61 [=====================>........] - ETA: 0s - loss: 0.0714 - accuracy: 0.977952/61 [========================>.....] - ETA: 0s - loss: 0.0713 - accuracy: 0.978058/61 [===========================>..] - ETA: 0s - loss: 0.0713 - accuracy: 0.978061/61 [==============================] - 1s 11ms/step - loss: 0.0713 - accuracy: 0.9780 - val_loss: 0.0449 - val_accuracy: 0.9882
Epoch 11/15
 1/61 [..............................] - ETA: 0s - loss: 0.0690 - accuracy: 0.9766 9/61 [===>..........................] - ETA: 0s - loss: 0.0601 - accuracy: 0.980713/61 [=====>........................] - ETA: 0s - loss: 0.0608 - accuracy: 0.980521/61 [=========>....................] - ETA: 0s - loss: 0.0627 - accuracy: 0.980229/61 [=============>................] - ETA: 0s - loss: 0.0632 - accuracy: 0.980136/61 [================>.............] - ETA: 0s - loss: 0.0637 - accuracy: 0.979944/61 [====================>.........] - ETA: 0s - loss: 0.0638 - accuracy: 0.979852/61 [========================>.....] - ETA: 0s - loss: 0.0639 - accuracy: 0.979760/61 [============================>.] - ETA: 0s - loss: 0.0640 - accuracy: 0.979661/61 [==============================] - 1s 8ms/step - loss: 0.0640 - accuracy: 0.9796 - val_loss: 0.0425 - val_accuracy: 0.9888
Epoch 12/15
 1/61 [..............................] - ETA: 0s - loss: 0.0771 - accuracy: 0.9777 8/61 [==>...........................] - ETA: 0s - loss: 0.0639 - accuracy: 0.979813/61 [=====>........................] - ETA: 0s - loss: 0.0630 - accuracy: 0.980321/61 [=========>....................] - ETA: 0s - loss: 0.0627 - accuracy: 0.980626/61 [===========>..................] - ETA: 0s - loss: 0.0628 - accuracy: 0.980634/61 [===============>..............] - ETA: 0s - loss: 0.0631 - accuracy: 0.980542/61 [===================>..........] - ETA: 0s - loss: 0.0633 - accuracy: 0.980549/61 [=======================>......] - ETA: 0s - loss: 0.0632 - accuracy: 0.980657/61 [===========================>..] - ETA: 0s - loss: 0.0631 - accuracy: 0.980661/61 [==============================] - 1s 9ms/step - loss: 0.0630 - accuracy: 0.9807 - val_loss: 0.0425 - val_accuracy: 0.9887
Epoch 13/15
 1/61 [..............................] - ETA: 0s - loss: 0.0539 - accuracy: 0.9888 9/61 [===>..........................] - ETA: 0s - loss: 0.0597 - accuracy: 0.982417/61 [=======>......................] - ETA: 0s - loss: 0.0589 - accuracy: 0.982425/61 [===========>..................] - ETA: 0s - loss: 0.0588 - accuracy: 0.982333/61 [===============>..............] - ETA: 0s - loss: 0.0590 - accuracy: 0.982241/61 [===================>..........] - ETA: 0s - loss: 0.0591 - accuracy: 0.982149/61 [=======================>......] - ETA: 0s - loss: 0.0592 - accuracy: 0.982157/61 [===========================>..] - ETA: 0s - loss: 0.0594 - accuracy: 0.982061/61 [==============================] - 0s 8ms/step - loss: 0.0594 - accuracy: 0.9820 - val_loss: 0.0393 - val_accuracy: 0.9893
Epoch 14/15
 1/61 [..............................] - ETA: 0s - loss: 0.0483 - accuracy: 0.9799 9/61 [===>..........................] - ETA: 0s - loss: 0.0596 - accuracy: 0.980217/61 [=======>......................] - ETA: 0s - loss: 0.0594 - accuracy: 0.980925/61 [===========>..................] - ETA: 0s - loss: 0.0589 - accuracy: 0.981333/61 [===============>..............] - ETA: 0s - loss: 0.0588 - accuracy: 0.981541/61 [===================>..........] - ETA: 0s - loss: 0.0584 - accuracy: 0.981749/61 [=======================>......] - ETA: 0s - loss: 0.0582 - accuracy: 0.981957/61 [===========================>..] - ETA: 0s - loss: 0.0580 - accuracy: 0.982061/61 [==============================] - 0s 8ms/step - loss: 0.0579 - accuracy: 0.9820 - val_loss: 0.0379 - val_accuracy: 0.9895
Epoch 15/15
 1/61 [..............................] - ETA: 0s - loss: 0.0639 - accuracy: 0.9788 9/61 [===>..........................] - ETA: 0s - loss: 0.0515 - accuracy: 0.982617/61 [=======>......................] - ETA: 0s - loss: 0.0516 - accuracy: 0.983125/61 [===========>..................] - ETA: 0s - loss: 0.0518 - accuracy: 0.983433/61 [===============>..............] - ETA: 0s - loss: 0.0526 - accuracy: 0.983541/61 [===================>..........] - ETA: 0s - loss: 0.0531 - accuracy: 0.983549/61 [=======================>......] - ETA: 0s - loss: 0.0534 - accuracy: 0.983557/61 [===========================>..] - ETA: 0s - loss: 0.0536 - accuracy: 0.983561/61 [==============================] - 0s 8ms/step - loss: 0.0538 - accuracy: 0.9835 - val_loss: 0.0379 - val_accuracy: 0.9895
training_time: 0:00:12.945927
Test loss: 0.03371011093258858
Test accuracy: 0.9879000186920166
