Number of devices: 7
batch_size_per_replica: 128
batch_size: 896 = 128 * 7
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
x_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
<class 'numpy.ndarray'> <class 'numpy.ndarray'>
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 26, 26, 32)        320       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 13, 13, 32)        0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 11, 11, 64)        18496     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 5, 5, 64)          0         
_________________________________________________________________
flatten (Flatten)            (None, 1600)              0         
_________________________________________________________________
dropout (Dropout)            (None, 1600)              0         
_________________________________________________________________
dense (Dense)                (None, 10)                16010     
=================================================================
Total params: 34,826
Trainable params: 34,826
Non-trainable params: 0
_________________________________________________________________
Epoch 1/15
 1/61 [..............................] - ETA: 2:42 - loss: 2.3071 - accuracy: 0.0993 2/61 [..............................] - ETA: 5s - loss: 2.3012 - accuracy: 0.1130   3/61 [>.............................] - ETA: 4s - loss: 2.2955 - accuracy: 0.1242 4/61 [>.............................] - ETA: 4s - loss: 2.2890 - accuracy: 0.1371 6/61 [=>............................] - ETA: 3s - loss: 2.2761 - accuracy: 0.1591 8/61 [==>...........................] - ETA: 3s - loss: 2.2623 - accuracy: 0.181216/61 [======>.......................] - ETA: 1s - loss: 2.1938 - accuracy: 0.255824/61 [==========>...................] - ETA: 0s - loss: 2.1021 - accuracy: 0.307932/61 [==============>...............] - ETA: 0s - loss: 2.0017 - accuracy: 0.348040/61 [==================>...........] - ETA: 0s - loss: 1.9085 - accuracy: 0.380148/61 [======================>.......] - ETA: 0s - loss: 1.8255 - accuracy: 0.407056/61 [==========================>...] - ETA: 0s - loss: 1.7524 - accuracy: 0.430061/61 [==============================] - ETA: 0s - loss: 1.7113 - accuracy: 0.442761/61 [==============================] - 4s 24ms/step - loss: 1.7036 - accuracy: 0.4450 - val_loss: 0.6424 - val_accuracy: 0.7607
Epoch 2/15
 1/61 [..............................] - ETA: 0s - loss: 0.6979 - accuracy: 0.7533 9/61 [===>..........................] - ETA: 0s - loss: 0.7080 - accuracy: 0.747117/61 [=======>......................] - ETA: 0s - loss: 0.6956 - accuracy: 0.749324/61 [==========>...................] - ETA: 0s - loss: 0.6877 - accuracy: 0.750830/61 [=============>................] - ETA: 0s - loss: 0.6823 - accuracy: 0.751937/61 [=================>............] - ETA: 0s - loss: 0.6768 - accuracy: 0.753344/61 [====================>.........] - ETA: 0s - loss: 0.6716 - accuracy: 0.754852/61 [========================>.....] - ETA: 0s - loss: 0.6659 - accuracy: 0.756460/61 [============================>.] - ETA: 0s - loss: 0.6607 - accuracy: 0.758061/61 [==============================] - ETA: 0s - loss: 0.6600 - accuracy: 0.758261/61 [==============================] - 1s 10ms/step - loss: 0.6594 - accuracy: 0.7584 - val_loss: 0.5092 - val_accuracy: 0.8097
Epoch 3/15
 1/61 [..............................] - ETA: 0s - loss: 0.5772 - accuracy: 0.7935 9/61 [===>..........................] - ETA: 0s - loss: 0.5805 - accuracy: 0.789617/61 [=======>......................] - ETA: 0s - loss: 0.5696 - accuracy: 0.792825/61 [===========>..................] - ETA: 0s - loss: 0.5621 - accuracy: 0.795233/61 [===============>..............] - ETA: 0s - loss: 0.5573 - accuracy: 0.796841/61 [===================>..........] - ETA: 0s - loss: 0.5531 - accuracy: 0.798349/61 [=======================>......] - ETA: 0s - loss: 0.5500 - accuracy: 0.799457/61 [===========================>..] - ETA: 0s - loss: 0.5475 - accuracy: 0.800261/61 [==============================] - 0s 8ms/step - loss: 0.5462 - accuracy: 0.8007 - val_loss: 0.4598 - val_accuracy: 0.8392
Epoch 4/15
 1/61 [..............................] - ETA: 0s - loss: 0.4742 - accuracy: 0.8292 9/61 [===>..........................] - ETA: 0s - loss: 0.4860 - accuracy: 0.824517/61 [=======>......................] - ETA: 0s - loss: 0.4843 - accuracy: 0.824525/61 [===========>..................] - ETA: 0s - loss: 0.4853 - accuracy: 0.823633/61 [===============>..............] - ETA: 0s - loss: 0.4855 - accuracy: 0.823538/61 [=================>............] - ETA: 0s - loss: 0.4850 - accuracy: 0.823642/61 [===================>..........] - ETA: 0s - loss: 0.4848 - accuracy: 0.823743/61 [====================>.........] - ETA: 0s - loss: 0.4847 - accuracy: 0.823745/61 [=====================>........] - ETA: 0s - loss: 0.4846 - accuracy: 0.823846/61 [=====================>........] - ETA: 0s - loss: 0.4846 - accuracy: 0.823848/61 [======================>.......] - ETA: 0s - loss: 0.4845 - accuracy: 0.823850/61 [=======================>......] - ETA: 0s - loss: 0.4844 - accuracy: 0.823954/61 [=========================>....] - ETA: 0s - loss: 0.4843 - accuracy: 0.823956/61 [==========================>...] - ETA: 0s - loss: 0.4842 - accuracy: 0.824057/61 [===========================>..] - ETA: 0s - loss: 0.4841 - accuracy: 0.824059/61 [============================>.] - ETA: 0s - loss: 0.4840 - accuracy: 0.824161/61 [==============================] - 1s 19ms/step - loss: 0.4839 - accuracy: 0.8241 - val_loss: 0.4238 - val_accuracy: 0.8513
Epoch 5/15
 1/61 [..............................] - ETA: 0s - loss: 0.4724 - accuracy: 0.8359 5/61 [=>............................] - ETA: 1s - loss: 0.4656 - accuracy: 0.8322 8/61 [==>...........................] - ETA: 0s - loss: 0.4632 - accuracy: 0.832213/61 [=====>........................] - ETA: 0s - loss: 0.4575 - accuracy: 0.833619/61 [========>.....................] - ETA: 0s - loss: 0.4551 - accuracy: 0.834525/61 [===========>..................] - ETA: 0s - loss: 0.4552 - accuracy: 0.834830/61 [=============>................] - ETA: 0s - loss: 0.4552 - accuracy: 0.834932/61 [==============>...............] - ETA: 0s - loss: 0.4552 - accuracy: 0.835034/61 [===============>..............] - ETA: 0s - loss: 0.4551 - accuracy: 0.835038/61 [=================>............] - ETA: 0s - loss: 0.4551 - accuracy: 0.835144/61 [====================>.........] - ETA: 0s - loss: 0.4549 - accuracy: 0.835247/61 [======================>.......] - ETA: 0s - loss: 0.4548 - accuracy: 0.835355/61 [==========================>...] - ETA: 0s - loss: 0.4544 - accuracy: 0.835461/61 [==============================] - 1s 16ms/step - loss: 0.4541 - accuracy: 0.8356 - val_loss: 0.4025 - val_accuracy: 0.8582
Epoch 6/15
 1/61 [..............................] - ETA: 0s - loss: 0.4415 - accuracy: 0.8371 5/61 [=>............................] - ETA: 0s - loss: 0.4432 - accuracy: 0.841413/61 [=====>........................] - ETA: 0s - loss: 0.4355 - accuracy: 0.846317/61 [=======>......................] - ETA: 0s - loss: 0.4354 - accuracy: 0.846924/61 [==========>...................] - ETA: 0s - loss: 0.4354 - accuracy: 0.847031/61 [==============>...............] - ETA: 0s - loss: 0.4348 - accuracy: 0.847237/61 [=================>............] - ETA: 0s - loss: 0.4342 - accuracy: 0.847440/61 [==================>...........] - ETA: 0s - loss: 0.4339 - accuracy: 0.847443/61 [====================>.........] - ETA: 0s - loss: 0.4335 - accuracy: 0.847651/61 [========================>.....] - ETA: 0s - loss: 0.4328 - accuracy: 0.847756/61 [==========================>...] - ETA: 0s - loss: 0.4325 - accuracy: 0.847760/61 [============================>.] - ETA: 0s - loss: 0.4324 - accuracy: 0.847761/61 [==============================] - 1s 13ms/step - loss: 0.4323 - accuracy: 0.8477 - val_loss: 0.3836 - val_accuracy: 0.8637
Epoch 7/15
 1/61 [..............................] - ETA: 0s - loss: 0.4188 - accuracy: 0.8482 4/61 [>.............................] - ETA: 1s - loss: 0.4210 - accuracy: 0.8523 9/61 [===>..........................] - ETA: 0s - loss: 0.4204 - accuracy: 0.852312/61 [====>.........................] - ETA: 0s - loss: 0.4195 - accuracy: 0.852718/61 [=======>......................] - ETA: 0s - loss: 0.4174 - accuracy: 0.853622/61 [=========>....................] - ETA: 0s - loss: 0.4164 - accuracy: 0.853926/61 [===========>..................] - ETA: 0s - loss: 0.4154 - accuracy: 0.854130/61 [=============>................] - ETA: 0s - loss: 0.4144 - accuracy: 0.854237/61 [=================>............] - ETA: 0s - loss: 0.4136 - accuracy: 0.854141/61 [===================>..........] - ETA: 0s - loss: 0.4135 - accuracy: 0.854045/61 [=====================>........] - ETA: 0s - loss: 0.4136 - accuracy: 0.853846/61 [=====================>........] - ETA: 0s - loss: 0.4137 - accuracy: 0.853848/61 [======================>.......] - ETA: 0s - loss: 0.4137 - accuracy: 0.853751/61 [========================>.....] - ETA: 0s - loss: 0.4137 - accuracy: 0.853754/61 [=========================>....] - ETA: 0s - loss: 0.4136 - accuracy: 0.853757/61 [===========================>..] - ETA: 0s - loss: 0.4136 - accuracy: 0.853661/61 [==============================] - 1s 19ms/step - loss: 0.4135 - accuracy: 0.8536 - val_loss: 0.3729 - val_accuracy: 0.8640
Epoch 8/15
 1/61 [..............................] - ETA: 0s - loss: 0.4862 - accuracy: 0.8449 6/61 [=>............................] - ETA: 0s - loss: 0.4271 - accuracy: 0.854114/61 [=====>........................] - ETA: 0s - loss: 0.4143 - accuracy: 0.855322/61 [=========>....................] - ETA: 0s - loss: 0.4118 - accuracy: 0.855330/61 [=============>................] - ETA: 0s - loss: 0.4106 - accuracy: 0.855438/61 [=================>............] - ETA: 0s - loss: 0.4098 - accuracy: 0.855446/61 [=====================>........] - ETA: 0s - loss: 0.4089 - accuracy: 0.855654/61 [=========================>....] - ETA: 0s - loss: 0.4079 - accuracy: 0.855861/61 [==============================] - ETA: 0s - loss: 0.4070 - accuracy: 0.856161/61 [==============================] - 1s 9ms/step - loss: 0.4069 - accuracy: 0.8561 - val_loss: 0.3570 - val_accuracy: 0.8725
Epoch 9/15
 1/61 [..............................] - ETA: 0s - loss: 0.4570 - accuracy: 0.8359 9/61 [===>..........................] - ETA: 0s - loss: 0.4085 - accuracy: 0.852217/61 [=======>......................] - ETA: 0s - loss: 0.4029 - accuracy: 0.855325/61 [===========>..................] - ETA: 0s - loss: 0.4001 - accuracy: 0.856433/61 [===============>..............] - ETA: 0s - loss: 0.3985 - accuracy: 0.857141/61 [===================>..........] - ETA: 0s - loss: 0.3969 - accuracy: 0.857747/61 [======================>.......] - ETA: 0s - loss: 0.3957 - accuracy: 0.858154/61 [=========================>....] - ETA: 0s - loss: 0.3944 - accuracy: 0.858661/61 [==============================] - ETA: 0s - loss: 0.3933 - accuracy: 0.859161/61 [==============================] - 1s 9ms/step - loss: 0.3931 - accuracy: 0.8592 - val_loss: 0.3587 - val_accuracy: 0.8692
Epoch 10/15
 1/61 [..............................] - ETA: 0s - loss: 0.4096 - accuracy: 0.8493 8/61 [==>...........................] - ETA: 0s - loss: 0.3947 - accuracy: 0.858315/61 [======>.......................] - ETA: 0s - loss: 0.3917 - accuracy: 0.859423/61 [==========>...................] - ETA: 0s - loss: 0.3888 - accuracy: 0.860726/61 [===========>..................] - ETA: 0s - loss: 0.3880 - accuracy: 0.861232/61 [==============>...............] - ETA: 0s - loss: 0.3865 - accuracy: 0.862039/61 [==================>...........] - ETA: 0s - loss: 0.3854 - accuracy: 0.862644/61 [====================>.........] - ETA: 0s - loss: 0.3847 - accuracy: 0.862949/61 [=======================>......] - ETA: 0s - loss: 0.3842 - accuracy: 0.863253/61 [=========================>....] - ETA: 0s - loss: 0.3838 - accuracy: 0.863459/61 [============================>.] - ETA: 0s - loss: 0.3833 - accuracy: 0.863761/61 [==============================] - 1s 14ms/step - loss: 0.3830 - accuracy: 0.8639 - val_loss: 0.3414 - val_accuracy: 0.8762
Epoch 11/15
 1/61 [..............................] - ETA: 0s - loss: 0.3673 - accuracy: 0.8739 6/61 [=>............................] - ETA: 0s - loss: 0.3845 - accuracy: 0.865213/61 [=====>........................] - ETA: 0s - loss: 0.3797 - accuracy: 0.867117/61 [=======>......................] - ETA: 0s - loss: 0.3781 - accuracy: 0.867924/61 [==========>...................] - ETA: 0s - loss: 0.3772 - accuracy: 0.868229/61 [=============>................] - ETA: 0s - loss: 0.3762 - accuracy: 0.868436/61 [================>.............] - ETA: 0s - loss: 0.3756 - accuracy: 0.868340/61 [==================>...........] - ETA: 0s - loss: 0.3753 - accuracy: 0.868345/61 [=====================>........] - ETA: 0s - loss: 0.3750 - accuracy: 0.868252/61 [========================>.....] - ETA: 0s - loss: 0.3745 - accuracy: 0.868160/61 [============================>.] - ETA: 0s - loss: 0.3738 - accuracy: 0.868261/61 [==============================] - 1s 11ms/step - loss: 0.3736 - accuracy: 0.8682 - val_loss: 0.3375 - val_accuracy: 0.8812
Epoch 12/15
 1/61 [..............................] - ETA: 0s - loss: 0.3727 - accuracy: 0.8583 9/61 [===>..........................] - ETA: 0s - loss: 0.3728 - accuracy: 0.862117/61 [=======>......................] - ETA: 0s - loss: 0.3710 - accuracy: 0.862825/61 [===========>..................] - ETA: 0s - loss: 0.3699 - accuracy: 0.863432/61 [==============>...............] - ETA: 0s - loss: 0.3686 - accuracy: 0.864438/61 [=================>............] - ETA: 0s - loss: 0.3676 - accuracy: 0.865145/61 [=====================>........] - ETA: 0s - loss: 0.3667 - accuracy: 0.865751/61 [========================>.....] - ETA: 0s - loss: 0.3661 - accuracy: 0.866159/61 [============================>.] - ETA: 0s - loss: 0.3652 - accuracy: 0.866661/61 [==============================] - 1s 9ms/step - loss: 0.3649 - accuracy: 0.8667 - val_loss: 0.3296 - val_accuracy: 0.8795
Epoch 13/15
 1/61 [..............................] - ETA: 0s - loss: 0.2962 - accuracy: 0.9074 9/61 [===>..........................] - ETA: 0s - loss: 0.3363 - accuracy: 0.882617/61 [=======>......................] - ETA: 0s - loss: 0.3427 - accuracy: 0.879724/61 [==========>...................] - ETA: 0s - loss: 0.3465 - accuracy: 0.878132/61 [==============>...............] - ETA: 0s - loss: 0.3493 - accuracy: 0.876940/61 [==================>...........] - ETA: 0s - loss: 0.3511 - accuracy: 0.875948/61 [======================>.......] - ETA: 0s - loss: 0.3522 - accuracy: 0.875256/61 [==========================>...] - ETA: 0s - loss: 0.3528 - accuracy: 0.874761/61 [==============================] - 1s 8ms/step - loss: 0.3529 - accuracy: 0.8745 - val_loss: 0.3281 - val_accuracy: 0.8833
Epoch 14/15
 1/61 [..............................] - ETA: 0s - loss: 0.3011 - accuracy: 0.8917 9/61 [===>..........................] - ETA: 0s - loss: 0.3418 - accuracy: 0.880417/61 [=======>......................] - ETA: 0s - loss: 0.3446 - accuracy: 0.879325/61 [===========>..................] - ETA: 0s - loss: 0.3458 - accuracy: 0.878633/61 [===============>..............] - ETA: 0s - loss: 0.3465 - accuracy: 0.878040/61 [==================>...........] - ETA: 0s - loss: 0.3470 - accuracy: 0.877448/61 [======================>.......] - ETA: 0s - loss: 0.3472 - accuracy: 0.877156/61 [==========================>...] - ETA: 0s - loss: 0.3476 - accuracy: 0.876861/61 [==============================] - 1s 8ms/step - loss: 0.3478 - accuracy: 0.8766 - val_loss: 0.3216 - val_accuracy: 0.8842
Epoch 15/15
 1/61 [..............................] - ETA: 0s - loss: 0.3453 - accuracy: 0.8783 9/61 [===>..........................] - ETA: 0s - loss: 0.3392 - accuracy: 0.883617/61 [=======>......................] - ETA: 0s - loss: 0.3393 - accuracy: 0.883024/61 [==========>...................] - ETA: 0s - loss: 0.3388 - accuracy: 0.882432/61 [==============>...............] - ETA: 0s - loss: 0.3388 - accuracy: 0.881740/61 [==================>...........] - ETA: 0s - loss: 0.3388 - accuracy: 0.881348/61 [======================>.......] - ETA: 0s - loss: 0.3390 - accuracy: 0.880955/61 [==========================>...] - ETA: 0s - loss: 0.3393 - accuracy: 0.880661/61 [==============================] - 0s 8ms/step - loss: 0.3397 - accuracy: 0.8803 - val_loss: 0.3149 - val_accuracy: 0.8863
training_time: 0:00:14.218307
Test loss: 0.3331039249897003
Test accuracy: 0.8823000192642212
