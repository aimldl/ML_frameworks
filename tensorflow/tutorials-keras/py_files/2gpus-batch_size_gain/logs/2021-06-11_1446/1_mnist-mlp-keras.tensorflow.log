Number of devices: 2
batch_size_per_replica: 250
batch_size: 500 = 250 * 2
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
60000 10000
Epoch 1/20
 1/96 [..............................] - ETA: 6:05 - loss: 96.3445 - accuracy: 0.136015/96 [===>..........................] - ETA: 0s - loss: 40.2215 - accuracy: 0.3008  29/96 [========>.....................] - ETA: 0s - loss: 27.4149 - accuracy: 0.329644/96 [============>.................] - ETA: 0s - loss: 21.1048 - accuracy: 0.336559/96 [=================>............] - ETA: 0s - loss: 17.4609 - accuracy: 0.343973/96 [=====================>........] - ETA: 0s - loss: 15.1855 - accuracy: 0.354087/96 [==========================>...] - ETA: 0s - loss: 13.5215 - accuracy: 0.367396/96 [==============================] - 6s 21ms/step - loss: 12.5770 - accuracy: 0.3771 - val_loss: 1.0006 - val_accuracy: 0.6878
Epoch 2/20
 1/96 [..............................] - ETA: 0s - loss: 1.0818 - accuracy: 0.646015/96 [===>..........................] - ETA: 0s - loss: 0.9822 - accuracy: 0.685130/96 [========>.....................] - ETA: 0s - loss: 0.9595 - accuracy: 0.695044/96 [============>.................] - ETA: 0s - loss: 0.9434 - accuracy: 0.706158/96 [=================>............] - ETA: 0s - loss: 0.9288 - accuracy: 0.717073/96 [=====================>........] - ETA: 0s - loss: 0.9143 - accuracy: 0.727087/96 [==========================>...] - ETA: 0s - loss: 0.9005 - accuracy: 0.735396/96 [==============================] - 1s 6ms/step - loss: 0.8917 - accuracy: 0.7404 - val_loss: 0.6805 - val_accuracy: 0.8400
Epoch 3/20
 1/96 [..............................] - ETA: 0s - loss: 0.6444 - accuracy: 0.836015/96 [===>..........................] - ETA: 0s - loss: 0.6230 - accuracy: 0.836729/96 [========>.....................] - ETA: 0s - loss: 0.6175 - accuracy: 0.841643/96 [============>.................] - ETA: 0s - loss: 0.6135 - accuracy: 0.843157/96 [================>.............] - ETA: 0s - loss: 0.6091 - accuracy: 0.844372/96 [=====================>........] - ETA: 0s - loss: 0.6045 - accuracy: 0.845687/96 [==========================>...] - ETA: 0s - loss: 0.6010 - accuracy: 0.846796/96 [==============================] - 1s 5ms/step - loss: 0.5987 - accuracy: 0.8473 - val_loss: 0.5253 - val_accuracy: 0.8868
Epoch 4/20
 1/96 [..............................] - ETA: 0s - loss: 0.4578 - accuracy: 0.868015/96 [===>..........................] - ETA: 0s - loss: 0.4320 - accuracy: 0.885529/96 [========>.....................] - ETA: 0s - loss: 0.4351 - accuracy: 0.883743/96 [============>.................] - ETA: 0s - loss: 0.4387 - accuracy: 0.882958/96 [=================>............] - ETA: 0s - loss: 0.4398 - accuracy: 0.882473/96 [=====================>........] - ETA: 0s - loss: 0.4393 - accuracy: 0.882888/96 [==========================>...] - ETA: 0s - loss: 0.4379 - accuracy: 0.883396/96 [==============================] - 1s 6ms/step - loss: 0.4368 - accuracy: 0.8836 - val_loss: 0.4143 - val_accuracy: 0.9003
Epoch 5/20
 1/96 [..............................] - ETA: 0s - loss: 0.4382 - accuracy: 0.888015/96 [===>..........................] - ETA: 0s - loss: 0.3645 - accuracy: 0.899729/96 [========>.....................] - ETA: 0s - loss: 0.3533 - accuracy: 0.901343/96 [============>.................] - ETA: 0s - loss: 0.3492 - accuracy: 0.901957/96 [================>.............] - ETA: 0s - loss: 0.3468 - accuracy: 0.902271/96 [=====================>........] - ETA: 0s - loss: 0.3463 - accuracy: 0.902385/96 [=========================>....] - ETA: 0s - loss: 0.3459 - accuracy: 0.902696/96 [==============================] - 1s 6ms/step - loss: 0.3452 - accuracy: 0.9028 - val_loss: 0.3861 - val_accuracy: 0.9145
Epoch 6/20
 1/96 [..............................] - ETA: 0s - loss: 0.3285 - accuracy: 0.894015/96 [===>..........................] - ETA: 0s - loss: 0.2863 - accuracy: 0.915429/96 [========>.....................] - ETA: 0s - loss: 0.2859 - accuracy: 0.916543/96 [============>.................] - ETA: 0s - loss: 0.2866 - accuracy: 0.916957/96 [================>.............] - ETA: 0s - loss: 0.2870 - accuracy: 0.917171/96 [=====================>........] - ETA: 0s - loss: 0.2872 - accuracy: 0.917385/96 [=========================>....] - ETA: 0s - loss: 0.2871 - accuracy: 0.917696/96 [==============================] - 1s 6ms/step - loss: 0.2872 - accuracy: 0.9177 - val_loss: 0.3966 - val_accuracy: 0.9185
Epoch 7/20
 1/96 [..............................] - ETA: 0s - loss: 0.2515 - accuracy: 0.930015/96 [===>..........................] - ETA: 0s - loss: 0.2438 - accuracy: 0.934029/96 [========>.....................] - ETA: 0s - loss: 0.2381 - accuracy: 0.935143/96 [============>.................] - ETA: 0s - loss: 0.2373 - accuracy: 0.934458/96 [=================>............] - ETA: 0s - loss: 0.2384 - accuracy: 0.933472/96 [=====================>........] - ETA: 0s - loss: 0.2398 - accuracy: 0.932887/96 [==========================>...] - ETA: 0s - loss: 0.2408 - accuracy: 0.932496/96 [==============================] - 1s 5ms/step - loss: 0.2413 - accuracy: 0.9323 - val_loss: 0.3328 - val_accuracy: 0.9310
Epoch 8/20
 1/96 [..............................] - ETA: 0s - loss: 0.2650 - accuracy: 0.924015/96 [===>..........................] - ETA: 0s - loss: 0.2163 - accuracy: 0.937130/96 [========>.....................] - ETA: 0s - loss: 0.2101 - accuracy: 0.938444/96 [============>.................] - ETA: 0s - loss: 0.2095 - accuracy: 0.938659/96 [=================>............] - ETA: 0s - loss: 0.2101 - accuracy: 0.938473/96 [=====================>........] - ETA: 0s - loss: 0.2099 - accuracy: 0.938587/96 [==========================>...] - ETA: 0s - loss: 0.2095 - accuracy: 0.938696/96 [==============================] - 1s 6ms/step - loss: 0.2094 - accuracy: 0.9387 - val_loss: 0.3084 - val_accuracy: 0.9390
Epoch 9/20
 1/96 [..............................] - ETA: 0s - loss: 0.1854 - accuracy: 0.946015/96 [===>..........................] - ETA: 0s - loss: 0.1824 - accuracy: 0.948529/96 [========>.....................] - ETA: 0s - loss: 0.1825 - accuracy: 0.947943/96 [============>.................] - ETA: 0s - loss: 0.1808 - accuracy: 0.947957/96 [================>.............] - ETA: 0s - loss: 0.1800 - accuracy: 0.947971/96 [=====================>........] - ETA: 0s - loss: 0.1793 - accuracy: 0.948085/96 [=========================>....] - ETA: 0s - loss: 0.1788 - accuracy: 0.948196/96 [==============================] - 1s 5ms/step - loss: 0.1786 - accuracy: 0.9481 - val_loss: 0.3241 - val_accuracy: 0.9413
Epoch 10/20
 1/96 [..............................] - ETA: 0s - loss: 0.1489 - accuracy: 0.964016/96 [====>.........................] - ETA: 0s - loss: 0.1512 - accuracy: 0.959431/96 [========>.....................] - ETA: 0s - loss: 0.1528 - accuracy: 0.957245/96 [=============>................] - ETA: 0s - loss: 0.1539 - accuracy: 0.956260/96 [=================>............] - ETA: 0s - loss: 0.1548 - accuracy: 0.955774/96 [======================>.......] - ETA: 0s - loss: 0.1556 - accuracy: 0.955488/96 [==========================>...] - ETA: 0s - loss: 0.1561 - accuracy: 0.955196/96 [==============================] - 1s 5ms/step - loss: 0.1564 - accuracy: 0.9550 - val_loss: 0.3182 - val_accuracy: 0.9464
Epoch 11/20
 1/96 [..............................] - ETA: 0s - loss: 0.1375 - accuracy: 0.962015/96 [===>..........................] - ETA: 0s - loss: 0.1318 - accuracy: 0.962229/96 [========>.....................] - ETA: 0s - loss: 0.1330 - accuracy: 0.961344/96 [============>.................] - ETA: 0s - loss: 0.1347 - accuracy: 0.960558/96 [=================>............] - ETA: 0s - loss: 0.1358 - accuracy: 0.960172/96 [=====================>........] - ETA: 0s - loss: 0.1360 - accuracy: 0.960086/96 [=========================>....] - ETA: 0s - loss: 0.1361 - accuracy: 0.959996/96 [==============================] - 1s 6ms/step - loss: 0.1363 - accuracy: 0.9598 - val_loss: 0.2805 - val_accuracy: 0.9469
Epoch 12/20
 1/96 [..............................] - ETA: 0s - loss: 0.1305 - accuracy: 0.956016/96 [====>.........................] - ETA: 0s - loss: 0.1202 - accuracy: 0.961630/96 [========>.....................] - ETA: 0s - loss: 0.1215 - accuracy: 0.962244/96 [============>.................] - ETA: 0s - loss: 0.1220 - accuracy: 0.962658/96 [=================>............] - ETA: 0s - loss: 0.1215 - accuracy: 0.963072/96 [=====================>........] - ETA: 0s - loss: 0.1211 - accuracy: 0.963386/96 [=========================>....] - ETA: 0s - loss: 0.1212 - accuracy: 0.963496/96 [==============================] - 1s 5ms/step - loss: 0.1213 - accuracy: 0.9635 - val_loss: 0.2893 - val_accuracy: 0.9475
Epoch 13/20
 1/96 [..............................] - ETA: 0s - loss: 0.0893 - accuracy: 0.972016/96 [====>.........................] - ETA: 0s - loss: 0.1099 - accuracy: 0.965330/96 [========>.....................] - ETA: 0s - loss: 0.1099 - accuracy: 0.965544/96 [============>.................] - ETA: 0s - loss: 0.1110 - accuracy: 0.965259/96 [=================>............] - ETA: 0s - loss: 0.1109 - accuracy: 0.965373/96 [=====================>........] - ETA: 0s - loss: 0.1108 - accuracy: 0.965488/96 [==========================>...] - ETA: 0s - loss: 0.1111 - accuracy: 0.965496/96 [==============================] - 1s 5ms/step - loss: 0.1113 - accuracy: 0.9654 - val_loss: 0.2939 - val_accuracy: 0.9486
Epoch 14/20
 1/96 [..............................] - ETA: 0s - loss: 0.0800 - accuracy: 0.970016/96 [====>.........................] - ETA: 0s - loss: 0.0923 - accuracy: 0.971330/96 [========>.....................] - ETA: 0s - loss: 0.1001 - accuracy: 0.969144/96 [============>.................] - ETA: 0s - loss: 0.1024 - accuracy: 0.968659/96 [=================>............] - ETA: 0s - loss: 0.1031 - accuracy: 0.968573/96 [=====================>........] - ETA: 0s - loss: 0.1032 - accuracy: 0.968587/96 [==========================>...] - ETA: 0s - loss: 0.1031 - accuracy: 0.968696/96 [==============================] - 1s 5ms/step - loss: 0.1029 - accuracy: 0.9687 - val_loss: 0.2760 - val_accuracy: 0.9519
Epoch 15/20
 1/96 [..............................] - ETA: 0s - loss: 0.1144 - accuracy: 0.960015/96 [===>..........................] - ETA: 0s - loss: 0.0857 - accuracy: 0.972629/96 [========>.....................] - ETA: 0s - loss: 0.0861 - accuracy: 0.973144/96 [============>.................] - ETA: 0s - loss: 0.0871 - accuracy: 0.972959/96 [=================>............] - ETA: 0s - loss: 0.0882 - accuracy: 0.972674/96 [======================>.......] - ETA: 0s - loss: 0.0890 - accuracy: 0.972489/96 [==========================>...] - ETA: 0s - loss: 0.0894 - accuracy: 0.972496/96 [==============================] - 1s 5ms/step - loss: 0.0898 - accuracy: 0.9723 - val_loss: 0.2957 - val_accuracy: 0.9490
Epoch 16/20
 1/96 [..............................] - ETA: 0s - loss: 0.1041 - accuracy: 0.968015/96 [===>..........................] - ETA: 0s - loss: 0.1107 - accuracy: 0.968529/96 [========>.....................] - ETA: 0s - loss: 0.1022 - accuracy: 0.970043/96 [============>.................] - ETA: 0s - loss: 0.0971 - accuracy: 0.971357/96 [================>.............] - ETA: 0s - loss: 0.0946 - accuracy: 0.971871/96 [=====================>........] - ETA: 0s - loss: 0.0929 - accuracy: 0.972386/96 [=========================>....] - ETA: 0s - loss: 0.0914 - accuracy: 0.972796/96 [==============================] - 1s 5ms/step - loss: 0.0907 - accuracy: 0.9729 - val_loss: 0.2796 - val_accuracy: 0.9547
Epoch 17/20
 1/96 [..............................] - ETA: 0s - loss: 0.0988 - accuracy: 0.970015/96 [===>..........................] - ETA: 0s - loss: 0.0818 - accuracy: 0.975829/96 [========>.....................] - ETA: 0s - loss: 0.0812 - accuracy: 0.975844/96 [============>.................] - ETA: 0s - loss: 0.0799 - accuracy: 0.976258/96 [=================>............] - ETA: 0s - loss: 0.0794 - accuracy: 0.976372/96 [=====================>........] - ETA: 0s - loss: 0.0792 - accuracy: 0.976586/96 [=========================>....] - ETA: 0s - loss: 0.0788 - accuracy: 0.976796/96 [==============================] - 1s 6ms/step - loss: 0.0786 - accuracy: 0.9768 - val_loss: 0.2889 - val_accuracy: 0.9572
Epoch 18/20
 1/96 [..............................] - ETA: 0s - loss: 0.0594 - accuracy: 0.986015/96 [===>..........................] - ETA: 0s - loss: 0.0682 - accuracy: 0.979628/96 [=======>......................] - ETA: 0s - loss: 0.0700 - accuracy: 0.978542/96 [============>.................] - ETA: 0s - loss: 0.0729 - accuracy: 0.977856/96 [================>.............] - ETA: 0s - loss: 0.0746 - accuracy: 0.977370/96 [====================>.........] - ETA: 0s - loss: 0.0755 - accuracy: 0.977284/96 [=========================>....] - ETA: 0s - loss: 0.0760 - accuracy: 0.977396/96 [==============================] - 1s 6ms/step - loss: 0.0764 - accuracy: 0.9773 - val_loss: 0.2833 - val_accuracy: 0.9558
Epoch 19/20
 1/96 [..............................] - ETA: 0s - loss: 0.1178 - accuracy: 0.972015/96 [===>..........................] - ETA: 0s - loss: 0.0776 - accuracy: 0.976730/96 [========>.....................] - ETA: 0s - loss: 0.0748 - accuracy: 0.977044/96 [============>.................] - ETA: 0s - loss: 0.0747 - accuracy: 0.977158/96 [=================>............] - ETA: 0s - loss: 0.0751 - accuracy: 0.977172/96 [=====================>........] - ETA: 0s - loss: 0.0752 - accuracy: 0.977186/96 [=========================>....] - ETA: 0s - loss: 0.0749 - accuracy: 0.977396/96 [==============================] - 1s 6ms/step - loss: 0.0746 - accuracy: 0.9774 - val_loss: 0.2749 - val_accuracy: 0.9606
Epoch 20/20
 1/96 [..............................] - ETA: 0s - loss: 0.0465 - accuracy: 0.988015/96 [===>..........................] - ETA: 0s - loss: 0.0558 - accuracy: 0.984329/96 [========>.....................] - ETA: 0s - loss: 0.0559 - accuracy: 0.983643/96 [============>.................] - ETA: 0s - loss: 0.0560 - accuracy: 0.983257/96 [================>.............] - ETA: 0s - loss: 0.0563 - accuracy: 0.983071/96 [=====================>........] - ETA: 0s - loss: 0.0567 - accuracy: 0.982885/96 [=========================>....] - ETA: 0s - loss: 0.0574 - accuracy: 0.982696/96 [==============================] - 1s 5ms/step - loss: 0.0582 - accuracy: 0.9824 - val_loss: 0.2787 - val_accuracy: 0.9578
training_time: 0:00:16.287032
  1/313 [..............................] - ETA: 7:50 - loss: 0.4027 - accuracy: 0.9375 14/313 [>.............................] - ETA: 1s - loss: 0.3426 - accuracy: 0.9643   28/313 [=>............................] - ETA: 1s - loss: 0.2571 - accuracy: 0.9632 42/313 [===>..........................] - ETA: 1s - loss: 0.3447 - accuracy: 0.9546 56/313 [====>.........................] - ETA: 0s - loss: 0.3673 - accuracy: 0.9520 70/313 [=====>........................] - ETA: 0s - loss: 0.3708 - accuracy: 0.9482 83/313 [======>.......................] - ETA: 0s - loss: 0.3949 - accuracy: 0.9462 97/313 [========>.....................] - ETA: 0s - loss: 0.3928 - accuracy: 0.9485111/313 [=========>....................] - ETA: 0s - loss: 0.3756 - accuracy: 0.9505125/313 [==========>...................] - ETA: 0s - loss: 0.4171 - accuracy: 0.9492139/313 [============>.................] - ETA: 0s - loss: 0.4173 - accuracy: 0.9481153/313 [=============>................] - ETA: 0s - loss: 0.4055 - accuracy: 0.9483167/313 [===============>..............] - ETA: 0s - loss: 0.3835 - accuracy: 0.9500181/313 [================>.............] - ETA: 0s - loss: 0.3689 - accuracy: 0.9523194/313 [=================>............] - ETA: 0s - loss: 0.3697 - accuracy: 0.9515207/313 [==================>...........] - ETA: 0s - loss: 0.3585 - accuracy: 0.9521220/313 [====================>.........] - ETA: 0s - loss: 0.3465 - accuracy: 0.9534234/313 [=====================>........] - ETA: 0s - loss: 0.3326 - accuracy: 0.9550247/313 [======================>.......] - ETA: 0s - loss: 0.3236 - accuracy: 0.9560260/313 [=======================>......] - ETA: 0s - loss: 0.3238 - accuracy: 0.9559273/313 [=========================>....] - ETA: 0s - loss: 0.3170 - accuracy: 0.9572286/313 [==========================>...] - ETA: 0s - loss: 0.3120 - accuracy: 0.9583299/313 [===========================>..] - ETA: 0s - loss: 0.3000 - accuracy: 0.9593312/313 [============================>.] - ETA: 0s - loss: 0.3086 - accuracy: 0.9581313/313 [==============================] - 3s 4ms/step - loss: 0.3081 - accuracy: 0.9582
Test results: Loss = 0.30812931060791016, Accuracy = 0.9581999778747559
