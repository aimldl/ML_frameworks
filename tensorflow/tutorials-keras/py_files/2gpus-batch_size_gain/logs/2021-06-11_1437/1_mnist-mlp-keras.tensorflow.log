Number of devices: 2
batch_size_per_replica: 250
batch_size: 500 = 250 * 2
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
60000 10000
Epoch 1/20
 1/96 [..............................] - ETA: 6:03 - loss: 117.7154 - accuracy: 0.116015/96 [===>..........................] - ETA: 0s - loss: 54.9153 - accuracy: 0.3318   30/96 [========>.....................] - ETA: 0s - loss: 37.7525 - accuracy: 0.425744/96 [============>.................] - ETA: 0s - loss: 29.9253 - accuracy: 0.462058/96 [=================>............] - ETA: 0s - loss: 25.0954 - accuracy: 0.481572/96 [=====================>........] - ETA: 0s - loss: 21.7799 - accuracy: 0.496486/96 [=========================>....] - ETA: 0s - loss: 19.3435 - accuracy: 0.509096/96 [==============================] - 6s 21ms/step - loss: 17.8331 - accuracy: 0.5182 - val_loss: 0.9115 - val_accuracy: 0.7398
Epoch 2/20
 1/96 [..............................] - ETA: 0s - loss: 0.9113 - accuracy: 0.704015/96 [===>..........................] - ETA: 0s - loss: 0.9048 - accuracy: 0.718729/96 [========>.....................] - ETA: 0s - loss: 0.8819 - accuracy: 0.729644/96 [============>.................] - ETA: 0s - loss: 0.8766 - accuracy: 0.737258/96 [=================>............] - ETA: 0s - loss: 0.8690 - accuracy: 0.742372/96 [=====================>........] - ETA: 0s - loss: 0.8586 - accuracy: 0.746586/96 [=========================>....] - ETA: 0s - loss: 0.8485 - accuracy: 0.750496/96 [==============================] - 1s 5ms/step - loss: 0.8409 - accuracy: 0.7532 - val_loss: 0.6538 - val_accuracy: 0.8138
Epoch 3/20
 1/96 [..............................] - ETA: 0s - loss: 0.5281 - accuracy: 0.836015/96 [===>..........................] - ETA: 0s - loss: 0.5691 - accuracy: 0.814329/96 [========>.....................] - ETA: 0s - loss: 0.5752 - accuracy: 0.816443/96 [============>.................] - ETA: 0s - loss: 0.5749 - accuracy: 0.819957/96 [================>.............] - ETA: 0s - loss: 0.5729 - accuracy: 0.822871/96 [=====================>........] - ETA: 0s - loss: 0.5708 - accuracy: 0.825385/96 [=========================>....] - ETA: 0s - loss: 0.5680 - accuracy: 0.827796/96 [==============================] - 1s 6ms/step - loss: 0.5658 - accuracy: 0.8294 - val_loss: 0.5222 - val_accuracy: 0.8747
Epoch 4/20
 1/96 [..............................] - ETA: 0s - loss: 0.4538 - accuracy: 0.866015/96 [===>..........................] - ETA: 0s - loss: 0.4513 - accuracy: 0.875730/96 [========>.....................] - ETA: 0s - loss: 0.4521 - accuracy: 0.874344/96 [============>.................] - ETA: 0s - loss: 0.4519 - accuracy: 0.872858/96 [=================>............] - ETA: 0s - loss: 0.4487 - accuracy: 0.873072/96 [=====================>........] - ETA: 0s - loss: 0.4462 - accuracy: 0.873786/96 [=========================>....] - ETA: 0s - loss: 0.4433 - accuracy: 0.874496/96 [==============================] - 1s 6ms/step - loss: 0.4410 - accuracy: 0.8751 - val_loss: 0.4594 - val_accuracy: 0.8974
Epoch 5/20
 1/96 [..............................] - ETA: 0s - loss: 0.3440 - accuracy: 0.906015/96 [===>..........................] - ETA: 0s - loss: 0.3342 - accuracy: 0.906129/96 [========>.....................] - ETA: 0s - loss: 0.3365 - accuracy: 0.903343/96 [============>.................] - ETA: 0s - loss: 0.3369 - accuracy: 0.901958/96 [=================>............] - ETA: 0s - loss: 0.3375 - accuracy: 0.901473/96 [=====================>........] - ETA: 0s - loss: 0.3381 - accuracy: 0.901088/96 [==========================>...] - ETA: 0s - loss: 0.3384 - accuracy: 0.900996/96 [==============================] - 1s 5ms/step - loss: 0.3385 - accuracy: 0.9009 - val_loss: 0.4529 - val_accuracy: 0.8998
Epoch 6/20
 1/96 [..............................] - ETA: 0s - loss: 0.3196 - accuracy: 0.912015/96 [===>..........................] - ETA: 0s - loss: 0.2971 - accuracy: 0.911529/96 [========>.....................] - ETA: 0s - loss: 0.2917 - accuracy: 0.912443/96 [============>.................] - ETA: 0s - loss: 0.2873 - accuracy: 0.913658/96 [=================>............] - ETA: 0s - loss: 0.2859 - accuracy: 0.914373/96 [=====================>........] - ETA: 0s - loss: 0.2855 - accuracy: 0.914787/96 [==========================>...] - ETA: 0s - loss: 0.2854 - accuracy: 0.915096/96 [==============================] - 1s 5ms/step - loss: 0.2855 - accuracy: 0.9152 - val_loss: 0.3987 - val_accuracy: 0.9174
Epoch 7/20
 1/96 [..............................] - ETA: 0s - loss: 0.1919 - accuracy: 0.942015/96 [===>..........................] - ETA: 0s - loss: 0.2224 - accuracy: 0.935029/96 [========>.....................] - ETA: 0s - loss: 0.2283 - accuracy: 0.933443/96 [============>.................] - ETA: 0s - loss: 0.2299 - accuracy: 0.932957/96 [================>.............] - ETA: 0s - loss: 0.2316 - accuracy: 0.932272/96 [=====================>........] - ETA: 0s - loss: 0.2332 - accuracy: 0.931687/96 [==========================>...] - ETA: 0s - loss: 0.2343 - accuracy: 0.931196/96 [==============================] - 1s 5ms/step - loss: 0.2347 - accuracy: 0.9309 - val_loss: 0.3739 - val_accuracy: 0.9280
Epoch 8/20
 1/96 [..............................] - ETA: 0s - loss: 0.2202 - accuracy: 0.926015/96 [===>..........................] - ETA: 0s - loss: 0.2087 - accuracy: 0.936829/96 [========>.....................] - ETA: 0s - loss: 0.2035 - accuracy: 0.937143/96 [============>.................] - ETA: 0s - loss: 0.2028 - accuracy: 0.937357/96 [================>.............] - ETA: 0s - loss: 0.2031 - accuracy: 0.937471/96 [=====================>........] - ETA: 0s - loss: 0.2034 - accuracy: 0.937685/96 [=========================>....] - ETA: 0s - loss: 0.2037 - accuracy: 0.937796/96 [==============================] - 1s 5ms/step - loss: 0.2041 - accuracy: 0.9377 - val_loss: 0.3480 - val_accuracy: 0.9307
Epoch 9/20
 1/96 [..............................] - ETA: 0s - loss: 0.2426 - accuracy: 0.940015/96 [===>..........................] - ETA: 0s - loss: 0.1872 - accuracy: 0.945029/96 [========>.....................] - ETA: 0s - loss: 0.1803 - accuracy: 0.946144/96 [============>.................] - ETA: 0s - loss: 0.1798 - accuracy: 0.946358/96 [=================>............] - ETA: 0s - loss: 0.1802 - accuracy: 0.946172/96 [=====================>........] - ETA: 0s - loss: 0.1801 - accuracy: 0.946086/96 [=========================>....] - ETA: 0s - loss: 0.1805 - accuracy: 0.945896/96 [==============================] - 1s 5ms/step - loss: 0.1810 - accuracy: 0.9456 - val_loss: 0.3273 - val_accuracy: 0.9356
Epoch 10/20
 1/96 [..............................] - ETA: 0s - loss: 0.1949 - accuracy: 0.938016/96 [====>.........................] - ETA: 0s - loss: 0.1741 - accuracy: 0.945030/96 [========>.....................] - ETA: 0s - loss: 0.1680 - accuracy: 0.946844/96 [============>.................] - ETA: 0s - loss: 0.1662 - accuracy: 0.947459/96 [=================>............] - ETA: 0s - loss: 0.1659 - accuracy: 0.947773/96 [=====================>........] - ETA: 0s - loss: 0.1660 - accuracy: 0.947888/96 [==========================>...] - ETA: 0s - loss: 0.1659 - accuracy: 0.947996/96 [==============================] - 1s 5ms/step - loss: 0.1660 - accuracy: 0.9479 - val_loss: 0.3243 - val_accuracy: 0.9307
Epoch 11/20
 1/96 [..............................] - ETA: 0s - loss: 0.1244 - accuracy: 0.966015/96 [===>..........................] - ETA: 0s - loss: 0.1446 - accuracy: 0.954630/96 [========>.....................] - ETA: 0s - loss: 0.1446 - accuracy: 0.953945/96 [=============>................] - ETA: 0s - loss: 0.1466 - accuracy: 0.953460/96 [=================>............] - ETA: 0s - loss: 0.1479 - accuracy: 0.953374/96 [======================>.......] - ETA: 0s - loss: 0.1488 - accuracy: 0.953288/96 [==========================>...] - ETA: 0s - loss: 0.1497 - accuracy: 0.953096/96 [==============================] - 1s 5ms/step - loss: 0.1502 - accuracy: 0.9529 - val_loss: 0.3119 - val_accuracy: 0.9413
Epoch 12/20
 1/96 [..............................] - ETA: 0s - loss: 0.1038 - accuracy: 0.968015/96 [===>..........................] - ETA: 0s - loss: 0.1283 - accuracy: 0.956129/96 [========>.....................] - ETA: 0s - loss: 0.1330 - accuracy: 0.956143/96 [============>.................] - ETA: 0s - loss: 0.1355 - accuracy: 0.955857/96 [================>.............] - ETA: 0s - loss: 0.1358 - accuracy: 0.956071/96 [=====================>........] - ETA: 0s - loss: 0.1356 - accuracy: 0.956385/96 [=========================>....] - ETA: 0s - loss: 0.1350 - accuracy: 0.956796/96 [==============================] - 1s 6ms/step - loss: 0.1349 - accuracy: 0.9569 - val_loss: 0.3150 - val_accuracy: 0.9398
Epoch 13/20
 1/96 [..............................] - ETA: 0s - loss: 0.1514 - accuracy: 0.956016/96 [====>.........................] - ETA: 0s - loss: 0.1419 - accuracy: 0.954330/96 [========>.....................] - ETA: 0s - loss: 0.1361 - accuracy: 0.956744/96 [============>.................] - ETA: 0s - loss: 0.1323 - accuracy: 0.958358/96 [=================>............] - ETA: 0s - loss: 0.1303 - accuracy: 0.959172/96 [=====================>........] - ETA: 0s - loss: 0.1292 - accuracy: 0.959687/96 [==========================>...] - ETA: 0s - loss: 0.1286 - accuracy: 0.959996/96 [==============================] - 1s 5ms/step - loss: 0.1285 - accuracy: 0.9600 - val_loss: 0.3218 - val_accuracy: 0.9403
Epoch 14/20
 1/96 [..............................] - ETA: 0s - loss: 0.1788 - accuracy: 0.948015/96 [===>..........................] - ETA: 0s - loss: 0.1196 - accuracy: 0.963429/96 [========>.....................] - ETA: 0s - loss: 0.1189 - accuracy: 0.963144/96 [============>.................] - ETA: 0s - loss: 0.1178 - accuracy: 0.963058/96 [=================>............] - ETA: 0s - loss: 0.1172 - accuracy: 0.963072/96 [=====================>........] - ETA: 0s - loss: 0.1168 - accuracy: 0.963086/96 [=========================>....] - ETA: 0s - loss: 0.1163 - accuracy: 0.963296/96 [==============================] - 1s 5ms/step - loss: 0.1162 - accuracy: 0.9632 - val_loss: 0.3236 - val_accuracy: 0.9423
Epoch 15/20
 1/96 [..............................] - ETA: 0s - loss: 0.1432 - accuracy: 0.956015/96 [===>..........................] - ETA: 0s - loss: 0.1260 - accuracy: 0.961929/96 [========>.....................] - ETA: 0s - loss: 0.1229 - accuracy: 0.962543/96 [============>.................] - ETA: 0s - loss: 0.1188 - accuracy: 0.963358/96 [=================>............] - ETA: 0s - loss: 0.1164 - accuracy: 0.963773/96 [=====================>........] - ETA: 0s - loss: 0.1148 - accuracy: 0.964088/96 [==========================>...] - ETA: 0s - loss: 0.1136 - accuracy: 0.964396/96 [==============================] - 1s 5ms/step - loss: 0.1131 - accuracy: 0.9644 - val_loss: 0.2916 - val_accuracy: 0.9489
Epoch 16/20
 1/96 [..............................] - ETA: 0s - loss: 0.0953 - accuracy: 0.970015/96 [===>..........................] - ETA: 0s - loss: 0.0850 - accuracy: 0.972129/96 [========>.....................] - ETA: 0s - loss: 0.0866 - accuracy: 0.971743/96 [============>.................] - ETA: 0s - loss: 0.0870 - accuracy: 0.971658/96 [=================>............] - ETA: 0s - loss: 0.0883 - accuracy: 0.971273/96 [=====================>........] - ETA: 0s - loss: 0.0889 - accuracy: 0.971187/96 [==========================>...] - ETA: 0s - loss: 0.0892 - accuracy: 0.971096/96 [==============================] - 1s 5ms/step - loss: 0.0893 - accuracy: 0.9710 - val_loss: 0.2894 - val_accuracy: 0.9513
Epoch 17/20
 1/96 [..............................] - ETA: 0s - loss: 0.0506 - accuracy: 0.986015/96 [===>..........................] - ETA: 0s - loss: 0.0752 - accuracy: 0.977229/96 [========>.....................] - ETA: 0s - loss: 0.0767 - accuracy: 0.976643/96 [============>.................] - ETA: 0s - loss: 0.0765 - accuracy: 0.976458/96 [=================>............] - ETA: 0s - loss: 0.0768 - accuracy: 0.976272/96 [=====================>........] - ETA: 0s - loss: 0.0770 - accuracy: 0.976086/96 [=========================>....] - ETA: 0s - loss: 0.0773 - accuracy: 0.975796/96 [==============================] - 1s 5ms/step - loss: 0.0777 - accuracy: 0.9756 - val_loss: 0.2962 - val_accuracy: 0.9467
Epoch 18/20
 1/96 [..............................] - ETA: 0s - loss: 0.0593 - accuracy: 0.980015/96 [===>..........................] - ETA: 0s - loss: 0.0760 - accuracy: 0.974729/96 [========>.....................] - ETA: 0s - loss: 0.0762 - accuracy: 0.974943/96 [============>.................] - ETA: 0s - loss: 0.0764 - accuracy: 0.975157/96 [================>.............] - ETA: 0s - loss: 0.0768 - accuracy: 0.975172/96 [=====================>........] - ETA: 0s - loss: 0.0770 - accuracy: 0.975087/96 [==========================>...] - ETA: 0s - loss: 0.0775 - accuracy: 0.974896/96 [==============================] - 1s 5ms/step - loss: 0.0777 - accuracy: 0.9748 - val_loss: 0.3314 - val_accuracy: 0.9498
Epoch 19/20
 1/96 [..............................] - ETA: 0s - loss: 0.0869 - accuracy: 0.976015/96 [===>..........................] - ETA: 0s - loss: 0.0735 - accuracy: 0.977829/96 [========>.....................] - ETA: 0s - loss: 0.0733 - accuracy: 0.977543/96 [============>.................] - ETA: 0s - loss: 0.0744 - accuracy: 0.977057/96 [================>.............] - ETA: 0s - loss: 0.0747 - accuracy: 0.976772/96 [=====================>........] - ETA: 0s - loss: 0.0747 - accuracy: 0.976586/96 [=========================>....] - ETA: 0s - loss: 0.0749 - accuracy: 0.976496/96 [==============================] - 1s 5ms/step - loss: 0.0752 - accuracy: 0.9763 - val_loss: 0.2930 - val_accuracy: 0.9483
Epoch 20/20
 1/96 [..............................] - ETA: 0s - loss: 0.0723 - accuracy: 0.976016/96 [====>.........................] - ETA: 0s - loss: 0.0811 - accuracy: 0.975630/96 [========>.....................] - ETA: 0s - loss: 0.0802 - accuracy: 0.975644/96 [============>.................] - ETA: 0s - loss: 0.0809 - accuracy: 0.975358/96 [=================>............] - ETA: 0s - loss: 0.0814 - accuracy: 0.975072/96 [=====================>........] - ETA: 0s - loss: 0.0816 - accuracy: 0.974987/96 [==========================>...] - ETA: 0s - loss: 0.0816 - accuracy: 0.974896/96 [==============================] - 1s 5ms/step - loss: 0.0816 - accuracy: 0.9747 - val_loss: 0.2972 - val_accuracy: 0.9514
training_time: 0:00:16.144599
  1/313 [..............................] - ETA: 7:46 - loss: 0.0247 - accuracy: 1.0000 14/313 [>.............................] - ETA: 1s - loss: 0.3459 - accuracy: 0.9710   28/313 [=>............................] - ETA: 1s - loss: 0.3167 - accuracy: 0.9576 42/313 [===>..........................] - ETA: 1s - loss: 0.3732 - accuracy: 0.9457 56/313 [====>.........................] - ETA: 0s - loss: 0.4027 - accuracy: 0.9408 70/313 [=====>........................] - ETA: 0s - loss: 0.4251 - accuracy: 0.9375 84/313 [=======>......................] - ETA: 0s - loss: 0.4279 - accuracy: 0.9379 98/313 [========>.....................] - ETA: 0s - loss: 0.4017 - accuracy: 0.9397112/313 [=========>....................] - ETA: 0s - loss: 0.3737 - accuracy: 0.9431125/313 [==========>...................] - ETA: 0s - loss: 0.4110 - accuracy: 0.9405139/313 [============>.................] - ETA: 0s - loss: 0.4077 - accuracy: 0.9397152/313 [=============>................] - ETA: 0s - loss: 0.4076 - accuracy: 0.9400166/313 [==============>...............] - ETA: 0s - loss: 0.3863 - accuracy: 0.9416180/313 [================>.............] - ETA: 0s - loss: 0.3703 - accuracy: 0.9443194/313 [=================>............] - ETA: 0s - loss: 0.3651 - accuracy: 0.9435208/313 [==================>...........] - ETA: 0s - loss: 0.3550 - accuracy: 0.9453222/313 [====================>.........] - ETA: 0s - loss: 0.3393 - accuracy: 0.9476236/313 [=====================>........] - ETA: 0s - loss: 0.3293 - accuracy: 0.9490250/313 [======================>.......] - ETA: 0s - loss: 0.3141 - accuracy: 0.9511264/313 [========================>.....] - ETA: 0s - loss: 0.3075 - accuracy: 0.9512277/313 [=========================>....] - ETA: 0s - loss: 0.2960 - accuracy: 0.9528291/313 [==========================>...] - ETA: 0s - loss: 0.2882 - accuracy: 0.9539305/313 [============================>.] - ETA: 0s - loss: 0.2884 - accuracy: 0.9541313/313 [==============================] - 3s 4ms/step - loss: 0.2906 - accuracy: 0.9538
Test results: Loss = 0.29059895873069763, Accuracy = 0.9538000226020813
