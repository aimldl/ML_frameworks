Number of devices: 2
batch_size_per_replica: 250
batch_size: 500 = 250 * 2
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
60000 10000
Epoch 1/20
 1/96 [..............................] - ETA: 6:01 - loss: 148.9637 - accuracy: 0.068015/96 [===>..........................] - ETA: 0s - loss: 67.0622 - accuracy: 0.3027   30/96 [========>.....................] - ETA: 0s - loss: 45.9804 - accuracy: 0.421944/96 [============>.................] - ETA: 0s - loss: 36.4232 - accuracy: 0.471659/96 [=================>............] - ETA: 0s - loss: 30.1838 - accuracy: 0.497874/96 [======================>.......] - ETA: 0s - loss: 25.9897 - accuracy: 0.517989/96 [==========================>...] - ETA: 0s - loss: 22.9496 - accuracy: 0.535496/96 [==============================] - 6s 21ms/step - loss: 21.6419 - accuracy: 0.5439 - val_loss: 0.9067 - val_accuracy: 0.7819
Epoch 2/20
 1/96 [..............................] - ETA: 0s - loss: 0.8662 - accuracy: 0.764015/96 [===>..........................] - ETA: 0s - loss: 0.8444 - accuracy: 0.775130/96 [========>.....................] - ETA: 0s - loss: 0.8557 - accuracy: 0.780745/96 [=============>................] - ETA: 0s - loss: 0.8489 - accuracy: 0.785559/96 [=================>............] - ETA: 0s - loss: 0.8428 - accuracy: 0.788974/96 [======================>.......] - ETA: 0s - loss: 0.8344 - accuracy: 0.792488/96 [==========================>...] - ETA: 0s - loss: 0.8279 - accuracy: 0.795296/96 [==============================] - 1s 5ms/step - loss: 0.8239 - accuracy: 0.7967 - val_loss: 0.6310 - val_accuracy: 0.8508
Epoch 3/20
 1/96 [..............................] - ETA: 0s - loss: 0.5034 - accuracy: 0.870015/96 [===>..........................] - ETA: 0s - loss: 0.5430 - accuracy: 0.852029/96 [========>.....................] - ETA: 0s - loss: 0.5535 - accuracy: 0.853943/96 [============>.................] - ETA: 0s - loss: 0.5540 - accuracy: 0.855158/96 [=================>............] - ETA: 0s - loss: 0.5541 - accuracy: 0.856172/96 [=====================>........] - ETA: 0s - loss: 0.5549 - accuracy: 0.856986/96 [=========================>....] - ETA: 0s - loss: 0.5554 - accuracy: 0.857696/96 [==============================] - 1s 5ms/step - loss: 0.5549 - accuracy: 0.8582 - val_loss: 0.5050 - val_accuracy: 0.8876
Epoch 4/20
 1/96 [..............................] - ETA: 0s - loss: 0.4838 - accuracy: 0.888015/96 [===>..........................] - ETA: 0s - loss: 0.4578 - accuracy: 0.885430/96 [========>.....................] - ETA: 0s - loss: 0.4502 - accuracy: 0.885145/96 [=============>................] - ETA: 0s - loss: 0.4464 - accuracy: 0.885360/96 [=================>............] - ETA: 0s - loss: 0.4431 - accuracy: 0.885974/96 [======================>.......] - ETA: 0s - loss: 0.4404 - accuracy: 0.886688/96 [==========================>...] - ETA: 0s - loss: 0.4373 - accuracy: 0.887296/96 [==============================] - 1s 5ms/step - loss: 0.4356 - accuracy: 0.8877 - val_loss: 0.4586 - val_accuracy: 0.9013
Epoch 5/20
 1/96 [..............................] - ETA: 0s - loss: 0.3548 - accuracy: 0.910015/96 [===>..........................] - ETA: 0s - loss: 0.3264 - accuracy: 0.912729/96 [========>.....................] - ETA: 0s - loss: 0.3219 - accuracy: 0.913044/96 [============>.................] - ETA: 0s - loss: 0.3237 - accuracy: 0.912559/96 [=================>............] - ETA: 0s - loss: 0.3255 - accuracy: 0.912073/96 [=====================>........] - ETA: 0s - loss: 0.3263 - accuracy: 0.912088/96 [==========================>...] - ETA: 0s - loss: 0.3264 - accuracy: 0.912196/96 [==============================] - 1s 5ms/step - loss: 0.3262 - accuracy: 0.9122 - val_loss: 0.4256 - val_accuracy: 0.9121
Epoch 6/20
 1/96 [..............................] - ETA: 0s - loss: 0.2800 - accuracy: 0.924015/96 [===>..........................] - ETA: 0s - loss: 0.2538 - accuracy: 0.929130/96 [========>.....................] - ETA: 0s - loss: 0.2572 - accuracy: 0.927745/96 [=============>................] - ETA: 0s - loss: 0.2609 - accuracy: 0.926660/96 [=================>............] - ETA: 0s - loss: 0.2629 - accuracy: 0.926275/96 [======================>.......] - ETA: 0s - loss: 0.2640 - accuracy: 0.926189/96 [==========================>...] - ETA: 0s - loss: 0.2652 - accuracy: 0.925996/96 [==============================] - 1s 6ms/step - loss: 0.2662 - accuracy: 0.9258 - val_loss: 0.3788 - val_accuracy: 0.9208
Epoch 7/20
 1/96 [..............................] - ETA: 0s - loss: 0.2189 - accuracy: 0.930016/96 [====>.........................] - ETA: 0s - loss: 0.2377 - accuracy: 0.933831/96 [========>.....................] - ETA: 0s - loss: 0.2388 - accuracy: 0.934046/96 [=============>................] - ETA: 0s - loss: 0.2389 - accuracy: 0.934160/96 [=================>............] - ETA: 0s - loss: 0.2380 - accuracy: 0.934374/96 [======================>.......] - ETA: 0s - loss: 0.2372 - accuracy: 0.934588/96 [==========================>...] - ETA: 0s - loss: 0.2367 - accuracy: 0.934596/96 [==============================] - 1s 5ms/step - loss: 0.2366 - accuracy: 0.9345 - val_loss: 0.3681 - val_accuracy: 0.9283
Epoch 8/20
 1/96 [..............................] - ETA: 0s - loss: 0.2249 - accuracy: 0.922016/96 [====>.........................] - ETA: 0s - loss: 0.2141 - accuracy: 0.937731/96 [========>.....................] - ETA: 0s - loss: 0.2080 - accuracy: 0.939645/96 [=============>................] - ETA: 0s - loss: 0.2051 - accuracy: 0.940559/96 [=================>............] - ETA: 0s - loss: 0.2033 - accuracy: 0.940973/96 [=====================>........] - ETA: 0s - loss: 0.2020 - accuracy: 0.941388/96 [==========================>...] - ETA: 0s - loss: 0.2017 - accuracy: 0.941596/96 [==============================] - 1s 6ms/step - loss: 0.2015 - accuracy: 0.9415 - val_loss: 0.3723 - val_accuracy: 0.9287
Epoch 9/20
 1/96 [..............................] - ETA: 0s - loss: 0.1317 - accuracy: 0.958015/96 [===>..........................] - ETA: 0s - loss: 0.1593 - accuracy: 0.949130/96 [========>.....................] - ETA: 0s - loss: 0.1624 - accuracy: 0.949744/96 [============>.................] - ETA: 0s - loss: 0.1654 - accuracy: 0.949858/96 [=================>............] - ETA: 0s - loss: 0.1667 - accuracy: 0.949873/96 [=====================>........] - ETA: 0s - loss: 0.1679 - accuracy: 0.949787/96 [==========================>...] - ETA: 0s - loss: 0.1688 - accuracy: 0.949696/96 [==============================] - 1s 5ms/step - loss: 0.1693 - accuracy: 0.9496 - val_loss: 0.3502 - val_accuracy: 0.9319
Epoch 10/20
 1/96 [..............................] - ETA: 0s - loss: 0.1771 - accuracy: 0.946015/96 [===>..........................] - ETA: 0s - loss: 0.1601 - accuracy: 0.950329/96 [========>.....................] - ETA: 0s - loss: 0.1544 - accuracy: 0.952343/96 [============>.................] - ETA: 0s - loss: 0.1521 - accuracy: 0.953458/96 [=================>............] - ETA: 0s - loss: 0.1509 - accuracy: 0.953872/96 [=====================>........] - ETA: 0s - loss: 0.1504 - accuracy: 0.954186/96 [=========================>....] - ETA: 0s - loss: 0.1501 - accuracy: 0.954396/96 [==============================] - 1s 5ms/step - loss: 0.1500 - accuracy: 0.9544 - val_loss: 0.3863 - val_accuracy: 0.9380
Epoch 11/20
 1/96 [..............................] - ETA: 0s - loss: 0.2068 - accuracy: 0.956015/96 [===>..........................] - ETA: 0s - loss: 0.1521 - accuracy: 0.959430/96 [========>.....................] - ETA: 0s - loss: 0.1499 - accuracy: 0.957745/96 [=============>................] - ETA: 0s - loss: 0.1470 - accuracy: 0.957360/96 [=================>............] - ETA: 0s - loss: 0.1449 - accuracy: 0.957474/96 [======================>.......] - ETA: 0s - loss: 0.1430 - accuracy: 0.957689/96 [==========================>...] - ETA: 0s - loss: 0.1417 - accuracy: 0.957896/96 [==============================] - 1s 5ms/step - loss: 0.1411 - accuracy: 0.9579 - val_loss: 0.3765 - val_accuracy: 0.9390
Epoch 12/20
 1/96 [..............................] - ETA: 0s - loss: 0.0830 - accuracy: 0.972016/96 [====>.........................] - ETA: 0s - loss: 0.1126 - accuracy: 0.966231/96 [========>.....................] - ETA: 0s - loss: 0.1135 - accuracy: 0.965246/96 [=============>................] - ETA: 0s - loss: 0.1139 - accuracy: 0.964860/96 [=================>............] - ETA: 0s - loss: 0.1144 - accuracy: 0.964574/96 [======================>.......] - ETA: 0s - loss: 0.1155 - accuracy: 0.964289/96 [==========================>...] - ETA: 0s - loss: 0.1167 - accuracy: 0.963896/96 [==============================] - 1s 5ms/step - loss: 0.1174 - accuracy: 0.9636 - val_loss: 0.3456 - val_accuracy: 0.9374
Epoch 13/20
 1/96 [..............................] - ETA: 0s - loss: 0.1077 - accuracy: 0.964015/96 [===>..........................] - ETA: 0s - loss: 0.1254 - accuracy: 0.961129/96 [========>.....................] - ETA: 0s - loss: 0.1211 - accuracy: 0.962343/96 [============>.................] - ETA: 0s - loss: 0.1179 - accuracy: 0.962957/96 [================>.............] - ETA: 0s - loss: 0.1161 - accuracy: 0.963371/96 [=====================>........] - ETA: 0s - loss: 0.1152 - accuracy: 0.963585/96 [=========================>....] - ETA: 0s - loss: 0.1152 - accuracy: 0.963696/96 [==============================] - 1s 5ms/step - loss: 0.1152 - accuracy: 0.9636 - val_loss: 0.3845 - val_accuracy: 0.9416
Epoch 14/20
 1/96 [..............................] - ETA: 0s - loss: 0.1548 - accuracy: 0.960015/96 [===>..........................] - ETA: 0s - loss: 0.1257 - accuracy: 0.964530/96 [========>.....................] - ETA: 0s - loss: 0.1238 - accuracy: 0.963945/96 [=============>................] - ETA: 0s - loss: 0.1228 - accuracy: 0.963759/96 [=================>............] - ETA: 0s - loss: 0.1223 - accuracy: 0.963674/96 [======================>.......] - ETA: 0s - loss: 0.1217 - accuracy: 0.963688/96 [==========================>...] - ETA: 0s - loss: 0.1213 - accuracy: 0.963596/96 [==============================] - 1s 5ms/step - loss: 0.1211 - accuracy: 0.9635 - val_loss: 0.3320 - val_accuracy: 0.9406
Epoch 15/20
 1/96 [..............................] - ETA: 0s - loss: 0.1332 - accuracy: 0.962016/96 [====>.........................] - ETA: 0s - loss: 0.1132 - accuracy: 0.965831/96 [========>.....................] - ETA: 0s - loss: 0.1095 - accuracy: 0.966446/96 [=============>................] - ETA: 0s - loss: 0.1074 - accuracy: 0.966660/96 [=================>............] - ETA: 0s - loss: 0.1060 - accuracy: 0.966975/96 [======================>.......] - ETA: 0s - loss: 0.1050 - accuracy: 0.967189/96 [==========================>...] - ETA: 0s - loss: 0.1044 - accuracy: 0.967296/96 [==============================] - 1s 5ms/step - loss: 0.1042 - accuracy: 0.9673 - val_loss: 0.3459 - val_accuracy: 0.9471
Epoch 16/20
 1/96 [..............................] - ETA: 0s - loss: 0.1141 - accuracy: 0.972016/96 [====>.........................] - ETA: 0s - loss: 0.0977 - accuracy: 0.970531/96 [========>.....................] - ETA: 0s - loss: 0.0984 - accuracy: 0.969945/96 [=============>................] - ETA: 0s - loss: 0.0966 - accuracy: 0.970060/96 [=================>............] - ETA: 0s - loss: 0.0947 - accuracy: 0.970475/96 [======================>.......] - ETA: 0s - loss: 0.0937 - accuracy: 0.970689/96 [==========================>...] - ETA: 0s - loss: 0.0932 - accuracy: 0.970696/96 [==============================] - 1s 5ms/step - loss: 0.0929 - accuracy: 0.9706 - val_loss: 0.3150 - val_accuracy: 0.9459
Epoch 17/20
 1/96 [..............................] - ETA: 0s - loss: 0.0793 - accuracy: 0.978016/96 [====>.........................] - ETA: 0s - loss: 0.0795 - accuracy: 0.974930/96 [========>.....................] - ETA: 0s - loss: 0.0777 - accuracy: 0.975244/96 [============>.................] - ETA: 0s - loss: 0.0780 - accuracy: 0.975158/96 [=================>............] - ETA: 0s - loss: 0.0794 - accuracy: 0.974772/96 [=====================>........] - ETA: 0s - loss: 0.0806 - accuracy: 0.974586/96 [=========================>....] - ETA: 0s - loss: 0.0816 - accuracy: 0.974296/96 [==============================] - 1s 6ms/step - loss: 0.0821 - accuracy: 0.9740 - val_loss: 0.3430 - val_accuracy: 0.9506
Epoch 18/20
 1/96 [..............................] - ETA: 0s - loss: 0.0682 - accuracy: 0.976016/96 [====>.........................] - ETA: 0s - loss: 0.0849 - accuracy: 0.973430/96 [========>.....................] - ETA: 0s - loss: 0.0885 - accuracy: 0.972544/96 [============>.................] - ETA: 0s - loss: 0.0886 - accuracy: 0.972358/96 [=================>............] - ETA: 0s - loss: 0.0872 - accuracy: 0.972572/96 [=====================>........] - ETA: 0s - loss: 0.0862 - accuracy: 0.972886/96 [=========================>....] - ETA: 0s - loss: 0.0854 - accuracy: 0.972996/96 [==============================] - 1s 6ms/step - loss: 0.0847 - accuracy: 0.9731 - val_loss: 0.3422 - val_accuracy: 0.9503
Epoch 19/20
 1/96 [..............................] - ETA: 0s - loss: 0.0643 - accuracy: 0.976015/96 [===>..........................] - ETA: 0s - loss: 0.0707 - accuracy: 0.978430/96 [========>.....................] - ETA: 0s - loss: 0.0691 - accuracy: 0.978745/96 [=============>................] - ETA: 0s - loss: 0.0690 - accuracy: 0.978360/96 [=================>............] - ETA: 0s - loss: 0.0690 - accuracy: 0.978275/96 [======================>.......] - ETA: 0s - loss: 0.0692 - accuracy: 0.978090/96 [===========================>..] - ETA: 0s - loss: 0.0696 - accuracy: 0.977796/96 [==============================] - 1s 5ms/step - loss: 0.0697 - accuracy: 0.9776 - val_loss: 0.3282 - val_accuracy: 0.9499
Epoch 20/20
 1/96 [..............................] - ETA: 0s - loss: 0.0558 - accuracy: 0.972015/96 [===>..........................] - ETA: 0s - loss: 0.0704 - accuracy: 0.974730/96 [========>.....................] - ETA: 0s - loss: 0.0703 - accuracy: 0.976045/96 [=============>................] - ETA: 0s - loss: 0.0724 - accuracy: 0.975859/96 [=================>............] - ETA: 0s - loss: 0.0731 - accuracy: 0.975873/96 [=====================>........] - ETA: 0s - loss: 0.0736 - accuracy: 0.975988/96 [==========================>...] - ETA: 0s - loss: 0.0740 - accuracy: 0.975996/96 [==============================] - 1s 5ms/step - loss: 0.0742 - accuracy: 0.9759 - val_loss: 0.3449 - val_accuracy: 0.9536
training_time: 0:00:16.070318
  1/313 [..............................] - ETA: 7:46 - loss: 0.0441 - accuracy: 0.9688 14/313 [>.............................] - ETA: 1s - loss: 0.3150 - accuracy: 0.9576   27/313 [=>............................] - ETA: 1s - loss: 0.3256 - accuracy: 0.9514 41/313 [==>...........................] - ETA: 1s - loss: 0.3386 - accuracy: 0.9421 55/313 [====>.........................] - ETA: 0s - loss: 0.3766 - accuracy: 0.9381 69/313 [=====>........................] - ETA: 0s - loss: 0.4001 - accuracy: 0.9370 83/313 [======>.......................] - ETA: 0s - loss: 0.4306 - accuracy: 0.9364 97/313 [========>.....................] - ETA: 0s - loss: 0.4113 - accuracy: 0.9378111/313 [=========>....................] - ETA: 0s - loss: 0.4000 - accuracy: 0.9400124/313 [==========>...................] - ETA: 0s - loss: 0.4182 - accuracy: 0.9380137/313 [============>.................] - ETA: 0s - loss: 0.4114 - accuracy: 0.9384150/313 [=============>................] - ETA: 0s - loss: 0.3913 - accuracy: 0.9394164/313 [==============>...............] - ETA: 0s - loss: 0.3750 - accuracy: 0.9407177/313 [===============>..............] - ETA: 0s - loss: 0.3626 - accuracy: 0.9439191/313 [=================>............] - ETA: 0s - loss: 0.3546 - accuracy: 0.9450204/313 [==================>...........] - ETA: 0s - loss: 0.3416 - accuracy: 0.9473218/313 [===================>..........] - ETA: 0s - loss: 0.3294 - accuracy: 0.9487232/313 [=====================>........] - ETA: 0s - loss: 0.3104 - accuracy: 0.9515246/313 [======================>.......] - ETA: 0s - loss: 0.3015 - accuracy: 0.9526260/313 [=======================>......] - ETA: 0s - loss: 0.2947 - accuracy: 0.9530274/313 [=========================>....] - ETA: 0s - loss: 0.2836 - accuracy: 0.9548288/313 [==========================>...] - ETA: 0s - loss: 0.2766 - accuracy: 0.9562302/313 [===========================>..] - ETA: 0s - loss: 0.2673 - accuracy: 0.9573313/313 [==============================] - 3s 4ms/step - loss: 0.2792 - accuracy: 0.9557
Test results: Loss = 0.27921441197395325, Accuracy = 0.9556999802589417
