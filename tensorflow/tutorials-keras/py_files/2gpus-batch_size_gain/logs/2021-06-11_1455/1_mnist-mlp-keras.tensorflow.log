Number of devices: 2
batch_size_per_replica: 250
batch_size: 500 = 250 * 2
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
60000 10000
Epoch 1/20
 1/96 [..............................] - ETA: 6:02 - loss: 141.9336 - accuracy: 0.156015/96 [===>..........................] - ETA: 0s - loss: 65.8209 - accuracy: 0.2843   29/96 [========>.....................] - ETA: 0s - loss: 45.3252 - accuracy: 0.347443/96 [============>.................] - ETA: 0s - loss: 35.4028 - accuracy: 0.365057/96 [================>.............] - ETA: 0s - loss: 29.4383 - accuracy: 0.375272/96 [=====================>........] - ETA: 0s - loss: 25.1691 - accuracy: 0.387886/96 [=========================>....] - ETA: 0s - loss: 22.3013 - accuracy: 0.400396/96 [==============================] - 6s 21ms/step - loss: 20.5317 - accuracy: 0.4099 - val_loss: 1.1482 - val_accuracy: 0.6560
Epoch 2/20
 1/96 [..............................] - ETA: 0s - loss: 1.1475 - accuracy: 0.664015/96 [===>..........................] - ETA: 0s - loss: 1.1494 - accuracy: 0.655229/96 [========>.....................] - ETA: 0s - loss: 1.1394 - accuracy: 0.657443/96 [============>.................] - ETA: 0s - loss: 1.1270 - accuracy: 0.661557/96 [================>.............] - ETA: 0s - loss: 1.1159 - accuracy: 0.666472/96 [=====================>........] - ETA: 0s - loss: 1.1042 - accuracy: 0.671887/96 [==========================>...] - ETA: 0s - loss: 1.0914 - accuracy: 0.677396/96 [==============================] - 1s 5ms/step - loss: 1.0828 - accuracy: 0.6809 - val_loss: 0.8066 - val_accuracy: 0.7812
Epoch 3/20
 1/96 [..............................] - ETA: 0s - loss: 0.7656 - accuracy: 0.776015/96 [===>..........................] - ETA: 0s - loss: 0.7794 - accuracy: 0.776729/96 [========>.....................] - ETA: 0s - loss: 0.7576 - accuracy: 0.787043/96 [============>.................] - ETA: 0s - loss: 0.7503 - accuracy: 0.791057/96 [================>.............] - ETA: 0s - loss: 0.7469 - accuracy: 0.793471/96 [=====================>........] - ETA: 0s - loss: 0.7423 - accuracy: 0.795585/96 [=========================>....] - ETA: 0s - loss: 0.7358 - accuracy: 0.797696/96 [==============================] - 1s 5ms/step - loss: 0.7297 - accuracy: 0.7994 - val_loss: 0.5901 - val_accuracy: 0.8455
Epoch 4/20
 1/96 [..............................] - ETA: 0s - loss: 0.4902 - accuracy: 0.858015/96 [===>..........................] - ETA: 0s - loss: 0.5079 - accuracy: 0.849629/96 [========>.....................] - ETA: 0s - loss: 0.5048 - accuracy: 0.851143/96 [============>.................] - ETA: 0s - loss: 0.5024 - accuracy: 0.852857/96 [================>.............] - ETA: 0s - loss: 0.5017 - accuracy: 0.854171/96 [=====================>........] - ETA: 0s - loss: 0.5023 - accuracy: 0.854985/96 [=========================>....] - ETA: 0s - loss: 0.5017 - accuracy: 0.856096/96 [==============================] - 1s 6ms/step - loss: 0.5003 - accuracy: 0.8572 - val_loss: 0.5076 - val_accuracy: 0.8765
Epoch 5/20
 1/96 [..............................] - ETA: 0s - loss: 0.3812 - accuracy: 0.890015/96 [===>..........................] - ETA: 0s - loss: 0.3892 - accuracy: 0.887329/96 [========>.....................] - ETA: 0s - loss: 0.3875 - accuracy: 0.890944/96 [============>.................] - ETA: 0s - loss: 0.3883 - accuracy: 0.892258/96 [=================>............] - ETA: 0s - loss: 0.3872 - accuracy: 0.893272/96 [=====================>........] - ETA: 0s - loss: 0.3866 - accuracy: 0.894186/96 [=========================>....] - ETA: 0s - loss: 0.3867 - accuracy: 0.894696/96 [==============================] - 1s 6ms/step - loss: 0.3872 - accuracy: 0.8950 - val_loss: 0.4871 - val_accuracy: 0.8900
Epoch 6/20
 1/96 [..............................] - ETA: 0s - loss: 0.3843 - accuracy: 0.892015/96 [===>..........................] - ETA: 0s - loss: 0.3520 - accuracy: 0.901129/96 [========>.....................] - ETA: 0s - loss: 0.3388 - accuracy: 0.905343/96 [============>.................] - ETA: 0s - loss: 0.3319 - accuracy: 0.907657/96 [================>.............] - ETA: 0s - loss: 0.3274 - accuracy: 0.909471/96 [=====================>........] - ETA: 0s - loss: 0.3246 - accuracy: 0.910585/96 [=========================>....] - ETA: 0s - loss: 0.3229 - accuracy: 0.911296/96 [==============================] - 1s 6ms/step - loss: 0.3221 - accuracy: 0.9117 - val_loss: 0.4104 - val_accuracy: 0.9070
Epoch 7/20
 1/96 [..............................] - ETA: 0s - loss: 0.3047 - accuracy: 0.918015/96 [===>..........................] - ETA: 0s - loss: 0.2788 - accuracy: 0.915429/96 [========>.....................] - ETA: 0s - loss: 0.2729 - accuracy: 0.919243/96 [============>.................] - ETA: 0s - loss: 0.2707 - accuracy: 0.921257/96 [================>.............] - ETA: 0s - loss: 0.2706 - accuracy: 0.922071/96 [=====================>........] - ETA: 0s - loss: 0.2705 - accuracy: 0.922785/96 [=========================>....] - ETA: 0s - loss: 0.2703 - accuracy: 0.923296/96 [==============================] - 1s 5ms/step - loss: 0.2702 - accuracy: 0.9237 - val_loss: 0.3807 - val_accuracy: 0.9173
Epoch 8/20
 1/96 [..............................] - ETA: 0s - loss: 0.2723 - accuracy: 0.918015/96 [===>..........................] - ETA: 0s - loss: 0.2489 - accuracy: 0.929929/96 [========>.....................] - ETA: 0s - loss: 0.2480 - accuracy: 0.931444/96 [============>.................] - ETA: 0s - loss: 0.2453 - accuracy: 0.932658/96 [=================>............] - ETA: 0s - loss: 0.2426 - accuracy: 0.933772/96 [=====================>........] - ETA: 0s - loss: 0.2407 - accuracy: 0.934486/96 [=========================>....] - ETA: 0s - loss: 0.2395 - accuracy: 0.934996/96 [==============================] - 1s 5ms/step - loss: 0.2390 - accuracy: 0.9351 - val_loss: 0.3513 - val_accuracy: 0.9289
Epoch 9/20
 1/96 [..............................] - ETA: 0s - loss: 0.1675 - accuracy: 0.954016/96 [====>.........................] - ETA: 0s - loss: 0.1999 - accuracy: 0.943030/96 [========>.....................] - ETA: 0s - loss: 0.1982 - accuracy: 0.943144/96 [============>.................] - ETA: 0s - loss: 0.1993 - accuracy: 0.942858/96 [=================>............] - ETA: 0s - loss: 0.1998 - accuracy: 0.942872/96 [=====================>........] - ETA: 0s - loss: 0.1997 - accuracy: 0.943087/96 [==========================>...] - ETA: 0s - loss: 0.1996 - accuracy: 0.943296/96 [==============================] - 1s 5ms/step - loss: 0.1996 - accuracy: 0.9433 - val_loss: 0.3428 - val_accuracy: 0.9340
Epoch 10/20
 1/96 [..............................] - ETA: 0s - loss: 0.1598 - accuracy: 0.954016/96 [====>.........................] - ETA: 0s - loss: 0.1660 - accuracy: 0.951830/96 [========>.....................] - ETA: 0s - loss: 0.1682 - accuracy: 0.950244/96 [============>.................] - ETA: 0s - loss: 0.1683 - accuracy: 0.949758/96 [=================>............] - ETA: 0s - loss: 0.1683 - accuracy: 0.949772/96 [=====================>........] - ETA: 0s - loss: 0.1689 - accuracy: 0.949786/96 [=========================>....] - ETA: 0s - loss: 0.1695 - accuracy: 0.949696/96 [==============================] - 1s 5ms/step - loss: 0.1699 - accuracy: 0.9496 - val_loss: 0.3490 - val_accuracy: 0.9358
Epoch 11/20
 1/96 [..............................] - ETA: 0s - loss: 0.1193 - accuracy: 0.966015/96 [===>..........................] - ETA: 0s - loss: 0.1510 - accuracy: 0.954229/96 [========>.....................] - ETA: 0s - loss: 0.1501 - accuracy: 0.954143/96 [============>.................] - ETA: 0s - loss: 0.1497 - accuracy: 0.954658/96 [=================>............] - ETA: 0s - loss: 0.1497 - accuracy: 0.954972/96 [=====================>........] - ETA: 0s - loss: 0.1502 - accuracy: 0.954986/96 [=========================>....] - ETA: 0s - loss: 0.1507 - accuracy: 0.954996/96 [==============================] - 1s 5ms/step - loss: 0.1511 - accuracy: 0.9549 - val_loss: 0.3315 - val_accuracy: 0.9388
Epoch 12/20
 1/96 [..............................] - ETA: 0s - loss: 0.1106 - accuracy: 0.964015/96 [===>..........................] - ETA: 0s - loss: 0.1276 - accuracy: 0.959929/96 [========>.....................] - ETA: 0s - loss: 0.1340 - accuracy: 0.959743/96 [============>.................] - ETA: 0s - loss: 0.1371 - accuracy: 0.959157/96 [================>.............] - ETA: 0s - loss: 0.1384 - accuracy: 0.958971/96 [=====================>........] - ETA: 0s - loss: 0.1398 - accuracy: 0.958685/96 [=========================>....] - ETA: 0s - loss: 0.1402 - accuracy: 0.958596/96 [==============================] - 1s 6ms/step - loss: 0.1405 - accuracy: 0.9584 - val_loss: 0.3433 - val_accuracy: 0.9441
Epoch 13/20
 1/96 [..............................] - ETA: 0s - loss: 0.1054 - accuracy: 0.968015/96 [===>..........................] - ETA: 0s - loss: 0.1015 - accuracy: 0.969630/96 [========>.....................] - ETA: 0s - loss: 0.1090 - accuracy: 0.967644/96 [============>.................] - ETA: 0s - loss: 0.1129 - accuracy: 0.966558/96 [=================>............] - ETA: 0s - loss: 0.1153 - accuracy: 0.965973/96 [=====================>........] - ETA: 0s - loss: 0.1174 - accuracy: 0.965487/96 [==========================>...] - ETA: 0s - loss: 0.1194 - accuracy: 0.964996/96 [==============================] - 1s 5ms/step - loss: 0.1206 - accuracy: 0.9646 - val_loss: 0.3162 - val_accuracy: 0.9461
Epoch 14/20
 1/96 [..............................] - ETA: 0s - loss: 0.1343 - accuracy: 0.958015/96 [===>..........................] - ETA: 0s - loss: 0.1188 - accuracy: 0.964329/96 [========>.....................] - ETA: 0s - loss: 0.1152 - accuracy: 0.965543/96 [============>.................] - ETA: 0s - loss: 0.1157 - accuracy: 0.965757/96 [================>.............] - ETA: 0s - loss: 0.1164 - accuracy: 0.965872/96 [=====================>........] - ETA: 0s - loss: 0.1169 - accuracy: 0.965786/96 [=========================>....] - ETA: 0s - loss: 0.1176 - accuracy: 0.965696/96 [==============================] - 1s 6ms/step - loss: 0.1179 - accuracy: 0.9655 - val_loss: 0.3411 - val_accuracy: 0.9481
Epoch 15/20
 1/96 [..............................] - ETA: 0s - loss: 0.0896 - accuracy: 0.976015/96 [===>..........................] - ETA: 0s - loss: 0.1034 - accuracy: 0.969529/96 [========>.....................] - ETA: 0s - loss: 0.1032 - accuracy: 0.969743/96 [============>.................] - ETA: 0s - loss: 0.1057 - accuracy: 0.968957/96 [================>.............] - ETA: 0s - loss: 0.1066 - accuracy: 0.968471/96 [=====================>........] - ETA: 0s - loss: 0.1071 - accuracy: 0.968185/96 [=========================>....] - ETA: 0s - loss: 0.1077 - accuracy: 0.967896/96 [==============================] - 1s 6ms/step - loss: 0.1082 - accuracy: 0.9676 - val_loss: 0.3251 - val_accuracy: 0.9484
Epoch 16/20
 1/96 [..............................] - ETA: 0s - loss: 0.0553 - accuracy: 0.978015/96 [===>..........................] - ETA: 0s - loss: 0.0905 - accuracy: 0.969629/96 [========>.....................] - ETA: 0s - loss: 0.0942 - accuracy: 0.969043/96 [============>.................] - ETA: 0s - loss: 0.0968 - accuracy: 0.968557/96 [================>.............] - ETA: 0s - loss: 0.0979 - accuracy: 0.968371/96 [=====================>........] - ETA: 0s - loss: 0.0984 - accuracy: 0.968485/96 [=========================>....] - ETA: 0s - loss: 0.0989 - accuracy: 0.968596/96 [==============================] - 1s 6ms/step - loss: 0.0994 - accuracy: 0.9685 - val_loss: 0.3229 - val_accuracy: 0.9490
Epoch 17/20
 1/96 [..............................] - ETA: 0s - loss: 0.0447 - accuracy: 0.988015/96 [===>..........................] - ETA: 0s - loss: 0.0840 - accuracy: 0.975629/96 [========>.....................] - ETA: 0s - loss: 0.0898 - accuracy: 0.973443/96 [============>.................] - ETA: 0s - loss: 0.0923 - accuracy: 0.972357/96 [================>.............] - ETA: 0s - loss: 0.0933 - accuracy: 0.971971/96 [=====================>........] - ETA: 0s - loss: 0.0938 - accuracy: 0.971785/96 [=========================>....] - ETA: 0s - loss: 0.0941 - accuracy: 0.971696/96 [==============================] - 1s 5ms/step - loss: 0.0944 - accuracy: 0.9715 - val_loss: 0.3071 - val_accuracy: 0.9509
Epoch 18/20
 1/96 [..............................] - ETA: 0s - loss: 0.0574 - accuracy: 0.980015/96 [===>..........................] - ETA: 0s - loss: 0.0905 - accuracy: 0.971629/96 [========>.....................] - ETA: 0s - loss: 0.0940 - accuracy: 0.970843/96 [============>.................] - ETA: 0s - loss: 0.0945 - accuracy: 0.970758/96 [=================>............] - ETA: 0s - loss: 0.0941 - accuracy: 0.970972/96 [=====================>........] - ETA: 0s - loss: 0.0939 - accuracy: 0.971186/96 [=========================>....] - ETA: 0s - loss: 0.0936 - accuracy: 0.971396/96 [==============================] - 1s 5ms/step - loss: 0.0934 - accuracy: 0.9715 - val_loss: 0.3291 - val_accuracy: 0.9514
Epoch 19/20
 1/96 [..............................] - ETA: 0s - loss: 0.0605 - accuracy: 0.980015/96 [===>..........................] - ETA: 0s - loss: 0.0742 - accuracy: 0.976829/96 [========>.....................] - ETA: 0s - loss: 0.0780 - accuracy: 0.975343/96 [============>.................] - ETA: 0s - loss: 0.0798 - accuracy: 0.975157/96 [================>.............] - ETA: 0s - loss: 0.0813 - accuracy: 0.974871/96 [=====================>........] - ETA: 0s - loss: 0.0825 - accuracy: 0.974685/96 [=========================>....] - ETA: 0s - loss: 0.0835 - accuracy: 0.974596/96 [==============================] - 1s 6ms/step - loss: 0.0842 - accuracy: 0.9743 - val_loss: 0.3129 - val_accuracy: 0.9525
Epoch 20/20
 1/96 [..............................] - ETA: 0s - loss: 0.0637 - accuracy: 0.974015/96 [===>..........................] - ETA: 0s - loss: 0.0660 - accuracy: 0.977329/96 [========>.....................] - ETA: 0s - loss: 0.0670 - accuracy: 0.977643/96 [============>.................] - ETA: 0s - loss: 0.0688 - accuracy: 0.977657/96 [================>.............] - ETA: 0s - loss: 0.0701 - accuracy: 0.977472/96 [=====================>........] - ETA: 0s - loss: 0.0713 - accuracy: 0.977387/96 [==========================>...] - ETA: 0s - loss: 0.0723 - accuracy: 0.977196/96 [==============================] - 1s 5ms/step - loss: 0.0728 - accuracy: 0.9771 - val_loss: 0.3209 - val_accuracy: 0.9541
training_time: 0:00:16.182398
  1/313 [..............................] - ETA: 7:46 - loss: 0.1448 - accuracy: 0.9375 14/313 [>.............................] - ETA: 1s - loss: 0.2276 - accuracy: 0.9531   28/313 [=>............................] - ETA: 1s - loss: 0.2685 - accuracy: 0.9487 42/313 [===>..........................] - ETA: 1s - loss: 0.2956 - accuracy: 0.9435 55/313 [====>.........................] - ETA: 0s - loss: 0.3217 - accuracy: 0.9403 68/313 [=====>........................] - ETA: 0s - loss: 0.3738 - accuracy: 0.9357 81/313 [======>.......................] - ETA: 0s - loss: 0.3855 - accuracy: 0.9352 95/313 [========>.....................] - ETA: 0s - loss: 0.3802 - accuracy: 0.9385109/313 [=========>....................] - ETA: 0s - loss: 0.3630 - accuracy: 0.9415123/313 [==========>...................] - ETA: 0s - loss: 0.3971 - accuracy: 0.9393137/313 [============>.................] - ETA: 0s - loss: 0.4247 - accuracy: 0.9386150/313 [=============>................] - ETA: 0s - loss: 0.4316 - accuracy: 0.9396163/313 [==============>...............] - ETA: 0s - loss: 0.4303 - accuracy: 0.9404177/313 [===============>..............] - ETA: 0s - loss: 0.4096 - accuracy: 0.9435191/313 [=================>............] - ETA: 0s - loss: 0.4102 - accuracy: 0.9429204/313 [==================>...........] - ETA: 0s - loss: 0.4061 - accuracy: 0.9441217/313 [===================>..........] - ETA: 0s - loss: 0.3969 - accuracy: 0.9446230/313 [=====================>........] - ETA: 0s - loss: 0.3788 - accuracy: 0.9469243/313 [======================>.......] - ETA: 0s - loss: 0.3623 - accuracy: 0.9487257/313 [=======================>......] - ETA: 0s - loss: 0.3553 - accuracy: 0.9498271/313 [========================>.....] - ETA: 0s - loss: 0.3468 - accuracy: 0.9508285/313 [==========================>...] - ETA: 0s - loss: 0.3428 - accuracy: 0.9523299/313 [===========================>..] - ETA: 0s - loss: 0.3306 - accuracy: 0.9540313/313 [==============================] - ETA: 0s - loss: 0.3423 - accuracy: 0.9523313/313 [==============================] - 3s 4ms/step - loss: 0.3423 - accuracy: 0.9523
Test results: Loss = 0.34228330850601196, Accuracy = 0.9523000121116638
