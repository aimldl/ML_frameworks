Number of devices: 2
batch_size_per_replica: 250
batch_size: 500 = 250 * 2
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
60000 10000
Epoch 1/20
 1/96 [..............................] - ETA: 6:03 - loss: 111.8868 - accuracy: 0.148015/96 [===>..........................] - ETA: 0s - loss: 54.8019 - accuracy: 0.3587   29/96 [========>.....................] - ETA: 0s - loss: 38.6933 - accuracy: 0.464243/96 [============>.................] - ETA: 0s - loss: 30.6280 - accuracy: 0.519657/96 [================>.............] - ETA: 0s - loss: 25.6617 - accuracy: 0.549671/96 [=====================>........] - ETA: 0s - loss: 22.2564 - accuracy: 0.568186/96 [=========================>....] - ETA: 0s - loss: 19.6032 - accuracy: 0.583596/96 [==============================] - 6s 21ms/step - loss: 18.0826 - accuracy: 0.5931 - val_loss: 0.9082 - val_accuracy: 0.7567
Epoch 2/20
 1/96 [..............................] - ETA: 0s - loss: 1.0271 - accuracy: 0.746015/96 [===>..........................] - ETA: 0s - loss: 0.8884 - accuracy: 0.763130/96 [========>.....................] - ETA: 0s - loss: 0.8732 - accuracy: 0.768444/96 [============>.................] - ETA: 0s - loss: 0.8636 - accuracy: 0.772658/96 [=================>............] - ETA: 0s - loss: 0.8547 - accuracy: 0.775972/96 [=====================>........] - ETA: 0s - loss: 0.8452 - accuracy: 0.778986/96 [=========================>....] - ETA: 0s - loss: 0.8358 - accuracy: 0.781896/96 [==============================] - 1s 5ms/step - loss: 0.8287 - accuracy: 0.7840 - val_loss: 0.6794 - val_accuracy: 0.8413
Epoch 3/20
 1/96 [..............................] - ETA: 0s - loss: 0.5106 - accuracy: 0.874015/96 [===>..........................] - ETA: 0s - loss: 0.5684 - accuracy: 0.850329/96 [========>.....................] - ETA: 0s - loss: 0.5710 - accuracy: 0.848643/96 [============>.................] - ETA: 0s - loss: 0.5738 - accuracy: 0.847357/96 [================>.............] - ETA: 0s - loss: 0.5747 - accuracy: 0.847171/96 [=====================>........] - ETA: 0s - loss: 0.5747 - accuracy: 0.847585/96 [=========================>....] - ETA: 0s - loss: 0.5732 - accuracy: 0.848596/96 [==============================] - 1s 6ms/step - loss: 0.5716 - accuracy: 0.8493 - val_loss: 0.5567 - val_accuracy: 0.8710
Epoch 4/20
 1/96 [..............................] - ETA: 0s - loss: 0.3864 - accuracy: 0.890015/96 [===>..........................] - ETA: 0s - loss: 0.4249 - accuracy: 0.882629/96 [========>.....................] - ETA: 0s - loss: 0.4405 - accuracy: 0.880543/96 [============>.................] - ETA: 0s - loss: 0.4433 - accuracy: 0.880457/96 [================>.............] - ETA: 0s - loss: 0.4446 - accuracy: 0.880372/96 [=====================>........] - ETA: 0s - loss: 0.4439 - accuracy: 0.880687/96 [==========================>...] - ETA: 0s - loss: 0.4418 - accuracy: 0.881296/96 [==============================] - 1s 5ms/step - loss: 0.4407 - accuracy: 0.8818 - val_loss: 0.4898 - val_accuracy: 0.8864
Epoch 5/20
 1/96 [..............................] - ETA: 0s - loss: 0.3239 - accuracy: 0.916015/96 [===>..........................] - ETA: 0s - loss: 0.3607 - accuracy: 0.895829/96 [========>.....................] - ETA: 0s - loss: 0.3587 - accuracy: 0.898843/96 [============>.................] - ETA: 0s - loss: 0.3562 - accuracy: 0.900757/96 [================>.............] - ETA: 0s - loss: 0.3532 - accuracy: 0.902471/96 [=====================>........] - ETA: 0s - loss: 0.3507 - accuracy: 0.903785/96 [=========================>....] - ETA: 0s - loss: 0.3491 - accuracy: 0.904696/96 [==============================] - 1s 6ms/step - loss: 0.3480 - accuracy: 0.9052 - val_loss: 0.4452 - val_accuracy: 0.9090
Epoch 6/20
 1/96 [..............................] - ETA: 0s - loss: 0.3408 - accuracy: 0.902015/96 [===>..........................] - ETA: 0s - loss: 0.3028 - accuracy: 0.916029/96 [========>.....................] - ETA: 0s - loss: 0.2912 - accuracy: 0.918543/96 [============>.................] - ETA: 0s - loss: 0.2847 - accuracy: 0.920257/96 [================>.............] - ETA: 0s - loss: 0.2810 - accuracy: 0.921471/96 [=====================>........] - ETA: 0s - loss: 0.2792 - accuracy: 0.922185/96 [=========================>....] - ETA: 0s - loss: 0.2784 - accuracy: 0.922696/96 [==============================] - 1s 5ms/step - loss: 0.2780 - accuracy: 0.9229 - val_loss: 0.4195 - val_accuracy: 0.9151
Epoch 7/20
 1/96 [..............................] - ETA: 0s - loss: 0.3333 - accuracy: 0.902015/96 [===>..........................] - ETA: 0s - loss: 0.2706 - accuracy: 0.923929/96 [========>.....................] - ETA: 0s - loss: 0.2573 - accuracy: 0.926743/96 [============>.................] - ETA: 0s - loss: 0.2506 - accuracy: 0.928158/96 [=================>............] - ETA: 0s - loss: 0.2469 - accuracy: 0.929372/96 [=====================>........] - ETA: 0s - loss: 0.2457 - accuracy: 0.929786/96 [=========================>....] - ETA: 0s - loss: 0.2450 - accuracy: 0.930196/96 [==============================] - 1s 5ms/step - loss: 0.2447 - accuracy: 0.9304 - val_loss: 0.4250 - val_accuracy: 0.9131
Epoch 8/20
 1/96 [..............................] - ETA: 0s - loss: 0.1923 - accuracy: 0.940015/96 [===>..........................] - ETA: 0s - loss: 0.2245 - accuracy: 0.931629/96 [========>.....................] - ETA: 0s - loss: 0.2279 - accuracy: 0.932644/96 [============>.................] - ETA: 0s - loss: 0.2263 - accuracy: 0.934158/96 [=================>............] - ETA: 0s - loss: 0.2245 - accuracy: 0.935173/96 [=====================>........] - ETA: 0s - loss: 0.2226 - accuracy: 0.935988/96 [==========================>...] - ETA: 0s - loss: 0.2207 - accuracy: 0.936596/96 [==============================] - 1s 5ms/step - loss: 0.2197 - accuracy: 0.9368 - val_loss: 0.3712 - val_accuracy: 0.9338
Epoch 9/20
 1/96 [..............................] - ETA: 0s - loss: 0.2067 - accuracy: 0.948015/96 [===>..........................] - ETA: 0s - loss: 0.1907 - accuracy: 0.943829/96 [========>.....................] - ETA: 0s - loss: 0.1889 - accuracy: 0.944143/96 [============>.................] - ETA: 0s - loss: 0.1876 - accuracy: 0.944557/96 [================>.............] - ETA: 0s - loss: 0.1859 - accuracy: 0.944971/96 [=====================>........] - ETA: 0s - loss: 0.1850 - accuracy: 0.945385/96 [=========================>....] - ETA: 0s - loss: 0.1844 - accuracy: 0.945596/96 [==============================] - 1s 6ms/step - loss: 0.1840 - accuracy: 0.9457 - val_loss: 0.3635 - val_accuracy: 0.9373
Epoch 10/20
 1/96 [..............................] - ETA: 0s - loss: 0.0769 - accuracy: 0.974015/96 [===>..........................] - ETA: 0s - loss: 0.1314 - accuracy: 0.959429/96 [========>.....................] - ETA: 0s - loss: 0.1401 - accuracy: 0.957443/96 [============>.................] - ETA: 0s - loss: 0.1430 - accuracy: 0.956957/96 [================>.............] - ETA: 0s - loss: 0.1456 - accuracy: 0.956572/96 [=====================>........] - ETA: 0s - loss: 0.1489 - accuracy: 0.955886/96 [=========================>....] - ETA: 0s - loss: 0.1509 - accuracy: 0.955496/96 [==============================] - 1s 6ms/step - loss: 0.1522 - accuracy: 0.9550 - val_loss: 0.3726 - val_accuracy: 0.9356
Epoch 11/20
 1/96 [..............................] - ETA: 0s - loss: 0.1183 - accuracy: 0.964015/96 [===>..........................] - ETA: 0s - loss: 0.1396 - accuracy: 0.960429/96 [========>.....................] - ETA: 0s - loss: 0.1411 - accuracy: 0.959143/96 [============>.................] - ETA: 0s - loss: 0.1409 - accuracy: 0.958657/96 [================>.............] - ETA: 0s - loss: 0.1405 - accuracy: 0.958472/96 [=====================>........] - ETA: 0s - loss: 0.1400 - accuracy: 0.958486/96 [=========================>....] - ETA: 0s - loss: 0.1401 - accuracy: 0.958496/96 [==============================] - 1s 5ms/step - loss: 0.1403 - accuracy: 0.9584 - val_loss: 0.3458 - val_accuracy: 0.9399
Epoch 12/20
 1/96 [..............................] - ETA: 0s - loss: 0.1757 - accuracy: 0.950015/96 [===>..........................] - ETA: 0s - loss: 0.1357 - accuracy: 0.959130/96 [========>.....................] - ETA: 0s - loss: 0.1332 - accuracy: 0.960144/96 [============>.................] - ETA: 0s - loss: 0.1315 - accuracy: 0.960559/96 [=================>............] - ETA: 0s - loss: 0.1305 - accuracy: 0.960773/96 [=====================>........] - ETA: 0s - loss: 0.1297 - accuracy: 0.960888/96 [==========================>...] - ETA: 0s - loss: 0.1291 - accuracy: 0.961096/96 [==============================] - 1s 6ms/step - loss: 0.1290 - accuracy: 0.9610 - val_loss: 0.3523 - val_accuracy: 0.9433
Epoch 13/20
 1/96 [..............................] - ETA: 0s - loss: 0.0944 - accuracy: 0.974016/96 [====>.........................] - ETA: 0s - loss: 0.1219 - accuracy: 0.962730/96 [========>.....................] - ETA: 0s - loss: 0.1215 - accuracy: 0.963144/96 [============>.................] - ETA: 0s - loss: 0.1202 - accuracy: 0.963958/96 [=================>............] - ETA: 0s - loss: 0.1190 - accuracy: 0.964472/96 [=====================>........] - ETA: 0s - loss: 0.1182 - accuracy: 0.964686/96 [=========================>....] - ETA: 0s - loss: 0.1179 - accuracy: 0.964896/96 [==============================] - 1s 5ms/step - loss: 0.1176 - accuracy: 0.9649 - val_loss: 0.3643 - val_accuracy: 0.9432
Epoch 14/20
 1/96 [..............................] - ETA: 0s - loss: 0.0834 - accuracy: 0.964015/96 [===>..........................] - ETA: 0s - loss: 0.0794 - accuracy: 0.973730/96 [========>.....................] - ETA: 0s - loss: 0.0837 - accuracy: 0.972944/96 [============>.................] - ETA: 0s - loss: 0.0865 - accuracy: 0.972058/96 [=================>............] - ETA: 0s - loss: 0.0882 - accuracy: 0.971572/96 [=====================>........] - ETA: 0s - loss: 0.0896 - accuracy: 0.971286/96 [=========================>....] - ETA: 0s - loss: 0.0906 - accuracy: 0.970996/96 [==============================] - 1s 6ms/step - loss: 0.0914 - accuracy: 0.9707 - val_loss: 0.3417 - val_accuracy: 0.9478
Epoch 15/20
 1/96 [..............................] - ETA: 0s - loss: 0.0977 - accuracy: 0.966015/96 [===>..........................] - ETA: 0s - loss: 0.0908 - accuracy: 0.969529/96 [========>.....................] - ETA: 0s - loss: 0.0898 - accuracy: 0.970643/96 [============>.................] - ETA: 0s - loss: 0.0892 - accuracy: 0.971357/96 [================>.............] - ETA: 0s - loss: 0.0888 - accuracy: 0.971671/96 [=====================>........] - ETA: 0s - loss: 0.0886 - accuracy: 0.971885/96 [=========================>....] - ETA: 0s - loss: 0.0886 - accuracy: 0.972096/96 [==============================] - 1s 5ms/step - loss: 0.0886 - accuracy: 0.9720 - val_loss: 0.3637 - val_accuracy: 0.9493
Epoch 16/20
 1/96 [..............................] - ETA: 0s - loss: 0.0742 - accuracy: 0.976015/96 [===>..........................] - ETA: 0s - loss: 0.0802 - accuracy: 0.974629/96 [========>.....................] - ETA: 0s - loss: 0.0825 - accuracy: 0.973843/96 [============>.................] - ETA: 0s - loss: 0.0837 - accuracy: 0.973757/96 [================>.............] - ETA: 0s - loss: 0.0844 - accuracy: 0.973672/96 [=====================>........] - ETA: 0s - loss: 0.0849 - accuracy: 0.973586/96 [=========================>....] - ETA: 0s - loss: 0.0852 - accuracy: 0.973596/96 [==============================] - 1s 5ms/step - loss: 0.0852 - accuracy: 0.9734 - val_loss: 0.3292 - val_accuracy: 0.9522
Epoch 17/20
 1/96 [..............................] - ETA: 0s - loss: 0.0421 - accuracy: 0.986015/96 [===>..........................] - ETA: 0s - loss: 0.0544 - accuracy: 0.982329/96 [========>.....................] - ETA: 0s - loss: 0.0602 - accuracy: 0.980743/96 [============>.................] - ETA: 0s - loss: 0.0642 - accuracy: 0.979657/96 [================>.............] - ETA: 0s - loss: 0.0671 - accuracy: 0.978771/96 [=====================>........] - ETA: 0s - loss: 0.0693 - accuracy: 0.978085/96 [=========================>....] - ETA: 0s - loss: 0.0712 - accuracy: 0.977496/96 [==============================] - 1s 5ms/step - loss: 0.0724 - accuracy: 0.9770 - val_loss: 0.3646 - val_accuracy: 0.9503
Epoch 18/20
 1/96 [..............................] - ETA: 0s - loss: 0.0984 - accuracy: 0.964015/96 [===>..........................] - ETA: 0s - loss: 0.0814 - accuracy: 0.971330/96 [========>.....................] - ETA: 0s - loss: 0.0811 - accuracy: 0.972145/96 [=============>................] - ETA: 0s - loss: 0.0796 - accuracy: 0.972959/96 [=================>............] - ETA: 0s - loss: 0.0796 - accuracy: 0.973373/96 [=====================>........] - ETA: 0s - loss: 0.0797 - accuracy: 0.973587/96 [==========================>...] - ETA: 0s - loss: 0.0796 - accuracy: 0.973796/96 [==============================] - 1s 5ms/step - loss: 0.0797 - accuracy: 0.9738 - val_loss: 0.3348 - val_accuracy: 0.9505
Epoch 19/20
 1/96 [..............................] - ETA: 0s - loss: 0.0760 - accuracy: 0.976015/96 [===>..........................] - ETA: 0s - loss: 0.0771 - accuracy: 0.977130/96 [========>.....................] - ETA: 0s - loss: 0.0755 - accuracy: 0.977045/96 [=============>................] - ETA: 0s - loss: 0.0759 - accuracy: 0.976759/96 [=================>............] - ETA: 0s - loss: 0.0773 - accuracy: 0.976473/96 [=====================>........] - ETA: 0s - loss: 0.0790 - accuracy: 0.976087/96 [==========================>...] - ETA: 0s - loss: 0.0810 - accuracy: 0.975596/96 [==============================] - 1s 5ms/step - loss: 0.0824 - accuracy: 0.9752 - val_loss: 0.3557 - val_accuracy: 0.9470
Epoch 20/20
 1/96 [..............................] - ETA: 0s - loss: 0.1077 - accuracy: 0.974015/96 [===>..........................] - ETA: 0s - loss: 0.0928 - accuracy: 0.973130/96 [========>.....................] - ETA: 0s - loss: 0.0915 - accuracy: 0.974244/96 [============>.................] - ETA: 0s - loss: 0.0908 - accuracy: 0.974658/96 [=================>............] - ETA: 0s - loss: 0.0898 - accuracy: 0.974772/96 [=====================>........] - ETA: 0s - loss: 0.0889 - accuracy: 0.974886/96 [=========================>....] - ETA: 0s - loss: 0.0879 - accuracy: 0.975096/96 [==============================] - 1s 6ms/step - loss: 0.0873 - accuracy: 0.9751 - val_loss: 0.3397 - val_accuracy: 0.9493
training_time: 0:00:16.154947
  1/313 [..............................] - ETA: 7:50 - loss: 0.1640 - accuracy: 0.9375 14/313 [>.............................] - ETA: 1s - loss: 0.2349 - accuracy: 0.9487   28/313 [=>............................] - ETA: 1s - loss: 0.2059 - accuracy: 0.9498 42/313 [===>..........................] - ETA: 1s - loss: 0.3100 - accuracy: 0.9368 56/313 [====>.........................] - ETA: 0s - loss: 0.3476 - accuracy: 0.9358 70/313 [=====>........................] - ETA: 0s - loss: 0.3873 - accuracy: 0.9353 84/313 [=======>......................] - ETA: 0s - loss: 0.4485 - accuracy: 0.9353 98/313 [========>.....................] - ETA: 0s - loss: 0.4495 - accuracy: 0.9346112/313 [=========>....................] - ETA: 0s - loss: 0.4554 - accuracy: 0.9355126/313 [===========>..................] - ETA: 0s - loss: 0.4724 - accuracy: 0.9335139/313 [============>.................] - ETA: 0s - loss: 0.4527 - accuracy: 0.9344152/313 [=============>................] - ETA: 0s - loss: 0.4439 - accuracy: 0.9346166/313 [==============>...............] - ETA: 0s - loss: 0.4250 - accuracy: 0.9369180/313 [================>.............] - ETA: 0s - loss: 0.4180 - accuracy: 0.9389194/313 [=================>............] - ETA: 0s - loss: 0.4148 - accuracy: 0.9377208/313 [==================>...........] - ETA: 0s - loss: 0.4040 - accuracy: 0.9392221/313 [====================>.........] - ETA: 0s - loss: 0.3887 - accuracy: 0.9415234/313 [=====================>........] - ETA: 0s - loss: 0.3702 - accuracy: 0.9438247/313 [======================>.......] - ETA: 0s - loss: 0.3570 - accuracy: 0.9451260/313 [=======================>......] - ETA: 0s - loss: 0.3491 - accuracy: 0.9456273/313 [=========================>....] - ETA: 0s - loss: 0.3383 - accuracy: 0.9469286/313 [==========================>...] - ETA: 0s - loss: 0.3382 - accuracy: 0.9483299/313 [===========================>..] - ETA: 0s - loss: 0.3271 - accuracy: 0.9501312/313 [============================>.] - ETA: 0s - loss: 0.3457 - accuracy: 0.9484313/313 [==============================] - 3s 4ms/step - loss: 0.3452 - accuracy: 0.9485
Test results: Loss = 0.3451596796512604, Accuracy = 0.9484999775886536
