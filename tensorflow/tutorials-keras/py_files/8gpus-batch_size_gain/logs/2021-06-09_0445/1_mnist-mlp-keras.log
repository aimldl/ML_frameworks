Number of devices: 8
batch_size_per_replica: 250
batch_size: 2000 = 250 * 8
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
60000 10000
Epoch 1/20
 1/24 [>.............................] - ETA: 20s - loss: 160.3710 - accuracy: 0.138519/24 [======================>.......] - ETA: 0s - loss: 61.2504 - accuracy: 0.3501  24/24 [==============================] - 1s 24ms/step - loss: 52.4997 - accuracy: 0.4003 - val_loss: 3.0683 - val_accuracy: 0.7553
Epoch 2/20
 1/24 [>.............................] - ETA: 0s - loss: 3.3057 - accuracy: 0.749019/24 [======================>.......] - ETA: 0s - loss: 2.5066 - accuracy: 0.713324/24 [==============================] - 0s 5ms/step - loss: 2.3694 - accuracy: 0.7042 - val_loss: 1.2562 - val_accuracy: 0.6413
Epoch 3/20
 1/24 [>.............................] - ETA: 0s - loss: 1.2177 - accuracy: 0.620020/24 [========================>.....] - ETA: 0s - loss: 1.2121 - accuracy: 0.651224/24 [==============================] - 0s 5ms/step - loss: 1.1961 - accuracy: 0.6608 - val_loss: 0.9906 - val_accuracy: 0.7838
Epoch 4/20
 1/24 [>.............................] - ETA: 0s - loss: 0.9298 - accuracy: 0.778020/24 [========================>.....] - ETA: 0s - loss: 0.9403 - accuracy: 0.779624/24 [==============================] - 0s 5ms/step - loss: 0.9369 - accuracy: 0.7795 - val_loss: 0.8732 - val_accuracy: 0.8050
Epoch 5/20
 1/24 [>.............................] - ETA: 0s - loss: 0.8532 - accuracy: 0.805020/24 [========================>.....] - ETA: 0s - loss: 0.8037 - accuracy: 0.801724/24 [==============================] - 0s 5ms/step - loss: 0.8003 - accuracy: 0.8024 - val_loss: 0.7716 - val_accuracy: 0.8251
Epoch 6/20
 1/24 [>.............................] - ETA: 0s - loss: 0.6454 - accuracy: 0.817020/24 [========================>.....] - ETA: 0s - loss: 0.6978 - accuracy: 0.818924/24 [==============================] - 0s 6ms/step - loss: 0.6959 - accuracy: 0.8199 - val_loss: 0.7135 - val_accuracy: 0.8436
Epoch 7/20
 1/24 [>.............................] - ETA: 0s - loss: 0.7012 - accuracy: 0.841020/24 [========================>.....] - ETA: 0s - loss: 0.6275 - accuracy: 0.842924/24 [==============================] - 0s 5ms/step - loss: 0.6248 - accuracy: 0.8434 - val_loss: 0.6656 - val_accuracy: 0.8553
Epoch 8/20
 1/24 [>.............................] - ETA: 0s - loss: 0.5701 - accuracy: 0.852020/24 [========================>.....] - ETA: 0s - loss: 0.5564 - accuracy: 0.858524/24 [==============================] - 0s 5ms/step - loss: 0.5545 - accuracy: 0.8590 - val_loss: 0.6289 - val_accuracy: 0.8637
Epoch 9/20
 1/24 [>.............................] - ETA: 0s - loss: 0.4316 - accuracy: 0.881520/24 [========================>.....] - ETA: 0s - loss: 0.4899 - accuracy: 0.871224/24 [==============================] - 0s 7ms/step - loss: 0.4913 - accuracy: 0.8715 - val_loss: 0.5898 - val_accuracy: 0.8701
Epoch 10/20
 1/24 [>.............................] - ETA: 0s - loss: 0.4709 - accuracy: 0.872020/24 [========================>.....] - ETA: 0s - loss: 0.4616 - accuracy: 0.875924/24 [==============================] - 0s 5ms/step - loss: 0.4610 - accuracy: 0.8767 - val_loss: 0.5720 - val_accuracy: 0.8763
Epoch 11/20
 1/24 [>.............................] - ETA: 0s - loss: 0.4125 - accuracy: 0.880020/24 [========================>.....] - ETA: 0s - loss: 0.4305 - accuracy: 0.883424/24 [==============================] - 0s 5ms/step - loss: 0.4286 - accuracy: 0.8844 - val_loss: 0.5528 - val_accuracy: 0.8838
Epoch 12/20
 1/24 [>.............................] - ETA: 0s - loss: 0.3742 - accuracy: 0.896020/24 [========================>.....] - ETA: 0s - loss: 0.3918 - accuracy: 0.896724/24 [==============================] - 0s 5ms/step - loss: 0.3909 - accuracy: 0.8969 - val_loss: 0.5432 - val_accuracy: 0.8936
Epoch 13/20
 1/24 [>.............................] - ETA: 0s - loss: 0.2792 - accuracy: 0.923019/24 [======================>.......] - ETA: 0s - loss: 0.3533 - accuracy: 0.905824/24 [==============================] - 0s 5ms/step - loss: 0.3551 - accuracy: 0.9052 - val_loss: 0.5276 - val_accuracy: 0.8948
Epoch 14/20
 1/24 [>.............................] - ETA: 0s - loss: 0.3255 - accuracy: 0.909520/24 [========================>.....] - ETA: 0s - loss: 0.3384 - accuracy: 0.908724/24 [==============================] - 0s 6ms/step - loss: 0.3378 - accuracy: 0.9088 - val_loss: 0.5209 - val_accuracy: 0.8993
Epoch 15/20
 1/24 [>.............................] - ETA: 0s - loss: 0.2924 - accuracy: 0.921019/24 [======================>.......] - ETA: 0s - loss: 0.3012 - accuracy: 0.917524/24 [==============================] - 0s 5ms/step - loss: 0.3031 - accuracy: 0.9169 - val_loss: 0.5133 - val_accuracy: 0.9008
Epoch 16/20
 1/24 [>.............................] - ETA: 0s - loss: 0.2930 - accuracy: 0.915020/24 [========================>.....] - ETA: 0s - loss: 0.2894 - accuracy: 0.918324/24 [==============================] - 0s 6ms/step - loss: 0.2897 - accuracy: 0.9184 - val_loss: 0.5015 - val_accuracy: 0.9057
Epoch 17/20
 1/24 [>.............................] - ETA: 0s - loss: 0.2949 - accuracy: 0.915518/24 [=====================>........] - ETA: 0s - loss: 0.2795 - accuracy: 0.920524/24 [==============================] - 0s 6ms/step - loss: 0.2776 - accuracy: 0.9209 - val_loss: 0.4927 - val_accuracy: 0.9094
Epoch 18/20
 1/24 [>.............................] - ETA: 0s - loss: 0.2282 - accuracy: 0.928020/24 [========================>.....] - ETA: 0s - loss: 0.2542 - accuracy: 0.926824/24 [==============================] - 0s 5ms/step - loss: 0.2542 - accuracy: 0.9268 - val_loss: 0.4826 - val_accuracy: 0.9066
Epoch 19/20
 1/24 [>.............................] - ETA: 0s - loss: 0.2288 - accuracy: 0.935021/24 [=========================>....] - ETA: 0s - loss: 0.2379 - accuracy: 0.930724/24 [==============================] - 0s 5ms/step - loss: 0.2382 - accuracy: 0.9307 - val_loss: 0.4785 - val_accuracy: 0.9110
Epoch 20/20
 1/24 [>.............................] - ETA: 0s - loss: 0.2276 - accuracy: 0.922520/24 [========================>.....] - ETA: 0s - loss: 0.2286 - accuracy: 0.931324/24 [==============================] - 0s 5ms/step - loss: 0.2290 - accuracy: 0.9314 - val_loss: 0.4659 - val_accuracy: 0.9133
training_time: 0:00:04.026496
  1/313 [..............................] - ETA: 48s - loss: 0.2359 - accuracy: 0.9688 21/313 [=>............................] - ETA: 0s - loss: 0.5305 - accuracy: 0.8988  40/313 [==>...........................] - ETA: 0s - loss: 0.6527 - accuracy: 0.8930 60/313 [====>.........................] - ETA: 0s - loss: 0.6362 - accuracy: 0.8875 81/313 [======>.......................] - ETA: 0s - loss: 0.6271 - accuracy: 0.8839100/313 [========>.....................] - ETA: 0s - loss: 0.5928 - accuracy: 0.8863120/313 [==========>...................] - ETA: 0s - loss: 0.5951 - accuracy: 0.8893139/313 [============>.................] - ETA: 0s - loss: 0.6283 - accuracy: 0.8844158/313 [==============>...............] - ETA: 0s - loss: 0.6142 - accuracy: 0.8843178/313 [================>.............] - ETA: 0s - loss: 0.5711 - accuracy: 0.8929198/313 [=================>............] - ETA: 0s - loss: 0.5450 - accuracy: 0.8957218/313 [===================>..........] - ETA: 0s - loss: 0.5321 - accuracy: 0.8984239/313 [=====================>........] - ETA: 0s - loss: 0.5040 - accuracy: 0.9036260/313 [=======================>......] - ETA: 0s - loss: 0.4950 - accuracy: 0.9049280/313 [=========================>....] - ETA: 0s - loss: 0.4676 - accuracy: 0.9096300/313 [===========================>..] - ETA: 0s - loss: 0.4571 - accuracy: 0.9132313/313 [==============================] - 1s 3ms/step - loss: 0.4703 - accuracy: 0.9123
Test results: Loss = 0.47028017044067383, Accuracy = 0.9122999906539917
