Number of devices: 8
batch_size_per_replica: 128
batch_size: 1024 = 128 * 8
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
x_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
<class 'numpy.ndarray'> <class 'numpy.ndarray'>
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 26, 26, 32)        320       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 13, 13, 32)        0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 11, 11, 64)        18496     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 5, 5, 64)          0         
_________________________________________________________________
flatten (Flatten)            (None, 1600)              0         
_________________________________________________________________
dropout (Dropout)            (None, 1600)              0         
_________________________________________________________________
dense (Dense)                (None, 10)                16010     
=================================================================
Total params: 34,826
Trainable params: 34,826
Non-trainable params: 0
_________________________________________________________________
Epoch 1/15
 1/53 [..............................] - ETA: 2:18 - loss: 2.3034 - accuracy: 0.1035 2/53 [>.............................] - ETA: 5s - loss: 2.2918 - accuracy: 0.1140   3/53 [>.............................] - ETA: 5s - loss: 2.2798 - accuracy: 0.1323 4/53 [=>............................] - ETA: 4s - loss: 2.2685 - accuracy: 0.1478 5/53 [=>............................] - ETA: 4s - loss: 2.2575 - accuracy: 0.1615 6/53 [==>...........................] - ETA: 4s - loss: 2.2468 - accuracy: 0.1743 9/53 [====>.........................] - ETA: 2s - loss: 2.2133 - accuracy: 0.209612/53 [=====>........................] - ETA: 2s - loss: 2.1766 - accuracy: 0.242815/53 [=======>......................] - ETA: 1s - loss: 2.1359 - accuracy: 0.274018/53 [=========>....................] - ETA: 1s - loss: 2.0912 - accuracy: 0.302321/53 [==========>...................] - ETA: 1s - loss: 2.0442 - accuracy: 0.327424/53 [============>.................] - ETA: 1s - loss: 1.9959 - accuracy: 0.350031/53 [================>.............] - ETA: 0s - loss: 1.8860 - accuracy: 0.394839/53 [=====================>........] - ETA: 0s - loss: 1.7717 - accuracy: 0.436646/53 [=========================>....] - ETA: 0s - loss: 1.6825 - accuracy: 0.467553/53 [==============================] - ETA: 0s - loss: 1.6031 - accuracy: 0.494453/53 [==============================] - 4s 32ms/step - loss: 1.5927 - accuracy: 0.4978 - val_loss: 0.2436 - val_accuracy: 0.9355
Epoch 2/15
 1/53 [..............................] - ETA: 0s - loss: 0.4064 - accuracy: 0.8711 8/53 [===>..........................] - ETA: 0s - loss: 0.3813 - accuracy: 0.882615/53 [=======>......................] - ETA: 0s - loss: 0.3665 - accuracy: 0.886422/53 [===========>..................] - ETA: 0s - loss: 0.3560 - accuracy: 0.889527/53 [==============>...............] - ETA: 0s - loss: 0.3496 - accuracy: 0.891534/53 [==================>...........] - ETA: 0s - loss: 0.3415 - accuracy: 0.894241/53 [======================>.......] - ETA: 0s - loss: 0.3346 - accuracy: 0.896648/53 [==========================>...] - ETA: 0s - loss: 0.3285 - accuracy: 0.898653/53 [==============================] - ETA: 0s - loss: 0.3244 - accuracy: 0.899953/53 [==============================] - 1s 11ms/step - loss: 0.3236 - accuracy: 0.9002 - val_loss: 0.1361 - val_accuracy: 0.9638
Epoch 3/15
 1/53 [..............................] - ETA: 0s - loss: 0.2584 - accuracy: 0.9170 8/53 [===>..........................] - ETA: 0s - loss: 0.2233 - accuracy: 0.931216/53 [========>.....................] - ETA: 0s - loss: 0.2145 - accuracy: 0.934722/53 [===========>..................] - ETA: 0s - loss: 0.2115 - accuracy: 0.935829/53 [===============>..............] - ETA: 0s - loss: 0.2088 - accuracy: 0.936834/53 [==================>...........] - ETA: 0s - loss: 0.2069 - accuracy: 0.937437/53 [===================>..........] - ETA: 0s - loss: 0.2059 - accuracy: 0.937839/53 [=====================>........] - ETA: 0s - loss: 0.2052 - accuracy: 0.938041/53 [======================>.......] - ETA: 0s - loss: 0.2045 - accuracy: 0.938342/53 [======================>.......] - ETA: 0s - loss: 0.2041 - accuracy: 0.938444/53 [=======================>......] - ETA: 0s - loss: 0.2034 - accuracy: 0.938646/53 [=========================>....] - ETA: 0s - loss: 0.2028 - accuracy: 0.938847/53 [=========================>....] - ETA: 0s - loss: 0.2025 - accuracy: 0.938949/53 [==========================>...] - ETA: 0s - loss: 0.2019 - accuracy: 0.939152/53 [============================>.] - ETA: 0s - loss: 0.2011 - accuracy: 0.939453/53 [==============================] - 1s 21ms/step - loss: 0.2005 - accuracy: 0.9396 - val_loss: 0.0994 - val_accuracy: 0.9745
Epoch 4/15
 1/53 [..............................] - ETA: 0s - loss: 0.1222 - accuracy: 0.9639 6/53 [==>...........................] - ETA: 0s - loss: 0.1414 - accuracy: 0.959412/53 [=====>........................] - ETA: 0s - loss: 0.1452 - accuracy: 0.957818/53 [=========>....................] - ETA: 0s - loss: 0.1476 - accuracy: 0.956925/53 [=============>................] - ETA: 0s - loss: 0.1494 - accuracy: 0.956226/53 [=============>................] - ETA: 0s - loss: 0.1497 - accuracy: 0.956132/53 [=================>............] - ETA: 0s - loss: 0.1506 - accuracy: 0.955537/53 [===================>..........] - ETA: 0s - loss: 0.1511 - accuracy: 0.955239/53 [=====================>........] - ETA: 0s - loss: 0.1512 - accuracy: 0.955142/53 [======================>.......] - ETA: 0s - loss: 0.1513 - accuracy: 0.955049/53 [==========================>...] - ETA: 0s - loss: 0.1513 - accuracy: 0.954953/53 [==============================] - ETA: 0s - loss: 0.1512 - accuracy: 0.954953/53 [==============================] - 1s 16ms/step - loss: 0.1512 - accuracy: 0.9549 - val_loss: 0.0842 - val_accuracy: 0.9775
Epoch 5/15
 1/53 [..............................] - ETA: 0s - loss: 0.1569 - accuracy: 0.9531 8/53 [===>..........................] - ETA: 0s - loss: 0.1422 - accuracy: 0.956413/53 [======>.......................] - ETA: 0s - loss: 0.1389 - accuracy: 0.957115/53 [=======>......................] - ETA: 0s - loss: 0.1380 - accuracy: 0.957320/53 [==========>...................] - ETA: 0s - loss: 0.1366 - accuracy: 0.957724/53 [============>.................] - ETA: 0s - loss: 0.1359 - accuracy: 0.957930/53 [===============>..............] - ETA: 0s - loss: 0.1350 - accuracy: 0.958337/53 [===================>..........] - ETA: 0s - loss: 0.1341 - accuracy: 0.958644/53 [=======================>......] - ETA: 0s - loss: 0.1333 - accuracy: 0.958845/53 [========================>.....] - ETA: 0s - loss: 0.1332 - accuracy: 0.958847/53 [=========================>....] - ETA: 0s - loss: 0.1330 - accuracy: 0.958953/53 [==============================] - ETA: 0s - loss: 0.1325 - accuracy: 0.959153/53 [==============================] - 1s 15ms/step - loss: 0.1324 - accuracy: 0.9591 - val_loss: 0.0721 - val_accuracy: 0.9802
Epoch 6/15
 1/53 [..............................] - ETA: 0s - loss: 0.1052 - accuracy: 0.9648 2/53 [>.............................] - ETA: 2s - loss: 0.1059 - accuracy: 0.9651 3/53 [>.............................] - ETA: 3s - loss: 0.1091 - accuracy: 0.9645 9/53 [====>.........................] - ETA: 0s - loss: 0.1186 - accuracy: 0.962511/53 [=====>........................] - ETA: 0s - loss: 0.1188 - accuracy: 0.962515/53 [=======>......................] - ETA: 0s - loss: 0.1197 - accuracy: 0.962220/53 [==========>...................] - ETA: 0s - loss: 0.1199 - accuracy: 0.962221/53 [==========>...................] - ETA: 0s - loss: 0.1198 - accuracy: 0.962224/53 [============>.................] - ETA: 0s - loss: 0.1195 - accuracy: 0.962328/53 [==============>...............] - ETA: 0s - loss: 0.1192 - accuracy: 0.962432/53 [=================>............] - ETA: 0s - loss: 0.1190 - accuracy: 0.962536/53 [===================>..........] - ETA: 0s - loss: 0.1187 - accuracy: 0.962639/53 [=====================>........] - ETA: 0s - loss: 0.1184 - accuracy: 0.962743/53 [=======================>......] - ETA: 0s - loss: 0.1180 - accuracy: 0.962846/53 [=========================>....] - ETA: 0s - loss: 0.1177 - accuracy: 0.962950/53 [===========================>..] - ETA: 0s - loss: 0.1172 - accuracy: 0.963153/53 [==============================] - 1s 23ms/step - loss: 0.1169 - accuracy: 0.9632 - val_loss: 0.0652 - val_accuracy: 0.9817
Epoch 7/15
 1/53 [..............................] - ETA: 3s - loss: 0.1342 - accuracy: 0.9570 2/53 [>.............................] - ETA: 2s - loss: 0.1278 - accuracy: 0.9595 6/53 [==>...........................] - ETA: 1s - loss: 0.1176 - accuracy: 0.962712/53 [=====>........................] - ETA: 0s - loss: 0.1096 - accuracy: 0.965115/53 [=======>......................] - ETA: 0s - loss: 0.1078 - accuracy: 0.965619/53 [=========>....................] - ETA: 0s - loss: 0.1067 - accuracy: 0.965923/53 [============>.................] - ETA: 0s - loss: 0.1061 - accuracy: 0.966129/53 [===============>..............] - ETA: 0s - loss: 0.1051 - accuracy: 0.966632/53 [=================>............] - ETA: 0s - loss: 0.1047 - accuracy: 0.966837/53 [===================>..........] - ETA: 0s - loss: 0.1040 - accuracy: 0.967140/53 [=====================>........] - ETA: 0s - loss: 0.1037 - accuracy: 0.967242/53 [======================>.......] - ETA: 0s - loss: 0.1035 - accuracy: 0.967345/53 [========================>.....] - ETA: 0s - loss: 0.1033 - accuracy: 0.967449/53 [==========================>...] - ETA: 0s - loss: 0.1031 - accuracy: 0.967651/53 [===========================>..] - ETA: 0s - loss: 0.1030 - accuracy: 0.967652/53 [============================>.] - ETA: 0s - loss: 0.1029 - accuracy: 0.967653/53 [==============================] - 1s 19ms/step - loss: 0.1029 - accuracy: 0.9677 - val_loss: 0.0601 - val_accuracy: 0.9828
Epoch 8/15
 1/53 [..............................] - ETA: 0s - loss: 0.1017 - accuracy: 0.9707 7/53 [==>...........................] - ETA: 0s - loss: 0.1011 - accuracy: 0.9695 9/53 [====>.........................] - ETA: 0s - loss: 0.1019 - accuracy: 0.969314/53 [======>.......................] - ETA: 0s - loss: 0.1019 - accuracy: 0.969319/53 [=========>....................] - ETA: 0s - loss: 0.1012 - accuracy: 0.969523/53 [============>.................] - ETA: 0s - loss: 0.1007 - accuracy: 0.969627/53 [==============>...............] - ETA: 0s - loss: 0.1002 - accuracy: 0.969732/53 [=================>............] - ETA: 0s - loss: 0.0994 - accuracy: 0.969938/53 [====================>.........] - ETA: 0s - loss: 0.0985 - accuracy: 0.970244/53 [=======================>......] - ETA: 0s - loss: 0.0978 - accuracy: 0.970449/53 [==========================>...] - ETA: 0s - loss: 0.0973 - accuracy: 0.970653/53 [==============================] - 1s 16ms/step - loss: 0.0968 - accuracy: 0.9707 - val_loss: 0.0560 - val_accuracy: 0.9842
Epoch 9/15
 1/53 [..............................] - ETA: 0s - loss: 0.0684 - accuracy: 0.9775 7/53 [==>...........................] - ETA: 0s - loss: 0.0824 - accuracy: 0.971913/53 [======>.......................] - ETA: 0s - loss: 0.0854 - accuracy: 0.971020/53 [==========>...................] - ETA: 0s - loss: 0.0870 - accuracy: 0.970928/53 [==============>...............] - ETA: 0s - loss: 0.0880 - accuracy: 0.970935/53 [==================>...........] - ETA: 0s - loss: 0.0883 - accuracy: 0.971143/53 [=======================>......] - ETA: 0s - loss: 0.0884 - accuracy: 0.971350/53 [===========================>..] - ETA: 0s - loss: 0.0883 - accuracy: 0.971553/53 [==============================] - ETA: 0s - loss: 0.0882 - accuracy: 0.971653/53 [==============================] - 1s 10ms/step - loss: 0.0882 - accuracy: 0.9717 - val_loss: 0.0515 - val_accuracy: 0.9860
Epoch 10/15
 1/53 [..............................] - ETA: 0s - loss: 0.0783 - accuracy: 0.9785 9/53 [====>.........................] - ETA: 0s - loss: 0.0784 - accuracy: 0.977817/53 [========>.....................] - ETA: 0s - loss: 0.0793 - accuracy: 0.977023/53 [============>.................] - ETA: 0s - loss: 0.0796 - accuracy: 0.976630/53 [===============>..............] - ETA: 0s - loss: 0.0797 - accuracy: 0.976337/53 [===================>..........] - ETA: 0s - loss: 0.0798 - accuracy: 0.976144/53 [=======================>......] - ETA: 0s - loss: 0.0801 - accuracy: 0.975850/53 [===========================>..] - ETA: 0s - loss: 0.0803 - accuracy: 0.975753/53 [==============================] - 1s 10ms/step - loss: 0.0803 - accuracy: 0.9757 - val_loss: 0.0493 - val_accuracy: 0.9867
Epoch 11/15
 1/53 [..............................] - ETA: 0s - loss: 0.0697 - accuracy: 0.9785 9/53 [====>.........................] - ETA: 0s - loss: 0.0726 - accuracy: 0.977917/53 [========>.....................] - ETA: 0s - loss: 0.0759 - accuracy: 0.976925/53 [=============>................] - ETA: 0s - loss: 0.0771 - accuracy: 0.976432/53 [=================>............] - ETA: 0s - loss: 0.0778 - accuracy: 0.976140/53 [=====================>........] - ETA: 0s - loss: 0.0782 - accuracy: 0.976048/53 [==========================>...] - ETA: 0s - loss: 0.0784 - accuracy: 0.975953/53 [==============================] - 0s 9ms/step - loss: 0.0783 - accuracy: 0.9759 - val_loss: 0.0465 - val_accuracy: 0.9867
Epoch 12/15
 1/53 [..............................] - ETA: 0s - loss: 0.0562 - accuracy: 0.9805 9/53 [====>.........................] - ETA: 0s - loss: 0.0691 - accuracy: 0.976216/53 [========>.....................] - ETA: 0s - loss: 0.0708 - accuracy: 0.976024/53 [============>.................] - ETA: 0s - loss: 0.0714 - accuracy: 0.976131/53 [================>.............] - ETA: 0s - loss: 0.0718 - accuracy: 0.976338/53 [====================>.........] - ETA: 0s - loss: 0.0720 - accuracy: 0.976445/53 [========================>.....] - ETA: 0s - loss: 0.0721 - accuracy: 0.976551/53 [===========================>..] - ETA: 0s - loss: 0.0720 - accuracy: 0.976653/53 [==============================] - 0s 9ms/step - loss: 0.0720 - accuracy: 0.9767 - val_loss: 0.0454 - val_accuracy: 0.9877
Epoch 13/15
 1/53 [..............................] - ETA: 0s - loss: 0.0545 - accuracy: 0.9844 8/53 [===>..........................] - ETA: 0s - loss: 0.0667 - accuracy: 0.979215/53 [=======>......................] - ETA: 0s - loss: 0.0684 - accuracy: 0.978422/53 [===========>..................] - ETA: 0s - loss: 0.0685 - accuracy: 0.978429/53 [===============>..............] - ETA: 0s - loss: 0.0687 - accuracy: 0.978437/53 [===================>..........] - ETA: 0s - loss: 0.0685 - accuracy: 0.978545/53 [========================>.....] - ETA: 0s - loss: 0.0682 - accuracy: 0.978752/53 [============================>.] - ETA: 0s - loss: 0.0680 - accuracy: 0.978753/53 [==============================] - 0s 9ms/step - loss: 0.0680 - accuracy: 0.9787 - val_loss: 0.0433 - val_accuracy: 0.9883
Epoch 14/15
 1/53 [..............................] - ETA: 0s - loss: 0.0703 - accuracy: 0.9727 8/53 [===>..........................] - ETA: 0s - loss: 0.0663 - accuracy: 0.978215/53 [=======>......................] - ETA: 0s - loss: 0.0641 - accuracy: 0.979619/53 [=========>....................] - ETA: 0s - loss: 0.0635 - accuracy: 0.980126/53 [=============>................] - ETA: 0s - loss: 0.0634 - accuracy: 0.980431/53 [================>.............] - ETA: 0s - loss: 0.0633 - accuracy: 0.980538/53 [====================>.........] - ETA: 0s - loss: 0.0635 - accuracy: 0.980544/53 [=======================>......] - ETA: 0s - loss: 0.0637 - accuracy: 0.980551/53 [===========================>..] - ETA: 0s - loss: 0.0639 - accuracy: 0.980453/53 [==============================] - 1s 11ms/step - loss: 0.0640 - accuracy: 0.9804 - val_loss: 0.0396 - val_accuracy: 0.9898
Epoch 15/15
 1/53 [..............................] - ETA: 0s - loss: 0.0458 - accuracy: 0.9873 8/53 [===>..........................] - ETA: 0s - loss: 0.0627 - accuracy: 0.981515/53 [=======>......................] - ETA: 0s - loss: 0.0645 - accuracy: 0.980422/53 [===========>..................] - ETA: 0s - loss: 0.0640 - accuracy: 0.980429/53 [===============>..............] - ETA: 0s - loss: 0.0636 - accuracy: 0.980436/53 [===================>..........] - ETA: 0s - loss: 0.0634 - accuracy: 0.980444/53 [=======================>......] - ETA: 0s - loss: 0.0632 - accuracy: 0.980452/53 [============================>.] - ETA: 0s - loss: 0.0632 - accuracy: 0.980453/53 [==============================] - 0s 9ms/step - loss: 0.0632 - accuracy: 0.9804 - val_loss: 0.0416 - val_accuracy: 0.9892
training_time: 0:00:14.617641
Test loss: 0.03871370851993561
Test accuracy: 0.9878000020980835
