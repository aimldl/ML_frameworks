Number of devices: 8
batch_size_per_replica: 128
batch_size: 1024 = 128 * 8
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
x_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
<class 'numpy.ndarray'> <class 'numpy.ndarray'>
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 26, 26, 32)        320       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 13, 13, 32)        0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 11, 11, 64)        18496     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 5, 5, 64)          0         
_________________________________________________________________
flatten (Flatten)            (None, 1600)              0         
_________________________________________________________________
dropout (Dropout)            (None, 1600)              0         
_________________________________________________________________
dense (Dense)                (None, 10)                16010     
=================================================================
Total params: 34,826
Trainable params: 34,826
Non-trainable params: 0
_________________________________________________________________
Epoch 1/15
 1/53 [..............................] - ETA: 2:21 - loss: 2.3037 - accuracy: 0.0938 2/53 [>.............................] - ETA: 5s - loss: 2.2941 - accuracy: 0.1116   3/53 [>.............................] - ETA: 4s - loss: 2.2849 - accuracy: 0.1287 4/53 [=>............................] - ETA: 4s - loss: 2.2757 - accuracy: 0.1447 6/53 [==>...........................] - ETA: 2s - loss: 2.2575 - accuracy: 0.174214/53 [======>.......................] - ETA: 1s - loss: 2.1769 - accuracy: 0.268822/53 [===========>..................] - ETA: 0s - loss: 2.0755 - accuracy: 0.336530/53 [===============>..............] - ETA: 0s - loss: 1.9619 - accuracy: 0.387738/53 [====================>.........] - ETA: 0s - loss: 1.8516 - accuracy: 0.428946/53 [=========================>....] - ETA: 0s - loss: 1.7520 - accuracy: 0.463153/53 [==============================] - ETA: 0s - loss: 1.6740 - accuracy: 0.488853/53 [==============================] - 4s 25ms/step - loss: 1.6637 - accuracy: 0.4922 - val_loss: 0.2702 - val_accuracy: 0.9252
Epoch 2/15
 1/53 [..............................] - ETA: 0s - loss: 0.4248 - accuracy: 0.8818 9/53 [====>.........................] - ETA: 0s - loss: 0.4097 - accuracy: 0.879017/53 [========>.....................] - ETA: 0s - loss: 0.3973 - accuracy: 0.882125/53 [=============>................] - ETA: 0s - loss: 0.3868 - accuracy: 0.884933/53 [=================>............] - ETA: 0s - loss: 0.3762 - accuracy: 0.888141/53 [======================>.......] - ETA: 0s - loss: 0.3667 - accuracy: 0.890848/53 [==========================>...] - ETA: 0s - loss: 0.3591 - accuracy: 0.893053/53 [==============================] - ETA: 0s - loss: 0.3542 - accuracy: 0.894453/53 [==============================] - 1s 11ms/step - loss: 0.3533 - accuracy: 0.8947 - val_loss: 0.1384 - val_accuracy: 0.9657
Epoch 3/15
 1/53 [..............................] - ETA: 0s - loss: 0.2262 - accuracy: 0.9355 8/53 [===>..........................] - ETA: 0s - loss: 0.2166 - accuracy: 0.936815/53 [=======>......................] - ETA: 0s - loss: 0.2124 - accuracy: 0.938122/53 [===========>..................] - ETA: 0s - loss: 0.2110 - accuracy: 0.938129/53 [===============>..............] - ETA: 0s - loss: 0.2104 - accuracy: 0.938137/53 [===================>..........] - ETA: 0s - loss: 0.2088 - accuracy: 0.938345/53 [========================>.....] - ETA: 0s - loss: 0.2066 - accuracy: 0.938753/53 [==============================] - ETA: 0s - loss: 0.2042 - accuracy: 0.939253/53 [==============================] - 0s 9ms/step - loss: 0.2039 - accuracy: 0.9393 - val_loss: 0.0981 - val_accuracy: 0.9752
Epoch 4/15
 1/53 [..............................] - ETA: 0s - loss: 0.1242 - accuracy: 0.9658 8/53 [===>..........................] - ETA: 0s - loss: 0.1517 - accuracy: 0.954716/53 [========>.....................] - ETA: 0s - loss: 0.1522 - accuracy: 0.954623/53 [============>.................] - ETA: 0s - loss: 0.1521 - accuracy: 0.954530/53 [===============>..............] - ETA: 0s - loss: 0.1522 - accuracy: 0.954438/53 [====================>.........] - ETA: 0s - loss: 0.1523 - accuracy: 0.954246/53 [=========================>....] - ETA: 0s - loss: 0.1521 - accuracy: 0.954253/53 [==============================] - ETA: 0s - loss: 0.1515 - accuracy: 0.954453/53 [==============================] - 1s 10ms/step - loss: 0.1514 - accuracy: 0.9544 - val_loss: 0.0823 - val_accuracy: 0.9792
Epoch 5/15
 1/53 [..............................] - ETA: 4s - loss: 0.1675 - accuracy: 0.9561 7/53 [==>...........................] - ETA: 0s - loss: 0.1406 - accuracy: 0.961013/53 [======>.......................] - ETA: 0s - loss: 0.1355 - accuracy: 0.961819/53 [=========>....................] - ETA: 0s - loss: 0.1343 - accuracy: 0.961726/53 [=============>................] - ETA: 0s - loss: 0.1329 - accuracy: 0.961931/53 [================>.............] - ETA: 0s - loss: 0.1322 - accuracy: 0.962037/53 [===================>..........] - ETA: 0s - loss: 0.1314 - accuracy: 0.962143/53 [=======================>......] - ETA: 0s - loss: 0.1305 - accuracy: 0.962250/53 [===========================>..] - ETA: 0s - loss: 0.1297 - accuracy: 0.962353/53 [==============================] - 1s 11ms/step - loss: 0.1293 - accuracy: 0.9624 - val_loss: 0.0702 - val_accuracy: 0.9812
Epoch 6/15
 1/53 [..............................] - ETA: 0s - loss: 0.1365 - accuracy: 0.9570 9/53 [====>.........................] - ETA: 0s - loss: 0.1140 - accuracy: 0.963717/53 [========>.....................] - ETA: 0s - loss: 0.1090 - accuracy: 0.965725/53 [=============>................] - ETA: 0s - loss: 0.1077 - accuracy: 0.966332/53 [=================>............] - ETA: 0s - loss: 0.1076 - accuracy: 0.966437/53 [===================>..........] - ETA: 0s - loss: 0.1075 - accuracy: 0.966640/53 [=====================>........] - ETA: 0s - loss: 0.1074 - accuracy: 0.966743/53 [=======================>......] - ETA: 0s - loss: 0.1073 - accuracy: 0.966846/53 [=========================>....] - ETA: 0s - loss: 0.1071 - accuracy: 0.966948/53 [==========================>...] - ETA: 0s - loss: 0.1070 - accuracy: 0.966951/53 [===========================>..] - ETA: 0s - loss: 0.1069 - accuracy: 0.967053/53 [==============================] - ETA: 0s - loss: 0.1068 - accuracy: 0.967053/53 [==============================] - 1s 17ms/step - loss: 0.1068 - accuracy: 0.9671 - val_loss: 0.0643 - val_accuracy: 0.9822
Epoch 7/15
 1/53 [..............................] - ETA: 0s - loss: 0.0753 - accuracy: 0.9766 3/53 [>.............................] - ETA: 2s - loss: 0.0826 - accuracy: 0.9744 6/53 [==>...........................] - ETA: 1s - loss: 0.0881 - accuracy: 0.972611/53 [=====>........................] - ETA: 0s - loss: 0.0907 - accuracy: 0.972012/53 [=====>........................] - ETA: 1s - loss: 0.0911 - accuracy: 0.971917/53 [========>.....................] - ETA: 0s - loss: 0.0924 - accuracy: 0.971420/53 [==========>...................] - ETA: 0s - loss: 0.0928 - accuracy: 0.971323/53 [============>.................] - ETA: 0s - loss: 0.0932 - accuracy: 0.971226/53 [=============>................] - ETA: 0s - loss: 0.0935 - accuracy: 0.971131/53 [================>.............] - ETA: 0s - loss: 0.0936 - accuracy: 0.971235/53 [==================>...........] - ETA: 0s - loss: 0.0937 - accuracy: 0.971239/53 [=====================>........] - ETA: 0s - loss: 0.0938 - accuracy: 0.971143/53 [=======================>......] - ETA: 0s - loss: 0.0938 - accuracy: 0.971144/53 [=======================>......] - ETA: 0s - loss: 0.0939 - accuracy: 0.971150/53 [===========================>..] - ETA: 0s - loss: 0.0940 - accuracy: 0.971153/53 [==============================] - ETA: 0s - loss: 0.0941 - accuracy: 0.971053/53 [==============================] - 1s 21ms/step - loss: 0.0941 - accuracy: 0.9710 - val_loss: 0.0593 - val_accuracy: 0.9832
Epoch 8/15
 1/53 [..............................] - ETA: 0s - loss: 0.0780 - accuracy: 0.9795 8/53 [===>..........................] - ETA: 0s - loss: 0.0879 - accuracy: 0.974415/53 [=======>......................] - ETA: 0s - loss: 0.0892 - accuracy: 0.973521/53 [==========>...................] - ETA: 0s - loss: 0.0900 - accuracy: 0.973426/53 [=============>................] - ETA: 0s - loss: 0.0901 - accuracy: 0.973428/53 [==============>...............] - ETA: 0s - loss: 0.0900 - accuracy: 0.973433/53 [=================>............] - ETA: 0s - loss: 0.0897 - accuracy: 0.973638/53 [====================>.........] - ETA: 0s - loss: 0.0894 - accuracy: 0.973645/53 [========================>.....] - ETA: 0s - loss: 0.0889 - accuracy: 0.973752/53 [============================>.] - ETA: 0s - loss: 0.0887 - accuracy: 0.973753/53 [==============================] - 1s 14ms/step - loss: 0.0886 - accuracy: 0.9737 - val_loss: 0.0550 - val_accuracy: 0.9858
Epoch 9/15
 1/53 [..............................] - ETA: 0s - loss: 0.0642 - accuracy: 0.9775 5/53 [=>............................] - ETA: 0s - loss: 0.0678 - accuracy: 0.978910/53 [====>.........................] - ETA: 0s - loss: 0.0749 - accuracy: 0.977215/53 [=======>......................] - ETA: 0s - loss: 0.0778 - accuracy: 0.976519/53 [=========>....................] - ETA: 0s - loss: 0.0788 - accuracy: 0.976222/53 [===========>..................] - ETA: 0s - loss: 0.0795 - accuracy: 0.976025/53 [=============>................] - ETA: 0s - loss: 0.0801 - accuracy: 0.975830/53 [===============>..............] - ETA: 0s - loss: 0.0807 - accuracy: 0.975636/53 [===================>..........] - ETA: 0s - loss: 0.0812 - accuracy: 0.975440/53 [=====================>........] - ETA: 0s - loss: 0.0814 - accuracy: 0.975345/53 [========================>.....] - ETA: 0s - loss: 0.0816 - accuracy: 0.975346/53 [=========================>....] - ETA: 0s - loss: 0.0816 - accuracy: 0.975350/53 [===========================>..] - ETA: 0s - loss: 0.0817 - accuracy: 0.975253/53 [==============================] - ETA: 0s - loss: 0.0817 - accuracy: 0.975253/53 [==============================] - 1s 17ms/step - loss: 0.0817 - accuracy: 0.9752 - val_loss: 0.0512 - val_accuracy: 0.9865
Epoch 10/15
 1/53 [..............................] - ETA: 0s - loss: 0.0703 - accuracy: 0.9785 5/53 [=>............................] - ETA: 0s - loss: 0.0767 - accuracy: 0.9772 8/53 [===>..........................] - ETA: 0s - loss: 0.0796 - accuracy: 0.976410/53 [====>.........................] - ETA: 0s - loss: 0.0809 - accuracy: 0.976217/53 [========>.....................] - ETA: 0s - loss: 0.0815 - accuracy: 0.976321/53 [==========>...................] - ETA: 0s - loss: 0.0815 - accuracy: 0.976426/53 [=============>................] - ETA: 0s - loss: 0.0811 - accuracy: 0.976533/53 [=================>............] - ETA: 0s - loss: 0.0807 - accuracy: 0.976638/53 [====================>.........] - ETA: 0s - loss: 0.0804 - accuracy: 0.976642/53 [======================>.......] - ETA: 0s - loss: 0.0801 - accuracy: 0.976746/53 [=========================>....] - ETA: 0s - loss: 0.0798 - accuracy: 0.976752/53 [============================>.] - ETA: 0s - loss: 0.0794 - accuracy: 0.976853/53 [==============================] - 1s 17ms/step - loss: 0.0792 - accuracy: 0.9768 - val_loss: 0.0485 - val_accuracy: 0.9877
Epoch 11/15
 1/53 [..............................] - ETA: 0s - loss: 0.0729 - accuracy: 0.9756 7/53 [==>...........................] - ETA: 0s - loss: 0.0673 - accuracy: 0.978414/53 [======>.......................] - ETA: 0s - loss: 0.0696 - accuracy: 0.977618/53 [=========>....................] - ETA: 0s - loss: 0.0703 - accuracy: 0.977525/53 [=============>................] - ETA: 0s - loss: 0.0710 - accuracy: 0.977530/53 [===============>..............] - ETA: 0s - loss: 0.0712 - accuracy: 0.977634/53 [==================>...........] - ETA: 0s - loss: 0.0713 - accuracy: 0.977641/53 [======================>.......] - ETA: 0s - loss: 0.0713 - accuracy: 0.977747/53 [=========================>....] - ETA: 0s - loss: 0.0713 - accuracy: 0.977852/53 [============================>.] - ETA: 0s - loss: 0.0713 - accuracy: 0.977853/53 [==============================] - 1s 13ms/step - loss: 0.0713 - accuracy: 0.9778 - val_loss: 0.0473 - val_accuracy: 0.9875
Epoch 12/15
 1/53 [..............................] - ETA: 0s - loss: 0.0752 - accuracy: 0.9766 7/53 [==>...........................] - ETA: 0s - loss: 0.0724 - accuracy: 0.977510/53 [====>.........................] - ETA: 0s - loss: 0.0735 - accuracy: 0.977115/53 [=======>......................] - ETA: 0s - loss: 0.0741 - accuracy: 0.976817/53 [========>.....................] - ETA: 0s - loss: 0.0740 - accuracy: 0.976824/53 [============>.................] - ETA: 0s - loss: 0.0737 - accuracy: 0.977027/53 [==============>...............] - ETA: 0s - loss: 0.0736 - accuracy: 0.977031/53 [================>.............] - ETA: 0s - loss: 0.0733 - accuracy: 0.977137/53 [===================>..........] - ETA: 0s - loss: 0.0726 - accuracy: 0.977440/53 [=====================>........] - ETA: 0s - loss: 0.0723 - accuracy: 0.977544/53 [=======================>......] - ETA: 0s - loss: 0.0719 - accuracy: 0.977648/53 [==========================>...] - ETA: 0s - loss: 0.0716 - accuracy: 0.977751/53 [===========================>..] - ETA: 0s - loss: 0.0714 - accuracy: 0.977853/53 [==============================] - 1s 16ms/step - loss: 0.0712 - accuracy: 0.9778 - val_loss: 0.0440 - val_accuracy: 0.9887
Epoch 13/15
 1/53 [..............................] - ETA: 0s - loss: 0.0579 - accuracy: 0.9824 7/53 [==>...........................] - ETA: 0s - loss: 0.0654 - accuracy: 0.980011/53 [=====>........................] - ETA: 0s - loss: 0.0660 - accuracy: 0.979818/53 [=========>....................] - ETA: 0s - loss: 0.0666 - accuracy: 0.979625/53 [=============>................] - ETA: 0s - loss: 0.0663 - accuracy: 0.979632/53 [=================>............] - ETA: 0s - loss: 0.0657 - accuracy: 0.979840/53 [=====================>........] - ETA: 0s - loss: 0.0654 - accuracy: 0.980048/53 [==========================>...] - ETA: 0s - loss: 0.0652 - accuracy: 0.980153/53 [==============================] - 1s 9ms/step - loss: 0.0650 - accuracy: 0.9801 - val_loss: 0.0432 - val_accuracy: 0.9887
Epoch 14/15
 1/53 [..............................] - ETA: 0s - loss: 0.0597 - accuracy: 0.9795 8/53 [===>..........................] - ETA: 0s - loss: 0.0567 - accuracy: 0.982116/53 [========>.....................] - ETA: 0s - loss: 0.0566 - accuracy: 0.982623/53 [============>.................] - ETA: 0s - loss: 0.0573 - accuracy: 0.982431/53 [================>.............] - ETA: 0s - loss: 0.0578 - accuracy: 0.982138/53 [====================>.........] - ETA: 0s - loss: 0.0582 - accuracy: 0.982046/53 [=========================>....] - ETA: 0s - loss: 0.0583 - accuracy: 0.982053/53 [==============================] - ETA: 0s - loss: 0.0583 - accuracy: 0.982053/53 [==============================] - 0s 9ms/step - loss: 0.0583 - accuracy: 0.9820 - val_loss: 0.0441 - val_accuracy: 0.9887
Epoch 15/15
 1/53 [..............................] - ETA: 0s - loss: 0.0585 - accuracy: 0.9814 8/53 [===>..........................] - ETA: 0s - loss: 0.0656 - accuracy: 0.980515/53 [=======>......................] - ETA: 0s - loss: 0.0635 - accuracy: 0.980823/53 [============>.................] - ETA: 0s - loss: 0.0619 - accuracy: 0.981331/53 [================>.............] - ETA: 0s - loss: 0.0613 - accuracy: 0.981438/53 [====================>.........] - ETA: 0s - loss: 0.0610 - accuracy: 0.981545/53 [========================>.....] - ETA: 0s - loss: 0.0607 - accuracy: 0.981553/53 [==============================] - ETA: 0s - loss: 0.0604 - accuracy: 0.981553/53 [==============================] - 0s 9ms/step - loss: 0.0603 - accuracy: 0.9816 - val_loss: 0.0401 - val_accuracy: 0.9892
training_time: 0:00:13.874864
Test loss: 0.03649425506591797
Test accuracy: 0.9890000224113464
