Number of devices: 8
batch_size_per_replica: 250
batch_size: 2000 = 250 * 8
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
60000 10000
Epoch 1/20
 1/24 [>.............................] - ETA: 19s - loss: 163.7874 - accuracy: 0.109520/24 [========================>.....] - ETA: 0s - loss: 61.3956 - accuracy: 0.3639  24/24 [==============================] - 1s 22ms/step - loss: 54.3278 - accuracy: 0.3987 - val_loss: 3.1282 - val_accuracy: 0.6771
Epoch 2/20
 1/24 [>.............................] - ETA: 0s - loss: 3.0429 - accuracy: 0.687521/24 [=========================>....] - ETA: 0s - loss: 2.4833 - accuracy: 0.647424/24 [==============================] - 0s 5ms/step - loss: 2.4054 - accuracy: 0.6421 - val_loss: 1.3360 - val_accuracy: 0.5970
Epoch 3/20
 1/24 [>.............................] - ETA: 0s - loss: 1.3808 - accuracy: 0.586020/24 [========================>.....] - ETA: 0s - loss: 1.2751 - accuracy: 0.610424/24 [==============================] - 0s 5ms/step - loss: 1.2612 - accuracy: 0.6163 - val_loss: 1.0298 - val_accuracy: 0.7066
Epoch 4/20
 1/24 [>.............................] - ETA: 0s - loss: 1.0038 - accuracy: 0.716020/24 [========================>.....] - ETA: 0s - loss: 0.9930 - accuracy: 0.721224/24 [==============================] - 0s 5ms/step - loss: 0.9872 - accuracy: 0.7228 - val_loss: 0.8982 - val_accuracy: 0.7458
Epoch 5/20
 1/24 [>.............................] - ETA: 0s - loss: 0.8720 - accuracy: 0.750020/24 [========================>.....] - ETA: 0s - loss: 0.8522 - accuracy: 0.776224/24 [==============================] - 0s 6ms/step - loss: 0.8473 - accuracy: 0.7814 - val_loss: 0.8112 - val_accuracy: 0.8210
Epoch 6/20
 1/24 [>.............................] - ETA: 0s - loss: 0.7203 - accuracy: 0.831520/24 [========================>.....] - ETA: 0s - loss: 0.7380 - accuracy: 0.834124/24 [==============================] - 0s 7ms/step - loss: 0.7365 - accuracy: 0.8345 - val_loss: 0.7396 - val_accuracy: 0.8389
Epoch 7/20
 1/24 [>.............................] - ETA: 0s - loss: 0.6594 - accuracy: 0.849520/24 [========================>.....] - ETA: 0s - loss: 0.6609 - accuracy: 0.849224/24 [==============================] - 0s 5ms/step - loss: 0.6601 - accuracy: 0.8492 - val_loss: 0.6952 - val_accuracy: 0.8456
Epoch 8/20
 1/24 [>.............................] - ETA: 0s - loss: 0.5744 - accuracy: 0.856520/24 [========================>.....] - ETA: 0s - loss: 0.5900 - accuracy: 0.854024/24 [==============================] - 0s 5ms/step - loss: 0.5906 - accuracy: 0.8549 - val_loss: 0.6242 - val_accuracy: 0.8607
Epoch 9/20
 1/24 [>.............................] - ETA: 0s - loss: 0.5653 - accuracy: 0.867020/24 [========================>.....] - ETA: 0s - loss: 0.5450 - accuracy: 0.866324/24 [==============================] - 0s 5ms/step - loss: 0.5432 - accuracy: 0.8660 - val_loss: 0.5832 - val_accuracy: 0.8675
Epoch 10/20
 1/24 [>.............................] - ETA: 0s - loss: 0.4787 - accuracy: 0.870020/24 [========================>.....] - ETA: 0s - loss: 0.4901 - accuracy: 0.872724/24 [==============================] - 0s 5ms/step - loss: 0.4883 - accuracy: 0.8727 - val_loss: 0.5347 - val_accuracy: 0.8697
Epoch 11/20
 1/24 [>.............................] - ETA: 0s - loss: 0.4700 - accuracy: 0.877020/24 [========================>.....] - ETA: 0s - loss: 0.4416 - accuracy: 0.881624/24 [==============================] - 0s 5ms/step - loss: 0.4398 - accuracy: 0.8815 - val_loss: 0.5128 - val_accuracy: 0.8812
Epoch 12/20
 1/24 [>.............................] - ETA: 0s - loss: 0.4106 - accuracy: 0.894020/24 [========================>.....] - ETA: 0s - loss: 0.3968 - accuracy: 0.891224/24 [==============================] - 0s 5ms/step - loss: 0.3947 - accuracy: 0.8912 - val_loss: 0.4753 - val_accuracy: 0.8869
Epoch 13/20
 1/24 [>.............................] - ETA: 0s - loss: 0.3140 - accuracy: 0.896520/24 [========================>.....] - ETA: 0s - loss: 0.3465 - accuracy: 0.898624/24 [==============================] - 0s 6ms/step - loss: 0.3469 - accuracy: 0.8991 - val_loss: 0.4473 - val_accuracy: 0.8942
Epoch 14/20
 1/24 [>.............................] - ETA: 0s - loss: 0.3191 - accuracy: 0.908020/24 [========================>.....] - ETA: 0s - loss: 0.3202 - accuracy: 0.909624/24 [==============================] - 0s 6ms/step - loss: 0.3194 - accuracy: 0.9095 - val_loss: 0.4184 - val_accuracy: 0.9049
Epoch 15/20
 1/24 [>.............................] - ETA: 0s - loss: 0.2837 - accuracy: 0.914519/24 [======================>.......] - ETA: 0s - loss: 0.2907 - accuracy: 0.915824/24 [==============================] - 0s 5ms/step - loss: 0.2901 - accuracy: 0.9159 - val_loss: 0.4023 - val_accuracy: 0.9094
Epoch 16/20
 1/24 [>.............................] - ETA: 0s - loss: 0.2630 - accuracy: 0.918019/24 [======================>.......] - ETA: 0s - loss: 0.2588 - accuracy: 0.923224/24 [==============================] - 0s 5ms/step - loss: 0.2594 - accuracy: 0.9233 - val_loss: 0.3923 - val_accuracy: 0.9122
Epoch 17/20
 1/24 [>.............................] - ETA: 0s - loss: 0.2381 - accuracy: 0.935519/24 [======================>.......] - ETA: 0s - loss: 0.2485 - accuracy: 0.927724/24 [==============================] - 0s 5ms/step - loss: 0.2475 - accuracy: 0.9275 - val_loss: 0.3815 - val_accuracy: 0.9143
Epoch 18/20
 1/24 [>.............................] - ETA: 0s - loss: 0.2374 - accuracy: 0.935520/24 [========================>.....] - ETA: 0s - loss: 0.2241 - accuracy: 0.933624/24 [==============================] - 0s 5ms/step - loss: 0.2242 - accuracy: 0.9333 - val_loss: 0.3775 - val_accuracy: 0.9192
Epoch 19/20
 1/24 [>.............................] - ETA: 0s - loss: 0.2286 - accuracy: 0.932020/24 [========================>.....] - ETA: 0s - loss: 0.2163 - accuracy: 0.935224/24 [==============================] - 0s 5ms/step - loss: 0.2152 - accuracy: 0.9354 - val_loss: 0.3702 - val_accuracy: 0.9208
Epoch 20/20
 1/24 [>.............................] - ETA: 0s - loss: 0.2220 - accuracy: 0.930020/24 [========================>.....] - ETA: 0s - loss: 0.1987 - accuracy: 0.938624/24 [==============================] - 0s 5ms/step - loss: 0.1988 - accuracy: 0.9386 - val_loss: 0.3602 - val_accuracy: 0.9231
training_time: 0:00:03.938542
  1/313 [..............................] - ETA: 56s - loss: 0.1913 - accuracy: 0.9375 20/313 [>.............................] - ETA: 0s - loss: 0.3964 - accuracy: 0.9250  39/313 [==>...........................] - ETA: 0s - loss: 0.4458 - accuracy: 0.9087 59/313 [====>.........................] - ETA: 0s - loss: 0.5367 - accuracy: 0.8999 79/313 [======>.......................] - ETA: 0s - loss: 0.5706 - accuracy: 0.8944 99/313 [========>.....................] - ETA: 0s - loss: 0.5672 - accuracy: 0.8952119/313 [==========>...................] - ETA: 0s - loss: 0.5679 - accuracy: 0.8976139/313 [============>.................] - ETA: 0s - loss: 0.5828 - accuracy: 0.8952159/313 [==============>...............] - ETA: 0s - loss: 0.5702 - accuracy: 0.8962179/313 [================>.............] - ETA: 0s - loss: 0.5383 - accuracy: 0.9028199/313 [==================>...........] - ETA: 0s - loss: 0.5052 - accuracy: 0.9059219/313 [===================>..........] - ETA: 0s - loss: 0.5049 - accuracy: 0.9088238/313 [=====================>........] - ETA: 0s - loss: 0.4758 - accuracy: 0.9131258/313 [=======================>......] - ETA: 0s - loss: 0.4597 - accuracy: 0.9139278/313 [=========================>....] - ETA: 0s - loss: 0.4353 - accuracy: 0.9177298/313 [===========================>..] - ETA: 0s - loss: 0.4327 - accuracy: 0.9200313/313 [==============================] - 1s 3ms/step - loss: 0.4456 - accuracy: 0.9186
Test results: Loss = 0.44557493925094604, Accuracy = 0.9186000227928162
