Number of devices: 8
batch_size_per_replica: 250
batch_size: 2000 = 250 * 8
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
60000 10000
Epoch 1/20
 1/24 [>.............................] - ETA: 20s - loss: 113.6986 - accuracy: 0.081020/24 [========================>.....] - ETA: 0s - loss: 38.8223 - accuracy: 0.4204  24/24 [==============================] - 1s 23ms/step - loss: 34.1898 - accuracy: 0.4614 - val_loss: 2.6933 - val_accuracy: 0.8110
Epoch 2/20
 1/24 [>.............................] - ETA: 0s - loss: 3.0009 - accuracy: 0.793520/24 [========================>.....] - ETA: 0s - loss: 2.3539 - accuracy: 0.802024/24 [==============================] - 0s 5ms/step - loss: 2.2563 - accuracy: 0.8007 - val_loss: 1.0912 - val_accuracy: 0.7904
Epoch 3/20
 1/24 [>.............................] - ETA: 0s - loss: 0.8508 - accuracy: 0.805520/24 [========================>.....] - ETA: 0s - loss: 0.9808 - accuracy: 0.790624/24 [==============================] - 0s 5ms/step - loss: 0.9738 - accuracy: 0.7913 - val_loss: 0.8095 - val_accuracy: 0.8183
Epoch 4/20
 1/24 [>.............................] - ETA: 0s - loss: 0.9524 - accuracy: 0.800520/24 [========================>.....] - ETA: 0s - loss: 0.7789 - accuracy: 0.819024/24 [==============================] - 0s 5ms/step - loss: 0.7638 - accuracy: 0.8216 - val_loss: 0.6793 - val_accuracy: 0.8518
Epoch 5/20
 1/24 [>.............................] - ETA: 0s - loss: 0.5594 - accuracy: 0.858520/24 [========================>.....] - ETA: 0s - loss: 0.5847 - accuracy: 0.859524/24 [==============================] - 0s 5ms/step - loss: 0.5803 - accuracy: 0.8605 - val_loss: 0.6201 - val_accuracy: 0.8688
Epoch 6/20
 1/24 [>.............................] - ETA: 0s - loss: 0.5364 - accuracy: 0.870520/24 [========================>.....] - ETA: 0s - loss: 0.4757 - accuracy: 0.881724/24 [==============================] - 0s 6ms/step - loss: 0.4762 - accuracy: 0.8821 - val_loss: 0.5744 - val_accuracy: 0.8773
Epoch 7/20
 1/24 [>.............................] - ETA: 0s - loss: 0.4317 - accuracy: 0.889020/24 [========================>.....] - ETA: 0s - loss: 0.4171 - accuracy: 0.893124/24 [==============================] - 0s 5ms/step - loss: 0.4168 - accuracy: 0.8935 - val_loss: 0.5418 - val_accuracy: 0.8891
Epoch 8/20
 1/24 [>.............................] - ETA: 0s - loss: 0.3771 - accuracy: 0.893519/24 [======================>.......] - ETA: 0s - loss: 0.3654 - accuracy: 0.901524/24 [==============================] - 0s 6ms/step - loss: 0.3650 - accuracy: 0.9025 - val_loss: 0.5126 - val_accuracy: 0.8981
Epoch 9/20
 1/24 [>.............................] - ETA: 0s - loss: 0.2878 - accuracy: 0.921520/24 [========================>.....] - ETA: 0s - loss: 0.3225 - accuracy: 0.914624/24 [==============================] - 0s 6ms/step - loss: 0.3229 - accuracy: 0.9144 - val_loss: 0.4936 - val_accuracy: 0.8992
Epoch 10/20
 1/24 [>.............................] - ETA: 0s - loss: 0.3039 - accuracy: 0.908019/24 [======================>.......] - ETA: 0s - loss: 0.2988 - accuracy: 0.919924/24 [==============================] - 0s 5ms/step - loss: 0.2956 - accuracy: 0.9204 - val_loss: 0.4750 - val_accuracy: 0.9070
Epoch 11/20
 1/24 [>.............................] - ETA: 0s - loss: 0.2603 - accuracy: 0.924020/24 [========================>.....] - ETA: 0s - loss: 0.2561 - accuracy: 0.927724/24 [==============================] - 0s 5ms/step - loss: 0.2565 - accuracy: 0.9277 - val_loss: 0.4595 - val_accuracy: 0.9096
Epoch 12/20
 1/24 [>.............................] - ETA: 0s - loss: 0.2325 - accuracy: 0.934519/24 [======================>.......] - ETA: 0s - loss: 0.2282 - accuracy: 0.933924/24 [==============================] - 0s 5ms/step - loss: 0.2302 - accuracy: 0.9334 - val_loss: 0.4577 - val_accuracy: 0.9143
Epoch 13/20
 1/24 [>.............................] - ETA: 0s - loss: 0.2141 - accuracy: 0.940521/24 [=========================>....] - ETA: 0s - loss: 0.2186 - accuracy: 0.936224/24 [==============================] - 0s 5ms/step - loss: 0.2183 - accuracy: 0.9363 - val_loss: 0.4428 - val_accuracy: 0.9171
Epoch 14/20
 1/24 [>.............................] - ETA: 0s - loss: 0.1874 - accuracy: 0.946519/24 [======================>.......] - ETA: 0s - loss: 0.1996 - accuracy: 0.941324/24 [==============================] - 0s 5ms/step - loss: 0.1995 - accuracy: 0.9413 - val_loss: 0.4259 - val_accuracy: 0.9198
Epoch 15/20
 1/24 [>.............................] - ETA: 0s - loss: 0.1873 - accuracy: 0.939520/24 [========================>.....] - ETA: 0s - loss: 0.1880 - accuracy: 0.941624/24 [==============================] - 0s 5ms/step - loss: 0.1870 - accuracy: 0.9421 - val_loss: 0.4188 - val_accuracy: 0.9219
Epoch 16/20
 1/24 [>.............................] - ETA: 0s - loss: 0.1769 - accuracy: 0.945520/24 [========================>.....] - ETA: 0s - loss: 0.1710 - accuracy: 0.947024/24 [==============================] - 0s 6ms/step - loss: 0.1705 - accuracy: 0.9474 - val_loss: 0.4118 - val_accuracy: 0.9230
Epoch 17/20
 1/24 [>.............................] - ETA: 0s - loss: 0.1420 - accuracy: 0.957520/24 [========================>.....] - ETA: 0s - loss: 0.1593 - accuracy: 0.950924/24 [==============================] - 0s 8ms/step - loss: 0.1587 - accuracy: 0.9511 - val_loss: 0.4019 - val_accuracy: 0.9259
Epoch 18/20
 1/24 [>.............................] - ETA: 0s - loss: 0.1384 - accuracy: 0.956521/24 [=========================>....] - ETA: 0s - loss: 0.1404 - accuracy: 0.956324/24 [==============================] - 0s 5ms/step - loss: 0.1412 - accuracy: 0.9560 - val_loss: 0.4034 - val_accuracy: 0.9288
Epoch 19/20
 1/24 [>.............................] - ETA: 0s - loss: 0.1543 - accuracy: 0.952020/24 [========================>.....] - ETA: 0s - loss: 0.1375 - accuracy: 0.956224/24 [==============================] - 0s 5ms/step - loss: 0.1373 - accuracy: 0.9563 - val_loss: 0.4051 - val_accuracy: 0.9289
Epoch 20/20
 1/24 [>.............................] - ETA: 0s - loss: 0.1146 - accuracy: 0.961021/24 [=========================>....] - ETA: 0s - loss: 0.1194 - accuracy: 0.961724/24 [==============================] - 0s 5ms/step - loss: 0.1204 - accuracy: 0.9614 - val_loss: 0.3977 - val_accuracy: 0.9309
training_time: 0:00:04.011482
  1/313 [..............................] - ETA: 48s - loss: 0.1653 - accuracy: 0.9688 20/313 [>.............................] - ETA: 0s - loss: 0.2982 - accuracy: 0.9344  40/313 [==>...........................] - ETA: 0s - loss: 0.4074 - accuracy: 0.9187 60/313 [====>.........................] - ETA: 0s - loss: 0.5122 - accuracy: 0.9156 80/313 [======>.......................] - ETA: 0s - loss: 0.5544 - accuracy: 0.9105100/313 [========>.....................] - ETA: 0s - loss: 0.5257 - accuracy: 0.9150120/313 [==========>...................] - ETA: 0s - loss: 0.5119 - accuracy: 0.9156139/313 [============>.................] - ETA: 0s - loss: 0.5280 - accuracy: 0.9132159/313 [==============>...............] - ETA: 0s - loss: 0.5231 - accuracy: 0.9137180/313 [================>.............] - ETA: 0s - loss: 0.5008 - accuracy: 0.9182200/313 [==================>...........] - ETA: 0s - loss: 0.4825 - accuracy: 0.9202220/313 [====================>.........] - ETA: 0s - loss: 0.4790 - accuracy: 0.9219240/313 [======================>.......] - ETA: 0s - loss: 0.4531 - accuracy: 0.9263261/313 [========================>.....] - ETA: 0s - loss: 0.4388 - accuracy: 0.9273282/313 [==========================>...] - ETA: 0s - loss: 0.4170 - accuracy: 0.9304302/313 [===========================>..] - ETA: 0s - loss: 0.4004 - accuracy: 0.9328313/313 [==============================] - 1s 3ms/step - loss: 0.4210 - accuracy: 0.9301
Test results: Loss = 0.4210294485092163, Accuracy = 0.9301000237464905
