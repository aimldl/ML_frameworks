Number of devices: 8
batch_size_per_replica: 128
batch_size: 1024 = 128 * 8
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
x_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
<class 'numpy.ndarray'> <class 'numpy.ndarray'>
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 26, 26, 32)        320       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 13, 13, 32)        0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 11, 11, 64)        18496     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 5, 5, 64)          0         
_________________________________________________________________
flatten (Flatten)            (None, 1600)              0         
_________________________________________________________________
dropout (Dropout)            (None, 1600)              0         
_________________________________________________________________
dense (Dense)                (None, 10)                16010     
=================================================================
Total params: 34,826
Trainable params: 34,826
Non-trainable params: 0
_________________________________________________________________
Epoch 1/15
 1/53 [..............................] - ETA: 2:17 - loss: 2.3347 - accuracy: 0.0557 2/53 [>.............................] - ETA: 5s - loss: 2.3265 - accuracy: 0.0664   3/53 [>.............................] - ETA: 5s - loss: 2.3183 - accuracy: 0.0811 4/53 [=>............................] - ETA: 4s - loss: 2.3103 - accuracy: 0.0957 5/53 [=>............................] - ETA: 4s - loss: 2.3026 - accuracy: 0.1096 6/53 [==>...........................] - ETA: 3s - loss: 2.2950 - accuracy: 0.1229 8/53 [===>..........................] - ETA: 3s - loss: 2.2798 - accuracy: 0.148910/53 [====>.........................] - ETA: 2s - loss: 2.2641 - accuracy: 0.172812/53 [=====>........................] - ETA: 2s - loss: 2.2471 - accuracy: 0.195314/53 [======>.......................] - ETA: 2s - loss: 2.2284 - accuracy: 0.216416/53 [========>.....................] - ETA: 1s - loss: 2.2081 - accuracy: 0.235724/53 [============>.................] - ETA: 1s - loss: 2.1091 - accuracy: 0.303132/53 [=================>............] - ETA: 0s - loss: 1.9968 - accuracy: 0.355740/53 [=====================>........] - ETA: 0s - loss: 1.8880 - accuracy: 0.398647/53 [=========================>....] - ETA: 0s - loss: 1.8003 - accuracy: 0.430553/53 [==============================] - ETA: 0s - loss: 1.7315 - accuracy: 0.454653/53 [==============================] - 4s 32ms/step - loss: 1.7208 - accuracy: 0.4583 - val_loss: 0.2597 - val_accuracy: 0.9328
Epoch 2/15
 1/53 [..............................] - ETA: 0s - loss: 0.4527 - accuracy: 0.8555 9/53 [====>.........................] - ETA: 0s - loss: 0.4193 - accuracy: 0.870117/53 [========>.....................] - ETA: 0s - loss: 0.4026 - accuracy: 0.876624/53 [============>.................] - ETA: 0s - loss: 0.3903 - accuracy: 0.880832/53 [=================>............] - ETA: 0s - loss: 0.3778 - accuracy: 0.884939/53 [=====================>........] - ETA: 0s - loss: 0.3682 - accuracy: 0.888046/53 [=========================>....] - ETA: 0s - loss: 0.3593 - accuracy: 0.890953/53 [==============================] - ETA: 0s - loss: 0.3514 - accuracy: 0.893553/53 [==============================] - 1s 11ms/step - loss: 0.3503 - accuracy: 0.8938 - val_loss: 0.1343 - val_accuracy: 0.9648
Epoch 3/15
 1/53 [..............................] - ETA: 0s - loss: 0.2578 - accuracy: 0.9209 8/53 [===>..........................] - ETA: 0s - loss: 0.2319 - accuracy: 0.930616/53 [========>.....................] - ETA: 0s - loss: 0.2225 - accuracy: 0.934123/53 [============>.................] - ETA: 0s - loss: 0.2182 - accuracy: 0.935430/53 [===============>..............] - ETA: 0s - loss: 0.2139 - accuracy: 0.936637/53 [===================>..........] - ETA: 0s - loss: 0.2103 - accuracy: 0.937744/53 [=======================>......] - ETA: 0s - loss: 0.2071 - accuracy: 0.938651/53 [===========================>..] - ETA: 0s - loss: 0.2043 - accuracy: 0.939453/53 [==============================] - 0s 9ms/step - loss: 0.2032 - accuracy: 0.9397 - val_loss: 0.0977 - val_accuracy: 0.9742
Epoch 4/15
 1/53 [..............................] - ETA: 0s - loss: 0.1560 - accuracy: 0.9590 8/53 [===>..........................] - ETA: 0s - loss: 0.1515 - accuracy: 0.955516/53 [========>.....................] - ETA: 0s - loss: 0.1515 - accuracy: 0.954823/53 [============>.................] - ETA: 0s - loss: 0.1514 - accuracy: 0.954631/53 [================>.............] - ETA: 0s - loss: 0.1507 - accuracy: 0.954738/53 [====================>.........] - ETA: 0s - loss: 0.1502 - accuracy: 0.954845/53 [========================>.....] - ETA: 0s - loss: 0.1496 - accuracy: 0.955053/53 [==============================] - ETA: 0s - loss: 0.1488 - accuracy: 0.955253/53 [==============================] - 0s 9ms/step - loss: 0.1488 - accuracy: 0.9552 - val_loss: 0.0811 - val_accuracy: 0.9790
Epoch 5/15
 1/53 [..............................] - ETA: 0s - loss: 0.1471 - accuracy: 0.9570 8/53 [===>..........................] - ETA: 0s - loss: 0.1408 - accuracy: 0.958616/53 [========>.....................] - ETA: 0s - loss: 0.1367 - accuracy: 0.959322/53 [===========>..................] - ETA: 0s - loss: 0.1341 - accuracy: 0.959729/53 [===============>..............] - ETA: 0s - loss: 0.1318 - accuracy: 0.960336/53 [===================>..........] - ETA: 0s - loss: 0.1303 - accuracy: 0.960743/53 [=======================>......] - ETA: 0s - loss: 0.1290 - accuracy: 0.961050/53 [===========================>..] - ETA: 0s - loss: 0.1281 - accuracy: 0.961253/53 [==============================] - 1s 10ms/step - loss: 0.1276 - accuracy: 0.9613 - val_loss: 0.0716 - val_accuracy: 0.9807
Epoch 6/15
 1/53 [..............................] - ETA: 0s - loss: 0.1206 - accuracy: 0.9668 8/53 [===>..........................] - ETA: 0s - loss: 0.1224 - accuracy: 0.962015/53 [=======>......................] - ETA: 0s - loss: 0.1221 - accuracy: 0.962319/53 [=========>....................] - ETA: 0s - loss: 0.1220 - accuracy: 0.962326/53 [=============>................] - ETA: 0s - loss: 0.1210 - accuracy: 0.962533/53 [=================>............] - ETA: 0s - loss: 0.1196 - accuracy: 0.963037/53 [===================>..........] - ETA: 0s - loss: 0.1188 - accuracy: 0.963242/53 [======================>.......] - ETA: 0s - loss: 0.1179 - accuracy: 0.963549/53 [==========================>...] - ETA: 0s - loss: 0.1166 - accuracy: 0.963951/53 [===========================>..] - ETA: 0s - loss: 0.1163 - accuracy: 0.964152/53 [============================>.] - ETA: 0s - loss: 0.1162 - accuracy: 0.964153/53 [==============================] - 1s 15ms/step - loss: 0.1159 - accuracy: 0.9642 - val_loss: 0.0660 - val_accuracy: 0.9835
Epoch 7/15
 1/53 [..............................] - ETA: 0s - loss: 0.1069 - accuracy: 0.9609 3/53 [>.............................] - ETA: 1s - loss: 0.1060 - accuracy: 0.9637 7/53 [==>...........................] - ETA: 1s - loss: 0.1013 - accuracy: 0.9667 9/53 [====>.........................] - ETA: 1s - loss: 0.1009 - accuracy: 0.967310/53 [====>.........................] - ETA: 1s - loss: 0.1005 - accuracy: 0.967516/53 [========>.....................] - ETA: 0s - loss: 0.1000 - accuracy: 0.968319/53 [=========>....................] - ETA: 0s - loss: 0.0997 - accuracy: 0.968720/53 [==========>...................] - ETA: 0s - loss: 0.0996 - accuracy: 0.968822/53 [===========>..................] - ETA: 0s - loss: 0.0996 - accuracy: 0.968925/53 [=============>................] - ETA: 0s - loss: 0.0995 - accuracy: 0.969027/53 [==============>...............] - ETA: 0s - loss: 0.0994 - accuracy: 0.969128/53 [==============>...............] - ETA: 0s - loss: 0.0993 - accuracy: 0.969131/53 [================>.............] - ETA: 0s - loss: 0.0992 - accuracy: 0.969234/53 [==================>...........] - ETA: 0s - loss: 0.0991 - accuracy: 0.969335/53 [==================>...........] - ETA: 0s - loss: 0.0991 - accuracy: 0.969340/53 [=====================>........] - ETA: 0s - loss: 0.0990 - accuracy: 0.969443/53 [=======================>......] - ETA: 0s - loss: 0.0989 - accuracy: 0.969447/53 [=========================>....] - ETA: 0s - loss: 0.0988 - accuracy: 0.969553/53 [==============================] - ETA: 0s - loss: 0.0985 - accuracy: 0.969653/53 [==============================] - 1s 25ms/step - loss: 0.0984 - accuracy: 0.9696 - val_loss: 0.0589 - val_accuracy: 0.9855
Epoch 8/15
 1/53 [..............................] - ETA: 0s - loss: 0.0814 - accuracy: 0.9756 3/53 [>.............................] - ETA: 1s - loss: 0.0846 - accuracy: 0.9745 7/53 [==>...........................] - ETA: 0s - loss: 0.0861 - accuracy: 0.974010/53 [====>.........................] - ETA: 0s - loss: 0.0862 - accuracy: 0.973916/53 [========>.....................] - ETA: 0s - loss: 0.0876 - accuracy: 0.973317/53 [========>.....................] - ETA: 0s - loss: 0.0878 - accuracy: 0.973222/53 [===========>..................] - ETA: 0s - loss: 0.0888 - accuracy: 0.973025/53 [=============>................] - ETA: 0s - loss: 0.0893 - accuracy: 0.972826/53 [=============>................] - ETA: 0s - loss: 0.0894 - accuracy: 0.972829/53 [===============>..............] - ETA: 0s - loss: 0.0897 - accuracy: 0.972733/53 [=================>............] - ETA: 0s - loss: 0.0900 - accuracy: 0.972637/53 [===================>..........] - ETA: 0s - loss: 0.0900 - accuracy: 0.972640/53 [=====================>........] - ETA: 0s - loss: 0.0900 - accuracy: 0.972744/53 [=======================>......] - ETA: 0s - loss: 0.0899 - accuracy: 0.972748/53 [==========================>...] - ETA: 0s - loss: 0.0898 - accuracy: 0.972753/53 [==============================] - ETA: 0s - loss: 0.0896 - accuracy: 0.972853/53 [==============================] - 1s 21ms/step - loss: 0.0895 - accuracy: 0.9728 - val_loss: 0.0565 - val_accuracy: 0.9863
Epoch 9/15
 1/53 [..............................] - ETA: 0s - loss: 0.0703 - accuracy: 0.9756 8/53 [===>..........................] - ETA: 0s - loss: 0.0858 - accuracy: 0.971713/53 [======>.......................] - ETA: 0s - loss: 0.0863 - accuracy: 0.971720/53 [==========>...................] - ETA: 0s - loss: 0.0860 - accuracy: 0.972327/53 [==============>...............] - ETA: 0s - loss: 0.0854 - accuracy: 0.972735/53 [==================>...........] - ETA: 0s - loss: 0.0847 - accuracy: 0.973143/53 [=======================>......] - ETA: 0s - loss: 0.0842 - accuracy: 0.973350/53 [===========================>..] - ETA: 0s - loss: 0.0839 - accuracy: 0.973653/53 [==============================] - 1s 11ms/step - loss: 0.0838 - accuracy: 0.9736 - val_loss: 0.0489 - val_accuracy: 0.9868
Epoch 10/15
 1/53 [..............................] - ETA: 0s - loss: 0.0838 - accuracy: 0.9795 6/53 [==>...........................] - ETA: 0s - loss: 0.0755 - accuracy: 0.978513/53 [======>.......................] - ETA: 0s - loss: 0.0756 - accuracy: 0.977620/53 [==========>...................] - ETA: 0s - loss: 0.0762 - accuracy: 0.977024/53 [============>.................] - ETA: 0s - loss: 0.0760 - accuracy: 0.976831/53 [================>.............] - ETA: 0s - loss: 0.0760 - accuracy: 0.976638/53 [====================>.........] - ETA: 0s - loss: 0.0758 - accuracy: 0.976646/53 [=========================>....] - ETA: 0s - loss: 0.0758 - accuracy: 0.976653/53 [==============================] - ETA: 0s - loss: 0.0758 - accuracy: 0.976753/53 [==============================] - 1s 10ms/step - loss: 0.0757 - accuracy: 0.9767 - val_loss: 0.0492 - val_accuracy: 0.9880
Epoch 11/15
 1/53 [..............................] - ETA: 0s - loss: 0.0668 - accuracy: 0.9824 8/53 [===>..........................] - ETA: 0s - loss: 0.0710 - accuracy: 0.979915/53 [=======>......................] - ETA: 0s - loss: 0.0738 - accuracy: 0.978722/53 [===========>..................] - ETA: 0s - loss: 0.0740 - accuracy: 0.978529/53 [===============>..............] - ETA: 0s - loss: 0.0742 - accuracy: 0.978436/53 [===================>..........] - ETA: 0s - loss: 0.0743 - accuracy: 0.978343/53 [=======================>......] - ETA: 0s - loss: 0.0742 - accuracy: 0.978348/53 [==========================>...] - ETA: 0s - loss: 0.0741 - accuracy: 0.978253/53 [==============================] - 0s 9ms/step - loss: 0.0739 - accuracy: 0.9782 - val_loss: 0.0457 - val_accuracy: 0.9873
Epoch 12/15
 1/53 [..............................] - ETA: 0s - loss: 0.0583 - accuracy: 0.9814 7/53 [==>...........................] - ETA: 0s - loss: 0.0642 - accuracy: 0.979513/53 [======>.......................] - ETA: 0s - loss: 0.0657 - accuracy: 0.978919/53 [=========>....................] - ETA: 0s - loss: 0.0667 - accuracy: 0.978725/53 [=============>................] - ETA: 0s - loss: 0.0671 - accuracy: 0.978728/53 [==============>...............] - ETA: 0s - loss: 0.0671 - accuracy: 0.978834/53 [==================>...........] - ETA: 0s - loss: 0.0673 - accuracy: 0.978839/53 [=====================>........] - ETA: 0s - loss: 0.0675 - accuracy: 0.978842/53 [======================>.......] - ETA: 0s - loss: 0.0676 - accuracy: 0.978848/53 [==========================>...] - ETA: 0s - loss: 0.0677 - accuracy: 0.978853/53 [==============================] - ETA: 0s - loss: 0.0679 - accuracy: 0.978853/53 [==============================] - 1s 14ms/step - loss: 0.0679 - accuracy: 0.9788 - val_loss: 0.0443 - val_accuracy: 0.9878
Epoch 13/15
 1/53 [..............................] - ETA: 0s - loss: 0.0458 - accuracy: 0.9873 4/53 [=>............................] - ETA: 1s - loss: 0.0537 - accuracy: 0.986411/53 [=====>........................] - ETA: 0s - loss: 0.0586 - accuracy: 0.984318/53 [=========>....................] - ETA: 0s - loss: 0.0606 - accuracy: 0.983425/53 [=============>................] - ETA: 0s - loss: 0.0615 - accuracy: 0.982833/53 [=================>............] - ETA: 0s - loss: 0.0619 - accuracy: 0.982540/53 [=====================>........] - ETA: 0s - loss: 0.0622 - accuracy: 0.982245/53 [========================>.....] - ETA: 0s - loss: 0.0624 - accuracy: 0.982051/53 [===========================>..] - ETA: 0s - loss: 0.0627 - accuracy: 0.981953/53 [==============================] - 1s 12ms/step - loss: 0.0628 - accuracy: 0.9818 - val_loss: 0.0423 - val_accuracy: 0.9875
Epoch 14/15
 1/53 [..............................] - ETA: 0s - loss: 0.0562 - accuracy: 0.9775 7/53 [==>...........................] - ETA: 0s - loss: 0.0651 - accuracy: 0.979514/53 [======>.......................] - ETA: 0s - loss: 0.0656 - accuracy: 0.980122/53 [===========>..................] - ETA: 0s - loss: 0.0648 - accuracy: 0.980427/53 [==============>...............] - ETA: 0s - loss: 0.0644 - accuracy: 0.980533/53 [=================>............] - ETA: 0s - loss: 0.0642 - accuracy: 0.980437/53 [===================>..........] - ETA: 0s - loss: 0.0641 - accuracy: 0.980442/53 [======================>.......] - ETA: 0s - loss: 0.0639 - accuracy: 0.980449/53 [==========================>...] - ETA: 0s - loss: 0.0638 - accuracy: 0.980353/53 [==============================] - 1s 11ms/step - loss: 0.0637 - accuracy: 0.9803 - val_loss: 0.0430 - val_accuracy: 0.9872
Epoch 15/15
 1/53 [..............................] - ETA: 0s - loss: 0.0674 - accuracy: 0.9805 9/53 [====>.........................] - ETA: 0s - loss: 0.0576 - accuracy: 0.982617/53 [========>.....................] - ETA: 0s - loss: 0.0572 - accuracy: 0.983025/53 [=============>................] - ETA: 0s - loss: 0.0579 - accuracy: 0.982933/53 [=================>............] - ETA: 0s - loss: 0.0583 - accuracy: 0.982941/53 [======================>.......] - ETA: 0s - loss: 0.0590 - accuracy: 0.982749/53 [==========================>...] - ETA: 0s - loss: 0.0594 - accuracy: 0.982653/53 [==============================] - 0s 8ms/step - loss: 0.0596 - accuracy: 0.9825 - val_loss: 0.0406 - val_accuracy: 0.9897
training_time: 0:00:13.878745
Test loss: 0.03682512044906616
Test accuracy: 0.9884999990463257
