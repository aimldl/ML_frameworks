Number of devices: 8
batch_size_per_replica: 128
batch_size: 1024 = 128 * 8
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
x_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
<class 'numpy.ndarray'> <class 'numpy.ndarray'>
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 26, 26, 32)        320       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 13, 13, 32)        0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 11, 11, 64)        18496     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 5, 5, 64)          0         
_________________________________________________________________
flatten (Flatten)            (None, 1600)              0         
_________________________________________________________________
dropout (Dropout)            (None, 1600)              0         
_________________________________________________________________
dense (Dense)                (None, 10)                16010     
=================================================================
Total params: 34,826
Trainable params: 34,826
Non-trainable params: 0
_________________________________________________________________
Epoch 1/15
 1/53 [..............................] - ETA: 2:19 - loss: 2.3152 - accuracy: 0.0811 2/53 [>.............................] - ETA: 5s - loss: 2.3075 - accuracy: 0.0962   3/53 [>.............................] - ETA: 4s - loss: 2.2988 - accuracy: 0.1114 4/53 [=>............................] - ETA: 4s - loss: 2.2900 - accuracy: 0.1248 5/53 [=>............................] - ETA: 4s - loss: 2.2814 - accuracy: 0.1361 6/53 [==>...........................] - ETA: 4s - loss: 2.2725 - accuracy: 0.1463 7/53 [==>...........................] - ETA: 3s - loss: 2.2636 - accuracy: 0.1560 8/53 [===>..........................] - ETA: 3s - loss: 2.2545 - accuracy: 0.165811/53 [=====>........................] - ETA: 2s - loss: 2.2256 - accuracy: 0.193714/53 [======>.......................] - ETA: 2s - loss: 2.1935 - accuracy: 0.218417/53 [========>.....................] - ETA: 1s - loss: 2.1580 - accuracy: 0.240820/53 [==========>...................] - ETA: 1s - loss: 2.1196 - accuracy: 0.261323/53 [============>.................] - ETA: 1s - loss: 2.0797 - accuracy: 0.279930/53 [===============>..............] - ETA: 0s - loss: 1.9876 - accuracy: 0.316838/53 [====================>.........] - ETA: 0s - loss: 1.8917 - accuracy: 0.351445/53 [========================>.....] - ETA: 0s - loss: 1.8177 - accuracy: 0.377053/53 [==============================] - ETA: 0s - loss: 1.7430 - accuracy: 0.402453/53 [==============================] - 4s 33ms/step - loss: 1.7345 - accuracy: 0.4053 - val_loss: 0.6691 - val_accuracy: 0.7518
Epoch 2/15
 1/53 [..............................] - ETA: 0s - loss: 0.7478 - accuracy: 0.7178 9/53 [====>.........................] - ETA: 0s - loss: 0.7452 - accuracy: 0.724617/53 [========>.....................] - ETA: 0s - loss: 0.7312 - accuracy: 0.730224/53 [============>.................] - ETA: 0s - loss: 0.7219 - accuracy: 0.733531/53 [================>.............] - ETA: 0s - loss: 0.7131 - accuracy: 0.737038/53 [====================>.........] - ETA: 0s - loss: 0.7053 - accuracy: 0.739945/53 [========================>.....] - ETA: 0s - loss: 0.6980 - accuracy: 0.742652/53 [============================>.] - ETA: 0s - loss: 0.6914 - accuracy: 0.744953/53 [==============================] - ETA: 0s - loss: 0.6906 - accuracy: 0.745253/53 [==============================] - 1s 11ms/step - loss: 0.6897 - accuracy: 0.7456 - val_loss: 0.5231 - val_accuracy: 0.8062
Epoch 3/15
 1/53 [..............................] - ETA: 0s - loss: 0.5860 - accuracy: 0.7842 9/53 [====>.........................] - ETA: 0s - loss: 0.5889 - accuracy: 0.785017/53 [========>.....................] - ETA: 0s - loss: 0.5808 - accuracy: 0.787725/53 [=============>................] - ETA: 0s - loss: 0.5760 - accuracy: 0.789833/53 [=================>............] - ETA: 0s - loss: 0.5729 - accuracy: 0.791041/53 [======================>.......] - ETA: 0s - loss: 0.5695 - accuracy: 0.792348/53 [==========================>...] - ETA: 0s - loss: 0.5671 - accuracy: 0.793353/53 [==============================] - ETA: 0s - loss: 0.5653 - accuracy: 0.794053/53 [==============================] - 1s 11ms/step - loss: 0.5649 - accuracy: 0.7941 - val_loss: 0.4688 - val_accuracy: 0.8295
Epoch 4/15
 1/53 [..............................] - ETA: 0s - loss: 0.5087 - accuracy: 0.8154 9/53 [====>.........................] - ETA: 0s - loss: 0.5153 - accuracy: 0.816516/53 [========>.....................] - ETA: 0s - loss: 0.5128 - accuracy: 0.816124/53 [============>.................] - ETA: 0s - loss: 0.5119 - accuracy: 0.815830/53 [===============>..............] - ETA: 0s - loss: 0.5109 - accuracy: 0.815835/53 [==================>...........] - ETA: 0s - loss: 0.5102 - accuracy: 0.815839/53 [=====================>........] - ETA: 0s - loss: 0.5097 - accuracy: 0.815845/53 [========================>.....] - ETA: 0s - loss: 0.5087 - accuracy: 0.815952/53 [============================>.] - ETA: 0s - loss: 0.5076 - accuracy: 0.816153/53 [==============================] - ETA: 0s - loss: 0.5075 - accuracy: 0.816253/53 [==============================] - 1s 12ms/step - loss: 0.5073 - accuracy: 0.8162 - val_loss: 0.4342 - val_accuracy: 0.8483
Epoch 5/15
 1/53 [..............................] - ETA: 0s - loss: 0.4518 - accuracy: 0.8262 7/53 [==>...........................] - ETA: 0s - loss: 0.4683 - accuracy: 0.831611/53 [=====>........................] - ETA: 0s - loss: 0.4688 - accuracy: 0.832313/53 [======>.......................] - ETA: 0s - loss: 0.4693 - accuracy: 0.832315/53 [=======>......................] - ETA: 0s - loss: 0.4694 - accuracy: 0.832217/53 [========>.....................] - ETA: 0s - loss: 0.4690 - accuracy: 0.832320/53 [==========>...................] - ETA: 0s - loss: 0.4683 - accuracy: 0.832423/53 [============>.................] - ETA: 0s - loss: 0.4678 - accuracy: 0.832526/53 [=============>................] - ETA: 0s - loss: 0.4675 - accuracy: 0.832429/53 [===============>..............] - ETA: 0s - loss: 0.4671 - accuracy: 0.832430/53 [===============>..............] - ETA: 0s - loss: 0.4671 - accuracy: 0.832431/53 [================>.............] - ETA: 0s - loss: 0.4670 - accuracy: 0.832432/53 [=================>............] - ETA: 0s - loss: 0.4669 - accuracy: 0.832334/53 [==================>...........] - ETA: 0s - loss: 0.4667 - accuracy: 0.832335/53 [==================>...........] - ETA: 0s - loss: 0.4666 - accuracy: 0.832337/53 [===================>..........] - ETA: 0s - loss: 0.4664 - accuracy: 0.832340/53 [=====================>........] - ETA: 0s - loss: 0.4662 - accuracy: 0.832342/53 [======================>.......] - ETA: 0s - loss: 0.4660 - accuracy: 0.832344/53 [=======================>......] - ETA: 0s - loss: 0.4658 - accuracy: 0.832347/53 [=========================>....] - ETA: 0s - loss: 0.4656 - accuracy: 0.832349/53 [==========================>...] - ETA: 0s - loss: 0.4655 - accuracy: 0.832452/53 [============================>.] - ETA: 0s - loss: 0.4654 - accuracy: 0.832453/53 [==============================] - ETA: 0s - loss: 0.4653 - accuracy: 0.832453/53 [==============================] - 2s 35ms/step - loss: 0.4653 - accuracy: 0.8324 - val_loss: 0.4111 - val_accuracy: 0.8558
Epoch 6/15
 1/53 [..............................] - ETA: 0s - loss: 0.4475 - accuracy: 0.8418 3/53 [>.............................] - ETA: 1s - loss: 0.4541 - accuracy: 0.8401 7/53 [==>...........................] - ETA: 1s - loss: 0.4546 - accuracy: 0.838910/53 [====>.........................] - ETA: 1s - loss: 0.4525 - accuracy: 0.839511/53 [=====>........................] - ETA: 1s - loss: 0.4522 - accuracy: 0.839617/53 [========>.....................] - ETA: 0s - loss: 0.4503 - accuracy: 0.839918/53 [=========>....................] - ETA: 0s - loss: 0.4501 - accuracy: 0.839919/53 [=========>....................] - ETA: 0s - loss: 0.4500 - accuracy: 0.839920/53 [==========>...................] - ETA: 0s - loss: 0.4498 - accuracy: 0.839926/53 [=============>................] - ETA: 0s - loss: 0.4489 - accuracy: 0.839832/53 [=================>............] - ETA: 0s - loss: 0.4482 - accuracy: 0.839933/53 [=================>............] - ETA: 0s - loss: 0.4482 - accuracy: 0.839938/53 [====================>.........] - ETA: 0s - loss: 0.4477 - accuracy: 0.840243/53 [=======================>......] - ETA: 0s - loss: 0.4475 - accuracy: 0.840346/53 [=========================>....] - ETA: 0s - loss: 0.4474 - accuracy: 0.840450/53 [===========================>..] - ETA: 0s - loss: 0.4469 - accuracy: 0.840653/53 [==============================] - ETA: 0s - loss: 0.4466 - accuracy: 0.840753/53 [==============================] - 1s 24ms/step - loss: 0.4465 - accuracy: 0.8408 - val_loss: 0.3976 - val_accuracy: 0.8608
Epoch 7/15
 1/53 [..............................] - ETA: 0s - loss: 0.4281 - accuracy: 0.8506 7/53 [==>...........................] - ETA: 0s - loss: 0.4202 - accuracy: 0.848114/53 [======>.......................] - ETA: 0s - loss: 0.4219 - accuracy: 0.848721/53 [==========>...................] - ETA: 0s - loss: 0.4254 - accuracy: 0.847528/53 [==============>...............] - ETA: 0s - loss: 0.4272 - accuracy: 0.846932/53 [=================>............] - ETA: 0s - loss: 0.4277 - accuracy: 0.846738/53 [====================>.........] - ETA: 0s - loss: 0.4281 - accuracy: 0.846741/53 [======================>.......] - ETA: 0s - loss: 0.4280 - accuracy: 0.846847/53 [=========================>....] - ETA: 0s - loss: 0.4278 - accuracy: 0.847053/53 [==============================] - ETA: 0s - loss: 0.4275 - accuracy: 0.847153/53 [==============================] - 1s 12ms/step - loss: 0.4275 - accuracy: 0.8472 - val_loss: 0.3811 - val_accuracy: 0.8655
Epoch 8/15
 1/53 [..............................] - ETA: 0s - loss: 0.4103 - accuracy: 0.8555 9/53 [====>.........................] - ETA: 0s - loss: 0.4150 - accuracy: 0.856917/53 [========>.....................] - ETA: 0s - loss: 0.4136 - accuracy: 0.856524/53 [============>.................] - ETA: 0s - loss: 0.4144 - accuracy: 0.855732/53 [=================>............] - ETA: 0s - loss: 0.4147 - accuracy: 0.855040/53 [=====================>........] - ETA: 0s - loss: 0.4144 - accuracy: 0.854846/53 [=========================>....] - ETA: 0s - loss: 0.4139 - accuracy: 0.854952/53 [============================>.] - ETA: 0s - loss: 0.4136 - accuracy: 0.854953/53 [==============================] - 1s 10ms/step - loss: 0.4134 - accuracy: 0.8549 - val_loss: 0.3707 - val_accuracy: 0.8677
Epoch 9/15
 1/53 [..............................] - ETA: 0s - loss: 0.4316 - accuracy: 0.8525 7/53 [==>...........................] - ETA: 0s - loss: 0.4141 - accuracy: 0.857915/53 [=======>......................] - ETA: 0s - loss: 0.4086 - accuracy: 0.858222/53 [===========>..................] - ETA: 0s - loss: 0.4064 - accuracy: 0.858127/53 [==============>...............] - ETA: 0s - loss: 0.4058 - accuracy: 0.857731/53 [================>.............] - ETA: 0s - loss: 0.4053 - accuracy: 0.857634/53 [==================>...........] - ETA: 0s - loss: 0.4049 - accuracy: 0.857539/53 [=====================>........] - ETA: 0s - loss: 0.4043 - accuracy: 0.857443/53 [=======================>......] - ETA: 0s - loss: 0.4039 - accuracy: 0.857448/53 [==========================>...] - ETA: 0s - loss: 0.4035 - accuracy: 0.857452/53 [============================>.] - ETA: 0s - loss: 0.4032 - accuracy: 0.857553/53 [==============================] - 1s 13ms/step - loss: 0.4030 - accuracy: 0.8575 - val_loss: 0.3608 - val_accuracy: 0.8715
Epoch 10/15
 1/53 [..............................] - ETA: 0s - loss: 0.4063 - accuracy: 0.8574 7/53 [==>...........................] - ETA: 0s - loss: 0.3877 - accuracy: 0.861612/53 [=====>........................] - ETA: 0s - loss: 0.3857 - accuracy: 0.862014/53 [======>.......................] - ETA: 0s - loss: 0.3855 - accuracy: 0.862017/53 [========>.....................] - ETA: 0s - loss: 0.3852 - accuracy: 0.862023/53 [============>.................] - ETA: 0s - loss: 0.3852 - accuracy: 0.862227/53 [==============>...............] - ETA: 0s - loss: 0.3854 - accuracy: 0.862429/53 [===============>..............] - ETA: 0s - loss: 0.3855 - accuracy: 0.862535/53 [==================>...........] - ETA: 0s - loss: 0.3856 - accuracy: 0.862840/53 [=====================>........] - ETA: 0s - loss: 0.3858 - accuracy: 0.862945/53 [========================>.....] - ETA: 0s - loss: 0.3859 - accuracy: 0.863050/53 [===========================>..] - ETA: 0s - loss: 0.3859 - accuracy: 0.863053/53 [==============================] - 1s 15ms/step - loss: 0.3859 - accuracy: 0.8631 - val_loss: 0.3533 - val_accuracy: 0.8733
Epoch 11/15
 1/53 [..............................] - ETA: 0s - loss: 0.3637 - accuracy: 0.8711 8/53 [===>..........................] - ETA: 0s - loss: 0.3683 - accuracy: 0.869614/53 [======>.......................] - ETA: 0s - loss: 0.3723 - accuracy: 0.868521/53 [==========>...................] - ETA: 0s - loss: 0.3761 - accuracy: 0.867028/53 [==============>...............] - ETA: 0s - loss: 0.3773 - accuracy: 0.866536/53 [===================>..........] - ETA: 0s - loss: 0.3776 - accuracy: 0.866440/53 [=====================>........] - ETA: 0s - loss: 0.3777 - accuracy: 0.866447/53 [=========================>....] - ETA: 0s - loss: 0.3779 - accuracy: 0.866353/53 [==============================] - ETA: 0s - loss: 0.3781 - accuracy: 0.866253/53 [==============================] - 1s 11ms/step - loss: 0.3781 - accuracy: 0.8662 - val_loss: 0.3511 - val_accuracy: 0.8725
Epoch 12/15
 1/53 [..............................] - ETA: 0s - loss: 0.4252 - accuracy: 0.8516 7/53 [==>...........................] - ETA: 0s - loss: 0.3902 - accuracy: 0.860611/53 [=====>........................] - ETA: 0s - loss: 0.3846 - accuracy: 0.861718/53 [=========>....................] - ETA: 0s - loss: 0.3808 - accuracy: 0.862825/53 [=============>................] - ETA: 0s - loss: 0.3787 - accuracy: 0.863729/53 [===============>..............] - ETA: 0s - loss: 0.3777 - accuracy: 0.864236/53 [===================>..........] - ETA: 0s - loss: 0.3762 - accuracy: 0.864842/53 [======================>.......] - ETA: 0s - loss: 0.3753 - accuracy: 0.865249/53 [==========================>...] - ETA: 0s - loss: 0.3744 - accuracy: 0.865653/53 [==============================] - 1s 11ms/step - loss: 0.3740 - accuracy: 0.8658 - val_loss: 0.3395 - val_accuracy: 0.8788
Epoch 13/15
 1/53 [..............................] - ETA: 0s - loss: 0.3538 - accuracy: 0.8584 7/53 [==>...........................] - ETA: 0s - loss: 0.3581 - accuracy: 0.866513/53 [======>.......................] - ETA: 0s - loss: 0.3612 - accuracy: 0.867418/53 [=========>....................] - ETA: 0s - loss: 0.3623 - accuracy: 0.867322/53 [===========>..................] - ETA: 0s - loss: 0.3626 - accuracy: 0.867226/53 [=============>................] - ETA: 0s - loss: 0.3629 - accuracy: 0.867228/53 [==============>...............] - ETA: 0s - loss: 0.3629 - accuracy: 0.867333/53 [=================>............] - ETA: 0s - loss: 0.3629 - accuracy: 0.867536/53 [===================>..........] - ETA: 0s - loss: 0.3627 - accuracy: 0.867643/53 [=======================>......] - ETA: 0s - loss: 0.3628 - accuracy: 0.867746/53 [=========================>....] - ETA: 0s - loss: 0.3628 - accuracy: 0.867851/53 [===========================>..] - ETA: 0s - loss: 0.3628 - accuracy: 0.867953/53 [==============================] - 1s 14ms/step - loss: 0.3629 - accuracy: 0.8680 - val_loss: 0.3326 - val_accuracy: 0.8785
Epoch 14/15
 1/53 [..............................] - ETA: 0s - loss: 0.3570 - accuracy: 0.8740 6/53 [==>...........................] - ETA: 0s - loss: 0.3631 - accuracy: 0.873113/53 [======>.......................] - ETA: 0s - loss: 0.3598 - accuracy: 0.874020/53 [==========>...................] - ETA: 0s - loss: 0.3600 - accuracy: 0.873427/53 [==============>...............] - ETA: 0s - loss: 0.3610 - accuracy: 0.872634/53 [==================>...........] - ETA: 0s - loss: 0.3616 - accuracy: 0.872142/53 [======================>.......] - ETA: 0s - loss: 0.3615 - accuracy: 0.871950/53 [===========================>..] - ETA: 0s - loss: 0.3612 - accuracy: 0.871953/53 [==============================] - 0s 9ms/step - loss: 0.3610 - accuracy: 0.8719 - val_loss: 0.3266 - val_accuracy: 0.8825
Epoch 15/15
 1/53 [..............................] - ETA: 0s - loss: 0.3555 - accuracy: 0.8730 8/53 [===>..........................] - ETA: 0s - loss: 0.3564 - accuracy: 0.871816/53 [========>.....................] - ETA: 0s - loss: 0.3534 - accuracy: 0.873424/53 [============>.................] - ETA: 0s - loss: 0.3530 - accuracy: 0.873532/53 [=================>............] - ETA: 0s - loss: 0.3525 - accuracy: 0.873840/53 [=====================>........] - ETA: 0s - loss: 0.3524 - accuracy: 0.873948/53 [==========================>...] - ETA: 0s - loss: 0.3523 - accuracy: 0.874153/53 [==============================] - 0s 9ms/step - loss: 0.3520 - accuracy: 0.8743 - val_loss: 0.3301 - val_accuracy: 0.8783
training_time: 0:00:15.018522
Test loss: 0.3440926969051361
Test accuracy: 0.8772000074386597
