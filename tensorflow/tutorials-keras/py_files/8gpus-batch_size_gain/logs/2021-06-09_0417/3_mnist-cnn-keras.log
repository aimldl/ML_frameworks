Number of devices: 8
batch_size_per_replica: 128
batch_size: 1024 = 128 * 8
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
x_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
<class 'numpy.ndarray'> <class 'numpy.ndarray'>
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 26, 26, 32)        320       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 13, 13, 32)        0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 11, 11, 64)        18496     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 5, 5, 64)          0         
_________________________________________________________________
flatten (Flatten)            (None, 1600)              0         
_________________________________________________________________
dropout (Dropout)            (None, 1600)              0         
_________________________________________________________________
dense (Dense)                (None, 10)                16010     
=================================================================
Total params: 34,826
Trainable params: 34,826
Non-trainable params: 0
_________________________________________________________________
Epoch 1/15
 1/53 [..............................] - ETA: 2:18 - loss: 2.3185 - accuracy: 0.0977 2/53 [>.............................] - ETA: 6s - loss: 2.3090 - accuracy: 0.1077   3/53 [>.............................] - ETA: 5s - loss: 2.3000 - accuracy: 0.1179 4/53 [=>............................] - ETA: 5s - loss: 2.2903 - accuracy: 0.1288 5/53 [=>............................] - ETA: 5s - loss: 2.2811 - accuracy: 0.1394 6/53 [==>...........................] - ETA: 4s - loss: 2.2715 - accuracy: 0.1508 7/53 [==>...........................] - ETA: 4s - loss: 2.2616 - accuracy: 0.1634 8/53 [===>..........................] - ETA: 4s - loss: 2.2516 - accuracy: 0.1758 9/53 [====>.........................] - ETA: 3s - loss: 2.2414 - accuracy: 0.188010/53 [====>.........................] - ETA: 3s - loss: 2.2311 - accuracy: 0.199812/53 [=====>........................] - ETA: 3s - loss: 2.2092 - accuracy: 0.223014/53 [======>.......................] - ETA: 2s - loss: 2.1863 - accuracy: 0.244216/53 [========>.....................] - ETA: 2s - loss: 2.1616 - accuracy: 0.264018/53 [=========>....................] - ETA: 2s - loss: 2.1354 - accuracy: 0.282526/53 [=============>................] - ETA: 1s - loss: 2.0206 - accuracy: 0.344533/53 [=================>............] - ETA: 0s - loss: 1.9179 - accuracy: 0.387540/53 [=====================>........] - ETA: 0s - loss: 1.8217 - accuracy: 0.423747/53 [=========================>....] - ETA: 0s - loss: 1.7337 - accuracy: 0.454853/53 [==============================] - ETA: 0s - loss: 1.6652 - accuracy: 0.478353/53 [==============================] - 5s 38ms/step - loss: 1.6547 - accuracy: 0.4818 - val_loss: 0.2457 - val_accuracy: 0.9328
Epoch 2/15
 1/53 [..............................] - ETA: 0s - loss: 0.3854 - accuracy: 0.8750 9/53 [====>.........................] - ETA: 0s - loss: 0.3662 - accuracy: 0.885316/53 [========>.....................] - ETA: 0s - loss: 0.3612 - accuracy: 0.888723/53 [============>.................] - ETA: 0s - loss: 0.3540 - accuracy: 0.891731/53 [================>.............] - ETA: 0s - loss: 0.3451 - accuracy: 0.894938/53 [====================>.........] - ETA: 0s - loss: 0.3379 - accuracy: 0.897445/53 [========================>.....] - ETA: 0s - loss: 0.3312 - accuracy: 0.899653/53 [==============================] - ETA: 0s - loss: 0.3240 - accuracy: 0.901953/53 [==============================] - 1s 11ms/step - loss: 0.3232 - accuracy: 0.9022 - val_loss: 0.1300 - val_accuracy: 0.9627
Epoch 3/15
 1/53 [..............................] - ETA: 0s - loss: 0.2347 - accuracy: 0.9307 9/53 [====>.........................] - ETA: 0s - loss: 0.2020 - accuracy: 0.939616/53 [========>.....................] - ETA: 0s - loss: 0.1992 - accuracy: 0.940624/53 [============>.................] - ETA: 0s - loss: 0.1972 - accuracy: 0.941632/53 [=================>............] - ETA: 0s - loss: 0.1948 - accuracy: 0.942639/53 [=====================>........] - ETA: 0s - loss: 0.1924 - accuracy: 0.943344/53 [=======================>......] - ETA: 0s - loss: 0.1911 - accuracy: 0.943751/53 [===========================>..] - ETA: 0s - loss: 0.1892 - accuracy: 0.944253/53 [==============================] - ETA: 0s - loss: 0.1886 - accuracy: 0.944453/53 [==============================] - 1s 11ms/step - loss: 0.1884 - accuracy: 0.9444 - val_loss: 0.0941 - val_accuracy: 0.9737
Epoch 4/15
 1/53 [..............................] - ETA: 0s - loss: 0.1586 - accuracy: 0.9580 6/53 [==>...........................] - ETA: 0s - loss: 0.1559 - accuracy: 0.953812/53 [=====>........................] - ETA: 0s - loss: 0.1506 - accuracy: 0.954819/53 [=========>....................] - ETA: 0s - loss: 0.1479 - accuracy: 0.955321/53 [==========>...................] - ETA: 0s - loss: 0.1474 - accuracy: 0.955326/53 [=============>................] - ETA: 0s - loss: 0.1462 - accuracy: 0.955632/53 [=================>............] - ETA: 0s - loss: 0.1450 - accuracy: 0.955938/53 [====================>.........] - ETA: 0s - loss: 0.1440 - accuracy: 0.956241/53 [======================>.......] - ETA: 0s - loss: 0.1436 - accuracy: 0.956446/53 [=========================>....] - ETA: 0s - loss: 0.1429 - accuracy: 0.956651/53 [===========================>..] - ETA: 0s - loss: 0.1422 - accuracy: 0.956852/53 [============================>.] - ETA: 0s - loss: 0.1421 - accuracy: 0.956853/53 [==============================] - ETA: 0s - loss: 0.1420 - accuracy: 0.956853/53 [==============================] - 1s 17ms/step - loss: 0.1418 - accuracy: 0.9569 - val_loss: 0.0796 - val_accuracy: 0.9775
Epoch 5/15
 1/53 [..............................] - ETA: 0s - loss: 0.1733 - accuracy: 0.9482 2/53 [>.............................] - ETA: 2s - loss: 0.1619 - accuracy: 0.9526 6/53 [==>...........................] - ETA: 1s - loss: 0.1435 - accuracy: 0.958411/53 [=====>........................] - ETA: 0s - loss: 0.1370 - accuracy: 0.960215/53 [=======>......................] - ETA: 0s - loss: 0.1340 - accuracy: 0.960917/53 [========>.....................] - ETA: 0s - loss: 0.1327 - accuracy: 0.961318/53 [=========>....................] - ETA: 0s - loss: 0.1321 - accuracy: 0.961419/53 [=========>....................] - ETA: 0s - loss: 0.1315 - accuracy: 0.961524/53 [============>.................] - ETA: 0s - loss: 0.1293 - accuracy: 0.962030/53 [===============>..............] - ETA: 0s - loss: 0.1272 - accuracy: 0.962433/53 [=================>............] - ETA: 0s - loss: 0.1263 - accuracy: 0.962638/53 [====================>.........] - ETA: 0s - loss: 0.1250 - accuracy: 0.962942/53 [======================>.......] - ETA: 0s - loss: 0.1241 - accuracy: 0.963143/53 [=======================>......] - ETA: 0s - loss: 0.1239 - accuracy: 0.963145/53 [========================>.....] - ETA: 0s - loss: 0.1234 - accuracy: 0.963251/53 [===========================>..] - ETA: 0s - loss: 0.1224 - accuracy: 0.963553/53 [==============================] - 1s 20ms/step - loss: 0.1219 - accuracy: 0.9636 - val_loss: 0.0675 - val_accuracy: 0.9815
Epoch 6/15
 1/53 [..............................] - ETA: 0s - loss: 0.0993 - accuracy: 0.9746 8/53 [===>..........................] - ETA: 0s - loss: 0.1090 - accuracy: 0.969913/53 [======>.......................] - ETA: 0s - loss: 0.1089 - accuracy: 0.969416/53 [========>.....................] - ETA: 0s - loss: 0.1083 - accuracy: 0.969320/53 [==========>...................] - ETA: 0s - loss: 0.1078 - accuracy: 0.969122/53 [===========>..................] - ETA: 0s - loss: 0.1075 - accuracy: 0.969125/53 [=============>................] - ETA: 0s - loss: 0.1073 - accuracy: 0.969027/53 [==============>...............] - ETA: 0s - loss: 0.1072 - accuracy: 0.968932/53 [=================>............] - ETA: 0s - loss: 0.1068 - accuracy: 0.968936/53 [===================>..........] - ETA: 0s - loss: 0.1066 - accuracy: 0.968837/53 [===================>..........] - ETA: 0s - loss: 0.1066 - accuracy: 0.968844/53 [=======================>......] - ETA: 0s - loss: 0.1063 - accuracy: 0.968750/53 [===========================>..] - ETA: 0s - loss: 0.1061 - accuracy: 0.968753/53 [==============================] - 1s 18ms/step - loss: 0.1059 - accuracy: 0.9687 - val_loss: 0.0594 - val_accuracy: 0.9828
Epoch 7/15
 1/53 [..............................] - ETA: 0s - loss: 0.0889 - accuracy: 0.9717 7/53 [==>...........................] - ETA: 0s - loss: 0.0953 - accuracy: 0.971410/53 [====>.........................] - ETA: 0s - loss: 0.0944 - accuracy: 0.971713/53 [======>.......................] - ETA: 0s - loss: 0.0940 - accuracy: 0.972017/53 [========>.....................] - ETA: 0s - loss: 0.0939 - accuracy: 0.972022/53 [===========>..................] - ETA: 0s - loss: 0.0938 - accuracy: 0.972129/53 [===============>..............] - ETA: 0s - loss: 0.0935 - accuracy: 0.972237/53 [===================>..........] - ETA: 0s - loss: 0.0935 - accuracy: 0.972244/53 [=======================>......] - ETA: 0s - loss: 0.0935 - accuracy: 0.972151/53 [===========================>..] - ETA: 0s - loss: 0.0935 - accuracy: 0.972153/53 [==============================] - 1s 12ms/step - loss: 0.0934 - accuracy: 0.9721 - val_loss: 0.0540 - val_accuracy: 0.9848
Epoch 8/15
 1/53 [..............................] - ETA: 0s - loss: 0.0741 - accuracy: 0.9814 8/53 [===>..........................] - ETA: 0s - loss: 0.0837 - accuracy: 0.975216/53 [========>.....................] - ETA: 0s - loss: 0.0849 - accuracy: 0.974223/53 [============>.................] - ETA: 0s - loss: 0.0854 - accuracy: 0.973725/53 [=============>................] - ETA: 0s - loss: 0.0854 - accuracy: 0.973730/53 [===============>..............] - ETA: 0s - loss: 0.0851 - accuracy: 0.973634/53 [==================>...........] - ETA: 0s - loss: 0.0851 - accuracy: 0.973638/53 [====================>.........] - ETA: 0s - loss: 0.0851 - accuracy: 0.973541/53 [======================>.......] - ETA: 0s - loss: 0.0850 - accuracy: 0.973544/53 [=======================>......] - ETA: 0s - loss: 0.0849 - accuracy: 0.973548/53 [==========================>...] - ETA: 0s - loss: 0.0848 - accuracy: 0.973552/53 [============================>.] - ETA: 0s - loss: 0.0848 - accuracy: 0.973653/53 [==============================] - 1s 15ms/step - loss: 0.0848 - accuracy: 0.9736 - val_loss: 0.0498 - val_accuracy: 0.9870
Epoch 9/15
 1/53 [..............................] - ETA: 0s - loss: 0.0749 - accuracy: 0.9736 6/53 [==>...........................] - ETA: 0s - loss: 0.0790 - accuracy: 0.974012/53 [=====>........................] - ETA: 0s - loss: 0.0786 - accuracy: 0.974918/53 [=========>....................] - ETA: 0s - loss: 0.0779 - accuracy: 0.975523/53 [============>.................] - ETA: 0s - loss: 0.0775 - accuracy: 0.975827/53 [==============>...............] - ETA: 0s - loss: 0.0773 - accuracy: 0.976029/53 [===============>..............] - ETA: 0s - loss: 0.0772 - accuracy: 0.976130/53 [===============>..............] - ETA: 0s - loss: 0.0772 - accuracy: 0.976137/53 [===================>..........] - ETA: 0s - loss: 0.0772 - accuracy: 0.976340/53 [=====================>........] - ETA: 0s - loss: 0.0772 - accuracy: 0.976346/53 [=========================>....] - ETA: 0s - loss: 0.0771 - accuracy: 0.976450/53 [===========================>..] - ETA: 0s - loss: 0.0772 - accuracy: 0.976451/53 [===========================>..] - ETA: 0s - loss: 0.0772 - accuracy: 0.976453/53 [==============================] - 1s 18ms/step - loss: 0.0772 - accuracy: 0.9764 - val_loss: 0.0471 - val_accuracy: 0.9875
Epoch 10/15
 1/53 [..............................] - ETA: 1s - loss: 0.0564 - accuracy: 0.9795 8/53 [===>..........................] - ETA: 0s - loss: 0.0693 - accuracy: 0.977514/53 [======>.......................] - ETA: 0s - loss: 0.0699 - accuracy: 0.977718/53 [=========>....................] - ETA: 0s - loss: 0.0704 - accuracy: 0.977825/53 [=============>................] - ETA: 0s - loss: 0.0706 - accuracy: 0.977930/53 [===============>..............] - ETA: 0s - loss: 0.0708 - accuracy: 0.978036/53 [===================>..........] - ETA: 0s - loss: 0.0709 - accuracy: 0.978141/53 [======================>.......] - ETA: 0s - loss: 0.0712 - accuracy: 0.978146/53 [=========================>....] - ETA: 0s - loss: 0.0714 - accuracy: 0.978151/53 [===========================>..] - ETA: 0s - loss: 0.0715 - accuracy: 0.978153/53 [==============================] - 1s 11ms/step - loss: 0.0716 - accuracy: 0.9781 - val_loss: 0.0442 - val_accuracy: 0.9887
Epoch 11/15
 1/53 [..............................] - ETA: 0s - loss: 0.0864 - accuracy: 0.9697 9/53 [====>.........................] - ETA: 0s - loss: 0.0768 - accuracy: 0.976917/53 [========>.....................] - ETA: 0s - loss: 0.0753 - accuracy: 0.977225/53 [=============>................] - ETA: 0s - loss: 0.0737 - accuracy: 0.977732/53 [=================>............] - ETA: 0s - loss: 0.0730 - accuracy: 0.977940/53 [=====================>........] - ETA: 0s - loss: 0.0722 - accuracy: 0.978248/53 [==========================>...] - ETA: 0s - loss: 0.0715 - accuracy: 0.978453/53 [==============================] - 0s 9ms/step - loss: 0.0711 - accuracy: 0.9785 - val_loss: 0.0433 - val_accuracy: 0.9885
Epoch 12/15
 1/53 [..............................] - ETA: 0s - loss: 0.0813 - accuracy: 0.9756 9/53 [====>.........................] - ETA: 0s - loss: 0.0713 - accuracy: 0.977217/53 [========>.....................] - ETA: 0s - loss: 0.0695 - accuracy: 0.977822/53 [===========>..................] - ETA: 0s - loss: 0.0683 - accuracy: 0.978328/53 [==============>...............] - ETA: 0s - loss: 0.0676 - accuracy: 0.978636/53 [===================>..........] - ETA: 0s - loss: 0.0670 - accuracy: 0.978944/53 [=======================>......] - ETA: 0s - loss: 0.0667 - accuracy: 0.979150/53 [===========================>..] - ETA: 0s - loss: 0.0665 - accuracy: 0.979153/53 [==============================] - 0s 9ms/step - loss: 0.0665 - accuracy: 0.9791 - val_loss: 0.0421 - val_accuracy: 0.9897
Epoch 13/15
 1/53 [..............................] - ETA: 0s - loss: 0.0614 - accuracy: 0.9746 9/53 [====>.........................] - ETA: 0s - loss: 0.0554 - accuracy: 0.980317/53 [========>.....................] - ETA: 0s - loss: 0.0552 - accuracy: 0.980925/53 [=============>................] - ETA: 0s - loss: 0.0567 - accuracy: 0.980732/53 [=================>............] - ETA: 0s - loss: 0.0581 - accuracy: 0.980539/53 [=====================>........] - ETA: 0s - loss: 0.0589 - accuracy: 0.980346/53 [=========================>....] - ETA: 0s - loss: 0.0596 - accuracy: 0.980253/53 [==============================] - 0s 9ms/step - loss: 0.0602 - accuracy: 0.9802 - val_loss: 0.0410 - val_accuracy: 0.9893
Epoch 14/15
 1/53 [..............................] - ETA: 0s - loss: 0.0687 - accuracy: 0.9775 9/53 [====>.........................] - ETA: 0s - loss: 0.0591 - accuracy: 0.981015/53 [=======>......................] - ETA: 0s - loss: 0.0590 - accuracy: 0.981422/53 [===========>..................] - ETA: 0s - loss: 0.0591 - accuracy: 0.981630/53 [===============>..............] - ETA: 0s - loss: 0.0590 - accuracy: 0.981737/53 [===================>..........] - ETA: 0s - loss: 0.0587 - accuracy: 0.981944/53 [=======================>......] - ETA: 0s - loss: 0.0584 - accuracy: 0.982051/53 [===========================>..] - ETA: 0s - loss: 0.0582 - accuracy: 0.982153/53 [==============================] - 0s 9ms/step - loss: 0.0581 - accuracy: 0.9821 - val_loss: 0.0391 - val_accuracy: 0.9902
Epoch 15/15
 1/53 [..............................] - ETA: 0s - loss: 0.0653 - accuracy: 0.9834 9/53 [====>.........................] - ETA: 0s - loss: 0.0602 - accuracy: 0.983717/53 [========>.....................] - ETA: 0s - loss: 0.0587 - accuracy: 0.983624/53 [============>.................] - ETA: 0s - loss: 0.0579 - accuracy: 0.983532/53 [=================>............] - ETA: 0s - loss: 0.0576 - accuracy: 0.983540/53 [=====================>........] - ETA: 0s - loss: 0.0571 - accuracy: 0.983447/53 [=========================>....] - ETA: 0s - loss: 0.0568 - accuracy: 0.983453/53 [==============================] - 1s 10ms/step - loss: 0.0568 - accuracy: 0.9833 - val_loss: 0.0400 - val_accuracy: 0.9885
training_time: 0:00:14.242951
Test loss: 0.03695457801222801
Test accuracy: 0.987500011920929
