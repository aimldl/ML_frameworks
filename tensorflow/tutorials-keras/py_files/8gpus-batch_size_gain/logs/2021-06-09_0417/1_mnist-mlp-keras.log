Number of devices: 8
batch_size_per_replica: 250
batch_size: 2000 = 250 * 8
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
60000 10000
Epoch 1/20
 1/24 [>.............................] - ETA: 20s - loss: 145.4656 - accuracy: 0.106519/24 [======================>.......] - ETA: 0s - loss: 56.2699 - accuracy: 0.3470  24/24 [==============================] - 1s 23ms/step - loss: 48.0973 - accuracy: 0.3919 - val_loss: 2.0064 - val_accuracy: 0.6357
Epoch 2/20
 1/24 [>.............................] - ETA: 0s - loss: 2.0534 - accuracy: 0.614020/24 [========================>.....] - ETA: 0s - loss: 1.7404 - accuracy: 0.574124/24 [==============================] - 0s 5ms/step - loss: 1.7066 - accuracy: 0.5724 - val_loss: 1.2972 - val_accuracy: 0.6410
Epoch 3/20
 1/24 [>.............................] - ETA: 0s - loss: 1.3808 - accuracy: 0.616520/24 [========================>.....] - ETA: 0s - loss: 1.2537 - accuracy: 0.661224/24 [==============================] - 0s 5ms/step - loss: 1.2380 - accuracy: 0.6688 - val_loss: 1.0414 - val_accuracy: 0.7628
Epoch 4/20
 1/24 [>.............................] - ETA: 0s - loss: 0.9157 - accuracy: 0.769520/24 [========================>.....] - ETA: 0s - loss: 0.9598 - accuracy: 0.766824/24 [==============================] - 0s 5ms/step - loss: 0.9566 - accuracy: 0.7677 - val_loss: 0.8739 - val_accuracy: 0.7883
Epoch 5/20
 1/24 [>.............................] - ETA: 0s - loss: 0.7796 - accuracy: 0.790020/24 [========================>.....] - ETA: 0s - loss: 0.7975 - accuracy: 0.798224/24 [==============================] - 0s 6ms/step - loss: 0.7948 - accuracy: 0.7995 - val_loss: 0.7832 - val_accuracy: 0.8202
Epoch 6/20
 1/24 [>.............................] - ETA: 0s - loss: 0.7264 - accuracy: 0.803020/24 [========================>.....] - ETA: 0s - loss: 0.7087 - accuracy: 0.818024/24 [==============================] - 0s 5ms/step - loss: 0.7038 - accuracy: 0.8197 - val_loss: 0.7058 - val_accuracy: 0.8394
Epoch 7/20
 1/24 [>.............................] - ETA: 0s - loss: 0.6512 - accuracy: 0.838020/24 [========================>.....] - ETA: 0s - loss: 0.6109 - accuracy: 0.842524/24 [==============================] - 0s 5ms/step - loss: 0.6085 - accuracy: 0.8434 - val_loss: 0.6491 - val_accuracy: 0.8474
Epoch 8/20
 1/24 [>.............................] - ETA: 0s - loss: 0.5642 - accuracy: 0.837020/24 [========================>.....] - ETA: 0s - loss: 0.5461 - accuracy: 0.852024/24 [==============================] - 0s 5ms/step - loss: 0.5437 - accuracy: 0.8535 - val_loss: 0.6051 - val_accuracy: 0.8673
Epoch 9/20
 1/24 [>.............................] - ETA: 0s - loss: 0.4443 - accuracy: 0.871020/24 [========================>.....] - ETA: 0s - loss: 0.4888 - accuracy: 0.872824/24 [==============================] - 0s 5ms/step - loss: 0.4863 - accuracy: 0.8734 - val_loss: 0.5774 - val_accuracy: 0.8748
Epoch 10/20
 1/24 [>.............................] - ETA: 0s - loss: 0.4528 - accuracy: 0.883020/24 [========================>.....] - ETA: 0s - loss: 0.4369 - accuracy: 0.883524/24 [==============================] - 0s 5ms/step - loss: 0.4362 - accuracy: 0.8837 - val_loss: 0.5489 - val_accuracy: 0.8838
Epoch 11/20
 1/24 [>.............................] - ETA: 0s - loss: 0.3995 - accuracy: 0.886520/24 [========================>.....] - ETA: 0s - loss: 0.4010 - accuracy: 0.891724/24 [==============================] - 0s 5ms/step - loss: 0.4001 - accuracy: 0.8923 - val_loss: 0.5340 - val_accuracy: 0.8855
Epoch 12/20
 1/24 [>.............................] - ETA: 0s - loss: 0.3594 - accuracy: 0.897019/24 [======================>.......] - ETA: 0s - loss: 0.3618 - accuracy: 0.901724/24 [==============================] - 0s 5ms/step - loss: 0.3620 - accuracy: 0.9017 - val_loss: 0.5186 - val_accuracy: 0.8938
Epoch 13/20
 1/24 [>.............................] - ETA: 0s - loss: 0.3495 - accuracy: 0.902019/24 [======================>.......] - ETA: 0s - loss: 0.3437 - accuracy: 0.905824/24 [==============================] - 0s 6ms/step - loss: 0.3435 - accuracy: 0.9059 - val_loss: 0.5012 - val_accuracy: 0.8980
Epoch 14/20
 1/24 [>.............................] - ETA: 0s - loss: 0.3235 - accuracy: 0.909020/24 [========================>.....] - ETA: 0s - loss: 0.3146 - accuracy: 0.912024/24 [==============================] - 0s 5ms/step - loss: 0.3145 - accuracy: 0.9120 - val_loss: 0.4935 - val_accuracy: 0.9011
Epoch 15/20
 1/24 [>.............................] - ETA: 0s - loss: 0.2866 - accuracy: 0.916520/24 [========================>.....] - ETA: 0s - loss: 0.2986 - accuracy: 0.915524/24 [==============================] - 0s 5ms/step - loss: 0.2979 - accuracy: 0.9158 - val_loss: 0.4791 - val_accuracy: 0.9068
Epoch 16/20
 1/24 [>.............................] - ETA: 0s - loss: 0.2737 - accuracy: 0.919020/24 [========================>.....] - ETA: 0s - loss: 0.2678 - accuracy: 0.922424/24 [==============================] - 0s 7ms/step - loss: 0.2686 - accuracy: 0.9223 - val_loss: 0.4702 - val_accuracy: 0.9096
Epoch 17/20
 1/24 [>.............................] - ETA: 0s - loss: 0.2425 - accuracy: 0.927520/24 [========================>.....] - ETA: 0s - loss: 0.2541 - accuracy: 0.926624/24 [==============================] - 0s 5ms/step - loss: 0.2544 - accuracy: 0.9264 - val_loss: 0.4608 - val_accuracy: 0.9097
Epoch 18/20
 1/24 [>.............................] - ETA: 0s - loss: 0.2386 - accuracy: 0.9220 7/24 [=======>......................] - ETA: 0s - loss: 0.2346 - accuracy: 0.927424/24 [==============================] - ETA: 0s - loss: 0.2365 - accuracy: 0.929424/24 [==============================] - 0s 8ms/step - loss: 0.2366 - accuracy: 0.9295 - val_loss: 0.4596 - val_accuracy: 0.9144
Epoch 19/20
 1/24 [>.............................] - ETA: 0s - loss: 0.2115 - accuracy: 0.931015/24 [=================>............] - ETA: 0s - loss: 0.2222 - accuracy: 0.932224/24 [==============================] - 0s 9ms/step - loss: 0.2228 - accuracy: 0.9325 - val_loss: 0.4497 - val_accuracy: 0.9157
Epoch 20/20
 1/24 [>.............................] - ETA: 0s - loss: 0.1979 - accuracy: 0.940013/24 [===============>..............] - ETA: 0s - loss: 0.2067 - accuracy: 0.940224/24 [==============================] - 0s 9ms/step - loss: 0.2100 - accuracy: 0.9391 - val_loss: 0.4474 - val_accuracy: 0.9187
training_time: 0:00:04.221660
  1/313 [..............................] - ETA: 48s - loss: 0.3957 - accuracy: 0.9375 21/313 [=>............................] - ETA: 0s - loss: 0.4426 - accuracy: 0.9226  41/313 [==>...........................] - ETA: 0s - loss: 0.5031 - accuracy: 0.9032 61/313 [====>.........................] - ETA: 0s - loss: 0.4904 - accuracy: 0.9022 81/313 [======>.......................] - ETA: 0s - loss: 0.5029 - accuracy: 0.8985101/313 [========>.....................] - ETA: 0s - loss: 0.4835 - accuracy: 0.9004121/313 [==========>...................] - ETA: 0s - loss: 0.5035 - accuracy: 0.8990141/313 [============>.................] - ETA: 0s - loss: 0.5254 - accuracy: 0.8985160/313 [==============>...............] - ETA: 0s - loss: 0.5115 - accuracy: 0.9014180/313 [================>.............] - ETA: 0s - loss: 0.4862 - accuracy: 0.9068200/313 [==================>...........] - ETA: 0s - loss: 0.4707 - accuracy: 0.9097219/313 [===================>..........] - ETA: 0s - loss: 0.4569 - accuracy: 0.9112237/313 [=====================>........] - ETA: 0s - loss: 0.4361 - accuracy: 0.9151256/313 [=======================>......] - ETA: 0s - loss: 0.4264 - accuracy: 0.9160273/313 [=========================>....] - ETA: 0s - loss: 0.4175 - accuracy: 0.9167293/313 [===========================>..] - ETA: 0s - loss: 0.4079 - accuracy: 0.9205313/313 [==============================] - 1s 3ms/step - loss: 0.4261 - accuracy: 0.9200
Test results: Loss = 0.42611587047576904, Accuracy = 0.9200000166893005
