Number of devices: 8
batch_size_per_replica: 128
batch_size: 1024 = 128 * 8
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
x_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
<class 'numpy.ndarray'> <class 'numpy.ndarray'>
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 26, 26, 32)        320       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 13, 13, 32)        0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 11, 11, 64)        18496     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 5, 5, 64)          0         
_________________________________________________________________
flatten (Flatten)            (None, 1600)              0         
_________________________________________________________________
dropout (Dropout)            (None, 1600)              0         
_________________________________________________________________
dense (Dense)                (None, 10)                16010     
=================================================================
Total params: 34,826
Trainable params: 34,826
Non-trainable params: 0
_________________________________________________________________
Epoch 1/15
 1/53 [..............................] - ETA: 2:18 - loss: 2.3163 - accuracy: 0.0928 2/53 [>.............................] - ETA: 5s - loss: 2.3072 - accuracy: 0.1021   3/53 [>.............................] - ETA: 4s - loss: 2.2985 - accuracy: 0.1138 4/53 [=>............................] - ETA: 4s - loss: 2.2893 - accuracy: 0.1274 6/53 [==>...........................] - ETA: 3s - loss: 2.2711 - accuracy: 0.1536 8/53 [===>..........................] - ETA: 2s - loss: 2.2527 - accuracy: 0.178010/53 [====>.........................] - ETA: 2s - loss: 2.2333 - accuracy: 0.200212/53 [=====>........................] - ETA: 2s - loss: 2.2128 - accuracy: 0.220415/53 [=======>......................] - ETA: 1s - loss: 2.1788 - accuracy: 0.248920/53 [==========>...................] - ETA: 1s - loss: 2.1139 - accuracy: 0.291828/53 [==============>...............] - ETA: 0s - loss: 1.9968 - accuracy: 0.348135/53 [==================>...........] - ETA: 0s - loss: 1.8954 - accuracy: 0.388643/53 [=======================>......] - ETA: 0s - loss: 1.7898 - accuracy: 0.427451/53 [===========================>..] - ETA: 0s - loss: 1.6959 - accuracy: 0.460353/53 [==============================] - ETA: 0s - loss: 1.6742 - accuracy: 0.467853/53 [==============================] - 4s 30ms/step - loss: 1.6639 - accuracy: 0.4713 - val_loss: 0.2652 - val_accuracy: 0.9302
Epoch 2/15
 1/53 [..............................] - ETA: 0s - loss: 0.4388 - accuracy: 0.8604 9/53 [====>.........................] - ETA: 0s - loss: 0.4097 - accuracy: 0.878117/53 [========>.....................] - ETA: 0s - loss: 0.3959 - accuracy: 0.882025/53 [=============>................] - ETA: 0s - loss: 0.3841 - accuracy: 0.885433/53 [=================>............] - ETA: 0s - loss: 0.3732 - accuracy: 0.888640/53 [=====================>........] - ETA: 0s - loss: 0.3650 - accuracy: 0.891048/53 [==========================>...] - ETA: 0s - loss: 0.3563 - accuracy: 0.893653/53 [==============================] - ETA: 0s - loss: 0.3513 - accuracy: 0.895153/53 [==============================] - 1s 11ms/step - loss: 0.3503 - accuracy: 0.8954 - val_loss: 0.1415 - val_accuracy: 0.9628
Epoch 3/15
 1/53 [..............................] - ETA: 0s - loss: 0.2349 - accuracy: 0.9414 8/53 [===>..........................] - ETA: 0s - loss: 0.2246 - accuracy: 0.935815/53 [=======>......................] - ETA: 0s - loss: 0.2230 - accuracy: 0.934422/53 [===========>..................] - ETA: 0s - loss: 0.2212 - accuracy: 0.934426/53 [=============>................] - ETA: 0s - loss: 0.2199 - accuracy: 0.934734/53 [==================>...........] - ETA: 0s - loss: 0.2174 - accuracy: 0.935341/53 [======================>.......] - ETA: 0s - loss: 0.2152 - accuracy: 0.935947/53 [=========================>....] - ETA: 0s - loss: 0.2133 - accuracy: 0.936351/53 [===========================>..] - ETA: 0s - loss: 0.2121 - accuracy: 0.936753/53 [==============================] - 1s 12ms/step - loss: 0.2112 - accuracy: 0.9369 - val_loss: 0.1065 - val_accuracy: 0.9700
Epoch 4/15
 1/53 [..............................] - ETA: 0s - loss: 0.1508 - accuracy: 0.9551 8/53 [===>..........................] - ETA: 0s - loss: 0.1569 - accuracy: 0.953714/53 [======>.......................] - ETA: 0s - loss: 0.1592 - accuracy: 0.952621/53 [==========>...................] - ETA: 0s - loss: 0.1595 - accuracy: 0.952329/53 [===============>..............] - ETA: 0s - loss: 0.1591 - accuracy: 0.952535/53 [==================>...........] - ETA: 0s - loss: 0.1587 - accuracy: 0.952638/53 [====================>.........] - ETA: 0s - loss: 0.1586 - accuracy: 0.952643/53 [=======================>......] - ETA: 0s - loss: 0.1584 - accuracy: 0.952645/53 [========================>.....] - ETA: 0s - loss: 0.1583 - accuracy: 0.952647/53 [=========================>....] - ETA: 0s - loss: 0.1581 - accuracy: 0.952648/53 [==========================>...] - ETA: 0s - loss: 0.1580 - accuracy: 0.952649/53 [==========================>...] - ETA: 0s - loss: 0.1579 - accuracy: 0.952751/53 [===========================>..] - ETA: 0s - loss: 0.1578 - accuracy: 0.952753/53 [==============================] - 1s 19ms/step - loss: 0.1576 - accuracy: 0.9527 - val_loss: 0.0890 - val_accuracy: 0.9768
Epoch 5/15
 1/53 [..............................] - ETA: 0s - loss: 0.1278 - accuracy: 0.9619 6/53 [==>...........................] - ETA: 0s - loss: 0.1451 - accuracy: 0.956212/53 [=====>........................] - ETA: 0s - loss: 0.1437 - accuracy: 0.957314/53 [======>.......................] - ETA: 0s - loss: 0.1430 - accuracy: 0.957720/53 [==========>...................] - ETA: 0s - loss: 0.1407 - accuracy: 0.958426/53 [=============>................] - ETA: 0s - loss: 0.1394 - accuracy: 0.958832/53 [=================>............] - ETA: 0s - loss: 0.1383 - accuracy: 0.959138/53 [====================>.........] - ETA: 0s - loss: 0.1373 - accuracy: 0.959442/53 [======================>.......] - ETA: 0s - loss: 0.1368 - accuracy: 0.959544/53 [=======================>......] - ETA: 0s - loss: 0.1365 - accuracy: 0.959650/53 [===========================>..] - ETA: 0s - loss: 0.1359 - accuracy: 0.959753/53 [==============================] - 1s 17ms/step - loss: 0.1355 - accuracy: 0.9598 - val_loss: 0.0757 - val_accuracy: 0.9797
Epoch 6/15
 1/53 [..............................] - ETA: 0s - loss: 0.1138 - accuracy: 0.9648 9/53 [====>.........................] - ETA: 0s - loss: 0.1220 - accuracy: 0.964615/53 [=======>......................] - ETA: 0s - loss: 0.1211 - accuracy: 0.964519/53 [=========>....................] - ETA: 0s - loss: 0.1210 - accuracy: 0.964222/53 [===========>..................] - ETA: 0s - loss: 0.1209 - accuracy: 0.964127/53 [==============>...............] - ETA: 0s - loss: 0.1203 - accuracy: 0.964131/53 [================>.............] - ETA: 0s - loss: 0.1199 - accuracy: 0.964136/53 [===================>..........] - ETA: 0s - loss: 0.1195 - accuracy: 0.964140/53 [=====================>........] - ETA: 0s - loss: 0.1191 - accuracy: 0.964243/53 [=======================>......] - ETA: 0s - loss: 0.1188 - accuracy: 0.964246/53 [=========================>....] - ETA: 0s - loss: 0.1185 - accuracy: 0.964350/53 [===========================>..] - ETA: 0s - loss: 0.1182 - accuracy: 0.964353/53 [==============================] - ETA: 0s - loss: 0.1180 - accuracy: 0.964453/53 [==============================] - 1s 18ms/step - loss: 0.1179 - accuracy: 0.9644 - val_loss: 0.0671 - val_accuracy: 0.9818
Epoch 7/15
 1/53 [..............................] - ETA: 0s - loss: 0.1190 - accuracy: 0.9619 4/53 [=>............................] - ETA: 0s - loss: 0.1132 - accuracy: 0.9635 5/53 [=>............................] - ETA: 1s - loss: 0.1124 - accuracy: 0.964212/53 [=====>........................] - ETA: 0s - loss: 0.1109 - accuracy: 0.965619/53 [=========>....................] - ETA: 0s - loss: 0.1100 - accuracy: 0.965926/53 [=============>................] - ETA: 0s - loss: 0.1094 - accuracy: 0.966230/53 [===============>..............] - ETA: 0s - loss: 0.1091 - accuracy: 0.966435/53 [==================>...........] - ETA: 0s - loss: 0.1086 - accuracy: 0.966638/53 [====================>.........] - ETA: 0s - loss: 0.1083 - accuracy: 0.966845/53 [========================>.....] - ETA: 0s - loss: 0.1076 - accuracy: 0.967148/53 [==========================>...] - ETA: 0s - loss: 0.1073 - accuracy: 0.967251/53 [===========================>..] - ETA: 0s - loss: 0.1070 - accuracy: 0.967353/53 [==============================] - 1s 17ms/step - loss: 0.1068 - accuracy: 0.9674 - val_loss: 0.0631 - val_accuracy: 0.9838
Epoch 8/15
 1/53 [..............................] - ETA: 1s - loss: 0.1361 - accuracy: 0.9619 6/53 [==>...........................] - ETA: 0s - loss: 0.1113 - accuracy: 0.967811/53 [=====>........................] - ETA: 0s - loss: 0.1078 - accuracy: 0.968518/53 [=========>....................] - ETA: 0s - loss: 0.1043 - accuracy: 0.969326/53 [=============>................] - ETA: 0s - loss: 0.1011 - accuracy: 0.970031/53 [================>.............] - ETA: 0s - loss: 0.0998 - accuracy: 0.970336/53 [===================>..........] - ETA: 0s - loss: 0.0989 - accuracy: 0.970538/53 [====================>.........] - ETA: 0s - loss: 0.0987 - accuracy: 0.970640/53 [=====================>........] - ETA: 0s - loss: 0.0985 - accuracy: 0.970647/53 [=========================>....] - ETA: 0s - loss: 0.0980 - accuracy: 0.970753/53 [==============================] - ETA: 0s - loss: 0.0975 - accuracy: 0.970853/53 [==============================] - 1s 13ms/step - loss: 0.0974 - accuracy: 0.9708 - val_loss: 0.0578 - val_accuracy: 0.9842
Epoch 9/15
 1/53 [..............................] - ETA: 0s - loss: 0.0845 - accuracy: 0.9707 8/53 [===>..........................] - ETA: 0s - loss: 0.0871 - accuracy: 0.974115/53 [=======>......................] - ETA: 0s - loss: 0.0894 - accuracy: 0.973822/53 [===========>..................] - ETA: 0s - loss: 0.0901 - accuracy: 0.973629/53 [===============>..............] - ETA: 0s - loss: 0.0901 - accuracy: 0.973636/53 [===================>..........] - ETA: 0s - loss: 0.0901 - accuracy: 0.973541/53 [======================>.......] - ETA: 0s - loss: 0.0900 - accuracy: 0.973646/53 [=========================>....] - ETA: 0s - loss: 0.0898 - accuracy: 0.973649/53 [==========================>...] - ETA: 0s - loss: 0.0896 - accuracy: 0.973753/53 [==============================] - 1s 11ms/step - loss: 0.0894 - accuracy: 0.9737 - val_loss: 0.0550 - val_accuracy: 0.9858
Epoch 10/15
 1/53 [..............................] - ETA: 0s - loss: 0.0780 - accuracy: 0.9756 7/53 [==>...........................] - ETA: 0s - loss: 0.0816 - accuracy: 0.975312/53 [=====>........................] - ETA: 0s - loss: 0.0830 - accuracy: 0.974716/53 [========>.....................] - ETA: 0s - loss: 0.0831 - accuracy: 0.974619/53 [=========>....................] - ETA: 0s - loss: 0.0833 - accuracy: 0.974524/53 [============>.................] - ETA: 0s - loss: 0.0837 - accuracy: 0.974329/53 [===============>..............] - ETA: 0s - loss: 0.0840 - accuracy: 0.974233/53 [=================>............] - ETA: 0s - loss: 0.0840 - accuracy: 0.974237/53 [===================>..........] - ETA: 0s - loss: 0.0839 - accuracy: 0.974239/53 [=====================>........] - ETA: 0s - loss: 0.0838 - accuracy: 0.974340/53 [=====================>........] - ETA: 0s - loss: 0.0838 - accuracy: 0.974345/53 [========================>.....] - ETA: 0s - loss: 0.0836 - accuracy: 0.974451/53 [===========================>..] - ETA: 0s - loss: 0.0834 - accuracy: 0.974553/53 [==============================] - ETA: 0s - loss: 0.0833 - accuracy: 0.974553/53 [==============================] - 1s 19ms/step - loss: 0.0833 - accuracy: 0.9746 - val_loss: 0.0508 - val_accuracy: 0.9865
Epoch 11/15
 1/53 [..............................] - ETA: 0s - loss: 0.0734 - accuracy: 0.9795 8/53 [===>..........................] - ETA: 0s - loss: 0.0761 - accuracy: 0.976014/53 [======>.......................] - ETA: 0s - loss: 0.0756 - accuracy: 0.976221/53 [==========>...................] - ETA: 0s - loss: 0.0768 - accuracy: 0.976028/53 [==============>...............] - ETA: 0s - loss: 0.0772 - accuracy: 0.976035/53 [==================>...........] - ETA: 0s - loss: 0.0773 - accuracy: 0.976039/53 [=====================>........] - ETA: 0s - loss: 0.0773 - accuracy: 0.976144/53 [=======================>......] - ETA: 0s - loss: 0.0773 - accuracy: 0.976151/53 [===========================>..] - ETA: 0s - loss: 0.0773 - accuracy: 0.976253/53 [==============================] - 1s 12ms/step - loss: 0.0774 - accuracy: 0.9762 - val_loss: 0.0499 - val_accuracy: 0.9877
Epoch 12/15
 1/53 [..............................] - ETA: 0s - loss: 0.0849 - accuracy: 0.9727 8/53 [===>..........................] - ETA: 0s - loss: 0.0738 - accuracy: 0.9766 9/53 [====>.........................] - ETA: 0s - loss: 0.0732 - accuracy: 0.977015/53 [=======>......................] - ETA: 0s - loss: 0.0715 - accuracy: 0.977920/53 [==========>...................] - ETA: 0s - loss: 0.0715 - accuracy: 0.978127/53 [==============>...............] - ETA: 0s - loss: 0.0719 - accuracy: 0.978134/53 [==================>...........] - ETA: 0s - loss: 0.0723 - accuracy: 0.978039/53 [=====================>........] - ETA: 0s - loss: 0.0724 - accuracy: 0.978141/53 [======================>.......] - ETA: 0s - loss: 0.0724 - accuracy: 0.978145/53 [========================>.....] - ETA: 0s - loss: 0.0725 - accuracy: 0.978149/53 [==========================>...] - ETA: 0s - loss: 0.0725 - accuracy: 0.978152/53 [============================>.] - ETA: 0s - loss: 0.0726 - accuracy: 0.978153/53 [==============================] - 1s 16ms/step - loss: 0.0727 - accuracy: 0.9780 - val_loss: 0.0500 - val_accuracy: 0.9870
Epoch 13/15
 1/53 [..............................] - ETA: 0s - loss: 0.0650 - accuracy: 0.9795 8/53 [===>..........................] - ETA: 0s - loss: 0.0712 - accuracy: 0.977713/53 [======>.......................] - ETA: 0s - loss: 0.0713 - accuracy: 0.977718/53 [=========>....................] - ETA: 0s - loss: 0.0712 - accuracy: 0.977822/53 [===========>..................] - ETA: 0s - loss: 0.0712 - accuracy: 0.977928/53 [==============>...............] - ETA: 0s - loss: 0.0708 - accuracy: 0.978133/53 [=================>............] - ETA: 0s - loss: 0.0705 - accuracy: 0.978241/53 [======================>.......] - ETA: 0s - loss: 0.0703 - accuracy: 0.978349/53 [==========================>...] - ETA: 0s - loss: 0.0701 - accuracy: 0.978453/53 [==============================] - 1s 12ms/step - loss: 0.0700 - accuracy: 0.9784 - val_loss: 0.0454 - val_accuracy: 0.9885
Epoch 14/15
 1/53 [..............................] - ETA: 0s - loss: 0.0631 - accuracy: 0.9775 8/53 [===>..........................] - ETA: 0s - loss: 0.0710 - accuracy: 0.976716/53 [========>.....................] - ETA: 0s - loss: 0.0693 - accuracy: 0.977424/53 [============>.................] - ETA: 0s - loss: 0.0679 - accuracy: 0.977929/53 [===============>..............] - ETA: 0s - loss: 0.0675 - accuracy: 0.978137/53 [===================>..........] - ETA: 0s - loss: 0.0671 - accuracy: 0.978245/53 [========================>.....] - ETA: 0s - loss: 0.0668 - accuracy: 0.978452/53 [============================>.] - ETA: 0s - loss: 0.0666 - accuracy: 0.978553/53 [==============================] - 0s 9ms/step - loss: 0.0665 - accuracy: 0.9785 - val_loss: 0.0431 - val_accuracy: 0.9888
Epoch 15/15
 1/53 [..............................] - ETA: 0s - loss: 0.0748 - accuracy: 0.9775 9/53 [====>.........................] - ETA: 0s - loss: 0.0660 - accuracy: 0.980517/53 [========>.....................] - ETA: 0s - loss: 0.0637 - accuracy: 0.981025/53 [=============>................] - ETA: 0s - loss: 0.0629 - accuracy: 0.981133/53 [=================>............] - ETA: 0s - loss: 0.0629 - accuracy: 0.981141/53 [======================>.......] - ETA: 0s - loss: 0.0629 - accuracy: 0.981149/53 [==========================>...] - ETA: 0s - loss: 0.0630 - accuracy: 0.981153/53 [==============================] - 0s 8ms/step - loss: 0.0631 - accuracy: 0.9811 - val_loss: 0.0439 - val_accuracy: 0.9895
training_time: 0:00:14.729429
Test loss: 0.03916367143392563
Test accuracy: 0.9869999885559082
