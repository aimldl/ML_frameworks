Number of devices: 8
batch_size_per_replica: 250
batch_size: 2000 = 250 * 8
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
60000 10000
Epoch 1/20
 1/24 [>.............................] - ETA: 20s - loss: 103.8781 - accuracy: 0.090519/24 [======================>.......] - ETA: 0s - loss: 38.1316 - accuracy: 0.4125  24/24 [==============================] - 1s 23ms/step - loss: 32.5571 - accuracy: 0.4608 - val_loss: 1.8040 - val_accuracy: 0.7133
Epoch 2/20
 1/24 [>.............................] - ETA: 0s - loss: 1.8003 - accuracy: 0.705021/24 [=========================>....] - ETA: 0s - loss: 1.5263 - accuracy: 0.656124/24 [==============================] - 0s 5ms/step - loss: 1.4985 - accuracy: 0.6544 - val_loss: 1.0340 - val_accuracy: 0.7286
Epoch 3/20
 1/24 [>.............................] - ETA: 0s - loss: 0.9595 - accuracy: 0.744521/24 [=========================>....] - ETA: 0s - loss: 0.9854 - accuracy: 0.753424/24 [==============================] - 0s 6ms/step - loss: 0.9779 - accuracy: 0.7555 - val_loss: 0.8432 - val_accuracy: 0.8004
Epoch 4/20
 1/24 [>.............................] - ETA: 0s - loss: 0.8012 - accuracy: 0.804521/24 [=========================>....] - ETA: 0s - loss: 0.7891 - accuracy: 0.807124/24 [==============================] - 0s 5ms/step - loss: 0.7855 - accuracy: 0.8083 - val_loss: 0.7580 - val_accuracy: 0.8344
Epoch 5/20
 1/24 [>.............................] - ETA: 0s - loss: 0.6996 - accuracy: 0.825021/24 [=========================>....] - ETA: 0s - loss: 0.6735 - accuracy: 0.833524/24 [==============================] - 0s 5ms/step - loss: 0.6708 - accuracy: 0.8342 - val_loss: 0.6879 - val_accuracy: 0.8512
Epoch 6/20
 1/24 [>.............................] - ETA: 0s - loss: 0.6490 - accuracy: 0.849519/24 [======================>.......] - ETA: 0s - loss: 0.6120 - accuracy: 0.849424/24 [==============================] - 0s 5ms/step - loss: 0.6035 - accuracy: 0.8508 - val_loss: 0.6346 - val_accuracy: 0.8615
Epoch 7/20
 1/24 [>.............................] - ETA: 0s - loss: 0.5235 - accuracy: 0.855520/24 [========================>.....] - ETA: 0s - loss: 0.5065 - accuracy: 0.867824/24 [==============================] - 0s 5ms/step - loss: 0.5061 - accuracy: 0.8684 - val_loss: 0.5978 - val_accuracy: 0.8752
Epoch 8/20
 1/24 [>.............................] - ETA: 0s - loss: 0.5045 - accuracy: 0.866519/24 [======================>.......] - ETA: 0s - loss: 0.4548 - accuracy: 0.879924/24 [==============================] - 0s 5ms/step - loss: 0.4534 - accuracy: 0.8810 - val_loss: 0.5456 - val_accuracy: 0.8832
Epoch 9/20
 1/24 [>.............................] - ETA: 0s - loss: 0.4170 - accuracy: 0.885520/24 [========================>.....] - ETA: 0s - loss: 0.3977 - accuracy: 0.894324/24 [==============================] - 0s 5ms/step - loss: 0.3972 - accuracy: 0.8945 - val_loss: 0.5273 - val_accuracy: 0.8938
Epoch 10/20
 1/24 [>.............................] - ETA: 0s - loss: 0.3771 - accuracy: 0.908020/24 [========================>.....] - ETA: 0s - loss: 0.3499 - accuracy: 0.905824/24 [==============================] - 0s 5ms/step - loss: 0.3495 - accuracy: 0.9058 - val_loss: 0.4915 - val_accuracy: 0.8988
Epoch 11/20
 1/24 [>.............................] - ETA: 0s - loss: 0.2832 - accuracy: 0.922020/24 [========================>.....] - ETA: 0s - loss: 0.3075 - accuracy: 0.914924/24 [==============================] - 0s 6ms/step - loss: 0.3078 - accuracy: 0.9148 - val_loss: 0.4761 - val_accuracy: 0.9032
Epoch 12/20
 1/24 [>.............................] - ETA: 0s - loss: 0.3071 - accuracy: 0.912520/24 [========================>.....] - ETA: 0s - loss: 0.2932 - accuracy: 0.916124/24 [==============================] - 0s 5ms/step - loss: 0.2911 - accuracy: 0.9167 - val_loss: 0.4608 - val_accuracy: 0.9088
Epoch 13/20
 1/24 [>.............................] - ETA: 0s - loss: 0.2396 - accuracy: 0.930019/24 [======================>.......] - ETA: 0s - loss: 0.2538 - accuracy: 0.926024/24 [==============================] - 0s 6ms/step - loss: 0.2551 - accuracy: 0.9257 - val_loss: 0.4431 - val_accuracy: 0.9112
Epoch 14/20
 1/24 [>.............................] - ETA: 0s - loss: 0.2602 - accuracy: 0.922519/24 [======================>.......] - ETA: 0s - loss: 0.2413 - accuracy: 0.929424/24 [==============================] - 0s 5ms/step - loss: 0.2404 - accuracy: 0.9292 - val_loss: 0.4457 - val_accuracy: 0.9172
Epoch 15/20
 1/24 [>.............................] - ETA: 0s - loss: 0.2420 - accuracy: 0.928020/24 [========================>.....] - ETA: 0s - loss: 0.2237 - accuracy: 0.933124/24 [==============================] - 0s 5ms/step - loss: 0.2233 - accuracy: 0.9331 - val_loss: 0.4312 - val_accuracy: 0.9191
Epoch 16/20
 1/24 [>.............................] - ETA: 0s - loss: 0.2144 - accuracy: 0.930520/24 [========================>.....] - ETA: 0s - loss: 0.2133 - accuracy: 0.933824/24 [==============================] - 0s 5ms/step - loss: 0.2117 - accuracy: 0.9345 - val_loss: 0.4268 - val_accuracy: 0.9224
Epoch 17/20
 1/24 [>.............................] - ETA: 0s - loss: 0.1905 - accuracy: 0.939520/24 [========================>.....] - ETA: 0s - loss: 0.1906 - accuracy: 0.940324/24 [==============================] - 0s 5ms/step - loss: 0.1909 - accuracy: 0.9403 - val_loss: 0.4208 - val_accuracy: 0.9233
Epoch 18/20
 1/24 [>.............................] - ETA: 0s - loss: 0.1857 - accuracy: 0.942019/24 [======================>.......] - ETA: 0s - loss: 0.1764 - accuracy: 0.944324/24 [==============================] - 0s 5ms/step - loss: 0.1769 - accuracy: 0.9442 - val_loss: 0.4164 - val_accuracy: 0.9262
Epoch 19/20
 1/24 [>.............................] - ETA: 0s - loss: 0.1515 - accuracy: 0.946520/24 [========================>.....] - ETA: 0s - loss: 0.1672 - accuracy: 0.945724/24 [==============================] - 0s 6ms/step - loss: 0.1670 - accuracy: 0.9459 - val_loss: 0.4112 - val_accuracy: 0.9268
Epoch 20/20
 1/24 [>.............................] - ETA: 0s - loss: 0.1567 - accuracy: 0.946019/24 [======================>.......] - ETA: 0s - loss: 0.1564 - accuracy: 0.949324/24 [==============================] - 0s 5ms/step - loss: 0.1565 - accuracy: 0.9493 - val_loss: 0.4275 - val_accuracy: 0.9268
training_time: 0:00:03.945085
  1/313 [..............................] - ETA: 50s - loss: 0.3292 - accuracy: 0.9062 19/313 [>.............................] - ETA: 0s - loss: 0.3876 - accuracy: 0.9145  36/313 [==>...........................] - ETA: 0s - loss: 0.4047 - accuracy: 0.9219 56/313 [====>.........................] - ETA: 0s - loss: 0.5086 - accuracy: 0.9102 76/313 [======>.......................] - ETA: 0s - loss: 0.5458 - accuracy: 0.9050 96/313 [========>.....................] - ETA: 0s - loss: 0.5044 - accuracy: 0.9095116/313 [==========>...................] - ETA: 0s - loss: 0.4993 - accuracy: 0.9127136/313 [============>.................] - ETA: 0s - loss: 0.5107 - accuracy: 0.9088156/313 [=============>................] - ETA: 0s - loss: 0.5256 - accuracy: 0.9085176/313 [===============>..............] - ETA: 0s - loss: 0.4779 - accuracy: 0.9155196/313 [=================>............] - ETA: 0s - loss: 0.4887 - accuracy: 0.9158216/313 [===================>..........] - ETA: 0s - loss: 0.4693 - accuracy: 0.9187236/313 [=====================>........] - ETA: 0s - loss: 0.4483 - accuracy: 0.9224255/313 [=======================>......] - ETA: 0s - loss: 0.4379 - accuracy: 0.9239275/313 [=========================>....] - ETA: 0s - loss: 0.4147 - accuracy: 0.9269295/313 [===========================>..] - ETA: 0s - loss: 0.4038 - accuracy: 0.9293313/313 [==============================] - 1s 3ms/step - loss: 0.4142 - accuracy: 0.9279
Test results: Loss = 0.4141654670238495, Accuracy = 0.9279000163078308
