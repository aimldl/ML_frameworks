Number of devices: 5
batch_size_per_replica: 128
batch_size: 640 = 128 * 5
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
x_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
<class 'numpy.ndarray'> <class 'numpy.ndarray'>
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 26, 26, 32)        320       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 13, 13, 32)        0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 11, 11, 64)        18496     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 5, 5, 64)          0         
_________________________________________________________________
flatten (Flatten)            (None, 1600)              0         
_________________________________________________________________
dropout (Dropout)            (None, 1600)              0         
_________________________________________________________________
dense (Dense)                (None, 10)                16010     
=================================================================
Total params: 34,826
Trainable params: 34,826
Non-trainable params: 0
_________________________________________________________________
Epoch 1/15
 1/85 [..............................] - ETA: 3:37 - loss: 2.3219 - accuracy: 0.0859 2/85 [..............................] - ETA: 6s - loss: 2.3129 - accuracy: 0.1004   3/85 [>.............................] - ETA: 5s - loss: 2.3030 - accuracy: 0.1180 4/85 [>.............................] - ETA: 5s - loss: 2.2948 - accuracy: 0.1326 5/85 [>.............................] - ETA: 5s - loss: 2.2864 - accuracy: 0.1470 6/85 [=>............................] - ETA: 4s - loss: 2.2782 - accuracy: 0.1599 9/85 [==>...........................] - ETA: 3s - loss: 2.2531 - accuracy: 0.194312/85 [===>..........................] - ETA: 3s - loss: 2.2253 - accuracy: 0.222615/85 [====>.........................] - ETA: 2s - loss: 2.1939 - accuracy: 0.247025/85 [=======>......................] - ETA: 1s - loss: 2.0690 - accuracy: 0.309335/85 [===========>..................] - ETA: 0s - loss: 1.9450 - accuracy: 0.353145/85 [==============>...............] - ETA: 0s - loss: 1.8381 - accuracy: 0.387755/85 [==================>...........] - ETA: 0s - loss: 1.7474 - accuracy: 0.416465/85 [=====================>........] - ETA: 0s - loss: 1.6700 - accuracy: 0.440675/85 [=========================>....] - ETA: 0s - loss: 1.6034 - accuracy: 0.461484/85 [============================>.] - ETA: 0s - loss: 1.5508 - accuracy: 0.477885/85 [==============================] - ETA: 0s - loss: 1.5453 - accuracy: 0.479585/85 [==============================] - 4s 17ms/step - loss: 1.5400 - accuracy: 0.4812 - val_loss: 0.5927 - val_accuracy: 0.7770
Epoch 2/15
 1/85 [..............................] - ETA: 0s - loss: 0.6426 - accuracy: 0.754711/85 [==>...........................] - ETA: 0s - loss: 0.6537 - accuracy: 0.757421/85 [======>.......................] - ETA: 0s - loss: 0.6488 - accuracy: 0.759231/85 [=========>....................] - ETA: 0s - loss: 0.6424 - accuracy: 0.761241/85 [=============>................] - ETA: 0s - loss: 0.6359 - accuracy: 0.763551/85 [=================>............] - ETA: 0s - loss: 0.6305 - accuracy: 0.765661/85 [====================>.........] - ETA: 0s - loss: 0.6257 - accuracy: 0.767571/85 [========================>.....] - ETA: 0s - loss: 0.6212 - accuracy: 0.769381/85 [===========================>..] - ETA: 0s - loss: 0.6168 - accuracy: 0.771085/85 [==============================] - ETA: 0s - loss: 0.6151 - accuracy: 0.771785/85 [==============================] - 1s 7ms/step - loss: 0.6147 - accuracy: 0.7719 - val_loss: 0.4794 - val_accuracy: 0.8245
Epoch 3/15
 1/85 [..............................] - ETA: 0s - loss: 0.4958 - accuracy: 0.817211/85 [==>...........................] - ETA: 0s - loss: 0.5039 - accuracy: 0.814721/85 [======>.......................] - ETA: 0s - loss: 0.5082 - accuracy: 0.813131/85 [=========>....................] - ETA: 0s - loss: 0.5099 - accuracy: 0.812439/85 [============>.................] - ETA: 0s - loss: 0.5102 - accuracy: 0.812549/85 [================>.............] - ETA: 0s - loss: 0.5103 - accuracy: 0.812859/85 [===================>..........] - ETA: 0s - loss: 0.5098 - accuracy: 0.813269/85 [=======================>......] - ETA: 0s - loss: 0.5093 - accuracy: 0.813779/85 [==========================>...] - ETA: 0s - loss: 0.5086 - accuracy: 0.814185/85 [==============================] - ETA: 0s - loss: 0.5082 - accuracy: 0.814485/85 [==============================] - 1s 7ms/step - loss: 0.5081 - accuracy: 0.8145 - val_loss: 0.4328 - val_accuracy: 0.8485
Epoch 4/15
 1/85 [..............................] - ETA: 0s - loss: 0.4847 - accuracy: 0.815611/85 [==>...........................] - ETA: 0s - loss: 0.4685 - accuracy: 0.830521/85 [======>.......................] - ETA: 0s - loss: 0.4717 - accuracy: 0.830231/85 [=========>....................] - ETA: 0s - loss: 0.4714 - accuracy: 0.830241/85 [=============>................] - ETA: 0s - loss: 0.4709 - accuracy: 0.830151/85 [=================>............] - ETA: 0s - loss: 0.4707 - accuracy: 0.830161/85 [====================>.........] - ETA: 0s - loss: 0.4706 - accuracy: 0.830271/85 [========================>.....] - ETA: 0s - loss: 0.4703 - accuracy: 0.830481/85 [===========================>..] - ETA: 0s - loss: 0.4696 - accuracy: 0.830885/85 [==============================] - ETA: 0s - loss: 0.4692 - accuracy: 0.830985/85 [==============================] - 1s 7ms/step - loss: 0.4691 - accuracy: 0.8310 - val_loss: 0.4040 - val_accuracy: 0.8552
Epoch 5/15
 1/85 [..............................] - ETA: 0s - loss: 0.4552 - accuracy: 0.843811/85 [==>...........................] - ETA: 0s - loss: 0.4368 - accuracy: 0.840321/85 [======>.......................] - ETA: 0s - loss: 0.4390 - accuracy: 0.840031/85 [=========>....................] - ETA: 0s - loss: 0.4402 - accuracy: 0.839941/85 [=============>................] - ETA: 0s - loss: 0.4402 - accuracy: 0.840351/85 [=================>............] - ETA: 0s - loss: 0.4396 - accuracy: 0.841061/85 [====================>.........] - ETA: 0s - loss: 0.4390 - accuracy: 0.841571/85 [========================>.....] - ETA: 0s - loss: 0.4386 - accuracy: 0.841881/85 [===========================>..] - ETA: 0s - loss: 0.4381 - accuracy: 0.842285/85 [==============================] - 1s 7ms/step - loss: 0.4379 - accuracy: 0.8423 - val_loss: 0.3918 - val_accuracy: 0.8582
Epoch 6/15
 1/85 [..............................] - ETA: 0s - loss: 0.4365 - accuracy: 0.846910/85 [==>...........................] - ETA: 0s - loss: 0.4291 - accuracy: 0.848120/85 [======>.......................] - ETA: 0s - loss: 0.4240 - accuracy: 0.848430/85 [=========>....................] - ETA: 0s - loss: 0.4202 - accuracy: 0.849540/85 [=============>................] - ETA: 0s - loss: 0.4190 - accuracy: 0.849750/85 [================>.............] - ETA: 0s - loss: 0.4180 - accuracy: 0.850060/85 [====================>.........] - ETA: 0s - loss: 0.4172 - accuracy: 0.850370/85 [=======================>......] - ETA: 0s - loss: 0.4166 - accuracy: 0.850680/85 [===========================>..] - ETA: 0s - loss: 0.4164 - accuracy: 0.850785/85 [==============================] - 1s 7ms/step - loss: 0.4163 - accuracy: 0.8507 - val_loss: 0.3764 - val_accuracy: 0.8645
Epoch 7/15
 1/85 [..............................] - ETA: 0s - loss: 0.3902 - accuracy: 0.857811/85 [==>...........................] - ETA: 0s - loss: 0.4018 - accuracy: 0.857321/85 [======>.......................] - ETA: 0s - loss: 0.4053 - accuracy: 0.856531/85 [=========>....................] - ETA: 0s - loss: 0.4054 - accuracy: 0.856441/85 [=============>................] - ETA: 0s - loss: 0.4050 - accuracy: 0.856251/85 [=================>............] - ETA: 0s - loss: 0.4047 - accuracy: 0.856161/85 [====================>.........] - ETA: 0s - loss: 0.4046 - accuracy: 0.856171/85 [========================>.....] - ETA: 0s - loss: 0.4044 - accuracy: 0.856181/85 [===========================>..] - ETA: 0s - loss: 0.4043 - accuracy: 0.856285/85 [==============================] - 1s 6ms/step - loss: 0.4041 - accuracy: 0.8562 - val_loss: 0.3647 - val_accuracy: 0.8688
Epoch 8/15
 1/85 [..............................] - ETA: 0s - loss: 0.4167 - accuracy: 0.8500 9/85 [==>...........................] - ETA: 0s - loss: 0.4147 - accuracy: 0.851419/85 [=====>........................] - ETA: 0s - loss: 0.4102 - accuracy: 0.854129/85 [=========>....................] - ETA: 0s - loss: 0.4067 - accuracy: 0.855739/85 [============>.................] - ETA: 0s - loss: 0.4041 - accuracy: 0.857145/85 [==============>...............] - ETA: 0s - loss: 0.4030 - accuracy: 0.857651/85 [=================>............] - ETA: 0s - loss: 0.4020 - accuracy: 0.858054/85 [==================>...........] - ETA: 0s - loss: 0.4016 - accuracy: 0.858257/85 [===================>..........] - ETA: 0s - loss: 0.4012 - accuracy: 0.858359/85 [===================>..........] - ETA: 0s - loss: 0.4009 - accuracy: 0.858461/85 [====================>.........] - ETA: 0s - loss: 0.4007 - accuracy: 0.858564/85 [=====================>........] - ETA: 0s - loss: 0.4003 - accuracy: 0.858665/85 [=====================>........] - ETA: 0s - loss: 0.4002 - accuracy: 0.858667/85 [======================>.......] - ETA: 0s - loss: 0.3999 - accuracy: 0.858771/85 [========================>.....] - ETA: 0s - loss: 0.3994 - accuracy: 0.858874/85 [=========================>....] - ETA: 0s - loss: 0.3991 - accuracy: 0.858978/85 [==========================>...] - ETA: 0s - loss: 0.3987 - accuracy: 0.859080/85 [===========================>..] - ETA: 0s - loss: 0.3985 - accuracy: 0.859182/85 [===========================>..] - ETA: 0s - loss: 0.3983 - accuracy: 0.859185/85 [==============================] - 1s 16ms/step - loss: 0.3980 - accuracy: 0.8592 - val_loss: 0.3545 - val_accuracy: 0.8710
Epoch 9/15
 1/85 [..............................] - ETA: 4s - loss: 0.3660 - accuracy: 0.8547 3/85 [>.............................] - ETA: 2s - loss: 0.3703 - accuracy: 0.8578 7/85 [=>............................] - ETA: 1s - loss: 0.3684 - accuracy: 0.863710/85 [==>...........................] - ETA: 1s - loss: 0.3689 - accuracy: 0.864912/85 [===>..........................] - ETA: 1s - loss: 0.3697 - accuracy: 0.865214/85 [===>..........................] - ETA: 1s - loss: 0.3702 - accuracy: 0.865516/85 [====>.........................] - ETA: 1s - loss: 0.3710 - accuracy: 0.865618/85 [=====>........................] - ETA: 1s - loss: 0.3719 - accuracy: 0.865520/85 [======>.......................] - ETA: 1s - loss: 0.3728 - accuracy: 0.865423/85 [=======>......................] - ETA: 1s - loss: 0.3741 - accuracy: 0.865326/85 [========>.....................] - ETA: 1s - loss: 0.3752 - accuracy: 0.865129/85 [=========>....................] - ETA: 1s - loss: 0.3761 - accuracy: 0.864932/85 [==========>...................] - ETA: 1s - loss: 0.3771 - accuracy: 0.864736/85 [===========>..................] - ETA: 1s - loss: 0.3780 - accuracy: 0.864441/85 [=============>................] - ETA: 0s - loss: 0.3788 - accuracy: 0.864147/85 [===============>..............] - ETA: 0s - loss: 0.3795 - accuracy: 0.863849/85 [================>.............] - ETA: 0s - loss: 0.3796 - accuracy: 0.863758/85 [===================>..........] - ETA: 0s - loss: 0.3804 - accuracy: 0.863462/85 [====================>.........] - ETA: 0s - loss: 0.3807 - accuracy: 0.863268/85 [=======================>......] - ETA: 0s - loss: 0.3812 - accuracy: 0.862975/85 [=========================>....] - ETA: 0s - loss: 0.3815 - accuracy: 0.862780/85 [===========================>..] - ETA: 0s - loss: 0.3816 - accuracy: 0.862785/85 [==============================] - 1s 17ms/step - loss: 0.3816 - accuracy: 0.8627 - val_loss: 0.3488 - val_accuracy: 0.8755
Epoch 10/15
 1/85 [..............................] - ETA: 0s - loss: 0.3755 - accuracy: 0.8625 4/85 [>.............................] - ETA: 1s - loss: 0.3760 - accuracy: 0.862910/85 [==>...........................] - ETA: 0s - loss: 0.3762 - accuracy: 0.864314/85 [===>..........................] - ETA: 0s - loss: 0.3747 - accuracy: 0.865217/85 [=====>........................] - ETA: 1s - loss: 0.3738 - accuracy: 0.865724/85 [=======>......................] - ETA: 0s - loss: 0.3731 - accuracy: 0.866331/85 [=========>....................] - ETA: 0s - loss: 0.3726 - accuracy: 0.866536/85 [===========>..................] - ETA: 0s - loss: 0.3719 - accuracy: 0.866840/85 [=============>................] - ETA: 0s - loss: 0.3714 - accuracy: 0.867247/85 [===============>..............] - ETA: 0s - loss: 0.3706 - accuracy: 0.867652/85 [=================>............] - ETA: 0s - loss: 0.3703 - accuracy: 0.867756/85 [==================>...........] - ETA: 0s - loss: 0.3702 - accuracy: 0.867762/85 [====================>.........] - ETA: 0s - loss: 0.3701 - accuracy: 0.867865/85 [=====================>........] - ETA: 0s - loss: 0.3700 - accuracy: 0.867871/85 [========================>.....] - ETA: 0s - loss: 0.3698 - accuracy: 0.867976/85 [=========================>....] - ETA: 0s - loss: 0.3696 - accuracy: 0.868080/85 [===========================>..] - ETA: 0s - loss: 0.3695 - accuracy: 0.868085/85 [==============================] - 1s 13ms/step - loss: 0.3694 - accuracy: 0.8681 - val_loss: 0.3354 - val_accuracy: 0.8765
Epoch 11/15
 1/85 [..............................] - ETA: 0s - loss: 0.3479 - accuracy: 0.867210/85 [==>...........................] - ETA: 0s - loss: 0.3691 - accuracy: 0.862815/85 [====>.........................] - ETA: 0s - loss: 0.3696 - accuracy: 0.863921/85 [======>.......................] - ETA: 0s - loss: 0.3691 - accuracy: 0.864929/85 [=========>....................] - ETA: 0s - loss: 0.3698 - accuracy: 0.865439/85 [============>.................] - ETA: 0s - loss: 0.3694 - accuracy: 0.866146/85 [===============>..............] - ETA: 0s - loss: 0.3692 - accuracy: 0.866355/85 [==================>...........] - ETA: 0s - loss: 0.3687 - accuracy: 0.866765/85 [=====================>........] - ETA: 0s - loss: 0.3681 - accuracy: 0.867075/85 [=========================>....] - ETA: 0s - loss: 0.3677 - accuracy: 0.867385/85 [==============================] - ETA: 0s - loss: 0.3672 - accuracy: 0.867685/85 [==============================] - 1s 8ms/step - loss: 0.3671 - accuracy: 0.8677 - val_loss: 0.3354 - val_accuracy: 0.8805
Epoch 12/15
 1/85 [..............................] - ETA: 0s - loss: 0.4017 - accuracy: 0.8594 9/85 [==>...........................] - ETA: 0s - loss: 0.3566 - accuracy: 0.869615/85 [====>.........................] - ETA: 0s - loss: 0.3519 - accuracy: 0.871924/85 [=======>......................] - ETA: 0s - loss: 0.3487 - accuracy: 0.873433/85 [==========>...................] - ETA: 0s - loss: 0.3476 - accuracy: 0.874243/85 [==============>...............] - ETA: 0s - loss: 0.3469 - accuracy: 0.874948/85 [===============>..............] - ETA: 0s - loss: 0.3467 - accuracy: 0.875156/85 [==================>...........] - ETA: 0s - loss: 0.3468 - accuracy: 0.875362/85 [====================>.........] - ETA: 0s - loss: 0.3470 - accuracy: 0.875368/85 [=======================>......] - ETA: 0s - loss: 0.3473 - accuracy: 0.875277/85 [==========================>...] - ETA: 0s - loss: 0.3479 - accuracy: 0.875085/85 [==============================] - 1s 8ms/step - loss: 0.3485 - accuracy: 0.8749 - val_loss: 0.3239 - val_accuracy: 0.8815
Epoch 13/15
 1/85 [..............................] - ETA: 0s - loss: 0.3439 - accuracy: 0.882811/85 [==>...........................] - ETA: 0s - loss: 0.3404 - accuracy: 0.881521/85 [======>.......................] - ETA: 0s - loss: 0.3419 - accuracy: 0.880431/85 [=========>....................] - ETA: 0s - loss: 0.3415 - accuracy: 0.880438/85 [============>.................] - ETA: 0s - loss: 0.3419 - accuracy: 0.880247/85 [===============>..............] - ETA: 0s - loss: 0.3426 - accuracy: 0.879857/85 [===================>..........] - ETA: 0s - loss: 0.3435 - accuracy: 0.879365/85 [=====================>........] - ETA: 0s - loss: 0.3440 - accuracy: 0.879073/85 [========================>.....] - ETA: 0s - loss: 0.3444 - accuracy: 0.878883/85 [============================>.] - ETA: 0s - loss: 0.3448 - accuracy: 0.878585/85 [==============================] - 1s 7ms/step - loss: 0.3449 - accuracy: 0.8785 - val_loss: 0.3232 - val_accuracy: 0.8820
Epoch 14/15
 1/85 [..............................] - ETA: 0s - loss: 0.3398 - accuracy: 0.873411/85 [==>...........................] - ETA: 0s - loss: 0.3331 - accuracy: 0.878120/85 [======>.......................] - ETA: 0s - loss: 0.3395 - accuracy: 0.876330/85 [=========>....................] - ETA: 0s - loss: 0.3413 - accuracy: 0.876539/85 [============>.................] - ETA: 0s - loss: 0.3422 - accuracy: 0.876648/85 [===============>..............] - ETA: 0s - loss: 0.3425 - accuracy: 0.876857/85 [===================>..........] - ETA: 0s - loss: 0.3431 - accuracy: 0.876866/85 [======================>.......] - ETA: 0s - loss: 0.3434 - accuracy: 0.876874/85 [=========================>....] - ETA: 0s - loss: 0.3435 - accuracy: 0.876982/85 [===========================>..] - ETA: 0s - loss: 0.3434 - accuracy: 0.877085/85 [==============================] - 1s 7ms/step - loss: 0.3433 - accuracy: 0.8770 - val_loss: 0.3114 - val_accuracy: 0.8852
Epoch 15/15
 1/85 [..............................] - ETA: 0s - loss: 0.3519 - accuracy: 0.8719 9/85 [==>...........................] - ETA: 0s - loss: 0.3370 - accuracy: 0.880117/85 [=====>........................] - ETA: 0s - loss: 0.3332 - accuracy: 0.880526/85 [========>.....................] - ETA: 0s - loss: 0.3311 - accuracy: 0.881136/85 [===========>..................] - ETA: 0s - loss: 0.3317 - accuracy: 0.880946/85 [===============>..............] - ETA: 0s - loss: 0.3325 - accuracy: 0.880755/85 [==================>...........] - ETA: 0s - loss: 0.3333 - accuracy: 0.880665/85 [=====================>........] - ETA: 0s - loss: 0.3337 - accuracy: 0.880574/85 [=========================>....] - ETA: 0s - loss: 0.3337 - accuracy: 0.880584/85 [============================>.] - ETA: 0s - loss: 0.3335 - accuracy: 0.880685/85 [==============================] - 1s 7ms/step - loss: 0.3335 - accuracy: 0.8806 - val_loss: 0.3113 - val_accuracy: 0.8860
training_time: 0:00:14.891681
Test loss: 0.32110080122947693
Test accuracy: 0.8866000175476074
