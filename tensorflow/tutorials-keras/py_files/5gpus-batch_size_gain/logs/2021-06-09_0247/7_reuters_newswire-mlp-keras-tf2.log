Number of devices: 5
batch_size_per_replica: 512
batch_size: 2560 = 512 * 5
Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/reuters.npz
   8192/2110848 [..............................] - ETA: 0s 712704/2110848 [=========>....................] - ETA: 0s2113536/2110848 [==============================] - 0s 0us/step
8982 training samples
2246 test samples
11228 total samples
8982 training labels, 2246 test labels
Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/reuters_word_index.json
  8192/550378 [..............................] - ETA: 0s557056/550378 [==============================] - 0s 0us/step
? period ended december 31 shr profit 11 cts vs loss 24 cts net profit 224 271 vs loss 511 349 revs 7 258 688 vs 7 200 349 reuter 3
x_train (8982, 10000)
x_test  (2246, 10000)
y_train_dummy (8982, 46)
y_test_dummy  (2246, 46)
3 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
4 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
y_train (8982, 46)
y_test  (2246, 46)
3 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
4 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
x_val  (1000, 10000)
y_val  (1000, 46)
partial_x_train  (7982, 10000)
partial_y_train  (7982, 46)
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense (Dense)                (None, 64)                640064    
_________________________________________________________________
dense_1 (Dense)              (None, 64)                4160      
_________________________________________________________________
dense_2 (Dense)              (None, 46)                2990      
=================================================================
Total params: 647,214
Trainable params: 647,214
Non-trainable params: 0
_________________________________________________________________
Epoch 1/10
1/4 [======>.......................] - ETA: 3s - loss: 3.8515 - accuracy: 0.00664/4 [==============================] - 2s 191ms/step - loss: 3.7145 - accuracy: 0.1736 - val_loss: 3.0738 - val_accuracy: 0.5640
Epoch 2/10
1/4 [======>.......................] - ETA: 0s - loss: 3.0398 - accuracy: 0.58713/4 [=====================>........] - ETA: 0s - loss: 2.9621 - accuracy: 0.59174/4 [==============================] - 0s 37ms/step - loss: 2.9247 - accuracy: 0.5922 - val_loss: 2.4845 - val_accuracy: 0.5800
Epoch 3/10
1/4 [======>.......................] - ETA: 0s - loss: 2.3992 - accuracy: 0.59343/4 [=====================>........] - ETA: 0s - loss: 2.3480 - accuracy: 0.61664/4 [==============================] - 0s 37ms/step - loss: 2.3244 - accuracy: 0.6223 - val_loss: 2.0649 - val_accuracy: 0.6330
Epoch 4/10
1/4 [======>.......................] - ETA: 0s - loss: 1.9494 - accuracy: 0.66374/4 [==============================] - ETA: 0s - loss: 1.9007 - accuracy: 0.67624/4 [==============================] - 0s 37ms/step - loss: 1.8956 - accuracy: 0.6768 - val_loss: 1.7901 - val_accuracy: 0.6630
Epoch 5/10
1/4 [======>.......................] - ETA: 0s - loss: 1.6288 - accuracy: 0.69844/4 [==============================] - ETA: 0s - loss: 1.6059 - accuracy: 0.70484/4 [==============================] - 0s 37ms/step - loss: 1.6024 - accuracy: 0.7052 - val_loss: 1.6090 - val_accuracy: 0.6670
Epoch 6/10
1/4 [======>.......................] - ETA: 0s - loss: 1.4489 - accuracy: 0.69694/4 [==============================] - ETA: 0s - loss: 1.4148 - accuracy: 0.71604/4 [==============================] - 0s 36ms/step - loss: 1.4112 - accuracy: 0.7173 - val_loss: 1.4536 - val_accuracy: 0.7090
Epoch 7/10
1/4 [======>.......................] - ETA: 0s - loss: 1.2537 - accuracy: 0.76254/4 [==============================] - ETA: 0s - loss: 1.2346 - accuracy: 0.76064/4 [==============================] - 0s 36ms/step - loss: 1.2324 - accuracy: 0.7604 - val_loss: 1.3512 - val_accuracy: 0.7320
Epoch 8/10
1/4 [======>.......................] - ETA: 0s - loss: 1.1068 - accuracy: 0.78243/4 [=====================>........] - ETA: 0s - loss: 1.1027 - accuracy: 0.78054/4 [==============================] - 0s 38ms/step - loss: 1.1000 - accuracy: 0.7806 - val_loss: 1.2665 - val_accuracy: 0.7300
Epoch 9/10
1/4 [======>.......................] - ETA: 0s - loss: 1.0267 - accuracy: 0.79264/4 [==============================] - ETA: 0s - loss: 1.0086 - accuracy: 0.79684/4 [==============================] - 0s 37ms/step - loss: 1.0062 - accuracy: 0.7972 - val_loss: 1.2065 - val_accuracy: 0.7380
Epoch 10/10
1/4 [======>.......................] - ETA: 0s - loss: 0.9212 - accuracy: 0.80434/4 [==============================] - ETA: 0s - loss: 0.9081 - accuracy: 0.81124/4 [==============================] - 0s 36ms/step - loss: 0.9068 - accuracy: 0.8120 - val_loss: 1.1663 - val_accuracy: 0.7380
/home/ubuntu/anaconda3/envs/tensorflow2_latest_p37/gpu_cuda11.0/lib/python3.7/site-packages/tensorflow/python/keras/datasets/reuters.py:148: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_train, y_train = np.array(xs[:idx]), np.array(labels[:idx])
/home/ubuntu/anaconda3/envs/tensorflow2_latest_p37/gpu_cuda11.0/lib/python3.7/site-packages/tensorflow/python/keras/datasets/reuters.py:149: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  x_test, y_test = np.array(xs[idx:]), np.array(labels[idx:])
training_time: 0:00:03.736277
