Number of devices: 5
batch_size_per_replica: 128
batch_size: 640 = 128 * 5
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
x_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
<class 'numpy.ndarray'> <class 'numpy.ndarray'>
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 26, 26, 32)        320       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 13, 13, 32)        0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 11, 11, 64)        18496     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 5, 5, 64)          0         
_________________________________________________________________
flatten (Flatten)            (None, 1600)              0         
_________________________________________________________________
dropout (Dropout)            (None, 1600)              0         
_________________________________________________________________
dense (Dense)                (None, 10)                16010     
=================================================================
Total params: 34,826
Trainable params: 34,826
Non-trainable params: 0
_________________________________________________________________
Epoch 1/15
 1/85 [..............................] - ETA: 3:39 - loss: 2.3203 - accuracy: 0.1016 2/85 [..............................] - ETA: 7s - loss: 2.3082 - accuracy: 0.1164   3/85 [>.............................] - ETA: 6s - loss: 2.2993 - accuracy: 0.1267 4/85 [>.............................] - ETA: 5s - loss: 2.2903 - accuracy: 0.1373 5/85 [>.............................] - ETA: 5s - loss: 2.2818 - accuracy: 0.1469 6/85 [=>............................] - ETA: 5s - loss: 2.2734 - accuracy: 0.1559 8/85 [=>............................] - ETA: 4s - loss: 2.2570 - accuracy: 0.172810/85 [==>...........................] - ETA: 4s - loss: 2.2401 - accuracy: 0.189712/85 [===>..........................] - ETA: 3s - loss: 2.2217 - accuracy: 0.208314/85 [===>..........................] - ETA: 3s - loss: 2.2019 - accuracy: 0.227817/85 [=====>........................] - ETA: 3s - loss: 2.1693 - accuracy: 0.256220/85 [======>.......................] - ETA: 2s - loss: 2.1337 - accuracy: 0.282123/85 [=======>......................] - ETA: 2s - loss: 2.0950 - accuracy: 0.306033/85 [==========>...................] - ETA: 1s - loss: 1.9570 - accuracy: 0.371643/85 [==============>...............] - ETA: 0s - loss: 1.8260 - accuracy: 0.421953/85 [=================>............] - ETA: 0s - loss: 1.7113 - accuracy: 0.462563/85 [=====================>........] - ETA: 0s - loss: 1.6122 - accuracy: 0.496473/85 [========================>.....] - ETA: 0s - loss: 1.5257 - accuracy: 0.525381/85 [===========================>..] - ETA: 0s - loss: 1.4642 - accuracy: 0.545685/85 [==============================] - ETA: 0s - loss: 1.4359 - accuracy: 0.554985/85 [==============================] - 4s 21ms/step - loss: 1.4291 - accuracy: 0.5571 - val_loss: 0.1811 - val_accuracy: 0.9517
Epoch 2/15
 1/85 [..............................] - ETA: 0s - loss: 0.2726 - accuracy: 0.909411/85 [==>...........................] - ETA: 0s - loss: 0.2711 - accuracy: 0.914021/85 [======>.......................] - ETA: 0s - loss: 0.2652 - accuracy: 0.917631/85 [=========>....................] - ETA: 0s - loss: 0.2604 - accuracy: 0.919541/85 [=============>................] - ETA: 0s - loss: 0.2561 - accuracy: 0.921151/85 [=================>............] - ETA: 0s - loss: 0.2519 - accuracy: 0.922761/85 [====================>.........] - ETA: 0s - loss: 0.2477 - accuracy: 0.924271/85 [========================>.....] - ETA: 0s - loss: 0.2440 - accuracy: 0.925681/85 [===========================>..] - ETA: 0s - loss: 0.2404 - accuracy: 0.926885/85 [==============================] - ETA: 0s - loss: 0.2390 - accuracy: 0.927385/85 [==============================] - 1s 7ms/step - loss: 0.2387 - accuracy: 0.9274 - val_loss: 0.1019 - val_accuracy: 0.9748
Epoch 3/15
 1/85 [..............................] - ETA: 0s - loss: 0.1493 - accuracy: 0.950011/85 [==>...........................] - ETA: 0s - loss: 0.1546 - accuracy: 0.952221/85 [======>.......................] - ETA: 0s - loss: 0.1540 - accuracy: 0.952731/85 [=========>....................] - ETA: 0s - loss: 0.1530 - accuracy: 0.953541/85 [=============>................] - ETA: 0s - loss: 0.1529 - accuracy: 0.953851/85 [=================>............] - ETA: 0s - loss: 0.1524 - accuracy: 0.954261/85 [====================>.........] - ETA: 0s - loss: 0.1512 - accuracy: 0.954771/85 [========================>.....] - ETA: 0s - loss: 0.1502 - accuracy: 0.955181/85 [===========================>..] - ETA: 0s - loss: 0.1491 - accuracy: 0.955485/85 [==============================] - ETA: 0s - loss: 0.1488 - accuracy: 0.955585/85 [==============================] - 1s 7ms/step - loss: 0.1487 - accuracy: 0.9556 - val_loss: 0.0789 - val_accuracy: 0.9778
Epoch 4/15
 1/85 [..............................] - ETA: 0s - loss: 0.1411 - accuracy: 0.954711/85 [==>...........................] - ETA: 0s - loss: 0.1313 - accuracy: 0.958021/85 [======>.......................] - ETA: 0s - loss: 0.1297 - accuracy: 0.959431/85 [=========>....................] - ETA: 0s - loss: 0.1274 - accuracy: 0.960641/85 [=============>................] - ETA: 0s - loss: 0.1252 - accuracy: 0.961551/85 [=================>............] - ETA: 0s - loss: 0.1233 - accuracy: 0.962261/85 [====================>.........] - ETA: 0s - loss: 0.1219 - accuracy: 0.962871/85 [========================>.....] - ETA: 0s - loss: 0.1206 - accuracy: 0.963281/85 [===========================>..] - ETA: 0s - loss: 0.1198 - accuracy: 0.963585/85 [==============================] - 1s 7ms/step - loss: 0.1195 - accuracy: 0.9636 - val_loss: 0.0659 - val_accuracy: 0.9840
Epoch 5/15
 1/85 [..............................] - ETA: 0s - loss: 0.0918 - accuracy: 0.970311/85 [==>...........................] - ETA: 0s - loss: 0.1040 - accuracy: 0.968921/85 [======>.......................] - ETA: 0s - loss: 0.1025 - accuracy: 0.969231/85 [=========>....................] - ETA: 0s - loss: 0.1023 - accuracy: 0.969240/85 [=============>................] - ETA: 0s - loss: 0.1021 - accuracy: 0.969350/85 [================>.............] - ETA: 0s - loss: 0.1020 - accuracy: 0.969460/85 [====================>.........] - ETA: 0s - loss: 0.1016 - accuracy: 0.969570/85 [=======================>......] - ETA: 0s - loss: 0.1011 - accuracy: 0.969680/85 [===========================>..] - ETA: 0s - loss: 0.1007 - accuracy: 0.969785/85 [==============================] - 1s 6ms/step - loss: 0.1004 - accuracy: 0.9698 - val_loss: 0.0604 - val_accuracy: 0.9837
Epoch 6/15
 1/85 [..............................] - ETA: 0s - loss: 0.0711 - accuracy: 0.979711/85 [==>...........................] - ETA: 0s - loss: 0.0810 - accuracy: 0.975521/85 [======>.......................] - ETA: 0s - loss: 0.0843 - accuracy: 0.974231/85 [=========>....................] - ETA: 0s - loss: 0.0862 - accuracy: 0.973741/85 [=============>................] - ETA: 0s - loss: 0.0863 - accuracy: 0.973751/85 [=================>............] - ETA: 0s - loss: 0.0861 - accuracy: 0.973861/85 [====================>.........] - ETA: 0s - loss: 0.0858 - accuracy: 0.973871/85 [========================>.....] - ETA: 0s - loss: 0.0857 - accuracy: 0.973881/85 [===========================>..] - ETA: 0s - loss: 0.0857 - accuracy: 0.973885/85 [==============================] - 1s 6ms/step - loss: 0.0857 - accuracy: 0.9738 - val_loss: 0.0532 - val_accuracy: 0.9872
Epoch 7/15
 1/85 [..............................] - ETA: 0s - loss: 0.0822 - accuracy: 0.976611/85 [==>...........................] - ETA: 0s - loss: 0.0802 - accuracy: 0.978520/85 [======>.......................] - ETA: 0s - loss: 0.0819 - accuracy: 0.976929/85 [=========>....................] - ETA: 0s - loss: 0.0822 - accuracy: 0.976339/85 [============>.................] - ETA: 0s - loss: 0.0826 - accuracy: 0.976049/85 [================>.............] - ETA: 0s - loss: 0.0823 - accuracy: 0.975958/85 [===================>..........] - ETA: 0s - loss: 0.0817 - accuracy: 0.976067/85 [======================>.......] - ETA: 0s - loss: 0.0812 - accuracy: 0.976175/85 [=========================>....] - ETA: 0s - loss: 0.0809 - accuracy: 0.976185/85 [==============================] - ETA: 0s - loss: 0.0805 - accuracy: 0.976285/85 [==============================] - 1s 7ms/step - loss: 0.0805 - accuracy: 0.9762 - val_loss: 0.0504 - val_accuracy: 0.9863
Epoch 8/15
 1/85 [..............................] - ETA: 0s - loss: 0.0448 - accuracy: 0.990611/85 [==>...........................] - ETA: 0s - loss: 0.0614 - accuracy: 0.984321/85 [======>.......................] - ETA: 0s - loss: 0.0660 - accuracy: 0.982531/85 [=========>....................] - ETA: 0s - loss: 0.0683 - accuracy: 0.981641/85 [=============>................] - ETA: 0s - loss: 0.0696 - accuracy: 0.981051/85 [=================>............] - ETA: 0s - loss: 0.0701 - accuracy: 0.980761/85 [====================>.........] - ETA: 0s - loss: 0.0704 - accuracy: 0.980471/85 [========================>.....] - ETA: 0s - loss: 0.0705 - accuracy: 0.980281/85 [===========================>..] - ETA: 0s - loss: 0.0706 - accuracy: 0.980185/85 [==============================] - 1s 6ms/step - loss: 0.0706 - accuracy: 0.9800 - val_loss: 0.0460 - val_accuracy: 0.9883
Epoch 9/15
 1/85 [..............................] - ETA: 0s - loss: 0.0493 - accuracy: 0.982811/85 [==>...........................] - ETA: 0s - loss: 0.0651 - accuracy: 0.978220/85 [======>.......................] - ETA: 0s - loss: 0.0649 - accuracy: 0.979229/85 [=========>....................] - ETA: 0s - loss: 0.0652 - accuracy: 0.979638/85 [============>.................] - ETA: 0s - loss: 0.0658 - accuracy: 0.979744/85 [==============>...............] - ETA: 0s - loss: 0.0662 - accuracy: 0.979746/85 [===============>..............] - ETA: 0s - loss: 0.0663 - accuracy: 0.979749/85 [================>.............] - ETA: 0s - loss: 0.0665 - accuracy: 0.979755/85 [==================>...........] - ETA: 0s - loss: 0.0667 - accuracy: 0.979858/85 [===================>..........] - ETA: 0s - loss: 0.0668 - accuracy: 0.979862/85 [====================>.........] - ETA: 0s - loss: 0.0669 - accuracy: 0.979866/85 [======================>.......] - ETA: 0s - loss: 0.0670 - accuracy: 0.979867/85 [======================>.......] - ETA: 0s - loss: 0.0671 - accuracy: 0.979869/85 [=======================>......] - ETA: 0s - loss: 0.0671 - accuracy: 0.979776/85 [=========================>....] - ETA: 0s - loss: 0.0673 - accuracy: 0.979781/85 [===========================>..] - ETA: 0s - loss: 0.0674 - accuracy: 0.979784/85 [============================>.] - ETA: 0s - loss: 0.0674 - accuracy: 0.979785/85 [==============================] - 1s 13ms/step - loss: 0.0674 - accuracy: 0.9797 - val_loss: 0.0442 - val_accuracy: 0.9885
Epoch 10/15
 1/85 [..............................] - ETA: 0s - loss: 0.0726 - accuracy: 0.9766 6/85 [=>............................] - ETA: 0s - loss: 0.0597 - accuracy: 0.9797 9/85 [==>...........................] - ETA: 1s - loss: 0.0588 - accuracy: 0.980314/85 [===>..........................] - ETA: 1s - loss: 0.0583 - accuracy: 0.980818/85 [=====>........................] - ETA: 1s - loss: 0.0585 - accuracy: 0.981022/85 [======>.......................] - ETA: 1s - loss: 0.0587 - accuracy: 0.981127/85 [========>.....................] - ETA: 0s - loss: 0.0587 - accuracy: 0.981232/85 [==========>...................] - ETA: 0s - loss: 0.0587 - accuracy: 0.981439/85 [============>.................] - ETA: 0s - loss: 0.0589 - accuracy: 0.981447/85 [===============>..............] - ETA: 0s - loss: 0.0592 - accuracy: 0.981352/85 [=================>............] - ETA: 0s - loss: 0.0594 - accuracy: 0.981358/85 [===================>..........] - ETA: 0s - loss: 0.0596 - accuracy: 0.981262/85 [====================>.........] - ETA: 0s - loss: 0.0598 - accuracy: 0.981270/85 [=======================>......] - ETA: 0s - loss: 0.0600 - accuracy: 0.981174/85 [=========================>....] - ETA: 0s - loss: 0.0601 - accuracy: 0.981179/85 [==========================>...] - ETA: 0s - loss: 0.0603 - accuracy: 0.981185/85 [==============================] - ETA: 0s - loss: 0.0604 - accuracy: 0.981185/85 [==============================] - 1s 13ms/step - loss: 0.0604 - accuracy: 0.9810 - val_loss: 0.0441 - val_accuracy: 0.9883
Epoch 11/15
 1/85 [..............................] - ETA: 1s - loss: 0.0543 - accuracy: 0.9828 7/85 [=>............................] - ETA: 0s - loss: 0.0537 - accuracy: 0.981811/85 [==>...........................] - ETA: 0s - loss: 0.0552 - accuracy: 0.981818/85 [=====>........................] - ETA: 0s - loss: 0.0567 - accuracy: 0.981525/85 [=======>......................] - ETA: 0s - loss: 0.0574 - accuracy: 0.981332/85 [==========>...................] - ETA: 0s - loss: 0.0575 - accuracy: 0.981335/85 [===========>..................] - ETA: 0s - loss: 0.0575 - accuracy: 0.981342/85 [=============>................] - ETA: 0s - loss: 0.0573 - accuracy: 0.981548/85 [===============>..............] - ETA: 0s - loss: 0.0572 - accuracy: 0.981654/85 [==================>...........] - ETA: 0s - loss: 0.0571 - accuracy: 0.981759/85 [===================>..........] - ETA: 0s - loss: 0.0571 - accuracy: 0.981767/85 [======================>.......] - ETA: 0s - loss: 0.0572 - accuracy: 0.981773/85 [========================>.....] - ETA: 0s - loss: 0.0573 - accuracy: 0.981781/85 [===========================>..] - ETA: 0s - loss: 0.0575 - accuracy: 0.981785/85 [==============================] - 1s 10ms/step - loss: 0.0576 - accuracy: 0.9817 - val_loss: 0.0400 - val_accuracy: 0.9890
Epoch 12/15
 1/85 [..............................] - ETA: 0s - loss: 0.0308 - accuracy: 0.9937 9/85 [==>...........................] - ETA: 0s - loss: 0.0501 - accuracy: 0.985618/85 [=====>........................] - ETA: 0s - loss: 0.0540 - accuracy: 0.983928/85 [========>.....................] - ETA: 0s - loss: 0.0554 - accuracy: 0.983438/85 [============>.................] - ETA: 0s - loss: 0.0564 - accuracy: 0.983348/85 [===============>..............] - ETA: 0s - loss: 0.0568 - accuracy: 0.983254/85 [==================>...........] - ETA: 0s - loss: 0.0569 - accuracy: 0.983163/85 [=====================>........] - ETA: 0s - loss: 0.0570 - accuracy: 0.983172/85 [========================>.....] - ETA: 0s - loss: 0.0571 - accuracy: 0.983079/85 [==========================>...] - ETA: 0s - loss: 0.0571 - accuracy: 0.983085/85 [==============================] - 1s 7ms/step - loss: 0.0571 - accuracy: 0.9829 - val_loss: 0.0387 - val_accuracy: 0.9900
Epoch 13/15
 1/85 [..............................] - ETA: 0s - loss: 0.0876 - accuracy: 0.9750 9/85 [==>...........................] - ETA: 0s - loss: 0.0655 - accuracy: 0.981517/85 [=====>........................] - ETA: 0s - loss: 0.0619 - accuracy: 0.982327/85 [========>.....................] - ETA: 0s - loss: 0.0599 - accuracy: 0.982837/85 [============>.................] - ETA: 0s - loss: 0.0583 - accuracy: 0.983147/85 [===============>..............] - ETA: 0s - loss: 0.0573 - accuracy: 0.983257/85 [===================>..........] - ETA: 0s - loss: 0.0567 - accuracy: 0.983364/85 [=====================>........] - ETA: 0s - loss: 0.0564 - accuracy: 0.983372/85 [========================>.....] - ETA: 0s - loss: 0.0560 - accuracy: 0.983380/85 [===========================>..] - ETA: 0s - loss: 0.0558 - accuracy: 0.983385/85 [==============================] - 1s 7ms/step - loss: 0.0556 - accuracy: 0.9833 - val_loss: 0.0364 - val_accuracy: 0.9903
Epoch 14/15
 1/85 [..............................] - ETA: 0s - loss: 0.0750 - accuracy: 0.982811/85 [==>...........................] - ETA: 0s - loss: 0.0545 - accuracy: 0.984321/85 [======>.......................] - ETA: 0s - loss: 0.0520 - accuracy: 0.984630/85 [=========>....................] - ETA: 0s - loss: 0.0515 - accuracy: 0.984435/85 [===========>..................] - ETA: 0s - loss: 0.0515 - accuracy: 0.984344/85 [==============>...............] - ETA: 0s - loss: 0.0512 - accuracy: 0.984250/85 [================>.............] - ETA: 0s - loss: 0.0509 - accuracy: 0.984355/85 [==================>...........] - ETA: 0s - loss: 0.0507 - accuracy: 0.984360/85 [====================>.........] - ETA: 0s - loss: 0.0505 - accuracy: 0.984464/85 [=====================>........] - ETA: 0s - loss: 0.0503 - accuracy: 0.984467/85 [======================>.......] - ETA: 0s - loss: 0.0502 - accuracy: 0.984470/85 [=======================>......] - ETA: 0s - loss: 0.0502 - accuracy: 0.984474/85 [=========================>....] - ETA: 0s - loss: 0.0502 - accuracy: 0.984476/85 [=========================>....] - ETA: 0s - loss: 0.0501 - accuracy: 0.984480/85 [===========================>..] - ETA: 0s - loss: 0.0501 - accuracy: 0.984485/85 [==============================] - 1s 11ms/step - loss: 0.0502 - accuracy: 0.9844 - val_loss: 0.0362 - val_accuracy: 0.9908
Epoch 15/15
 1/85 [..............................] - ETA: 0s - loss: 0.0425 - accuracy: 0.9828 6/85 [=>............................] - ETA: 0s - loss: 0.0416 - accuracy: 0.984410/85 [==>...........................] - ETA: 0s - loss: 0.0419 - accuracy: 0.984714/85 [===>..........................] - ETA: 0s - loss: 0.0421 - accuracy: 0.985117/85 [=====>........................] - ETA: 0s - loss: 0.0422 - accuracy: 0.985323/85 [=======>......................] - ETA: 0s - loss: 0.0425 - accuracy: 0.985532/85 [==========>...................] - ETA: 0s - loss: 0.0432 - accuracy: 0.985542/85 [=============>................] - ETA: 0s - loss: 0.0440 - accuracy: 0.985552/85 [=================>............] - ETA: 0s - loss: 0.0444 - accuracy: 0.985462/85 [====================>.........] - ETA: 0s - loss: 0.0450 - accuracy: 0.985472/85 [========================>.....] - ETA: 0s - loss: 0.0455 - accuracy: 0.985382/85 [===========================>..] - ETA: 0s - loss: 0.0459 - accuracy: 0.985285/85 [==============================] - 1s 9ms/step - loss: 0.0461 - accuracy: 0.9852 - val_loss: 0.0355 - val_accuracy: 0.9907
training_time: 0:00:14.692295
Test loss: 0.030590591952204704
Test accuracy: 0.9896000027656555
