Number of devices: 5
batch_size_per_replica: 128
batch_size: 640 = 128 * 5
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
x_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
<class 'numpy.ndarray'> <class 'numpy.ndarray'>
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 26, 26, 32)        320       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 13, 13, 32)        0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 11, 11, 64)        18496     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 5, 5, 64)          0         
_________________________________________________________________
flatten (Flatten)            (None, 1600)              0         
_________________________________________________________________
dropout (Dropout)            (None, 1600)              0         
_________________________________________________________________
dense (Dense)                (None, 10)                16010     
=================================================================
Total params: 34,826
Trainable params: 34,826
Non-trainable params: 0
_________________________________________________________________
Epoch 1/15
 1/85 [..............................] - ETA: 3:40 - loss: 2.3032 - accuracy: 0.1094 2/85 [..............................] - ETA: 7s - loss: 2.2956 - accuracy: 0.1250   3/85 [>.............................] - ETA: 6s - loss: 2.2891 - accuracy: 0.1380 4/85 [>.............................] - ETA: 5s - loss: 2.2829 - accuracy: 0.1494 5/85 [>.............................] - ETA: 5s - loss: 2.2763 - accuracy: 0.1619 6/85 [=>............................] - ETA: 5s - loss: 2.2699 - accuracy: 0.1737 8/85 [=>............................] - ETA: 4s - loss: 2.2561 - accuracy: 0.195611/85 [==>...........................] - ETA: 3s - loss: 2.2335 - accuracy: 0.226321/85 [======>.......................] - ETA: 1s - loss: 2.1336 - accuracy: 0.310031/85 [=========>....................] - ETA: 1s - loss: 2.0005 - accuracy: 0.373641/85 [=============>................] - ETA: 0s - loss: 1.8660 - accuracy: 0.423851/85 [=================>............] - ETA: 0s - loss: 1.7461 - accuracy: 0.464660/85 [====================>.........] - ETA: 0s - loss: 1.6516 - accuracy: 0.495670/85 [=======================>......] - ETA: 0s - loss: 1.5600 - accuracy: 0.525179/85 [==========================>...] - ETA: 0s - loss: 1.4877 - accuracy: 0.548185/85 [==============================] - ETA: 0s - loss: 1.4441 - accuracy: 0.561885/85 [==============================] - 4s 18ms/step - loss: 1.4373 - accuracy: 0.5640 - val_loss: 0.1785 - val_accuracy: 0.9548
Epoch 2/15
 1/85 [..............................] - ETA: 0s - loss: 0.2863 - accuracy: 0.918711/85 [==>...........................] - ETA: 0s - loss: 0.2670 - accuracy: 0.920621/85 [======>.......................] - ETA: 0s - loss: 0.2606 - accuracy: 0.922631/85 [=========>....................] - ETA: 0s - loss: 0.2554 - accuracy: 0.924241/85 [=============>................] - ETA: 0s - loss: 0.2510 - accuracy: 0.925651/85 [=================>............] - ETA: 0s - loss: 0.2474 - accuracy: 0.926761/85 [====================>.........] - ETA: 0s - loss: 0.2440 - accuracy: 0.927871/85 [========================>.....] - ETA: 0s - loss: 0.2406 - accuracy: 0.928879/85 [==========================>...] - ETA: 0s - loss: 0.2381 - accuracy: 0.929685/85 [==============================] - ETA: 0s - loss: 0.2363 - accuracy: 0.930185/85 [==============================] - 1s 7ms/step - loss: 0.2360 - accuracy: 0.9302 - val_loss: 0.1067 - val_accuracy: 0.9718
Epoch 3/15
 1/85 [..............................] - ETA: 0s - loss: 0.1416 - accuracy: 0.960911/85 [==>...........................] - ETA: 0s - loss: 0.1622 - accuracy: 0.951021/85 [======>.......................] - ETA: 0s - loss: 0.1616 - accuracy: 0.951530/85 [=========>....................] - ETA: 0s - loss: 0.1591 - accuracy: 0.952439/85 [============>.................] - ETA: 0s - loss: 0.1576 - accuracy: 0.952949/85 [================>.............] - ETA: 0s - loss: 0.1567 - accuracy: 0.953259/85 [===================>..........] - ETA: 0s - loss: 0.1558 - accuracy: 0.953568/85 [=======================>......] - ETA: 0s - loss: 0.1548 - accuracy: 0.953878/85 [==========================>...] - ETA: 0s - loss: 0.1536 - accuracy: 0.954185/85 [==============================] - ETA: 0s - loss: 0.1528 - accuracy: 0.954385/85 [==============================] - 1s 7ms/step - loss: 0.1527 - accuracy: 0.9544 - val_loss: 0.0792 - val_accuracy: 0.9800
Epoch 4/15
 1/85 [..............................] - ETA: 0s - loss: 0.1316 - accuracy: 0.956311/85 [==>...........................] - ETA: 0s - loss: 0.1244 - accuracy: 0.961921/85 [======>.......................] - ETA: 0s - loss: 0.1243 - accuracy: 0.962331/85 [=========>....................] - ETA: 0s - loss: 0.1230 - accuracy: 0.962841/85 [=============>................] - ETA: 0s - loss: 0.1217 - accuracy: 0.963451/85 [=================>............] - ETA: 0s - loss: 0.1208 - accuracy: 0.963861/85 [====================>.........] - ETA: 0s - loss: 0.1202 - accuracy: 0.964071/85 [========================>.....] - ETA: 0s - loss: 0.1198 - accuracy: 0.964181/85 [===========================>..] - ETA: 0s - loss: 0.1194 - accuracy: 0.964385/85 [==============================] - 1s 7ms/step - loss: 0.1191 - accuracy: 0.9644 - val_loss: 0.0683 - val_accuracy: 0.9815
Epoch 5/15
 1/85 [..............................] - ETA: 0s - loss: 0.1301 - accuracy: 0.956311/85 [==>...........................] - ETA: 0s - loss: 0.1034 - accuracy: 0.967621/85 [======>.......................] - ETA: 0s - loss: 0.1039 - accuracy: 0.967331/85 [=========>....................] - ETA: 0s - loss: 0.1051 - accuracy: 0.967341/85 [=============>................] - ETA: 0s - loss: 0.1051 - accuracy: 0.967651/85 [=================>............] - ETA: 0s - loss: 0.1048 - accuracy: 0.967861/85 [====================>.........] - ETA: 0s - loss: 0.1046 - accuracy: 0.967971/85 [========================>.....] - ETA: 0s - loss: 0.1042 - accuracy: 0.968081/85 [===========================>..] - ETA: 0s - loss: 0.1037 - accuracy: 0.968185/85 [==============================] - 1s 7ms/step - loss: 0.1034 - accuracy: 0.9682 - val_loss: 0.0592 - val_accuracy: 0.9848
Epoch 6/15
 1/85 [..............................] - ETA: 0s - loss: 0.0835 - accuracy: 0.967211/85 [==>...........................] - ETA: 0s - loss: 0.0863 - accuracy: 0.971721/85 [======>.......................] - ETA: 0s - loss: 0.0887 - accuracy: 0.972431/85 [=========>....................] - ETA: 0s - loss: 0.0890 - accuracy: 0.972841/85 [=============>................] - ETA: 0s - loss: 0.0885 - accuracy: 0.973151/85 [=================>............] - ETA: 0s - loss: 0.0880 - accuracy: 0.973361/85 [====================>.........] - ETA: 0s - loss: 0.0877 - accuracy: 0.973471/85 [========================>.....] - ETA: 0s - loss: 0.0876 - accuracy: 0.973581/85 [===========================>..] - ETA: 0s - loss: 0.0874 - accuracy: 0.973585/85 [==============================] - 1s 7ms/step - loss: 0.0873 - accuracy: 0.9735 - val_loss: 0.0528 - val_accuracy: 0.9863
Epoch 7/15
 1/85 [..............................] - ETA: 0s - loss: 0.0540 - accuracy: 0.981211/85 [==>...........................] - ETA: 0s - loss: 0.0749 - accuracy: 0.975521/85 [======>.......................] - ETA: 0s - loss: 0.0754 - accuracy: 0.976231/85 [=========>....................] - ETA: 0s - loss: 0.0757 - accuracy: 0.976441/85 [=============>................] - ETA: 0s - loss: 0.0760 - accuracy: 0.976547/85 [===============>..............] - ETA: 0s - loss: 0.0760 - accuracy: 0.976657/85 [===================>..........] - ETA: 0s - loss: 0.0762 - accuracy: 0.976666/85 [======================>.......] - ETA: 0s - loss: 0.0764 - accuracy: 0.976576/85 [=========================>....] - ETA: 0s - loss: 0.0765 - accuracy: 0.976585/85 [==============================] - ETA: 0s - loss: 0.0766 - accuracy: 0.976585/85 [==============================] - 1s 7ms/step - loss: 0.0767 - accuracy: 0.9765 - val_loss: 0.0498 - val_accuracy: 0.9883
Epoch 8/15
 1/85 [..............................] - ETA: 0s - loss: 0.0741 - accuracy: 0.976611/85 [==>...........................] - ETA: 0s - loss: 0.0727 - accuracy: 0.976920/85 [======>.......................] - ETA: 0s - loss: 0.0720 - accuracy: 0.977430/85 [=========>....................] - ETA: 0s - loss: 0.0724 - accuracy: 0.977340/85 [=============>................] - ETA: 0s - loss: 0.0728 - accuracy: 0.977149/85 [================>.............] - ETA: 0s - loss: 0.0733 - accuracy: 0.977057/85 [===================>..........] - ETA: 0s - loss: 0.0734 - accuracy: 0.977064/85 [=====================>........] - ETA: 0s - loss: 0.0734 - accuracy: 0.977072/85 [========================>.....] - ETA: 0s - loss: 0.0733 - accuracy: 0.977076/85 [=========================>....] - ETA: 0s - loss: 0.0732 - accuracy: 0.977184/85 [============================>.] - ETA: 0s - loss: 0.0731 - accuracy: 0.977185/85 [==============================] - 1s 8ms/step - loss: 0.0731 - accuracy: 0.9771 - val_loss: 0.0465 - val_accuracy: 0.9880
Epoch 9/15
 1/85 [..............................] - ETA: 2s - loss: 0.0481 - accuracy: 0.9875 3/85 [>.............................] - ETA: 2s - loss: 0.0591 - accuracy: 0.9833 7/85 [=>............................] - ETA: 1s - loss: 0.0639 - accuracy: 0.981210/85 [==>...........................] - ETA: 1s - loss: 0.0655 - accuracy: 0.980214/85 [===>..........................] - ETA: 1s - loss: 0.0661 - accuracy: 0.979716/85 [====>.........................] - ETA: 1s - loss: 0.0661 - accuracy: 0.979620/85 [======>.......................] - ETA: 1s - loss: 0.0667 - accuracy: 0.979422/85 [======>.......................] - ETA: 1s - loss: 0.0671 - accuracy: 0.979323/85 [=======>......................] - ETA: 1s - loss: 0.0673 - accuracy: 0.979226/85 [========>.....................] - ETA: 1s - loss: 0.0678 - accuracy: 0.979131/85 [=========>....................] - ETA: 1s - loss: 0.0684 - accuracy: 0.979035/85 [===========>..................] - ETA: 1s - loss: 0.0686 - accuracy: 0.978936/85 [===========>..................] - ETA: 1s - loss: 0.0686 - accuracy: 0.978939/85 [============>.................] - ETA: 1s - loss: 0.0687 - accuracy: 0.978942/85 [=============>................] - ETA: 0s - loss: 0.0688 - accuracy: 0.978945/85 [==============>...............] - ETA: 0s - loss: 0.0688 - accuracy: 0.978849/85 [================>.............] - ETA: 0s - loss: 0.0688 - accuracy: 0.978953/85 [=================>............] - ETA: 0s - loss: 0.0687 - accuracy: 0.978957/85 [===================>..........] - ETA: 0s - loss: 0.0687 - accuracy: 0.978961/85 [====================>.........] - ETA: 0s - loss: 0.0687 - accuracy: 0.978963/85 [=====================>........] - ETA: 0s - loss: 0.0686 - accuracy: 0.978969/85 [=======================>......] - ETA: 0s - loss: 0.0686 - accuracy: 0.978979/85 [==========================>...] - ETA: 0s - loss: 0.0684 - accuracy: 0.978985/85 [==============================] - 2s 19ms/step - loss: 0.0683 - accuracy: 0.9789 - val_loss: 0.0453 - val_accuracy: 0.9883
Epoch 10/15
 1/85 [..............................] - ETA: 1s - loss: 0.0526 - accuracy: 0.985910/85 [==>...........................] - ETA: 0s - loss: 0.0641 - accuracy: 0.979820/85 [======>.......................] - ETA: 0s - loss: 0.0633 - accuracy: 0.980230/85 [=========>....................] - ETA: 0s - loss: 0.0628 - accuracy: 0.980640/85 [=============>................] - ETA: 0s - loss: 0.0623 - accuracy: 0.980950/85 [================>.............] - ETA: 0s - loss: 0.0623 - accuracy: 0.980957/85 [===================>..........] - ETA: 0s - loss: 0.0624 - accuracy: 0.980963/85 [=====================>........] - ETA: 0s - loss: 0.0624 - accuracy: 0.980972/85 [========================>.....] - ETA: 0s - loss: 0.0624 - accuracy: 0.980981/85 [===========================>..] - ETA: 0s - loss: 0.0624 - accuracy: 0.980985/85 [==============================] - 1s 8ms/step - loss: 0.0623 - accuracy: 0.9809 - val_loss: 0.0419 - val_accuracy: 0.9895
Epoch 11/15
 1/85 [..............................] - ETA: 0s - loss: 0.0530 - accuracy: 0.985911/85 [==>...........................] - ETA: 0s - loss: 0.0626 - accuracy: 0.980621/85 [======>.......................] - ETA: 0s - loss: 0.0615 - accuracy: 0.981031/85 [=========>....................] - ETA: 0s - loss: 0.0612 - accuracy: 0.981140/85 [=============>................] - ETA: 0s - loss: 0.0610 - accuracy: 0.981250/85 [================>.............] - ETA: 0s - loss: 0.0607 - accuracy: 0.981360/85 [====================>.........] - ETA: 0s - loss: 0.0607 - accuracy: 0.981464/85 [=====================>........] - ETA: 0s - loss: 0.0607 - accuracy: 0.981471/85 [========================>.....] - ETA: 0s - loss: 0.0606 - accuracy: 0.981576/85 [=========================>....] - ETA: 0s - loss: 0.0606 - accuracy: 0.981584/85 [============================>.] - ETA: 0s - loss: 0.0605 - accuracy: 0.981585/85 [==============================] - 1s 8ms/step - loss: 0.0605 - accuracy: 0.9815 - val_loss: 0.0409 - val_accuracy: 0.9890
Epoch 12/15
 1/85 [..............................] - ETA: 0s - loss: 0.0699 - accuracy: 0.9766 9/85 [==>...........................] - ETA: 0s - loss: 0.0617 - accuracy: 0.981017/85 [=====>........................] - ETA: 0s - loss: 0.0621 - accuracy: 0.981326/85 [========>.....................] - ETA: 0s - loss: 0.0616 - accuracy: 0.981534/85 [===========>..................] - ETA: 0s - loss: 0.0608 - accuracy: 0.981838/85 [============>.................] - ETA: 0s - loss: 0.0606 - accuracy: 0.981946/85 [===============>..............] - ETA: 0s - loss: 0.0603 - accuracy: 0.981956/85 [==================>...........] - ETA: 0s - loss: 0.0599 - accuracy: 0.982066/85 [======================>.......] - ETA: 0s - loss: 0.0596 - accuracy: 0.982076/85 [=========================>....] - ETA: 0s - loss: 0.0593 - accuracy: 0.982183/85 [============================>.] - ETA: 0s - loss: 0.0591 - accuracy: 0.982185/85 [==============================] - 1s 8ms/step - loss: 0.0590 - accuracy: 0.9822 - val_loss: 0.0408 - val_accuracy: 0.9893
Epoch 13/15
 1/85 [..............................] - ETA: 0s - loss: 0.0376 - accuracy: 0.992210/85 [==>...........................] - ETA: 0s - loss: 0.0519 - accuracy: 0.985219/85 [=====>........................] - ETA: 0s - loss: 0.0512 - accuracy: 0.985129/85 [=========>....................] - ETA: 0s - loss: 0.0516 - accuracy: 0.984736/85 [===========>..................] - ETA: 0s - loss: 0.0521 - accuracy: 0.984546/85 [===============>..............] - ETA: 0s - loss: 0.0525 - accuracy: 0.984255/85 [==================>...........] - ETA: 0s - loss: 0.0529 - accuracy: 0.984165/85 [=====================>........] - ETA: 0s - loss: 0.0532 - accuracy: 0.984075/85 [=========================>....] - ETA: 0s - loss: 0.0535 - accuracy: 0.983985/85 [==============================] - ETA: 0s - loss: 0.0536 - accuracy: 0.983885/85 [==============================] - 1s 7ms/step - loss: 0.0536 - accuracy: 0.9838 - val_loss: 0.0387 - val_accuracy: 0.9902
Epoch 14/15
 1/85 [..............................] - ETA: 0s - loss: 0.0376 - accuracy: 0.990610/85 [==>...........................] - ETA: 0s - loss: 0.0522 - accuracy: 0.982520/85 [======>.......................] - ETA: 0s - loss: 0.0544 - accuracy: 0.982328/85 [========>.....................] - ETA: 0s - loss: 0.0541 - accuracy: 0.982537/85 [============>.................] - ETA: 0s - loss: 0.0538 - accuracy: 0.982743/85 [==============>...............] - ETA: 0s - loss: 0.0536 - accuracy: 0.982847/85 [===============>..............] - ETA: 0s - loss: 0.0535 - accuracy: 0.982951/85 [=================>............] - ETA: 0s - loss: 0.0534 - accuracy: 0.983053/85 [=================>............] - ETA: 0s - loss: 0.0533 - accuracy: 0.983059/85 [===================>..........] - ETA: 0s - loss: 0.0532 - accuracy: 0.983163/85 [=====================>........] - ETA: 0s - loss: 0.0531 - accuracy: 0.983171/85 [========================>.....] - ETA: 0s - loss: 0.0530 - accuracy: 0.983273/85 [========================>.....] - ETA: 0s - loss: 0.0530 - accuracy: 0.983281/85 [===========================>..] - ETA: 0s - loss: 0.0529 - accuracy: 0.983285/85 [==============================] - 1s 12ms/step - loss: 0.0528 - accuracy: 0.9833 - val_loss: 0.0383 - val_accuracy: 0.9888
Epoch 15/15
 1/85 [..............................] - ETA: 0s - loss: 0.0542 - accuracy: 0.9844 9/85 [==>...........................] - ETA: 0s - loss: 0.0432 - accuracy: 0.987215/85 [====>.........................] - ETA: 0s - loss: 0.0439 - accuracy: 0.986221/85 [======>.......................] - ETA: 0s - loss: 0.0447 - accuracy: 0.985831/85 [=========>....................] - ETA: 0s - loss: 0.0449 - accuracy: 0.985841/85 [=============>................] - ETA: 0s - loss: 0.0453 - accuracy: 0.985751/85 [=================>............] - ETA: 0s - loss: 0.0457 - accuracy: 0.985661/85 [====================>.........] - ETA: 0s - loss: 0.0460 - accuracy: 0.985571/85 [========================>.....] - ETA: 0s - loss: 0.0464 - accuracy: 0.985381/85 [===========================>..] - ETA: 0s - loss: 0.0467 - accuracy: 0.985285/85 [==============================] - 1s 7ms/step - loss: 0.0468 - accuracy: 0.9852 - val_loss: 0.0369 - val_accuracy: 0.9903
training_time: 0:00:14.284817
Test loss: 0.03195389360189438
Test accuracy: 0.9894000291824341
