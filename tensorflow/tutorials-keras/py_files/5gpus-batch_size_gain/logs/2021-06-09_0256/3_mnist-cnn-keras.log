Number of devices: 5
batch_size_per_replica: 128
batch_size: 640 = 128 * 5
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
x_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
<class 'numpy.ndarray'> <class 'numpy.ndarray'>
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 26, 26, 32)        320       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 13, 13, 32)        0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 11, 11, 64)        18496     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 5, 5, 64)          0         
_________________________________________________________________
flatten (Flatten)            (None, 1600)              0         
_________________________________________________________________
dropout (Dropout)            (None, 1600)              0         
_________________________________________________________________
dense (Dense)                (None, 10)                16010     
=================================================================
Total params: 34,826
Trainable params: 34,826
Non-trainable params: 0
_________________________________________________________________
Epoch 1/15
 1/85 [..............................] - ETA: 3:43 - loss: 2.2945 - accuracy: 0.1109 2/85 [..............................] - ETA: 7s - loss: 2.2872 - accuracy: 0.1195   4/85 [>.............................] - ETA: 4s - loss: 2.2717 - accuracy: 0.1408 6/85 [=>............................] - ETA: 4s - loss: 2.2554 - accuracy: 0.1613 8/85 [=>............................] - ETA: 3s - loss: 2.2383 - accuracy: 0.182811/85 [==>...........................] - ETA: 2s - loss: 2.2094 - accuracy: 0.215321/85 [======>.......................] - ETA: 1s - loss: 2.0893 - accuracy: 0.309731/85 [=========>....................] - ETA: 0s - loss: 1.9483 - accuracy: 0.377141/85 [=============>................] - ETA: 0s - loss: 1.8152 - accuracy: 0.428151/85 [=================>............] - ETA: 0s - loss: 1.6994 - accuracy: 0.468661/85 [====================>.........] - ETA: 0s - loss: 1.5995 - accuracy: 0.502271/85 [========================>.....] - ETA: 0s - loss: 1.5129 - accuracy: 0.530781/85 [===========================>..] - ETA: 0s - loss: 1.4375 - accuracy: 0.555285/85 [==============================] - ETA: 0s - loss: 1.4099 - accuracy: 0.564285/85 [==============================] - 4s 16ms/step - loss: 1.4033 - accuracy: 0.5663 - val_loss: 0.1813 - val_accuracy: 0.9530
Epoch 2/15
 1/85 [..............................] - ETA: 0s - loss: 0.2521 - accuracy: 0.915611/85 [==>...........................] - ETA: 0s - loss: 0.2680 - accuracy: 0.916821/85 [======>.......................] - ETA: 0s - loss: 0.2664 - accuracy: 0.918231/85 [=========>....................] - ETA: 0s - loss: 0.2631 - accuracy: 0.919241/85 [=============>................] - ETA: 0s - loss: 0.2594 - accuracy: 0.920251/85 [=================>............] - ETA: 0s - loss: 0.2553 - accuracy: 0.921561/85 [====================>.........] - ETA: 0s - loss: 0.2512 - accuracy: 0.923071/85 [========================>.....] - ETA: 0s - loss: 0.2471 - accuracy: 0.924481/85 [===========================>..] - ETA: 0s - loss: 0.2432 - accuracy: 0.925785/85 [==============================] - ETA: 0s - loss: 0.2417 - accuracy: 0.926285/85 [==============================] - 1s 7ms/step - loss: 0.2413 - accuracy: 0.9263 - val_loss: 0.0973 - val_accuracy: 0.9748
Epoch 3/15
 1/85 [..............................] - ETA: 0s - loss: 0.1868 - accuracy: 0.939111/85 [==>...........................] - ETA: 0s - loss: 0.1675 - accuracy: 0.951521/85 [======>.......................] - ETA: 0s - loss: 0.1644 - accuracy: 0.951831/85 [=========>....................] - ETA: 0s - loss: 0.1628 - accuracy: 0.951941/85 [=============>................] - ETA: 0s - loss: 0.1604 - accuracy: 0.952450/85 [================>.............] - ETA: 0s - loss: 0.1586 - accuracy: 0.952860/85 [====================>.........] - ETA: 0s - loss: 0.1567 - accuracy: 0.953370/85 [=======================>......] - ETA: 0s - loss: 0.1551 - accuracy: 0.953779/85 [==========================>...] - ETA: 0s - loss: 0.1536 - accuracy: 0.954185/85 [==============================] - ETA: 0s - loss: 0.1527 - accuracy: 0.954385/85 [==============================] - 1s 8ms/step - loss: 0.1525 - accuracy: 0.9543 - val_loss: 0.0725 - val_accuracy: 0.9807
Epoch 4/15
 1/85 [..............................] - ETA: 0s - loss: 0.1080 - accuracy: 0.9672 9/85 [==>...........................] - ETA: 0s - loss: 0.1231 - accuracy: 0.963418/85 [=====>........................] - ETA: 0s - loss: 0.1209 - accuracy: 0.963727/85 [========>.....................] - ETA: 0s - loss: 0.1193 - accuracy: 0.964137/85 [============>.................] - ETA: 0s - loss: 0.1180 - accuracy: 0.964644/85 [==============>...............] - ETA: 0s - loss: 0.1173 - accuracy: 0.964853/85 [=================>............] - ETA: 0s - loss: 0.1165 - accuracy: 0.964955/85 [==================>...........] - ETA: 0s - loss: 0.1164 - accuracy: 0.965057/85 [===================>..........] - ETA: 0s - loss: 0.1162 - accuracy: 0.965062/85 [====================>.........] - ETA: 0s - loss: 0.1158 - accuracy: 0.965169/85 [=======================>......] - ETA: 0s - loss: 0.1152 - accuracy: 0.965373/85 [========================>.....] - ETA: 0s - loss: 0.1150 - accuracy: 0.965377/85 [==========================>...] - ETA: 0s - loss: 0.1147 - accuracy: 0.965481/85 [===========================>..] - ETA: 0s - loss: 0.1144 - accuracy: 0.965583/85 [============================>.] - ETA: 0s - loss: 0.1142 - accuracy: 0.965585/85 [==============================] - 1s 13ms/step - loss: 0.1140 - accuracy: 0.9656 - val_loss: 0.0606 - val_accuracy: 0.9838
Epoch 5/15
 1/85 [..............................] - ETA: 0s - loss: 0.0785 - accuracy: 0.9750 2/85 [..............................] - ETA: 4s - loss: 0.0805 - accuracy: 0.9754 7/85 [=>............................] - ETA: 1s - loss: 0.0917 - accuracy: 0.973210/85 [==>...........................] - ETA: 1s - loss: 0.0933 - accuracy: 0.972612/85 [===>..........................] - ETA: 1s - loss: 0.0941 - accuracy: 0.972317/85 [=====>........................] - ETA: 1s - loss: 0.0950 - accuracy: 0.971821/85 [======>.......................] - ETA: 1s - loss: 0.0954 - accuracy: 0.971425/85 [=======>......................] - ETA: 1s - loss: 0.0957 - accuracy: 0.971234/85 [===========>..................] - ETA: 0s - loss: 0.0962 - accuracy: 0.971042/85 [=============>................] - ETA: 0s - loss: 0.0960 - accuracy: 0.971051/85 [=================>............] - ETA: 0s - loss: 0.0959 - accuracy: 0.971056/85 [==================>...........] - ETA: 0s - loss: 0.0957 - accuracy: 0.971061/85 [====================>.........] - ETA: 0s - loss: 0.0956 - accuracy: 0.971065/85 [=====================>........] - ETA: 0s - loss: 0.0955 - accuracy: 0.971071/85 [========================>.....] - ETA: 0s - loss: 0.0954 - accuracy: 0.971076/85 [=========================>....] - ETA: 0s - loss: 0.0953 - accuracy: 0.971185/85 [==============================] - ETA: 0s - loss: 0.0950 - accuracy: 0.971185/85 [==============================] - 1s 12ms/step - loss: 0.0950 - accuracy: 0.9711 - val_loss: 0.0526 - val_accuracy: 0.9855
Epoch 6/15
 1/85 [..............................] - ETA: 0s - loss: 0.0848 - accuracy: 0.9797 7/85 [=>............................] - ETA: 0s - loss: 0.0871 - accuracy: 0.976510/85 [==>...........................] - ETA: 0s - loss: 0.0879 - accuracy: 0.975915/85 [====>.........................] - ETA: 0s - loss: 0.0879 - accuracy: 0.975520/85 [======>.......................] - ETA: 0s - loss: 0.0874 - accuracy: 0.975324/85 [=======>......................] - ETA: 0s - loss: 0.0875 - accuracy: 0.975031/85 [=========>....................] - ETA: 0s - loss: 0.0875 - accuracy: 0.974639/85 [============>.................] - ETA: 0s - loss: 0.0876 - accuracy: 0.974444/85 [==============>...............] - ETA: 0s - loss: 0.0877 - accuracy: 0.974450/85 [================>.............] - ETA: 0s - loss: 0.0877 - accuracy: 0.974360/85 [====================>.........] - ETA: 0s - loss: 0.0876 - accuracy: 0.974366/85 [======================>.......] - ETA: 0s - loss: 0.0874 - accuracy: 0.974373/85 [========================>.....] - ETA: 0s - loss: 0.0872 - accuracy: 0.974379/85 [==========================>...] - ETA: 0s - loss: 0.0870 - accuracy: 0.974385/85 [==============================] - ETA: 0s - loss: 0.0868 - accuracy: 0.974385/85 [==============================] - 1s 11ms/step - loss: 0.0868 - accuracy: 0.9743 - val_loss: 0.0497 - val_accuracy: 0.9870
Epoch 7/15
 1/85 [..............................] - ETA: 0s - loss: 0.0679 - accuracy: 0.9781 9/85 [==>...........................] - ETA: 0s - loss: 0.0699 - accuracy: 0.977118/85 [=====>........................] - ETA: 0s - loss: 0.0727 - accuracy: 0.976628/85 [========>.....................] - ETA: 0s - loss: 0.0747 - accuracy: 0.976635/85 [===========>..................] - ETA: 0s - loss: 0.0749 - accuracy: 0.976841/85 [=============>................] - ETA: 0s - loss: 0.0749 - accuracy: 0.976945/85 [==============>...............] - ETA: 0s - loss: 0.0749 - accuracy: 0.977053/85 [=================>............] - ETA: 0s - loss: 0.0748 - accuracy: 0.977157/85 [===================>..........] - ETA: 0s - loss: 0.0749 - accuracy: 0.977266/85 [======================>.......] - ETA: 0s - loss: 0.0748 - accuracy: 0.977375/85 [=========================>....] - ETA: 0s - loss: 0.0748 - accuracy: 0.977382/85 [===========================>..] - ETA: 0s - loss: 0.0748 - accuracy: 0.977485/85 [==============================] - 1s 9ms/step - loss: 0.0748 - accuracy: 0.9774 - val_loss: 0.0463 - val_accuracy: 0.9880
Epoch 8/15
 1/85 [..............................] - ETA: 0s - loss: 0.0476 - accuracy: 0.9906 9/85 [==>...........................] - ETA: 0s - loss: 0.0721 - accuracy: 0.978616/85 [====>.........................] - ETA: 0s - loss: 0.0742 - accuracy: 0.977320/85 [======>.......................] - ETA: 0s - loss: 0.0749 - accuracy: 0.977026/85 [========>.....................] - ETA: 0s - loss: 0.0753 - accuracy: 0.977030/85 [=========>....................] - ETA: 0s - loss: 0.0754 - accuracy: 0.977035/85 [===========>..................] - ETA: 0s - loss: 0.0753 - accuracy: 0.977138/85 [============>.................] - ETA: 0s - loss: 0.0751 - accuracy: 0.977244/85 [==============>...............] - ETA: 0s - loss: 0.0748 - accuracy: 0.977349/85 [================>.............] - ETA: 0s - loss: 0.0745 - accuracy: 0.977454/85 [==================>...........] - ETA: 0s - loss: 0.0742 - accuracy: 0.977661/85 [====================>.........] - ETA: 0s - loss: 0.0739 - accuracy: 0.977771/85 [========================>.....] - ETA: 0s - loss: 0.0734 - accuracy: 0.977880/85 [===========================>..] - ETA: 0s - loss: 0.0730 - accuracy: 0.977985/85 [==============================] - 1s 10ms/step - loss: 0.0727 - accuracy: 0.9779 - val_loss: 0.0421 - val_accuracy: 0.9887
Epoch 9/15
 1/85 [..............................] - ETA: 0s - loss: 0.0569 - accuracy: 0.989111/85 [==>...........................] - ETA: 0s - loss: 0.0650 - accuracy: 0.983121/85 [======>.......................] - ETA: 0s - loss: 0.0671 - accuracy: 0.981731/85 [=========>....................] - ETA: 0s - loss: 0.0674 - accuracy: 0.981241/85 [=============>................] - ETA: 0s - loss: 0.0671 - accuracy: 0.981150/85 [================>.............] - ETA: 0s - loss: 0.0667 - accuracy: 0.981060/85 [====================>.........] - ETA: 0s - loss: 0.0664 - accuracy: 0.980970/85 [=======================>......] - ETA: 0s - loss: 0.0662 - accuracy: 0.980880/85 [===========================>..] - ETA: 0s - loss: 0.0662 - accuracy: 0.980785/85 [==============================] - 1s 7ms/step - loss: 0.0661 - accuracy: 0.9806 - val_loss: 0.0397 - val_accuracy: 0.9893
Epoch 10/15
 1/85 [..............................] - ETA: 0s - loss: 0.0651 - accuracy: 0.979711/85 [==>...........................] - ETA: 0s - loss: 0.0562 - accuracy: 0.983420/85 [======>.......................] - ETA: 0s - loss: 0.0567 - accuracy: 0.982527/85 [========>.....................] - ETA: 0s - loss: 0.0573 - accuracy: 0.982237/85 [============>.................] - ETA: 0s - loss: 0.0579 - accuracy: 0.982047/85 [===============>..............] - ETA: 0s - loss: 0.0583 - accuracy: 0.982057/85 [===================>..........] - ETA: 0s - loss: 0.0585 - accuracy: 0.981964/85 [=====================>........] - ETA: 0s - loss: 0.0587 - accuracy: 0.981974/85 [=========================>....] - ETA: 0s - loss: 0.0588 - accuracy: 0.981880/85 [===========================>..] - ETA: 0s - loss: 0.0588 - accuracy: 0.981884/85 [============================>.] - ETA: 0s - loss: 0.0588 - accuracy: 0.981885/85 [==============================] - 1s 8ms/step - loss: 0.0588 - accuracy: 0.9818 - val_loss: 0.0379 - val_accuracy: 0.9887
Epoch 11/15
 1/85 [..............................] - ETA: 0s - loss: 0.0437 - accuracy: 0.985910/85 [==>...........................] - ETA: 0s - loss: 0.0593 - accuracy: 0.982619/85 [=====>........................] - ETA: 0s - loss: 0.0604 - accuracy: 0.981928/85 [========>.....................] - ETA: 0s - loss: 0.0600 - accuracy: 0.981835/85 [===========>..................] - ETA: 0s - loss: 0.0595 - accuracy: 0.982043/85 [==============>...............] - ETA: 0s - loss: 0.0590 - accuracy: 0.982151/85 [=================>............] - ETA: 0s - loss: 0.0587 - accuracy: 0.982258/85 [===================>..........] - ETA: 0s - loss: 0.0584 - accuracy: 0.982262/85 [====================>.........] - ETA: 0s - loss: 0.0583 - accuracy: 0.982364/85 [=====================>........] - ETA: 0s - loss: 0.0582 - accuracy: 0.982372/85 [========================>.....] - ETA: 0s - loss: 0.0581 - accuracy: 0.982378/85 [==========================>...] - ETA: 0s - loss: 0.0580 - accuracy: 0.982385/85 [==============================] - ETA: 0s - loss: 0.0578 - accuracy: 0.982485/85 [==============================] - 1s 10ms/step - loss: 0.0578 - accuracy: 0.9824 - val_loss: 0.0365 - val_accuracy: 0.9903
Epoch 12/15
 1/85 [..............................] - ETA: 0s - loss: 0.0335 - accuracy: 0.9906 5/85 [>.............................] - ETA: 1s - loss: 0.0488 - accuracy: 0.9873 8/85 [=>............................] - ETA: 1s - loss: 0.0485 - accuracy: 0.987115/85 [====>.........................] - ETA: 0s - loss: 0.0495 - accuracy: 0.986624/85 [=======>......................] - ETA: 0s - loss: 0.0496 - accuracy: 0.986229/85 [=========>....................] - ETA: 0s - loss: 0.0496 - accuracy: 0.986136/85 [===========>..................] - ETA: 0s - loss: 0.0497 - accuracy: 0.985942/85 [=============>................] - ETA: 0s - loss: 0.0498 - accuracy: 0.985851/85 [=================>............] - ETA: 0s - loss: 0.0498 - accuracy: 0.985759/85 [===================>..........] - ETA: 0s - loss: 0.0496 - accuracy: 0.985769/85 [=======================>......] - ETA: 0s - loss: 0.0496 - accuracy: 0.985679/85 [==========================>...] - ETA: 0s - loss: 0.0498 - accuracy: 0.985585/85 [==============================] - 1s 8ms/step - loss: 0.0500 - accuracy: 0.9854 - val_loss: 0.0378 - val_accuracy: 0.9902
Epoch 13/15
 1/85 [..............................] - ETA: 0s - loss: 0.0639 - accuracy: 0.978110/85 [==>...........................] - ETA: 0s - loss: 0.0553 - accuracy: 0.981020/85 [======>.......................] - ETA: 0s - loss: 0.0549 - accuracy: 0.981930/85 [=========>....................] - ETA: 0s - loss: 0.0543 - accuracy: 0.982540/85 [=============>................] - ETA: 0s - loss: 0.0531 - accuracy: 0.983050/85 [================>.............] - ETA: 0s - loss: 0.0523 - accuracy: 0.983358/85 [===================>..........] - ETA: 0s - loss: 0.0519 - accuracy: 0.983568/85 [=======================>......] - ETA: 0s - loss: 0.0515 - accuracy: 0.983677/85 [==========================>...] - ETA: 0s - loss: 0.0512 - accuracy: 0.983885/85 [==============================] - ETA: 0s - loss: 0.0511 - accuracy: 0.983985/85 [==============================] - 1s 7ms/step - loss: 0.0511 - accuracy: 0.9839 - val_loss: 0.0347 - val_accuracy: 0.9908
Epoch 14/15
 1/85 [..............................] - ETA: 0s - loss: 0.0437 - accuracy: 0.989111/85 [==>...........................] - ETA: 0s - loss: 0.0481 - accuracy: 0.986219/85 [=====>........................] - ETA: 0s - loss: 0.0475 - accuracy: 0.986229/85 [=========>....................] - ETA: 0s - loss: 0.0476 - accuracy: 0.986139/85 [============>.................] - ETA: 0s - loss: 0.0478 - accuracy: 0.986046/85 [===============>..............] - ETA: 0s - loss: 0.0478 - accuracy: 0.985956/85 [==================>...........] - ETA: 0s - loss: 0.0479 - accuracy: 0.985865/85 [=====================>........] - ETA: 0s - loss: 0.0481 - accuracy: 0.985774/85 [=========================>....] - ETA: 0s - loss: 0.0482 - accuracy: 0.985784/85 [============================>.] - ETA: 0s - loss: 0.0483 - accuracy: 0.985685/85 [==============================] - 1s 7ms/step - loss: 0.0483 - accuracy: 0.9856 - val_loss: 0.0323 - val_accuracy: 0.9915
Epoch 15/15
 1/85 [..............................] - ETA: 0s - loss: 0.0477 - accuracy: 0.9812 8/85 [=>............................] - ETA: 0s - loss: 0.0496 - accuracy: 0.983215/85 [====>.........................] - ETA: 0s - loss: 0.0492 - accuracy: 0.984124/85 [=======>......................] - ETA: 0s - loss: 0.0479 - accuracy: 0.984834/85 [===========>..................] - ETA: 0s - loss: 0.0478 - accuracy: 0.985144/85 [==============>...............] - ETA: 0s - loss: 0.0479 - accuracy: 0.985154/85 [==================>...........] - ETA: 0s - loss: 0.0478 - accuracy: 0.985264/85 [=====================>........] - ETA: 0s - loss: 0.0476 - accuracy: 0.985374/85 [=========================>....] - ETA: 0s - loss: 0.0476 - accuracy: 0.985484/85 [============================>.] - ETA: 0s - loss: 0.0474 - accuracy: 0.985485/85 [==============================] - 1s 7ms/step - loss: 0.0474 - accuracy: 0.9854 - val_loss: 0.0339 - val_accuracy: 0.9905
training_time: 0:00:14.870480
Test loss: 0.02944248728454113
Test accuracy: 0.9902999997138977
