Number of devices: 5
batch_size_per_replica: 128
batch_size: 640 = 128 * 5
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
x_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
<class 'numpy.ndarray'> <class 'numpy.ndarray'>
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 26, 26, 32)        320       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 13, 13, 32)        0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 11, 11, 64)        18496     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 5, 5, 64)          0         
_________________________________________________________________
flatten (Flatten)            (None, 1600)              0         
_________________________________________________________________
dropout (Dropout)            (None, 1600)              0         
_________________________________________________________________
dense (Dense)                (None, 10)                16010     
=================================================================
Total params: 34,826
Trainable params: 34,826
Non-trainable params: 0
_________________________________________________________________
Epoch 1/15
 1/85 [..............................] - ETA: 3:39 - loss: 2.3097 - accuracy: 0.0953 2/85 [..............................] - ETA: 7s - loss: 2.3010 - accuracy: 0.1031   3/85 [>.............................] - ETA: 7s - loss: 2.2918 - accuracy: 0.1156 4/85 [>.............................] - ETA: 7s - loss: 2.2826 - accuracy: 0.1289 5/85 [>.............................] - ETA: 7s - loss: 2.2737 - accuracy: 0.1428 6/85 [=>............................] - ETA: 6s - loss: 2.2648 - accuracy: 0.1564 7/85 [=>............................] - ETA: 6s - loss: 2.2557 - accuracy: 0.1697 8/85 [=>............................] - ETA: 6s - loss: 2.2459 - accuracy: 0.1833 9/85 [==>...........................] - ETA: 6s - loss: 2.2361 - accuracy: 0.195910/85 [==>...........................] - ETA: 5s - loss: 2.2260 - accuracy: 0.208011/85 [==>...........................] - ETA: 5s - loss: 2.2156 - accuracy: 0.219812/85 [===>..........................] - ETA: 5s - loss: 2.2048 - accuracy: 0.231213/85 [===>..........................] - ETA: 5s - loss: 2.1936 - accuracy: 0.242514/85 [===>..........................] - ETA: 5s - loss: 2.1821 - accuracy: 0.253315/85 [====>.........................] - ETA: 5s - loss: 2.1702 - accuracy: 0.263516/85 [====>.........................] - ETA: 5s - loss: 2.1579 - accuracy: 0.273519/85 [=====>........................] - ETA: 4s - loss: 2.1189 - accuracy: 0.301029/85 [=========>....................] - ETA: 2s - loss: 1.9747 - accuracy: 0.374139/85 [============>.................] - ETA: 1s - loss: 1.8350 - accuracy: 0.428349/85 [================>.............] - ETA: 0s - loss: 1.7120 - accuracy: 0.471359/85 [===================>..........] - ETA: 0s - loss: 1.6058 - accuracy: 0.506769/85 [=======================>......] - ETA: 0s - loss: 1.5142 - accuracy: 0.536679/85 [==========================>...] - ETA: 0s - loss: 1.4347 - accuracy: 0.562285/85 [==============================] - ETA: 0s - loss: 1.3919 - accuracy: 0.575885/85 [==============================] - 5s 25ms/step - loss: 1.3853 - accuracy: 0.5779 - val_loss: 0.1676 - val_accuracy: 0.9570
Epoch 2/15
 1/85 [..............................] - ETA: 0s - loss: 0.3091 - accuracy: 0.910911/85 [==>...........................] - ETA: 0s - loss: 0.2831 - accuracy: 0.915921/85 [======>.......................] - ETA: 0s - loss: 0.2723 - accuracy: 0.920131/85 [=========>....................] - ETA: 0s - loss: 0.2649 - accuracy: 0.922841/85 [=============>................] - ETA: 0s - loss: 0.2586 - accuracy: 0.924651/85 [=================>............] - ETA: 0s - loss: 0.2532 - accuracy: 0.926061/85 [====================>.........] - ETA: 0s - loss: 0.2483 - accuracy: 0.927371/85 [========================>.....] - ETA: 0s - loss: 0.2441 - accuracy: 0.928481/85 [===========================>..] - ETA: 0s - loss: 0.2403 - accuracy: 0.929485/85 [==============================] - ETA: 0s - loss: 0.2388 - accuracy: 0.929785/85 [==============================] - 1s 7ms/step - loss: 0.2385 - accuracy: 0.9298 - val_loss: 0.0995 - val_accuracy: 0.9732
Epoch 3/15
 1/85 [..............................] - ETA: 0s - loss: 0.1820 - accuracy: 0.957811/85 [==>...........................] - ETA: 0s - loss: 0.1638 - accuracy: 0.956321/85 [======>.......................] - ETA: 0s - loss: 0.1591 - accuracy: 0.955331/85 [=========>....................] - ETA: 0s - loss: 0.1564 - accuracy: 0.955240/85 [=============>................] - ETA: 0s - loss: 0.1544 - accuracy: 0.955350/85 [================>.............] - ETA: 0s - loss: 0.1524 - accuracy: 0.955460/85 [====================>.........] - ETA: 0s - loss: 0.1510 - accuracy: 0.955668/85 [=======================>......] - ETA: 0s - loss: 0.1502 - accuracy: 0.955778/85 [==========================>...] - ETA: 0s - loss: 0.1493 - accuracy: 0.955985/85 [==============================] - ETA: 0s - loss: 0.1488 - accuracy: 0.955985/85 [==============================] - 1s 8ms/step - loss: 0.1488 - accuracy: 0.9560 - val_loss: 0.0789 - val_accuracy: 0.9797
Epoch 4/15
 1/85 [..............................] - ETA: 0s - loss: 0.1063 - accuracy: 0.965611/85 [==>...........................] - ETA: 0s - loss: 0.1213 - accuracy: 0.961419/85 [=====>........................] - ETA: 0s - loss: 0.1222 - accuracy: 0.961929/85 [=========>....................] - ETA: 0s - loss: 0.1214 - accuracy: 0.962436/85 [===========>..................] - ETA: 0s - loss: 0.1209 - accuracy: 0.962745/85 [==============>...............] - ETA: 0s - loss: 0.1201 - accuracy: 0.963054/85 [==================>...........] - ETA: 0s - loss: 0.1194 - accuracy: 0.963364/85 [=====================>........] - ETA: 0s - loss: 0.1185 - accuracy: 0.963673/85 [========================>.....] - ETA: 0s - loss: 0.1178 - accuracy: 0.963883/85 [============================>.] - ETA: 0s - loss: 0.1172 - accuracy: 0.963985/85 [==============================] - 1s 7ms/step - loss: 0.1171 - accuracy: 0.9640 - val_loss: 0.0631 - val_accuracy: 0.9830
Epoch 5/15
 1/85 [..............................] - ETA: 0s - loss: 0.1235 - accuracy: 0.962510/85 [==>...........................] - ETA: 0s - loss: 0.1080 - accuracy: 0.970714/85 [===>..........................] - ETA: 0s - loss: 0.1068 - accuracy: 0.970823/85 [=======>......................] - ETA: 0s - loss: 0.1065 - accuracy: 0.970033/85 [==========>...................] - ETA: 0s - loss: 0.1052 - accuracy: 0.969842/85 [=============>................] - ETA: 0s - loss: 0.1041 - accuracy: 0.969751/85 [=================>............] - ETA: 0s - loss: 0.1031 - accuracy: 0.969760/85 [====================>.........] - ETA: 0s - loss: 0.1026 - accuracy: 0.969670/85 [=======================>......] - ETA: 0s - loss: 0.1021 - accuracy: 0.969680/85 [===========================>..] - ETA: 0s - loss: 0.1017 - accuracy: 0.969585/85 [==============================] - 1s 7ms/step - loss: 0.1016 - accuracy: 0.9695 - val_loss: 0.0595 - val_accuracy: 0.9858
Epoch 6/15
 1/85 [..............................] - ETA: 0s - loss: 0.0801 - accuracy: 0.978111/85 [==>...........................] - ETA: 0s - loss: 0.0910 - accuracy: 0.973319/85 [=====>........................] - ETA: 0s - loss: 0.0927 - accuracy: 0.972329/85 [=========>....................] - ETA: 0s - loss: 0.0929 - accuracy: 0.972039/85 [============>.................] - ETA: 0s - loss: 0.0924 - accuracy: 0.972049/85 [================>.............] - ETA: 0s - loss: 0.0920 - accuracy: 0.972059/85 [===================>..........] - ETA: 0s - loss: 0.0915 - accuracy: 0.972263/85 [=====================>........] - ETA: 0s - loss: 0.0913 - accuracy: 0.972369/85 [=======================>......] - ETA: 0s - loss: 0.0910 - accuracy: 0.972478/85 [==========================>...] - ETA: 0s - loss: 0.0907 - accuracy: 0.972582/85 [===========================>..] - ETA: 0s - loss: 0.0906 - accuracy: 0.972585/85 [==============================] - 1s 9ms/step - loss: 0.0904 - accuracy: 0.9726 - val_loss: 0.0528 - val_accuracy: 0.9860
Epoch 7/15
 1/85 [..............................] - ETA: 0s - loss: 0.0523 - accuracy: 0.9828 6/85 [=>............................] - ETA: 0s - loss: 0.0803 - accuracy: 0.976913/85 [===>..........................] - ETA: 0s - loss: 0.0865 - accuracy: 0.974815/85 [====>.........................] - ETA: 0s - loss: 0.0869 - accuracy: 0.974617/85 [=====>........................] - ETA: 1s - loss: 0.0871 - accuracy: 0.974419/85 [=====>........................] - ETA: 1s - loss: 0.0872 - accuracy: 0.974422/85 [======>.......................] - ETA: 1s - loss: 0.0873 - accuracy: 0.974323/85 [=======>......................] - ETA: 1s - loss: 0.0873 - accuracy: 0.974325/85 [=======>......................] - ETA: 1s - loss: 0.0872 - accuracy: 0.974326/85 [========>.....................] - ETA: 1s - loss: 0.0871 - accuracy: 0.974329/85 [=========>....................] - ETA: 1s - loss: 0.0870 - accuracy: 0.974330/85 [=========>....................] - ETA: 1s - loss: 0.0869 - accuracy: 0.974334/85 [===========>..................] - ETA: 1s - loss: 0.0865 - accuracy: 0.974342/85 [=============>................] - ETA: 0s - loss: 0.0859 - accuracy: 0.974444/85 [==============>...............] - ETA: 0s - loss: 0.0858 - accuracy: 0.974448/85 [===============>..............] - ETA: 0s - loss: 0.0856 - accuracy: 0.974452/85 [=================>............] - ETA: 0s - loss: 0.0854 - accuracy: 0.974458/85 [===================>..........] - ETA: 0s - loss: 0.0851 - accuracy: 0.974462/85 [====================>.........] - ETA: 0s - loss: 0.0849 - accuracy: 0.974565/85 [=====================>........] - ETA: 0s - loss: 0.0847 - accuracy: 0.974570/85 [=======================>......] - ETA: 0s - loss: 0.0844 - accuracy: 0.974576/85 [=========================>....] - ETA: 0s - loss: 0.0841 - accuracy: 0.974682/85 [===========================>..] - ETA: 0s - loss: 0.0839 - accuracy: 0.974585/85 [==============================] - 2s 20ms/step - loss: 0.0838 - accuracy: 0.9746 - val_loss: 0.0490 - val_accuracy: 0.9868
Epoch 8/15
 1/85 [..............................] - ETA: 0s - loss: 0.0657 - accuracy: 0.981211/85 [==>...........................] - ETA: 0s - loss: 0.0757 - accuracy: 0.978015/85 [====>.........................] - ETA: 0s - loss: 0.0765 - accuracy: 0.977624/85 [=======>......................] - ETA: 0s - loss: 0.0777 - accuracy: 0.977031/85 [=========>....................] - ETA: 0s - loss: 0.0774 - accuracy: 0.976934/85 [===========>..................] - ETA: 0s - loss: 0.0772 - accuracy: 0.976943/85 [==============>...............] - ETA: 0s - loss: 0.0768 - accuracy: 0.977046/85 [===============>..............] - ETA: 0s - loss: 0.0767 - accuracy: 0.977055/85 [==================>...........] - ETA: 0s - loss: 0.0763 - accuracy: 0.977060/85 [====================>.........] - ETA: 0s - loss: 0.0762 - accuracy: 0.977066/85 [======================>.......] - ETA: 0s - loss: 0.0760 - accuracy: 0.977072/85 [========================>.....] - ETA: 0s - loss: 0.0758 - accuracy: 0.977081/85 [===========================>..] - ETA: 0s - loss: 0.0756 - accuracy: 0.977185/85 [==============================] - 1s 10ms/step - loss: 0.0755 - accuracy: 0.9771 - val_loss: 0.0460 - val_accuracy: 0.9877
Epoch 9/15
 1/85 [..............................] - ETA: 0s - loss: 0.0821 - accuracy: 0.973410/85 [==>...........................] - ETA: 0s - loss: 0.0725 - accuracy: 0.977116/85 [====>.........................] - ETA: 0s - loss: 0.0711 - accuracy: 0.977820/85 [======>.......................] - ETA: 0s - loss: 0.0705 - accuracy: 0.978023/85 [=======>......................] - ETA: 0s - loss: 0.0702 - accuracy: 0.978125/85 [=======>......................] - ETA: 0s - loss: 0.0700 - accuracy: 0.978131/85 [=========>....................] - ETA: 0s - loss: 0.0696 - accuracy: 0.978139/85 [============>.................] - ETA: 0s - loss: 0.0696 - accuracy: 0.978243/85 [==============>...............] - ETA: 0s - loss: 0.0697 - accuracy: 0.978246/85 [===============>..............] - ETA: 0s - loss: 0.0698 - accuracy: 0.978154/85 [==================>...........] - ETA: 0s - loss: 0.0699 - accuracy: 0.978159/85 [===================>..........] - ETA: 0s - loss: 0.0699 - accuracy: 0.978266/85 [======================>.......] - ETA: 0s - loss: 0.0699 - accuracy: 0.978267/85 [======================>.......] - ETA: 0s - loss: 0.0699 - accuracy: 0.978274/85 [=========================>....] - ETA: 0s - loss: 0.0698 - accuracy: 0.978283/85 [============================>.] - ETA: 0s - loss: 0.0696 - accuracy: 0.978285/85 [==============================] - 1s 12ms/step - loss: 0.0696 - accuracy: 0.9783 - val_loss: 0.0443 - val_accuracy: 0.9880
Epoch 10/15
 1/85 [..............................] - ETA: 0s - loss: 0.0686 - accuracy: 0.978110/85 [==>...........................] - ETA: 0s - loss: 0.0610 - accuracy: 0.980220/85 [======>.......................] - ETA: 0s - loss: 0.0622 - accuracy: 0.979830/85 [=========>....................] - ETA: 0s - loss: 0.0625 - accuracy: 0.979740/85 [=============>................] - ETA: 0s - loss: 0.0627 - accuracy: 0.979850/85 [================>.............] - ETA: 0s - loss: 0.0630 - accuracy: 0.979859/85 [===================>..........] - ETA: 0s - loss: 0.0633 - accuracy: 0.979767/85 [======================>.......] - ETA: 0s - loss: 0.0634 - accuracy: 0.979774/85 [=========================>....] - ETA: 0s - loss: 0.0634 - accuracy: 0.979784/85 [============================>.] - ETA: 0s - loss: 0.0635 - accuracy: 0.979785/85 [==============================] - 1s 7ms/step - loss: 0.0635 - accuracy: 0.9797 - val_loss: 0.0420 - val_accuracy: 0.9892
Epoch 11/15
 1/85 [..............................] - ETA: 0s - loss: 0.0600 - accuracy: 0.9844 8/85 [=>............................] - ETA: 0s - loss: 0.0563 - accuracy: 0.984118/85 [=====>........................] - ETA: 0s - loss: 0.0596 - accuracy: 0.982328/85 [========>.....................] - ETA: 0s - loss: 0.0614 - accuracy: 0.981635/85 [===========>..................] - ETA: 0s - loss: 0.0614 - accuracy: 0.981645/85 [==============>...............] - ETA: 0s - loss: 0.0614 - accuracy: 0.981755/85 [==================>...........] - ETA: 0s - loss: 0.0614 - accuracy: 0.981765/85 [=====================>........] - ETA: 0s - loss: 0.0614 - accuracy: 0.981775/85 [=========================>....] - ETA: 0s - loss: 0.0614 - accuracy: 0.981784/85 [============================>.] - ETA: 0s - loss: 0.0613 - accuracy: 0.981785/85 [==============================] - 1s 7ms/step - loss: 0.0613 - accuracy: 0.9817 - val_loss: 0.0421 - val_accuracy: 0.9877
Epoch 12/15
 1/85 [..............................] - ETA: 0s - loss: 0.0773 - accuracy: 0.976610/85 [==>...........................] - ETA: 0s - loss: 0.0660 - accuracy: 0.978114/85 [===>..........................] - ETA: 0s - loss: 0.0643 - accuracy: 0.979022/85 [======>.......................] - ETA: 0s - loss: 0.0629 - accuracy: 0.979828/85 [========>.....................] - ETA: 0s - loss: 0.0621 - accuracy: 0.980233/85 [==========>...................] - ETA: 0s - loss: 0.0615 - accuracy: 0.980435/85 [===========>..................] - ETA: 0s - loss: 0.0613 - accuracy: 0.980537/85 [============>.................] - ETA: 0s - loss: 0.0610 - accuracy: 0.980640/85 [=============>................] - ETA: 0s - loss: 0.0608 - accuracy: 0.980744/85 [==============>...............] - ETA: 0s - loss: 0.0604 - accuracy: 0.980846/85 [===============>..............] - ETA: 0s - loss: 0.0603 - accuracy: 0.980951/85 [=================>............] - ETA: 0s - loss: 0.0600 - accuracy: 0.981053/85 [=================>............] - ETA: 0s - loss: 0.0599 - accuracy: 0.981056/85 [==================>...........] - ETA: 0s - loss: 0.0598 - accuracy: 0.981158/85 [===================>..........] - ETA: 0s - loss: 0.0598 - accuracy: 0.981165/85 [=====================>........] - ETA: 0s - loss: 0.0596 - accuracy: 0.981271/85 [========================>.....] - ETA: 0s - loss: 0.0595 - accuracy: 0.981277/85 [==========================>...] - ETA: 0s - loss: 0.0594 - accuracy: 0.981384/85 [============================>.] - ETA: 0s - loss: 0.0592 - accuracy: 0.981385/85 [==============================] - 1s 16ms/step - loss: 0.0592 - accuracy: 0.9813 - val_loss: 0.0415 - val_accuracy: 0.9882
Epoch 13/15
 1/85 [..............................] - ETA: 0s - loss: 0.0570 - accuracy: 0.9828 9/85 [==>...........................] - ETA: 0s - loss: 0.0497 - accuracy: 0.982914/85 [===>..........................] - ETA: 0s - loss: 0.0506 - accuracy: 0.982822/85 [======>.......................] - ETA: 0s - loss: 0.0508 - accuracy: 0.983130/85 [=========>....................] - ETA: 0s - loss: 0.0505 - accuracy: 0.983439/85 [============>.................] - ETA: 0s - loss: 0.0508 - accuracy: 0.983548/85 [===============>..............] - ETA: 0s - loss: 0.0510 - accuracy: 0.983657/85 [===================>..........] - ETA: 0s - loss: 0.0511 - accuracy: 0.983765/85 [=====================>........] - ETA: 0s - loss: 0.0514 - accuracy: 0.983773/85 [========================>.....] - ETA: 0s - loss: 0.0516 - accuracy: 0.983782/85 [===========================>..] - ETA: 0s - loss: 0.0518 - accuracy: 0.983785/85 [==============================] - 1s 8ms/step - loss: 0.0519 - accuracy: 0.9837 - val_loss: 0.0374 - val_accuracy: 0.9895
Epoch 14/15
 1/85 [..............................] - ETA: 0s - loss: 0.0673 - accuracy: 0.9781 7/85 [=>............................] - ETA: 0s - loss: 0.0559 - accuracy: 0.982416/85 [====>.........................] - ETA: 0s - loss: 0.0547 - accuracy: 0.982626/85 [========>.....................] - ETA: 0s - loss: 0.0538 - accuracy: 0.982833/85 [==========>...................] - ETA: 0s - loss: 0.0537 - accuracy: 0.982942/85 [=============>................] - ETA: 0s - loss: 0.0536 - accuracy: 0.982952/85 [=================>............] - ETA: 0s - loss: 0.0534 - accuracy: 0.983061/85 [====================>.........] - ETA: 0s - loss: 0.0533 - accuracy: 0.983067/85 [======================>.......] - ETA: 0s - loss: 0.0532 - accuracy: 0.983173/85 [========================>.....] - ETA: 0s - loss: 0.0532 - accuracy: 0.983179/85 [==========================>...] - ETA: 0s - loss: 0.0531 - accuracy: 0.983185/85 [==============================] - 1s 9ms/step - loss: 0.0531 - accuracy: 0.9831 - val_loss: 0.0369 - val_accuracy: 0.9902
Epoch 15/15
 1/85 [..............................] - ETA: 0s - loss: 0.0408 - accuracy: 0.9859 6/85 [=>............................] - ETA: 0s - loss: 0.0479 - accuracy: 0.983515/85 [====>.........................] - ETA: 0s - loss: 0.0466 - accuracy: 0.984123/85 [=======>......................] - ETA: 0s - loss: 0.0474 - accuracy: 0.984233/85 [==========>...................] - ETA: 0s - loss: 0.0484 - accuracy: 0.984143/85 [==============>...............] - ETA: 0s - loss: 0.0488 - accuracy: 0.984053/85 [=================>............] - ETA: 0s - loss: 0.0492 - accuracy: 0.983963/85 [=====================>........] - ETA: 0s - loss: 0.0493 - accuracy: 0.983973/85 [========================>.....] - ETA: 0s - loss: 0.0495 - accuracy: 0.983983/85 [============================>.] - ETA: 0s - loss: 0.0496 - accuracy: 0.983885/85 [==============================] - 1s 7ms/step - loss: 0.0496 - accuracy: 0.9838 - val_loss: 0.0360 - val_accuracy: 0.9903
training_time: 0:00:16.186213
Test loss: 0.032599978148937225
Test accuracy: 0.9886000156402588
