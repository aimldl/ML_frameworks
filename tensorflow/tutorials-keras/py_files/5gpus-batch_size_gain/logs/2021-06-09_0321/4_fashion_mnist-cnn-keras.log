Number of devices: 5
batch_size_per_replica: 128
batch_size: 640 = 128 * 5
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
x_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
<class 'numpy.ndarray'> <class 'numpy.ndarray'>
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 26, 26, 32)        320       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 13, 13, 32)        0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 11, 11, 64)        18496     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 5, 5, 64)          0         
_________________________________________________________________
flatten (Flatten)            (None, 1600)              0         
_________________________________________________________________
dropout (Dropout)            (None, 1600)              0         
_________________________________________________________________
dense (Dense)                (None, 10)                16010     
=================================================================
Total params: 34,826
Trainable params: 34,826
Non-trainable params: 0
_________________________________________________________________
Epoch 1/15
 1/85 [..............................] - ETA: 3:43 - loss: 2.3161 - accuracy: 0.0844 2/85 [..............................] - ETA: 6s - loss: 2.3089 - accuracy: 0.0984   3/85 [>.............................] - ETA: 5s - loss: 2.3018 - accuracy: 0.1149 4/85 [>.............................] - ETA: 5s - loss: 2.2951 - accuracy: 0.1295 5/85 [>.............................] - ETA: 5s - loss: 2.2883 - accuracy: 0.1438 6/85 [=>............................] - ETA: 4s - loss: 2.2811 - accuracy: 0.1577 7/85 [=>............................] - ETA: 4s - loss: 2.2741 - accuracy: 0.1704 8/85 [=>............................] - ETA: 4s - loss: 2.2669 - accuracy: 0.1827 9/85 [==>...........................] - ETA: 4s - loss: 2.2594 - accuracy: 0.194010/85 [==>...........................] - ETA: 4s - loss: 2.2518 - accuracy: 0.204213/85 [===>..........................] - ETA: 3s - loss: 2.2266 - accuracy: 0.231319/85 [=====>........................] - ETA: 2s - loss: 2.1669 - accuracy: 0.272527/85 [========>.....................] - ETA: 1s - loss: 2.0727 - accuracy: 0.313837/85 [============>.................] - ETA: 1s - loss: 1.9552 - accuracy: 0.354647/85 [===============>..............] - ETA: 0s - loss: 1.8516 - accuracy: 0.387757/85 [===================>..........] - ETA: 0s - loss: 1.7623 - accuracy: 0.415667/85 [======================>.......] - ETA: 0s - loss: 1.6852 - accuracy: 0.439877/85 [==========================>...] - ETA: 0s - loss: 1.6184 - accuracy: 0.460885/85 [==============================] - ETA: 0s - loss: 1.5710 - accuracy: 0.475685/85 [==============================] - 4s 19ms/step - loss: 1.5655 - accuracy: 0.4774 - val_loss: 0.5862 - val_accuracy: 0.7818
Epoch 2/15
 1/85 [..............................] - ETA: 0s - loss: 0.6627 - accuracy: 0.756311/85 [==>...........................] - ETA: 0s - loss: 0.6392 - accuracy: 0.766821/85 [======>.......................] - ETA: 0s - loss: 0.6327 - accuracy: 0.768231/85 [=========>....................] - ETA: 0s - loss: 0.6266 - accuracy: 0.770541/85 [=============>................] - ETA: 0s - loss: 0.6228 - accuracy: 0.772151/85 [=================>............] - ETA: 0s - loss: 0.6189 - accuracy: 0.773561/85 [====================>.........] - ETA: 0s - loss: 0.6147 - accuracy: 0.775171/85 [========================>.....] - ETA: 0s - loss: 0.6105 - accuracy: 0.776781/85 [===========================>..] - ETA: 0s - loss: 0.6066 - accuracy: 0.778285/85 [==============================] - ETA: 0s - loss: 0.6051 - accuracy: 0.778885/85 [==============================] - 1s 7ms/step - loss: 0.6047 - accuracy: 0.7789 - val_loss: 0.4816 - val_accuracy: 0.8202
Epoch 3/15
 1/85 [..............................] - ETA: 0s - loss: 0.5365 - accuracy: 0.814111/85 [==>...........................] - ETA: 0s - loss: 0.5222 - accuracy: 0.808421/85 [======>.......................] - ETA: 0s - loss: 0.5193 - accuracy: 0.808931/85 [=========>....................] - ETA: 0s - loss: 0.5162 - accuracy: 0.810341/85 [=============>................] - ETA: 0s - loss: 0.5137 - accuracy: 0.811751/85 [=================>............] - ETA: 0s - loss: 0.5115 - accuracy: 0.812861/85 [====================>.........] - ETA: 0s - loss: 0.5095 - accuracy: 0.813871/85 [========================>.....] - ETA: 0s - loss: 0.5076 - accuracy: 0.814781/85 [===========================>..] - ETA: 0s - loss: 0.5060 - accuracy: 0.815585/85 [==============================] - ETA: 0s - loss: 0.5054 - accuracy: 0.815885/85 [==============================] - 1s 7ms/step - loss: 0.5053 - accuracy: 0.8159 - val_loss: 0.4340 - val_accuracy: 0.8478
Epoch 4/15
 1/85 [..............................] - ETA: 0s - loss: 0.4958 - accuracy: 0.807811/85 [==>...........................] - ETA: 0s - loss: 0.4901 - accuracy: 0.822221/85 [======>.......................] - ETA: 0s - loss: 0.4823 - accuracy: 0.825531/85 [=========>....................] - ETA: 0s - loss: 0.4764 - accuracy: 0.828041/85 [=============>................] - ETA: 0s - loss: 0.4732 - accuracy: 0.829551/85 [=================>............] - ETA: 0s - loss: 0.4704 - accuracy: 0.830761/85 [====================>.........] - ETA: 0s - loss: 0.4684 - accuracy: 0.831671/85 [========================>.....] - ETA: 0s - loss: 0.4667 - accuracy: 0.832381/85 [===========================>..] - ETA: 0s - loss: 0.4651 - accuracy: 0.833085/85 [==============================] - 1s 7ms/step - loss: 0.4643 - accuracy: 0.8333 - val_loss: 0.3965 - val_accuracy: 0.8605
Epoch 5/15
 1/85 [..............................] - ETA: 0s - loss: 0.3982 - accuracy: 0.851611/85 [==>...........................] - ETA: 0s - loss: 0.4230 - accuracy: 0.845121/85 [======>.......................] - ETA: 0s - loss: 0.4260 - accuracy: 0.844531/85 [=========>....................] - ETA: 0s - loss: 0.4276 - accuracy: 0.845140/85 [=============>................] - ETA: 0s - loss: 0.4276 - accuracy: 0.845750/85 [================>.............] - ETA: 0s - loss: 0.4274 - accuracy: 0.846260/85 [====================>.........] - ETA: 0s - loss: 0.4273 - accuracy: 0.846570/85 [=======================>......] - ETA: 0s - loss: 0.4273 - accuracy: 0.846879/85 [==========================>...] - ETA: 0s - loss: 0.4272 - accuracy: 0.846985/85 [==============================] - ETA: 0s - loss: 0.4271 - accuracy: 0.847085/85 [==============================] - 1s 7ms/step - loss: 0.4271 - accuracy: 0.8470 - val_loss: 0.3794 - val_accuracy: 0.8665
Epoch 6/15
 1/85 [..............................] - ETA: 0s - loss: 0.4264 - accuracy: 0.864111/85 [==>...........................] - ETA: 0s - loss: 0.4166 - accuracy: 0.855021/85 [======>.......................] - ETA: 0s - loss: 0.4182 - accuracy: 0.853031/85 [=========>....................] - ETA: 0s - loss: 0.4162 - accuracy: 0.853541/85 [=============>................] - ETA: 0s - loss: 0.4143 - accuracy: 0.853951/85 [=================>............] - ETA: 0s - loss: 0.4130 - accuracy: 0.854161/85 [====================>.........] - ETA: 0s - loss: 0.4122 - accuracy: 0.854271/85 [========================>.....] - ETA: 0s - loss: 0.4116 - accuracy: 0.854381/85 [===========================>..] - ETA: 0s - loss: 0.4109 - accuracy: 0.854585/85 [==============================] - 1s 7ms/step - loss: 0.4106 - accuracy: 0.8546 - val_loss: 0.3664 - val_accuracy: 0.8682
Epoch 7/15
 1/85 [..............................] - ETA: 0s - loss: 0.3609 - accuracy: 0.875011/85 [==>...........................] - ETA: 0s - loss: 0.3792 - accuracy: 0.867721/85 [======>.......................] - ETA: 0s - loss: 0.3826 - accuracy: 0.865430/85 [=========>....................] - ETA: 0s - loss: 0.3842 - accuracy: 0.864139/85 [============>.................] - ETA: 0s - loss: 0.3854 - accuracy: 0.863249/85 [================>.............] - ETA: 0s - loss: 0.3860 - accuracy: 0.862758/85 [===================>..........] - ETA: 0s - loss: 0.3861 - accuracy: 0.862367/85 [======================>.......] - ETA: 0s - loss: 0.3861 - accuracy: 0.862277/85 [==========================>...] - ETA: 0s - loss: 0.3864 - accuracy: 0.862085/85 [==============================] - ETA: 0s - loss: 0.3864 - accuracy: 0.861985/85 [==============================] - 1s 7ms/step - loss: 0.3864 - accuracy: 0.8619 - val_loss: 0.3591 - val_accuracy: 0.8725
Epoch 8/15
 1/85 [..............................] - ETA: 0s - loss: 0.3731 - accuracy: 0.870311/85 [==>...........................] - ETA: 0s - loss: 0.3695 - accuracy: 0.873621/85 [======>.......................] - ETA: 0s - loss: 0.3736 - accuracy: 0.870830/85 [=========>....................] - ETA: 0s - loss: 0.3742 - accuracy: 0.870036/85 [===========>..................] - ETA: 0s - loss: 0.3740 - accuracy: 0.869841/85 [=============>................] - ETA: 0s - loss: 0.3738 - accuracy: 0.869643/85 [==============>...............] - ETA: 0s - loss: 0.3738 - accuracy: 0.869546/85 [===============>..............] - ETA: 0s - loss: 0.3738 - accuracy: 0.869547/85 [===============>..............] - ETA: 0s - loss: 0.3738 - accuracy: 0.869550/85 [================>.............] - ETA: 0s - loss: 0.3738 - accuracy: 0.869453/85 [=================>............] - ETA: 0s - loss: 0.3739 - accuracy: 0.869355/85 [==================>...........] - ETA: 0s - loss: 0.3739 - accuracy: 0.869357/85 [===================>..........] - ETA: 0s - loss: 0.3739 - accuracy: 0.869360/85 [====================>.........] - ETA: 0s - loss: 0.3738 - accuracy: 0.869262/85 [====================>.........] - ETA: 0s - loss: 0.3738 - accuracy: 0.869269/85 [=======================>......] - ETA: 0s - loss: 0.3740 - accuracy: 0.869072/85 [========================>.....] - ETA: 0s - loss: 0.3740 - accuracy: 0.869080/85 [===========================>..] - ETA: 0s - loss: 0.3741 - accuracy: 0.868982/85 [===========================>..] - ETA: 0s - loss: 0.3741 - accuracy: 0.868885/85 [==============================] - ETA: 0s - loss: 0.3742 - accuracy: 0.868885/85 [==============================] - 1s 17ms/step - loss: 0.3742 - accuracy: 0.8688 - val_loss: 0.3448 - val_accuracy: 0.8745
Epoch 9/15
 1/85 [..............................] - ETA: 0s - loss: 0.3903 - accuracy: 0.8453 3/85 [>.............................] - ETA: 3s - loss: 0.3837 - accuracy: 0.8513 7/85 [=>............................] - ETA: 1s - loss: 0.3828 - accuracy: 0.8561 9/85 [==>...........................] - ETA: 1s - loss: 0.3816 - accuracy: 0.857716/85 [====>.........................] - ETA: 1s - loss: 0.3784 - accuracy: 0.861317/85 [=====>........................] - ETA: 1s - loss: 0.3780 - accuracy: 0.861626/85 [========>.....................] - ETA: 0s - loss: 0.3757 - accuracy: 0.863834/85 [===========>..................] - ETA: 0s - loss: 0.3743 - accuracy: 0.864843/85 [==============>...............] - ETA: 0s - loss: 0.3731 - accuracy: 0.865553/85 [=================>............] - ETA: 0s - loss: 0.3721 - accuracy: 0.866163/85 [=====================>........] - ETA: 0s - loss: 0.3713 - accuracy: 0.866569/85 [=======================>......] - ETA: 0s - loss: 0.3709 - accuracy: 0.866777/85 [==========================>...] - ETA: 0s - loss: 0.3707 - accuracy: 0.866984/85 [============================>.] - ETA: 0s - loss: 0.3705 - accuracy: 0.867085/85 [==============================] - 1s 11ms/step - loss: 0.3704 - accuracy: 0.8671 - val_loss: 0.3357 - val_accuracy: 0.8782
Epoch 10/15
 1/85 [..............................] - ETA: 0s - loss: 0.4083 - accuracy: 0.8469 7/85 [=>............................] - ETA: 0s - loss: 0.3910 - accuracy: 0.863410/85 [==>...........................] - ETA: 0s - loss: 0.3868 - accuracy: 0.865717/85 [=====>........................] - ETA: 0s - loss: 0.3818 - accuracy: 0.867926/85 [========>.....................] - ETA: 0s - loss: 0.3771 - accuracy: 0.868634/85 [===========>..................] - ETA: 0s - loss: 0.3748 - accuracy: 0.868643/85 [==============>...............] - ETA: 0s - loss: 0.3731 - accuracy: 0.868653/85 [=================>............] - ETA: 0s - loss: 0.3715 - accuracy: 0.868861/85 [====================>.........] - ETA: 0s - loss: 0.3703 - accuracy: 0.869168/85 [=======================>......] - ETA: 0s - loss: 0.3692 - accuracy: 0.869373/85 [========================>.....] - ETA: 0s - loss: 0.3685 - accuracy: 0.869580/85 [===========================>..] - ETA: 0s - loss: 0.3676 - accuracy: 0.869785/85 [==============================] - ETA: 0s - loss: 0.3671 - accuracy: 0.869985/85 [==============================] - 1s 10ms/step - loss: 0.3670 - accuracy: 0.8699 - val_loss: 0.3296 - val_accuracy: 0.8822
Epoch 11/15
 1/85 [..............................] - ETA: 0s - loss: 0.3479 - accuracy: 0.8719 7/85 [=>............................] - ETA: 0s - loss: 0.3459 - accuracy: 0.871713/85 [===>..........................] - ETA: 0s - loss: 0.3485 - accuracy: 0.872618/85 [=====>........................] - ETA: 0s - loss: 0.3487 - accuracy: 0.873423/85 [=======>......................] - ETA: 0s - loss: 0.3489 - accuracy: 0.873527/85 [========>.....................] - ETA: 0s - loss: 0.3488 - accuracy: 0.873528/85 [========>.....................] - ETA: 0s - loss: 0.3488 - accuracy: 0.873630/85 [=========>....................] - ETA: 0s - loss: 0.3487 - accuracy: 0.873635/85 [===========>..................] - ETA: 0s - loss: 0.3486 - accuracy: 0.873742/85 [=============>................] - ETA: 0s - loss: 0.3486 - accuracy: 0.873746/85 [===============>..............] - ETA: 0s - loss: 0.3486 - accuracy: 0.873750/85 [================>.............] - ETA: 0s - loss: 0.3486 - accuracy: 0.873754/85 [==================>...........] - ETA: 0s - loss: 0.3486 - accuracy: 0.873659/85 [===================>..........] - ETA: 0s - loss: 0.3487 - accuracy: 0.873663/85 [=====================>........] - ETA: 0s - loss: 0.3488 - accuracy: 0.873571/85 [========================>.....] - ETA: 0s - loss: 0.3491 - accuracy: 0.873477/85 [==========================>...] - ETA: 0s - loss: 0.3492 - accuracy: 0.873483/85 [============================>.] - ETA: 0s - loss: 0.3493 - accuracy: 0.873485/85 [==============================] - 1s 14ms/step - loss: 0.3493 - accuracy: 0.8735 - val_loss: 0.3197 - val_accuracy: 0.8825
Epoch 12/15
 1/85 [..............................] - ETA: 0s - loss: 0.3107 - accuracy: 0.8859 7/85 [=>............................] - ETA: 0s - loss: 0.3347 - accuracy: 0.884916/85 [====>.........................] - ETA: 0s - loss: 0.3417 - accuracy: 0.880921/85 [======>.......................] - ETA: 0s - loss: 0.3433 - accuracy: 0.880028/85 [========>.....................] - ETA: 0s - loss: 0.3429 - accuracy: 0.879632/85 [==========>...................] - ETA: 0s - loss: 0.3425 - accuracy: 0.879537/85 [============>.................] - ETA: 0s - loss: 0.3419 - accuracy: 0.879543/85 [==============>...............] - ETA: 0s - loss: 0.3414 - accuracy: 0.879649/85 [================>.............] - ETA: 0s - loss: 0.3413 - accuracy: 0.879457/85 [===================>..........] - ETA: 0s - loss: 0.3413 - accuracy: 0.879364/85 [=====================>........] - ETA: 0s - loss: 0.3414 - accuracy: 0.879372/85 [========================>.....] - ETA: 0s - loss: 0.3415 - accuracy: 0.879276/85 [=========================>....] - ETA: 0s - loss: 0.3415 - accuracy: 0.879280/85 [===========================>..] - ETA: 0s - loss: 0.3415 - accuracy: 0.879183/85 [============================>.] - ETA: 0s - loss: 0.3415 - accuracy: 0.879185/85 [==============================] - 1s 12ms/step - loss: 0.3415 - accuracy: 0.8791 - val_loss: 0.3116 - val_accuracy: 0.8847
Epoch 13/15
 1/85 [..............................] - ETA: 0s - loss: 0.2901 - accuracy: 0.9016 9/85 [==>...........................] - ETA: 0s - loss: 0.3257 - accuracy: 0.885816/85 [====>.........................] - ETA: 0s - loss: 0.3302 - accuracy: 0.884621/85 [======>.......................] - ETA: 0s - loss: 0.3318 - accuracy: 0.883828/85 [========>.....................] - ETA: 0s - loss: 0.3332 - accuracy: 0.883334/85 [===========>..................] - ETA: 0s - loss: 0.3344 - accuracy: 0.882941/85 [=============>................] - ETA: 0s - loss: 0.3351 - accuracy: 0.882444/85 [==============>...............] - ETA: 0s - loss: 0.3352 - accuracy: 0.882349/85 [================>.............] - ETA: 0s - loss: 0.3354 - accuracy: 0.882156/85 [==================>...........] - ETA: 0s - loss: 0.3358 - accuracy: 0.881959/85 [===================>..........] - ETA: 0s - loss: 0.3359 - accuracy: 0.881866/85 [======================>.......] - ETA: 0s - loss: 0.3360 - accuracy: 0.881672/85 [========================>.....] - ETA: 0s - loss: 0.3360 - accuracy: 0.881680/85 [===========================>..] - ETA: 0s - loss: 0.3360 - accuracy: 0.881585/85 [==============================] - 1s 10ms/step - loss: 0.3360 - accuracy: 0.8814 - val_loss: 0.3080 - val_accuracy: 0.8880
Epoch 14/15
 1/85 [..............................] - ETA: 0s - loss: 0.3512 - accuracy: 0.871911/85 [==>...........................] - ETA: 0s - loss: 0.3259 - accuracy: 0.887220/85 [======>.......................] - ETA: 0s - loss: 0.3254 - accuracy: 0.886930/85 [=========>....................] - ETA: 0s - loss: 0.3277 - accuracy: 0.885740/85 [=============>................] - ETA: 0s - loss: 0.3286 - accuracy: 0.885050/85 [================>.............] - ETA: 0s - loss: 0.3288 - accuracy: 0.884659/85 [===================>..........] - ETA: 0s - loss: 0.3288 - accuracy: 0.884469/85 [=======================>......] - ETA: 0s - loss: 0.3286 - accuracy: 0.884378/85 [==========================>...] - ETA: 0s - loss: 0.3285 - accuracy: 0.884384/85 [============================>.] - ETA: 0s - loss: 0.3285 - accuracy: 0.884285/85 [==============================] - 1s 7ms/step - loss: 0.3285 - accuracy: 0.8842 - val_loss: 0.3135 - val_accuracy: 0.8848
Epoch 15/15
 1/85 [..............................] - ETA: 0s - loss: 0.3387 - accuracy: 0.871910/85 [==>...........................] - ETA: 0s - loss: 0.3197 - accuracy: 0.885519/85 [=====>........................] - ETA: 0s - loss: 0.3179 - accuracy: 0.887629/85 [=========>....................] - ETA: 0s - loss: 0.3195 - accuracy: 0.887838/85 [============>.................] - ETA: 0s - loss: 0.3205 - accuracy: 0.887548/85 [===============>..............] - ETA: 0s - loss: 0.3213 - accuracy: 0.886958/85 [===================>..........] - ETA: 0s - loss: 0.3215 - accuracy: 0.886767/85 [======================>.......] - ETA: 0s - loss: 0.3216 - accuracy: 0.886576/85 [=========================>....] - ETA: 0s - loss: 0.3217 - accuracy: 0.886385/85 [==============================] - ETA: 0s - loss: 0.3219 - accuracy: 0.886185/85 [==============================] - 1s 7ms/step - loss: 0.3219 - accuracy: 0.8861 - val_loss: 0.3060 - val_accuracy: 0.8905
training_time: 0:00:15.476594
Test loss: 0.3183736503124237
Test accuracy: 0.888700008392334
