Number of devices: 5
batch_size_per_replica: 128
batch_size: 640 = 128 * 5
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
x_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
<class 'numpy.ndarray'> <class 'numpy.ndarray'>
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 26, 26, 32)        320       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 13, 13, 32)        0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 11, 11, 64)        18496     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 5, 5, 64)          0         
_________________________________________________________________
flatten (Flatten)            (None, 1600)              0         
_________________________________________________________________
dropout (Dropout)            (None, 1600)              0         
_________________________________________________________________
dense (Dense)                (None, 10)                16010     
=================================================================
Total params: 34,826
Trainable params: 34,826
Non-trainable params: 0
_________________________________________________________________
Epoch 1/15
 1/85 [..............................] - ETA: 3:44 - loss: 2.3037 - accuracy: 0.1219 2/85 [..............................] - ETA: 7s - loss: 2.2981 - accuracy: 0.1305   3/85 [>.............................] - ETA: 5s - loss: 2.2901 - accuracy: 0.1450 4/85 [>.............................] - ETA: 5s - loss: 2.2820 - accuracy: 0.1574 6/85 [=>............................] - ETA: 4s - loss: 2.2654 - accuracy: 0.1824 8/85 [=>............................] - ETA: 3s - loss: 2.2488 - accuracy: 0.205010/85 [==>...........................] - ETA: 3s - loss: 2.2308 - accuracy: 0.226918/85 [=====>........................] - ETA: 1s - loss: 2.1466 - accuracy: 0.301527/85 [========>.....................] - ETA: 1s - loss: 2.0257 - accuracy: 0.365037/85 [============>.................] - ETA: 0s - loss: 1.8873 - accuracy: 0.418547/85 [===============>..............] - ETA: 0s - loss: 1.7612 - accuracy: 0.461656/85 [==================>...........] - ETA: 0s - loss: 1.6613 - accuracy: 0.494366/85 [======================>.......] - ETA: 0s - loss: 1.5646 - accuracy: 0.525376/85 [=========================>....] - ETA: 0s - loss: 1.4809 - accuracy: 0.551985/85 [==============================] - ETA: 0s - loss: 1.4146 - accuracy: 0.572785/85 [==============================] - 4s 17ms/step - loss: 1.4079 - accuracy: 0.5749 - val_loss: 0.1725 - val_accuracy: 0.9540
Epoch 2/15
 1/85 [..............................] - ETA: 0s - loss: 0.2540 - accuracy: 0.9297 4/85 [>.............................] - ETA: 1s - loss: 0.2563 - accuracy: 0.928613/85 [===>..........................] - ETA: 0s - loss: 0.2617 - accuracy: 0.923218/85 [=====>........................] - ETA: 0s - loss: 0.2603 - accuracy: 0.922626/85 [========>.....................] - ETA: 0s - loss: 0.2570 - accuracy: 0.922834/85 [===========>..................] - ETA: 0s - loss: 0.2534 - accuracy: 0.923743/85 [==============>...............] - ETA: 0s - loss: 0.2497 - accuracy: 0.924752/85 [=================>............] - ETA: 0s - loss: 0.2459 - accuracy: 0.925760/85 [====================>.........] - ETA: 0s - loss: 0.2429 - accuracy: 0.926668/85 [=======================>......] - ETA: 0s - loss: 0.2402 - accuracy: 0.927478/85 [==========================>...] - ETA: 0s - loss: 0.2370 - accuracy: 0.928485/85 [==============================] - ETA: 0s - loss: 0.2349 - accuracy: 0.929185/85 [==============================] - 1s 9ms/step - loss: 0.2346 - accuracy: 0.9292 - val_loss: 0.1057 - val_accuracy: 0.9717
Epoch 3/15
 1/85 [..............................] - ETA: 0s - loss: 0.1668 - accuracy: 0.9453 7/85 [=>............................] - ETA: 0s - loss: 0.1656 - accuracy: 0.946811/85 [==>...........................] - ETA: 1s - loss: 0.1653 - accuracy: 0.947613/85 [===>..........................] - ETA: 1s - loss: 0.1653 - accuracy: 0.947916/85 [====>.........................] - ETA: 1s - loss: 0.1665 - accuracy: 0.947917/85 [=====>........................] - ETA: 1s - loss: 0.1668 - accuracy: 0.948019/85 [=====>........................] - ETA: 1s - loss: 0.1671 - accuracy: 0.948122/85 [======>.......................] - ETA: 1s - loss: 0.1676 - accuracy: 0.948225/85 [=======>......................] - ETA: 1s - loss: 0.1680 - accuracy: 0.948227/85 [========>.....................] - ETA: 1s - loss: 0.1679 - accuracy: 0.948228/85 [========>.....................] - ETA: 1s - loss: 0.1679 - accuracy: 0.948332/85 [==========>...................] - ETA: 1s - loss: 0.1674 - accuracy: 0.948535/85 [===========>..................] - ETA: 1s - loss: 0.1669 - accuracy: 0.948738/85 [============>.................] - ETA: 1s - loss: 0.1665 - accuracy: 0.948940/85 [=============>................] - ETA: 1s - loss: 0.1661 - accuracy: 0.949143/85 [==============>...............] - ETA: 1s - loss: 0.1656 - accuracy: 0.949345/85 [==============>...............] - ETA: 0s - loss: 0.1652 - accuracy: 0.949446/85 [===============>..............] - ETA: 0s - loss: 0.1651 - accuracy: 0.949548/85 [===============>..............] - ETA: 0s - loss: 0.1647 - accuracy: 0.949751/85 [=================>............] - ETA: 0s - loss: 0.1641 - accuracy: 0.949953/85 [=================>............] - ETA: 0s - loss: 0.1637 - accuracy: 0.950158/85 [===================>..........] - ETA: 0s - loss: 0.1628 - accuracy: 0.950561/85 [====================>.........] - ETA: 0s - loss: 0.1622 - accuracy: 0.950763/85 [=====================>........] - ETA: 0s - loss: 0.1618 - accuracy: 0.950867/85 [======================>.......] - ETA: 0s - loss: 0.1612 - accuracy: 0.951069/85 [=======================>......] - ETA: 0s - loss: 0.1608 - accuracy: 0.951279/85 [==========================>...] - ETA: 0s - loss: 0.1592 - accuracy: 0.951785/85 [==============================] - ETA: 0s - loss: 0.1584 - accuracy: 0.952085/85 [==============================] - 2s 23ms/step - loss: 0.1583 - accuracy: 0.9520 - val_loss: 0.0821 - val_accuracy: 0.9778
Epoch 4/15
 1/85 [..............................] - ETA: 0s - loss: 0.1554 - accuracy: 0.9578 5/85 [>.............................] - ETA: 1s - loss: 0.1456 - accuracy: 0.9575 8/85 [=>............................] - ETA: 1s - loss: 0.1405 - accuracy: 0.958415/85 [====>.........................] - ETA: 0s - loss: 0.1328 - accuracy: 0.960121/85 [======>.......................] - ETA: 0s - loss: 0.1300 - accuracy: 0.960828/85 [========>.....................] - ETA: 0s - loss: 0.1282 - accuracy: 0.961238/85 [============>.................] - ETA: 0s - loss: 0.1264 - accuracy: 0.961644/85 [==============>...............] - ETA: 0s - loss: 0.1257 - accuracy: 0.961853/85 [=================>............] - ETA: 0s - loss: 0.1249 - accuracy: 0.962062/85 [====================>.........] - ETA: 0s - loss: 0.1242 - accuracy: 0.962268/85 [=======================>......] - ETA: 0s - loss: 0.1238 - accuracy: 0.962377/85 [==========================>...] - ETA: 0s - loss: 0.1232 - accuracy: 0.962585/85 [==============================] - ETA: 0s - loss: 0.1227 - accuracy: 0.962685/85 [==============================] - 1s 9ms/step - loss: 0.1227 - accuracy: 0.9626 - val_loss: 0.0708 - val_accuracy: 0.9813
Epoch 5/15
 1/85 [..............................] - ETA: 0s - loss: 0.1332 - accuracy: 0.959411/85 [==>...........................] - ETA: 0s - loss: 0.1182 - accuracy: 0.965720/85 [======>.......................] - ETA: 0s - loss: 0.1145 - accuracy: 0.966630/85 [=========>....................] - ETA: 0s - loss: 0.1133 - accuracy: 0.966940/85 [=============>................] - ETA: 0s - loss: 0.1117 - accuracy: 0.967246/85 [===============>..............] - ETA: 0s - loss: 0.1108 - accuracy: 0.967456/85 [==================>...........] - ETA: 0s - loss: 0.1097 - accuracy: 0.967764/85 [=====================>........] - ETA: 0s - loss: 0.1090 - accuracy: 0.967873/85 [========================>.....] - ETA: 0s - loss: 0.1084 - accuracy: 0.967977/85 [==========================>...] - ETA: 0s - loss: 0.1081 - accuracy: 0.968085/85 [==============================] - ETA: 0s - loss: 0.1075 - accuracy: 0.968185/85 [==============================] - 1s 8ms/step - loss: 0.1074 - accuracy: 0.9681 - val_loss: 0.0598 - val_accuracy: 0.9828
Epoch 6/15
 1/85 [..............................] - ETA: 0s - loss: 0.0887 - accuracy: 0.9688 7/85 [=>............................] - ETA: 0s - loss: 0.0978 - accuracy: 0.967514/85 [===>..........................] - ETA: 0s - loss: 0.0986 - accuracy: 0.968321/85 [======>.......................] - ETA: 0s - loss: 0.0978 - accuracy: 0.969029/85 [=========>....................] - ETA: 0s - loss: 0.0971 - accuracy: 0.969636/85 [===========>..................] - ETA: 0s - loss: 0.0962 - accuracy: 0.970144/85 [==============>...............] - ETA: 0s - loss: 0.0953 - accuracy: 0.970554/85 [==================>...........] - ETA: 0s - loss: 0.0944 - accuracy: 0.970964/85 [=====================>........] - ETA: 0s - loss: 0.0938 - accuracy: 0.971274/85 [=========================>....] - ETA: 0s - loss: 0.0934 - accuracy: 0.971584/85 [============================>.] - ETA: 0s - loss: 0.0929 - accuracy: 0.971785/85 [==============================] - 1s 8ms/step - loss: 0.0928 - accuracy: 0.9718 - val_loss: 0.0540 - val_accuracy: 0.9860
Epoch 7/15
 1/85 [..............................] - ETA: 0s - loss: 0.0723 - accuracy: 0.984411/85 [==>...........................] - ETA: 0s - loss: 0.0801 - accuracy: 0.976521/85 [======>.......................] - ETA: 0s - loss: 0.0812 - accuracy: 0.975831/85 [=========>....................] - ETA: 0s - loss: 0.0823 - accuracy: 0.975341/85 [=============>................] - ETA: 0s - loss: 0.0827 - accuracy: 0.975151/85 [=================>............] - ETA: 0s - loss: 0.0830 - accuracy: 0.974961/85 [====================>.........] - ETA: 0s - loss: 0.0830 - accuracy: 0.974871/85 [========================>.....] - ETA: 0s - loss: 0.0829 - accuracy: 0.974881/85 [===========================>..] - ETA: 0s - loss: 0.0827 - accuracy: 0.974885/85 [==============================] - 1s 7ms/step - loss: 0.0826 - accuracy: 0.9748 - val_loss: 0.0482 - val_accuracy: 0.9870
Epoch 8/15
 1/85 [..............................] - ETA: 0s - loss: 0.0759 - accuracy: 0.9797 6/85 [=>............................] - ETA: 0s - loss: 0.0817 - accuracy: 0.979416/85 [====>.........................] - ETA: 0s - loss: 0.0821 - accuracy: 0.977826/85 [========>.....................] - ETA: 0s - loss: 0.0820 - accuracy: 0.977234/85 [===========>..................] - ETA: 0s - loss: 0.0814 - accuracy: 0.977041/85 [=============>................] - ETA: 0s - loss: 0.0807 - accuracy: 0.977051/85 [=================>............] - ETA: 0s - loss: 0.0800 - accuracy: 0.976961/85 [====================>.........] - ETA: 0s - loss: 0.0795 - accuracy: 0.976971/85 [========================>.....] - ETA: 0s - loss: 0.0790 - accuracy: 0.976881/85 [===========================>..] - ETA: 0s - loss: 0.0786 - accuracy: 0.976885/85 [==============================] - 1s 8ms/step - loss: 0.0784 - accuracy: 0.9768 - val_loss: 0.0459 - val_accuracy: 0.9888
Epoch 9/15
 1/85 [..............................] - ETA: 0s - loss: 0.0520 - accuracy: 0.9828 8/85 [=>............................] - ETA: 0s - loss: 0.0630 - accuracy: 0.978818/85 [=====>........................] - ETA: 0s - loss: 0.0659 - accuracy: 0.977928/85 [========>.....................] - ETA: 0s - loss: 0.0664 - accuracy: 0.978138/85 [============>.................] - ETA: 0s - loss: 0.0667 - accuracy: 0.978348/85 [===============>..............] - ETA: 0s - loss: 0.0668 - accuracy: 0.978457/85 [===================>..........] - ETA: 0s - loss: 0.0669 - accuracy: 0.978566/85 [======================>.......] - ETA: 0s - loss: 0.0670 - accuracy: 0.978576/85 [=========================>....] - ETA: 0s - loss: 0.0672 - accuracy: 0.978685/85 [==============================] - ETA: 0s - loss: 0.0675 - accuracy: 0.978685/85 [==============================] - 1s 7ms/step - loss: 0.0675 - accuracy: 0.9786 - val_loss: 0.0434 - val_accuracy: 0.9888
Epoch 10/15
 1/85 [..............................] - ETA: 0s - loss: 0.0575 - accuracy: 0.984411/85 [==>...........................] - ETA: 0s - loss: 0.0605 - accuracy: 0.982021/85 [======>.......................] - ETA: 0s - loss: 0.0627 - accuracy: 0.981131/85 [=========>....................] - ETA: 0s - loss: 0.0639 - accuracy: 0.980741/85 [=============>................] - ETA: 0s - loss: 0.0647 - accuracy: 0.980349/85 [================>.............] - ETA: 0s - loss: 0.0650 - accuracy: 0.980255/85 [==================>...........] - ETA: 0s - loss: 0.0651 - accuracy: 0.980164/85 [=====================>........] - ETA: 0s - loss: 0.0653 - accuracy: 0.980074/85 [=========================>....] - ETA: 0s - loss: 0.0653 - accuracy: 0.979984/85 [============================>.] - ETA: 0s - loss: 0.0653 - accuracy: 0.979985/85 [==============================] - 1s 7ms/step - loss: 0.0653 - accuracy: 0.9799 - val_loss: 0.0426 - val_accuracy: 0.9893
Epoch 11/15
 1/85 [..............................] - ETA: 0s - loss: 0.0552 - accuracy: 0.979711/85 [==>...........................] - ETA: 0s - loss: 0.0575 - accuracy: 0.981721/85 [======>.......................] - ETA: 0s - loss: 0.0582 - accuracy: 0.981731/85 [=========>....................] - ETA: 0s - loss: 0.0577 - accuracy: 0.981939/85 [============>.................] - ETA: 0s - loss: 0.0579 - accuracy: 0.981949/85 [================>.............] - ETA: 0s - loss: 0.0582 - accuracy: 0.981959/85 [===================>..........] - ETA: 0s - loss: 0.0587 - accuracy: 0.981869/85 [=======================>......] - ETA: 0s - loss: 0.0590 - accuracy: 0.981779/85 [==========================>...] - ETA: 0s - loss: 0.0593 - accuracy: 0.981685/85 [==============================] - ETA: 0s - loss: 0.0594 - accuracy: 0.981585/85 [==============================] - 1s 7ms/step - loss: 0.0595 - accuracy: 0.9815 - val_loss: 0.0410 - val_accuracy: 0.9892
Epoch 12/15
 1/85 [..............................] - ETA: 0s - loss: 0.0605 - accuracy: 0.979710/85 [==>...........................] - ETA: 0s - loss: 0.0613 - accuracy: 0.979320/85 [======>.......................] - ETA: 0s - loss: 0.0582 - accuracy: 0.980729/85 [=========>....................] - ETA: 0s - loss: 0.0591 - accuracy: 0.980839/85 [============>.................] - ETA: 0s - loss: 0.0596 - accuracy: 0.980848/85 [===============>..............] - ETA: 0s - loss: 0.0597 - accuracy: 0.980958/85 [===================>..........] - ETA: 0s - loss: 0.0598 - accuracy: 0.980968/85 [=======================>......] - ETA: 0s - loss: 0.0598 - accuracy: 0.981078/85 [==========================>...] - ETA: 0s - loss: 0.0598 - accuracy: 0.981185/85 [==============================] - ETA: 0s - loss: 0.0597 - accuracy: 0.981285/85 [==============================] - 1s 7ms/step - loss: 0.0597 - accuracy: 0.9812 - val_loss: 0.0381 - val_accuracy: 0.9902
Epoch 13/15
 1/85 [..............................] - ETA: 0s - loss: 0.0745 - accuracy: 0.975011/85 [==>...........................] - ETA: 0s - loss: 0.0588 - accuracy: 0.981421/85 [======>.......................] - ETA: 0s - loss: 0.0587 - accuracy: 0.982031/85 [=========>....................] - ETA: 0s - loss: 0.0579 - accuracy: 0.982440/85 [=============>................] - ETA: 0s - loss: 0.0576 - accuracy: 0.982550/85 [================>.............] - ETA: 0s - loss: 0.0576 - accuracy: 0.982459/85 [===================>..........] - ETA: 0s - loss: 0.0577 - accuracy: 0.982368/85 [=======================>......] - ETA: 0s - loss: 0.0577 - accuracy: 0.982377/85 [==========================>...] - ETA: 0s - loss: 0.0576 - accuracy: 0.982385/85 [==============================] - ETA: 0s - loss: 0.0575 - accuracy: 0.982385/85 [==============================] - 1s 7ms/step - loss: 0.0575 - accuracy: 0.9823 - val_loss: 0.0369 - val_accuracy: 0.9897
Epoch 14/15
 1/85 [..............................] - ETA: 0s - loss: 0.0430 - accuracy: 0.989111/85 [==>...........................] - ETA: 0s - loss: 0.0505 - accuracy: 0.984721/85 [======>.......................] - ETA: 0s - loss: 0.0507 - accuracy: 0.984530/85 [=========>....................] - ETA: 0s - loss: 0.0515 - accuracy: 0.984233/85 [==========>...................] - ETA: 0s - loss: 0.0517 - accuracy: 0.984039/85 [============>.................] - ETA: 0s - loss: 0.0521 - accuracy: 0.983940/85 [=============>................] - ETA: 0s - loss: 0.0521 - accuracy: 0.983843/85 [==============>...............] - ETA: 0s - loss: 0.0522 - accuracy: 0.983845/85 [==============>...............] - ETA: 0s - loss: 0.0523 - accuracy: 0.983847/85 [===============>..............] - ETA: 0s - loss: 0.0524 - accuracy: 0.983750/85 [================>.............] - ETA: 0s - loss: 0.0525 - accuracy: 0.983753/85 [=================>............] - ETA: 0s - loss: 0.0525 - accuracy: 0.983756/85 [==================>...........] - ETA: 0s - loss: 0.0526 - accuracy: 0.983760/85 [====================>.........] - ETA: 0s - loss: 0.0526 - accuracy: 0.983764/85 [=====================>........] - ETA: 0s - loss: 0.0526 - accuracy: 0.983770/85 [=======================>......] - ETA: 0s - loss: 0.0526 - accuracy: 0.983778/85 [==========================>...] - ETA: 0s - loss: 0.0525 - accuracy: 0.983785/85 [==============================] - ETA: 0s - loss: 0.0524 - accuracy: 0.983785/85 [==============================] - 1s 14ms/step - loss: 0.0524 - accuracy: 0.9837 - val_loss: 0.0352 - val_accuracy: 0.9910
Epoch 15/15
 1/85 [..............................] - ETA: 0s - loss: 0.0584 - accuracy: 0.9797 5/85 [>.............................] - ETA: 1s - loss: 0.0551 - accuracy: 0.983311/85 [==>...........................] - ETA: 0s - loss: 0.0548 - accuracy: 0.983619/85 [=====>........................] - ETA: 0s - loss: 0.0538 - accuracy: 0.983627/85 [========>.....................] - ETA: 0s - loss: 0.0533 - accuracy: 0.983637/85 [============>.................] - ETA: 0s - loss: 0.0532 - accuracy: 0.983647/85 [===============>..............] - ETA: 0s - loss: 0.0530 - accuracy: 0.983657/85 [===================>..........] - ETA: 0s - loss: 0.0528 - accuracy: 0.983667/85 [======================>.......] - ETA: 0s - loss: 0.0528 - accuracy: 0.983777/85 [==========================>...] - ETA: 0s - loss: 0.0527 - accuracy: 0.983685/85 [==============================] - ETA: 0s - loss: 0.0527 - accuracy: 0.983685/85 [==============================] - 1s 8ms/step - loss: 0.0527 - accuracy: 0.9836 - val_loss: 0.0369 - val_accuracy: 0.9898
training_time: 0:00:15.165323
Test loss: 0.03305070474743843
Test accuracy: 0.9898999929428101
