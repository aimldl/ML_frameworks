Number of devices: 6
batch_size_per_replica: 250
batch_size: 1500 = 250 * 6
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
60000 10000
Epoch 1/20
 1/32 [..............................] - ETA: 26s - loss: 153.3823 - accuracy: 0.091319/32 [================>.............] - ETA: 0s - loss: 61.5669 - accuracy: 0.3341  32/32 [==============================] - 1s 18ms/step - loss: 44.2627 - accuracy: 0.4058 - val_loss: 1.5612 - val_accuracy: 0.5231
Epoch 2/20
 1/32 [..............................] - ETA: 0s - loss: 1.6896 - accuracy: 0.496720/32 [=================>............] - ETA: 0s - loss: 1.5188 - accuracy: 0.526332/32 [==============================] - 0s 5ms/step - loss: 1.4743 - accuracy: 0.5469 - val_loss: 1.1897 - val_accuracy: 0.6897
Epoch 3/20
 1/32 [..............................] - ETA: 0s - loss: 1.1910 - accuracy: 0.682020/32 [=================>............] - ETA: 0s - loss: 1.1847 - accuracy: 0.682732/32 [==============================] - 0s 5ms/step - loss: 1.1626 - accuracy: 0.6875 - val_loss: 1.0369 - val_accuracy: 0.7306
Epoch 4/20
 1/32 [..............................] - ETA: 0s - loss: 0.9549 - accuracy: 0.734020/32 [=================>............] - ETA: 0s - loss: 1.0005 - accuracy: 0.727532/32 [==============================] - 0s 5ms/step - loss: 0.9874 - accuracy: 0.7300 - val_loss: 0.9116 - val_accuracy: 0.7505
Epoch 5/20
 1/32 [..............................] - ETA: 0s - loss: 0.8933 - accuracy: 0.740721/32 [==================>...........] - ETA: 0s - loss: 0.8632 - accuracy: 0.753732/32 [==============================] - 0s 5ms/step - loss: 0.8573 - accuracy: 0.7551 - val_loss: 0.8232 - val_accuracy: 0.8217
Epoch 6/20
 1/32 [..............................] - ETA: 0s - loss: 0.7151 - accuracy: 0.813319/32 [================>.............] - ETA: 0s - loss: 0.7651 - accuracy: 0.813732/32 [==============================] - 0s 5ms/step - loss: 0.7598 - accuracy: 0.8169 - val_loss: 0.7538 - val_accuracy: 0.8388
Epoch 7/20
 1/32 [..............................] - ETA: 0s - loss: 0.6150 - accuracy: 0.842019/32 [================>.............] - ETA: 0s - loss: 0.6660 - accuracy: 0.837132/32 [==============================] - 0s 5ms/step - loss: 0.6693 - accuracy: 0.8377 - val_loss: 0.7097 - val_accuracy: 0.8534
Epoch 8/20
 1/32 [..............................] - ETA: 0s - loss: 0.5936 - accuracy: 0.847319/32 [================>.............] - ETA: 0s - loss: 0.6095 - accuracy: 0.849432/32 [==============================] - 0s 5ms/step - loss: 0.6078 - accuracy: 0.8519 - val_loss: 0.6617 - val_accuracy: 0.8678
Epoch 9/20
 1/32 [..............................] - ETA: 0s - loss: 0.4315 - accuracy: 0.890719/32 [================>.............] - ETA: 0s - loss: 0.5129 - accuracy: 0.873832/32 [==============================] - 0s 5ms/step - loss: 0.5208 - accuracy: 0.8723 - val_loss: 0.5844 - val_accuracy: 0.8820
Epoch 10/20
 1/32 [..............................] - ETA: 0s - loss: 0.4560 - accuracy: 0.886719/32 [================>.............] - ETA: 0s - loss: 0.4620 - accuracy: 0.880832/32 [==============================] - 0s 5ms/step - loss: 0.4605 - accuracy: 0.8817 - val_loss: 0.5357 - val_accuracy: 0.8872
Epoch 11/20
 1/32 [..............................] - ETA: 0s - loss: 0.4143 - accuracy: 0.886720/32 [=================>............] - ETA: 0s - loss: 0.4157 - accuracy: 0.887232/32 [==============================] - 0s 5ms/step - loss: 0.4123 - accuracy: 0.8890 - val_loss: 0.5000 - val_accuracy: 0.8972
Epoch 12/20
 1/32 [..............................] - ETA: 0s - loss: 0.3911 - accuracy: 0.898019/32 [================>.............] - ETA: 0s - loss: 0.3697 - accuracy: 0.899732/32 [==============================] - 0s 5ms/step - loss: 0.3650 - accuracy: 0.9013 - val_loss: 0.4908 - val_accuracy: 0.9023
Epoch 13/20
 1/32 [..............................] - ETA: 0s - loss: 0.3207 - accuracy: 0.916020/32 [=================>............] - ETA: 0s - loss: 0.3173 - accuracy: 0.913532/32 [==============================] - 0s 5ms/step - loss: 0.3185 - accuracy: 0.9129 - val_loss: 0.4719 - val_accuracy: 0.9036
Epoch 14/20
 1/32 [..............................] - ETA: 0s - loss: 0.2899 - accuracy: 0.916020/32 [=================>............] - ETA: 0s - loss: 0.2973 - accuracy: 0.916132/32 [==============================] - 0s 5ms/step - loss: 0.2964 - accuracy: 0.9165 - val_loss: 0.4604 - val_accuracy: 0.9090
Epoch 15/20
 1/32 [..............................] - ETA: 0s - loss: 0.2982 - accuracy: 0.920020/32 [=================>............] - ETA: 0s - loss: 0.2780 - accuracy: 0.920532/32 [==============================] - 0s 5ms/step - loss: 0.2752 - accuracy: 0.9211 - val_loss: 0.4347 - val_accuracy: 0.9147
Epoch 16/20
 1/32 [..............................] - ETA: 0s - loss: 0.1905 - accuracy: 0.936720/32 [=================>............] - ETA: 0s - loss: 0.2375 - accuracy: 0.928032/32 [==============================] - 0s 5ms/step - loss: 0.2410 - accuracy: 0.9278 - val_loss: 0.4260 - val_accuracy: 0.9193
Epoch 17/20
 1/32 [..............................] - ETA: 0s - loss: 0.2039 - accuracy: 0.938020/32 [=================>............] - ETA: 0s - loss: 0.2212 - accuracy: 0.932432/32 [==============================] - 0s 5ms/step - loss: 0.2255 - accuracy: 0.9316 - val_loss: 0.4139 - val_accuracy: 0.9220
Epoch 18/20
 1/32 [..............................] - ETA: 0s - loss: 0.1925 - accuracy: 0.936719/32 [================>.............] - ETA: 0s - loss: 0.2058 - accuracy: 0.936932/32 [==============================] - 0s 5ms/step - loss: 0.2076 - accuracy: 0.9367 - val_loss: 0.4089 - val_accuracy: 0.9261
Epoch 19/20
 1/32 [..............................] - ETA: 0s - loss: 0.1914 - accuracy: 0.939320/32 [=================>............] - ETA: 0s - loss: 0.2030 - accuracy: 0.939332/32 [==============================] - 0s 5ms/step - loss: 0.2017 - accuracy: 0.9392 - val_loss: 0.4024 - val_accuracy: 0.9261
Epoch 20/20
 1/32 [..............................] - ETA: 0s - loss: 0.1759 - accuracy: 0.948020/32 [=================>............] - ETA: 0s - loss: 0.1802 - accuracy: 0.944632/32 [==============================] - 0s 5ms/step - loss: 0.1829 - accuracy: 0.9438 - val_loss: 0.3952 - val_accuracy: 0.9274
training_time: 0:00:04.368158
  1/313 [..............................] - ETA: 48s - loss: 0.1523 - accuracy: 0.9375 20/313 [>.............................] - ETA: 0s - loss: 0.3935 - accuracy: 0.9016  39/313 [==>...........................] - ETA: 0s - loss: 0.4483 - accuracy: 0.8990 58/313 [====>.........................] - ETA: 0s - loss: 0.4622 - accuracy: 0.8971 77/313 [======>.......................] - ETA: 0s - loss: 0.4894 - accuracy: 0.8953 96/313 [========>.....................] - ETA: 0s - loss: 0.4581 - accuracy: 0.9027115/313 [==========>...................] - ETA: 0s - loss: 0.4518 - accuracy: 0.9068134/313 [===========>..................] - ETA: 0s - loss: 0.4956 - accuracy: 0.9030153/313 [=============>................] - ETA: 0s - loss: 0.4966 - accuracy: 0.9024172/313 [===============>..............] - ETA: 0s - loss: 0.4648 - accuracy: 0.9090191/313 [=================>............] - ETA: 0s - loss: 0.4476 - accuracy: 0.9108210/313 [===================>..........] - ETA: 0s - loss: 0.4338 - accuracy: 0.9138229/313 [====================>.........] - ETA: 0s - loss: 0.4138 - accuracy: 0.9181248/313 [======================>.......] - ETA: 0s - loss: 0.3971 - accuracy: 0.9206268/313 [========================>.....] - ETA: 0s - loss: 0.3931 - accuracy: 0.9214287/313 [==========================>...] - ETA: 0s - loss: 0.3925 - accuracy: 0.9254307/313 [============================>.] - ETA: 0s - loss: 0.3872 - accuracy: 0.9263313/313 [==============================] - 1s 3ms/step - loss: 0.3907 - accuracy: 0.9253
Test results: Loss = 0.3907063901424408, Accuracy = 0.9253000020980835
