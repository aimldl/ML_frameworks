Number of devices: 6
batch_size_per_replica: 128
batch_size: 768 = 128 * 6
Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/train-labels-idx1-ubyte.gz
 8192/29515 [=======>......................] - ETA: 0s32768/29515 [=================================] - 0s 0us/step
Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/train-images-idx3-ubyte.gz
    8192/26421880 [..............................] - ETA: 0s  778240/26421880 [..............................] - ETA: 1s 2154496/26421880 [=>............................] - ETA: 1s 4063232/26421880 [===>..........................] - ETA: 0s 4202496/26421880 [===>..........................] - ETA: 3s 7528448/26421880 [=======>......................] - ETA: 1s12148736/26421880 [============>.................] - ETA: 0s19324928/26421880 [====================>.........] - ETA: 0s26427392/26421880 [==============================] - 1s 0us/step
Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/t10k-labels-idx1-ubyte.gz
8192/5148 [===============================================] - 0s 0us/step
Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/t10k-images-idx3-ubyte.gz
   8192/4422102 [..............................] - ETA: 0s3481600/4422102 [======================>.......] - ETA: 0s4423680/4422102 [==============================] - 0s 0us/step
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
x_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
<class 'numpy.ndarray'> <class 'numpy.ndarray'>
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 26, 26, 32)        320       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 13, 13, 32)        0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 11, 11, 64)        18496     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 5, 5, 64)          0         
_________________________________________________________________
flatten (Flatten)            (None, 1600)              0         
_________________________________________________________________
dropout (Dropout)            (None, 1600)              0         
_________________________________________________________________
dense (Dense)                (None, 10)                16010     
=================================================================
Total params: 34,826
Trainable params: 34,826
Non-trainable params: 0
_________________________________________________________________
Epoch 1/15
 1/71 [..............................] - ETA: 3:04 - loss: 2.3206 - accuracy: 0.0951 2/71 [..............................] - ETA: 6s - loss: 2.3105 - accuracy: 0.1107   3/71 [>.............................] - ETA: 5s - loss: 2.3023 - accuracy: 0.1250 4/71 [>.............................] - ETA: 5s - loss: 2.2943 - accuracy: 0.1388 6/71 [=>............................] - ETA: 4s - loss: 2.2790 - accuracy: 0.162615/71 [=====>........................] - ETA: 1s - loss: 2.1984 - accuracy: 0.242624/71 [=========>....................] - ETA: 0s - loss: 2.0884 - accuracy: 0.299833/71 [============>.................] - ETA: 0s - loss: 1.9746 - accuracy: 0.342842/71 [================>.............] - ETA: 0s - loss: 1.8727 - accuracy: 0.377151/71 [====================>.........] - ETA: 0s - loss: 1.7835 - accuracy: 0.405960/71 [========================>.....] - ETA: 0s - loss: 1.7060 - accuracy: 0.430669/71 [============================>.] - ETA: 0s - loss: 1.6384 - accuracy: 0.451971/71 [==============================] - ETA: 0s - loss: 1.6246 - accuracy: 0.456371/71 [==============================] - 4s 19ms/step - loss: 1.6180 - accuracy: 0.4584 - val_loss: 0.6081 - val_accuracy: 0.7660
Epoch 2/15
 1/71 [..............................] - ETA: 0s - loss: 0.6937 - accuracy: 0.7513 8/71 [==>...........................] - ETA: 0s - loss: 0.6708 - accuracy: 0.754915/71 [=====>........................] - ETA: 0s - loss: 0.6567 - accuracy: 0.759823/71 [========>.....................] - ETA: 0s - loss: 0.6490 - accuracy: 0.762930/71 [===========>..................] - ETA: 0s - loss: 0.6440 - accuracy: 0.764735/71 [=============>................] - ETA: 0s - loss: 0.6409 - accuracy: 0.765943/71 [=================>............] - ETA: 0s - loss: 0.6361 - accuracy: 0.767648/71 [===================>..........] - ETA: 0s - loss: 0.6336 - accuracy: 0.768550/71 [====================>.........] - ETA: 0s - loss: 0.6326 - accuracy: 0.768853/71 [=====================>........] - ETA: 0s - loss: 0.6313 - accuracy: 0.769356/71 [======================>.......] - ETA: 0s - loss: 0.6300 - accuracy: 0.769857/71 [=======================>......] - ETA: 0s - loss: 0.6295 - accuracy: 0.769958/71 [=======================>......] - ETA: 0s - loss: 0.6291 - accuracy: 0.770159/71 [=======================>......] - ETA: 0s - loss: 0.6287 - accuracy: 0.770261/71 [========================>.....] - ETA: 0s - loss: 0.6278 - accuracy: 0.770564/71 [==========================>...] - ETA: 0s - loss: 0.6265 - accuracy: 0.771068/71 [===========================>..] - ETA: 0s - loss: 0.6249 - accuracy: 0.771671/71 [==============================] - ETA: 0s - loss: 0.6238 - accuracy: 0.772071/71 [==============================] - 1s 18ms/step - loss: 0.6234 - accuracy: 0.7721 - val_loss: 0.4926 - val_accuracy: 0.8227
Epoch 3/15
 1/71 [..............................] - ETA: 0s - loss: 0.5392 - accuracy: 0.8021 8/71 [==>...........................] - ETA: 0s - loss: 0.5529 - accuracy: 0.801415/71 [=====>........................] - ETA: 0s - loss: 0.5480 - accuracy: 0.802820/71 [=======>......................] - ETA: 0s - loss: 0.5436 - accuracy: 0.804125/71 [=========>....................] - ETA: 0s - loss: 0.5403 - accuracy: 0.805127/71 [==========>...................] - ETA: 0s - loss: 0.5392 - accuracy: 0.805434/71 [=============>................] - ETA: 0s - loss: 0.5359 - accuracy: 0.806641/71 [================>.............] - ETA: 0s - loss: 0.5335 - accuracy: 0.807547/71 [==================>...........] - ETA: 0s - loss: 0.5317 - accuracy: 0.808253/71 [=====================>........] - ETA: 0s - loss: 0.5302 - accuracy: 0.808762/71 [=========================>....] - ETA: 0s - loss: 0.5282 - accuracy: 0.809571/71 [==============================] - ETA: 0s - loss: 0.5262 - accuracy: 0.810271/71 [==============================] - 1s 11ms/step - loss: 0.5260 - accuracy: 0.8103 - val_loss: 0.4397 - val_accuracy: 0.8435
Epoch 4/15
 1/71 [..............................] - ETA: 0s - loss: 0.4606 - accuracy: 0.8333 9/71 [==>...........................] - ETA: 0s - loss: 0.4751 - accuracy: 0.831813/71 [====>.........................] - ETA: 0s - loss: 0.4734 - accuracy: 0.831417/71 [======>.......................] - ETA: 0s - loss: 0.4739 - accuracy: 0.830825/71 [=========>....................] - ETA: 0s - loss: 0.4744 - accuracy: 0.830130/71 [===========>..................] - ETA: 0s - loss: 0.4743 - accuracy: 0.830034/71 [=============>................] - ETA: 0s - loss: 0.4744 - accuracy: 0.829943/71 [=================>............] - ETA: 0s - loss: 0.4749 - accuracy: 0.829648/71 [===================>..........] - ETA: 0s - loss: 0.4748 - accuracy: 0.829652/71 [====================>.........] - ETA: 0s - loss: 0.4747 - accuracy: 0.829655/71 [======================>.......] - ETA: 0s - loss: 0.4746 - accuracy: 0.829662/71 [=========================>....] - ETA: 0s - loss: 0.4743 - accuracy: 0.829864/71 [==========================>...] - ETA: 0s - loss: 0.4741 - accuracy: 0.829868/71 [===========================>..] - ETA: 0s - loss: 0.4738 - accuracy: 0.829971/71 [==============================] - ETA: 0s - loss: 0.4735 - accuracy: 0.830071/71 [==============================] - 1s 16ms/step - loss: 0.4734 - accuracy: 0.8301 - val_loss: 0.4208 - val_accuracy: 0.8485
Epoch 5/15
 1/71 [..............................] - ETA: 0s - loss: 0.4453 - accuracy: 0.8464 7/71 [=>............................] - ETA: 0s - loss: 0.4353 - accuracy: 0.846614/71 [====>.........................] - ETA: 0s - loss: 0.4396 - accuracy: 0.843822/71 [========>.....................] - ETA: 0s - loss: 0.4397 - accuracy: 0.843629/71 [===========>..................] - ETA: 0s - loss: 0.4395 - accuracy: 0.843431/71 [============>.................] - ETA: 0s - loss: 0.4394 - accuracy: 0.843538/71 [===============>..............] - ETA: 0s - loss: 0.4391 - accuracy: 0.843646/71 [==================>...........] - ETA: 0s - loss: 0.4391 - accuracy: 0.843552/71 [====================>.........] - ETA: 0s - loss: 0.4395 - accuracy: 0.843357/71 [=======================>......] - ETA: 0s - loss: 0.4398 - accuracy: 0.843266/71 [==========================>...] - ETA: 0s - loss: 0.4400 - accuracy: 0.843071/71 [==============================] - ETA: 0s - loss: 0.4401 - accuracy: 0.843071/71 [==============================] - 1s 10ms/step - loss: 0.4401 - accuracy: 0.8430 - val_loss: 0.3889 - val_accuracy: 0.8635
Epoch 6/15
 1/71 [..............................] - ETA: 0s - loss: 0.3773 - accuracy: 0.868510/71 [===>..........................] - ETA: 0s - loss: 0.4088 - accuracy: 0.855619/71 [=======>......................] - ETA: 0s - loss: 0.4147 - accuracy: 0.852728/71 [==========>...................] - ETA: 0s - loss: 0.4189 - accuracy: 0.850837/71 [==============>...............] - ETA: 0s - loss: 0.4209 - accuracy: 0.850046/71 [==================>...........] - ETA: 0s - loss: 0.4214 - accuracy: 0.849755/71 [======================>.......] - ETA: 0s - loss: 0.4214 - accuracy: 0.849764/71 [==========================>...] - ETA: 0s - loss: 0.4211 - accuracy: 0.849871/71 [==============================] - ETA: 0s - loss: 0.4209 - accuracy: 0.849871/71 [==============================] - 1s 8ms/step - loss: 0.4209 - accuracy: 0.8498 - val_loss: 0.3768 - val_accuracy: 0.8668
Epoch 7/15
 1/71 [..............................] - ETA: 0s - loss: 0.4133 - accuracy: 0.860710/71 [===>..........................] - ETA: 0s - loss: 0.3960 - accuracy: 0.865319/71 [=======>......................] - ETA: 0s - loss: 0.3969 - accuracy: 0.864428/71 [==========>...................] - ETA: 0s - loss: 0.3973 - accuracy: 0.863534/71 [=============>................] - ETA: 0s - loss: 0.3973 - accuracy: 0.863241/71 [================>.............] - ETA: 0s - loss: 0.3973 - accuracy: 0.862750/71 [====================>.........] - ETA: 0s - loss: 0.3973 - accuracy: 0.862256/71 [======================>.......] - ETA: 0s - loss: 0.3972 - accuracy: 0.862064/71 [==========================>...] - ETA: 0s - loss: 0.3974 - accuracy: 0.861769/71 [============================>.] - ETA: 0s - loss: 0.3976 - accuracy: 0.861471/71 [==============================] - 1s 9ms/step - loss: 0.3977 - accuracy: 0.8612 - val_loss: 0.3621 - val_accuracy: 0.8715
Epoch 8/15
 1/71 [..............................] - ETA: 0s - loss: 0.3934 - accuracy: 0.8607 5/71 [=>............................] - ETA: 1s - loss: 0.3785 - accuracy: 0.867210/71 [===>..........................] - ETA: 0s - loss: 0.3806 - accuracy: 0.866211/71 [===>..........................] - ETA: 1s - loss: 0.3813 - accuracy: 0.865912/71 [====>.........................] - ETA: 1s - loss: 0.3819 - accuracy: 0.865614/71 [====>.........................] - ETA: 1s - loss: 0.3821 - accuracy: 0.865619/71 [=======>......................] - ETA: 1s - loss: 0.3841 - accuracy: 0.865324/71 [=========>....................] - ETA: 0s - loss: 0.3862 - accuracy: 0.864629/71 [===========>..................] - ETA: 0s - loss: 0.3872 - accuracy: 0.864236/71 [==============>...............] - ETA: 0s - loss: 0.3878 - accuracy: 0.863942/71 [================>.............] - ETA: 0s - loss: 0.3882 - accuracy: 0.863749/71 [===================>..........] - ETA: 0s - loss: 0.3886 - accuracy: 0.863554/71 [=====================>........] - ETA: 0s - loss: 0.3889 - accuracy: 0.863361/71 [========================>.....] - ETA: 0s - loss: 0.3891 - accuracy: 0.863170/71 [============================>.] - ETA: 0s - loss: 0.3894 - accuracy: 0.863071/71 [==============================] - 1s 13ms/step - loss: 0.3895 - accuracy: 0.8630 - val_loss: 0.3492 - val_accuracy: 0.8745
Epoch 9/15
 1/71 [..............................] - ETA: 0s - loss: 0.4034 - accuracy: 0.860710/71 [===>..........................] - ETA: 0s - loss: 0.3980 - accuracy: 0.862819/71 [=======>......................] - ETA: 0s - loss: 0.3920 - accuracy: 0.864428/71 [==========>...................] - ETA: 0s - loss: 0.3881 - accuracy: 0.865135/71 [=============>................] - ETA: 0s - loss: 0.3867 - accuracy: 0.865343/71 [=================>............] - ETA: 0s - loss: 0.3854 - accuracy: 0.865651/71 [====================>.........] - ETA: 0s - loss: 0.3844 - accuracy: 0.865757/71 [=======================>......] - ETA: 0s - loss: 0.3838 - accuracy: 0.865765/71 [==========================>...] - ETA: 0s - loss: 0.3830 - accuracy: 0.865871/71 [==============================] - 1s 8ms/step - loss: 0.3826 - accuracy: 0.8658 - val_loss: 0.3439 - val_accuracy: 0.8757
Epoch 10/15
 1/71 [..............................] - ETA: 1s - loss: 0.3654 - accuracy: 0.8737 7/71 [=>............................] - ETA: 0s - loss: 0.3556 - accuracy: 0.875614/71 [====>.........................] - ETA: 0s - loss: 0.3606 - accuracy: 0.874422/71 [========>.....................] - ETA: 0s - loss: 0.3660 - accuracy: 0.872531/71 [============>.................] - ETA: 0s - loss: 0.3674 - accuracy: 0.871740/71 [===============>..............] - ETA: 0s - loss: 0.3672 - accuracy: 0.871549/71 [===================>..........] - ETA: 0s - loss: 0.3671 - accuracy: 0.871454/71 [=====================>........] - ETA: 0s - loss: 0.3670 - accuracy: 0.871361/71 [========================>.....] - ETA: 0s - loss: 0.3670 - accuracy: 0.871166/71 [==========================>...] - ETA: 0s - loss: 0.3672 - accuracy: 0.871070/71 [============================>.] - ETA: 0s - loss: 0.3673 - accuracy: 0.870871/71 [==============================] - 1s 10ms/step - loss: 0.3674 - accuracy: 0.8708 - val_loss: 0.3382 - val_accuracy: 0.8803
Epoch 11/15
 1/71 [..............................] - ETA: 0s - loss: 0.3608 - accuracy: 0.8789 9/71 [==>...........................] - ETA: 0s - loss: 0.3699 - accuracy: 0.875518/71 [======>.......................] - ETA: 0s - loss: 0.3722 - accuracy: 0.872627/71 [==========>...................] - ETA: 0s - loss: 0.3704 - accuracy: 0.872435/71 [=============>................] - ETA: 0s - loss: 0.3696 - accuracy: 0.871944/71 [=================>............] - ETA: 0s - loss: 0.3686 - accuracy: 0.871853/71 [=====================>........] - ETA: 0s - loss: 0.3674 - accuracy: 0.871862/71 [=========================>....] - ETA: 0s - loss: 0.3662 - accuracy: 0.871971/71 [==============================] - ETA: 0s - loss: 0.3654 - accuracy: 0.871971/71 [==============================] - 1s 7ms/step - loss: 0.3653 - accuracy: 0.8719 - val_loss: 0.3280 - val_accuracy: 0.8850
Epoch 12/15
 1/71 [..............................] - ETA: 0s - loss: 0.3407 - accuracy: 0.882810/71 [===>..........................] - ETA: 0s - loss: 0.3470 - accuracy: 0.879418/71 [======>.......................] - ETA: 0s - loss: 0.3480 - accuracy: 0.878024/71 [=========>....................] - ETA: 0s - loss: 0.3484 - accuracy: 0.877033/71 [============>.................] - ETA: 0s - loss: 0.3492 - accuracy: 0.876141/71 [================>.............] - ETA: 0s - loss: 0.3498 - accuracy: 0.875747/71 [==================>...........] - ETA: 0s - loss: 0.3499 - accuracy: 0.875553/71 [=====================>........] - ETA: 0s - loss: 0.3502 - accuracy: 0.875460/71 [========================>.....] - ETA: 0s - loss: 0.3504 - accuracy: 0.875368/71 [===========================>..] - ETA: 0s - loss: 0.3506 - accuracy: 0.875171/71 [==============================] - 1s 9ms/step - loss: 0.3507 - accuracy: 0.8750 - val_loss: 0.3266 - val_accuracy: 0.8817
Epoch 13/15
 1/71 [..............................] - ETA: 0s - loss: 0.3469 - accuracy: 0.8854 9/71 [==>...........................] - ETA: 0s - loss: 0.3444 - accuracy: 0.876714/71 [====>.........................] - ETA: 0s - loss: 0.3448 - accuracy: 0.876622/71 [========>.....................] - ETA: 0s - loss: 0.3445 - accuracy: 0.876827/71 [==========>...................] - ETA: 0s - loss: 0.3446 - accuracy: 0.876735/71 [=============>................] - ETA: 0s - loss: 0.3450 - accuracy: 0.876639/71 [===============>..............] - ETA: 0s - loss: 0.3453 - accuracy: 0.876644/71 [=================>............] - ETA: 0s - loss: 0.3454 - accuracy: 0.876651/71 [====================>.........] - ETA: 0s - loss: 0.3455 - accuracy: 0.876756/71 [======================>.......] - ETA: 0s - loss: 0.3457 - accuracy: 0.876761/71 [========================>.....] - ETA: 0s - loss: 0.3458 - accuracy: 0.876767/71 [===========================>..] - ETA: 0s - loss: 0.3459 - accuracy: 0.876771/71 [==============================] - 1s 10ms/step - loss: 0.3459 - accuracy: 0.8766 - val_loss: 0.3223 - val_accuracy: 0.8833
Epoch 14/15
 1/71 [..............................] - ETA: 0s - loss: 0.3513 - accuracy: 0.8802 9/71 [==>...........................] - ETA: 0s - loss: 0.3354 - accuracy: 0.881813/71 [====>.........................] - ETA: 0s - loss: 0.3356 - accuracy: 0.880919/71 [=======>......................] - ETA: 0s - loss: 0.3367 - accuracy: 0.880028/71 [==========>...................] - ETA: 0s - loss: 0.3374 - accuracy: 0.879235/71 [=============>................] - ETA: 0s - loss: 0.3379 - accuracy: 0.879144/71 [=================>............] - ETA: 0s - loss: 0.3384 - accuracy: 0.879049/71 [===================>..........] - ETA: 0s - loss: 0.3384 - accuracy: 0.879056/71 [======================>.......] - ETA: 0s - loss: 0.3383 - accuracy: 0.879165/71 [==========================>...] - ETA: 0s - loss: 0.3380 - accuracy: 0.879271/71 [==============================] - 1s 8ms/step - loss: 0.3378 - accuracy: 0.8793 - val_loss: 0.3106 - val_accuracy: 0.8903
Epoch 15/15
 1/71 [..............................] - ETA: 0s - loss: 0.3286 - accuracy: 0.871110/71 [===>..........................] - ETA: 0s - loss: 0.3438 - accuracy: 0.876719/71 [=======>......................] - ETA: 0s - loss: 0.3427 - accuracy: 0.877328/71 [==========>...................] - ETA: 0s - loss: 0.3417 - accuracy: 0.877737/71 [==============>...............] - ETA: 0s - loss: 0.3407 - accuracy: 0.877946/71 [==================>...........] - ETA: 0s - loss: 0.3395 - accuracy: 0.878255/71 [======================>.......] - ETA: 0s - loss: 0.3383 - accuracy: 0.878664/71 [==========================>...] - ETA: 0s - loss: 0.3374 - accuracy: 0.878871/71 [==============================] - 0s 7ms/step - loss: 0.3367 - accuracy: 0.8790 - val_loss: 0.3140 - val_accuracy: 0.8865
training_time: 0:00:14.368607
Test loss: 0.3244602382183075
Test accuracy: 0.885200023651123
