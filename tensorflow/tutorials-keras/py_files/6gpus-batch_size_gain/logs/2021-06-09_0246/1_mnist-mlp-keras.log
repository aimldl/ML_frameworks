Matplotlib is building the font cache; this may take a moment.
Number of devices: 6
batch_size_per_replica: 250
batch_size: 1500 = 250 * 6
Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/mnist.npz
    8192/11490434 [..............................] - ETA: 0s 2097152/11490434 [====>.........................] - ETA: 0s 4202496/11490434 [=========>....................] - ETA: 0s10002432/11490434 [=========================>....] - ETA: 0s11493376/11490434 [==============================] - 0s 0us/step
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
60000 10000
Epoch 1/20
 1/32 [..............................] - ETA: 14:57 - loss: 192.7700 - accuracy: 0.104716/32 [==============>...............] - ETA: 0s - loss: 75.2240 - accuracy: 0.3126    32/32 [==============================] - 30s 23ms/step - loss: 49.1825 - accuracy: 0.3995 - val_loss: 1.6464 - val_accuracy: 0.4879
Epoch 2/20
 1/32 [..............................] - ETA: 0s - loss: 1.7113 - accuracy: 0.488720/32 [=================>............] - ETA: 0s - loss: 1.5845 - accuracy: 0.514632/32 [==============================] - 0s 5ms/step - loss: 1.5364 - accuracy: 0.5288 - val_loss: 1.1956 - val_accuracy: 0.6188
Epoch 3/20
 1/32 [..............................] - ETA: 0s - loss: 1.1313 - accuracy: 0.632020/32 [=================>............] - ETA: 0s - loss: 1.1807 - accuracy: 0.630432/32 [==============================] - 0s 5ms/step - loss: 1.1661 - accuracy: 0.6375 - val_loss: 0.9907 - val_accuracy: 0.6910
Epoch 4/20
 1/32 [..............................] - ETA: 0s - loss: 1.0195 - accuracy: 0.662720/32 [=================>............] - ETA: 0s - loss: 0.9975 - accuracy: 0.695532/32 [==============================] - 0s 5ms/step - loss: 0.9823 - accuracy: 0.7096 - val_loss: 0.8232 - val_accuracy: 0.7958
Epoch 5/20
 1/32 [..............................] - ETA: 0s - loss: 0.8577 - accuracy: 0.776020/32 [=================>............] - ETA: 0s - loss: 0.8348 - accuracy: 0.789132/32 [==============================] - 0s 5ms/step - loss: 0.8225 - accuracy: 0.7933 - val_loss: 0.7153 - val_accuracy: 0.8161
Epoch 6/20
 1/32 [..............................] - ETA: 0s - loss: 0.7112 - accuracy: 0.818721/32 [==================>...........] - ETA: 0s - loss: 0.7135 - accuracy: 0.819132/32 [==============================] - 0s 4ms/step - loss: 0.7033 - accuracy: 0.8216 - val_loss: 0.6194 - val_accuracy: 0.8527
Epoch 7/20
 1/32 [..............................] - ETA: 0s - loss: 0.6037 - accuracy: 0.849321/32 [==================>...........] - ETA: 0s - loss: 0.6017 - accuracy: 0.844532/32 [==============================] - 0s 4ms/step - loss: 0.5961 - accuracy: 0.8462 - val_loss: 0.5529 - val_accuracy: 0.8655
Epoch 8/20
 1/32 [..............................] - ETA: 0s - loss: 0.5070 - accuracy: 0.872721/32 [==================>...........] - ETA: 0s - loss: 0.5028 - accuracy: 0.867732/32 [==============================] - 0s 5ms/step - loss: 0.5047 - accuracy: 0.8678 - val_loss: 0.5006 - val_accuracy: 0.8798
Epoch 9/20
 1/32 [..............................] - ETA: 0s - loss: 0.4257 - accuracy: 0.887320/32 [=================>............] - ETA: 0s - loss: 0.4497 - accuracy: 0.880832/32 [==============================] - 0s 5ms/step - loss: 0.4506 - accuracy: 0.8809 - val_loss: 0.4723 - val_accuracy: 0.8918
Epoch 10/20
 1/32 [..............................] - ETA: 0s - loss: 0.3951 - accuracy: 0.896021/32 [==================>...........] - ETA: 0s - loss: 0.4089 - accuracy: 0.890832/32 [==============================] - 0s 5ms/step - loss: 0.4068 - accuracy: 0.8919 - val_loss: 0.4389 - val_accuracy: 0.8940
Epoch 11/20
 1/32 [..............................] - ETA: 0s - loss: 0.3584 - accuracy: 0.892720/32 [=================>............] - ETA: 0s - loss: 0.3545 - accuracy: 0.902732/32 [==============================] - 0s 5ms/step - loss: 0.3567 - accuracy: 0.9030 - val_loss: 0.4160 - val_accuracy: 0.9082
Epoch 12/20
 1/32 [..............................] - ETA: 0s - loss: 0.3374 - accuracy: 0.909320/32 [=================>............] - ETA: 0s - loss: 0.3418 - accuracy: 0.910032/32 [==============================] - 0s 5ms/step - loss: 0.3379 - accuracy: 0.9107 - val_loss: 0.3977 - val_accuracy: 0.9066
Epoch 13/20
 1/32 [..............................] - ETA: 0s - loss: 0.3274 - accuracy: 0.908021/32 [==================>...........] - ETA: 0s - loss: 0.3072 - accuracy: 0.916532/32 [==============================] - 0s 5ms/step - loss: 0.3048 - accuracy: 0.9171 - val_loss: 0.3742 - val_accuracy: 0.9161
Epoch 14/20
 1/32 [..............................] - ETA: 0s - loss: 0.2580 - accuracy: 0.920721/32 [==================>...........] - ETA: 0s - loss: 0.2814 - accuracy: 0.922732/32 [==============================] - 0s 5ms/step - loss: 0.2809 - accuracy: 0.9231 - val_loss: 0.3712 - val_accuracy: 0.9183
Epoch 15/20
 1/32 [..............................] - ETA: 0s - loss: 0.2529 - accuracy: 0.931321/32 [==================>...........] - ETA: 0s - loss: 0.2527 - accuracy: 0.928432/32 [==============================] - 0s 5ms/step - loss: 0.2532 - accuracy: 0.9285 - val_loss: 0.3566 - val_accuracy: 0.9261
Epoch 16/20
 1/32 [..............................] - ETA: 0s - loss: 0.2365 - accuracy: 0.935321/32 [==================>...........] - ETA: 0s - loss: 0.2339 - accuracy: 0.933432/32 [==============================] - 0s 4ms/step - loss: 0.2345 - accuracy: 0.9333 - val_loss: 0.3419 - val_accuracy: 0.9262
Epoch 17/20
 1/32 [..............................] - ETA: 0s - loss: 0.2289 - accuracy: 0.932721/32 [==================>...........] - ETA: 0s - loss: 0.2295 - accuracy: 0.933932/32 [==============================] - 0s 4ms/step - loss: 0.2267 - accuracy: 0.9345 - val_loss: 0.3401 - val_accuracy: 0.9276
Epoch 18/20
 1/32 [..............................] - ETA: 0s - loss: 0.2058 - accuracy: 0.943321/32 [==================>...........] - ETA: 0s - loss: 0.1974 - accuracy: 0.943232/32 [==============================] - 0s 4ms/step - loss: 0.1989 - accuracy: 0.9426 - val_loss: 0.3381 - val_accuracy: 0.9282
Epoch 19/20
 1/32 [..............................] - ETA: 0s - loss: 0.1756 - accuracy: 0.945320/32 [=================>............] - ETA: 0s - loss: 0.1868 - accuracy: 0.945832/32 [==============================] - 0s 4ms/step - loss: 0.1884 - accuracy: 0.9453 - val_loss: 0.3349 - val_accuracy: 0.9323
Epoch 20/20
 1/32 [..............................] - ETA: 0s - loss: 0.1638 - accuracy: 0.952020/32 [=================>............] - ETA: 0s - loss: 0.1778 - accuracy: 0.947932/32 [==============================] - 0s 5ms/step - loss: 0.1783 - accuracy: 0.9476 - val_loss: 0.3558 - val_accuracy: 0.9283
training_time: 0:00:34.030354
  1/313 [..............................] - ETA: 47s - loss: 0.1737 - accuracy: 0.9375 22/313 [=>............................] - ETA: 0s - loss: 0.3550 - accuracy: 0.9318  42/313 [===>..........................] - ETA: 0s - loss: 0.4136 - accuracy: 0.9167 62/313 [====>.........................] - ETA: 0s - loss: 0.4246 - accuracy: 0.9148 82/313 [======>.......................] - ETA: 0s - loss: 0.4483 - accuracy: 0.9108102/313 [========>.....................] - ETA: 0s - loss: 0.4353 - accuracy: 0.9145122/313 [==========>...................] - ETA: 0s - loss: 0.4554 - accuracy: 0.9139142/313 [============>.................] - ETA: 0s - loss: 0.4560 - accuracy: 0.9135162/313 [==============>...............] - ETA: 0s - loss: 0.4492 - accuracy: 0.9147182/313 [================>.............] - ETA: 0s - loss: 0.4235 - accuracy: 0.9190202/313 [==================>...........] - ETA: 0s - loss: 0.4253 - accuracy: 0.9197222/313 [====================>.........] - ETA: 0s - loss: 0.4115 - accuracy: 0.9226242/313 [======================>.......] - ETA: 0s - loss: 0.3878 - accuracy: 0.9261262/313 [========================>.....] - ETA: 0s - loss: 0.3786 - accuracy: 0.9265282/313 [==========================>...] - ETA: 0s - loss: 0.3583 - accuracy: 0.9303302/313 [===========================>..] - ETA: 0s - loss: 0.3455 - accuracy: 0.9327313/313 [==============================] - ETA: 0s - loss: 0.3558 - accuracy: 0.9299313/313 [==============================] - 1s 3ms/step - loss: 0.3558 - accuracy: 0.9299
Test results: Loss = 0.3557734489440918, Accuracy = 0.9298999905586243
