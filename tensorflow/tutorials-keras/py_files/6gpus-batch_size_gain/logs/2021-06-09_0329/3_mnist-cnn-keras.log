Number of devices: 6
batch_size_per_replica: 128
batch_size: 768 = 128 * 6
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
x_train shape: (60000, 28, 28, 1)
60000 train samples
10000 test samples
<class 'numpy.ndarray'> <class 'numpy.ndarray'>
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 26, 26, 32)        320       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 13, 13, 32)        0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 11, 11, 64)        18496     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 5, 5, 64)          0         
_________________________________________________________________
flatten (Flatten)            (None, 1600)              0         
_________________________________________________________________
dropout (Dropout)            (None, 1600)              0         
_________________________________________________________________
dense (Dense)                (None, 10)                16010     
=================================================================
Total params: 34,826
Trainable params: 34,826
Non-trainable params: 0
_________________________________________________________________
Epoch 1/15
 1/71 [..............................] - ETA: 3:03 - loss: 2.3121 - accuracy: 0.0938 2/71 [..............................] - ETA: 6s - loss: 2.3046 - accuracy: 0.1042   3/71 [>.............................] - ETA: 6s - loss: 2.2964 - accuracy: 0.1143 4/71 [>.............................] - ETA: 6s - loss: 2.2896 - accuracy: 0.1236 6/71 [=>............................] - ETA: 4s - loss: 2.2773 - accuracy: 0.1424 8/71 [==>...........................] - ETA: 4s - loss: 2.2646 - accuracy: 0.164810/71 [===>..........................] - ETA: 3s - loss: 2.2507 - accuracy: 0.188919/71 [=======>......................] - ETA: 1s - loss: 2.1717 - accuracy: 0.284128/71 [==========>...................] - ETA: 1s - loss: 2.0627 - accuracy: 0.353137/71 [==============>...............] - ETA: 0s - loss: 1.9419 - accuracy: 0.405646/71 [==================>...........] - ETA: 0s - loss: 1.8273 - accuracy: 0.447855/71 [======================>.......] - ETA: 0s - loss: 1.7242 - accuracy: 0.483164/71 [==========================>...] - ETA: 0s - loss: 1.6329 - accuracy: 0.513071/71 [==============================] - ETA: 0s - loss: 1.5695 - accuracy: 0.533471/71 [==============================] - 4s 21ms/step - loss: 1.5611 - accuracy: 0.5360 - val_loss: 0.1944 - val_accuracy: 0.9505
Epoch 2/15
 1/71 [..............................] - ETA: 0s - loss: 0.2894 - accuracy: 0.916710/71 [===>..........................] - ETA: 0s - loss: 0.3034 - accuracy: 0.911419/71 [=======>......................] - ETA: 0s - loss: 0.2954 - accuracy: 0.912528/71 [==========>...................] - ETA: 0s - loss: 0.2879 - accuracy: 0.914437/71 [==============>...............] - ETA: 0s - loss: 0.2816 - accuracy: 0.916246/71 [==================>...........] - ETA: 0s - loss: 0.2756 - accuracy: 0.918055/71 [======================>.......] - ETA: 0s - loss: 0.2703 - accuracy: 0.919664/71 [==========================>...] - ETA: 0s - loss: 0.2656 - accuracy: 0.921071/71 [==============================] - ETA: 0s - loss: 0.2622 - accuracy: 0.921971/71 [==============================] - 1s 8ms/step - loss: 0.2618 - accuracy: 0.9221 - val_loss: 0.1127 - val_accuracy: 0.9707
Epoch 3/15
 1/71 [..............................] - ETA: 0s - loss: 0.1598 - accuracy: 0.964810/71 [===>..........................] - ETA: 0s - loss: 0.1733 - accuracy: 0.952518/71 [======>.......................] - ETA: 0s - loss: 0.1756 - accuracy: 0.951127/71 [==========>...................] - ETA: 0s - loss: 0.1742 - accuracy: 0.951136/71 [==============>...............] - ETA: 0s - loss: 0.1727 - accuracy: 0.951245/71 [==================>...........] - ETA: 0s - loss: 0.1711 - accuracy: 0.951354/71 [=====================>........] - ETA: 0s - loss: 0.1695 - accuracy: 0.951662/71 [=========================>....] - ETA: 0s - loss: 0.1684 - accuracy: 0.951767/71 [===========================>..] - ETA: 0s - loss: 0.1676 - accuracy: 0.951871/71 [==============================] - ETA: 0s - loss: 0.1671 - accuracy: 0.951971/71 [==============================] - 1s 10ms/step - loss: 0.1669 - accuracy: 0.9519 - val_loss: 0.0876 - val_accuracy: 0.9768
Epoch 4/15
 1/71 [..............................] - ETA: 0s - loss: 0.1602 - accuracy: 0.9466 8/71 [==>...........................] - ETA: 0s - loss: 0.1414 - accuracy: 0.955714/71 [====>.........................] - ETA: 0s - loss: 0.1401 - accuracy: 0.956820/71 [=======>......................] - ETA: 0s - loss: 0.1375 - accuracy: 0.957925/71 [=========>....................] - ETA: 0s - loss: 0.1356 - accuracy: 0.958730/71 [===========>..................] - ETA: 0s - loss: 0.1340 - accuracy: 0.959237/71 [==============>...............] - ETA: 0s - loss: 0.1327 - accuracy: 0.959639/71 [===============>..............] - ETA: 0s - loss: 0.1324 - accuracy: 0.959741/71 [================>.............] - ETA: 0s - loss: 0.1321 - accuracy: 0.959844/71 [=================>............] - ETA: 0s - loss: 0.1317 - accuracy: 0.959945/71 [==================>...........] - ETA: 0s - loss: 0.1316 - accuracy: 0.960047/71 [==================>...........] - ETA: 0s - loss: 0.1314 - accuracy: 0.960048/71 [===================>..........] - ETA: 0s - loss: 0.1313 - accuracy: 0.960150/71 [====================>.........] - ETA: 0s - loss: 0.1310 - accuracy: 0.960153/71 [=====================>........] - ETA: 0s - loss: 0.1307 - accuracy: 0.960356/71 [======================>.......] - ETA: 0s - loss: 0.1304 - accuracy: 0.960458/71 [=======================>......] - ETA: 0s - loss: 0.1302 - accuracy: 0.960462/71 [=========================>....] - ETA: 0s - loss: 0.1298 - accuracy: 0.960664/71 [==========================>...] - ETA: 0s - loss: 0.1296 - accuracy: 0.960765/71 [==========================>...] - ETA: 0s - loss: 0.1295 - accuracy: 0.960768/71 [===========================>..] - ETA: 0s - loss: 0.1293 - accuracy: 0.960870/71 [============================>.] - ETA: 0s - loss: 0.1291 - accuracy: 0.960871/71 [==============================] - ETA: 0s - loss: 0.1291 - accuracy: 0.960971/71 [==============================] - 2s 23ms/step - loss: 0.1290 - accuracy: 0.9609 - val_loss: 0.0717 - val_accuracy: 0.9787
Epoch 5/15
 1/71 [..............................] - ETA: 0s - loss: 0.1072 - accuracy: 0.9701 4/71 [>.............................] - ETA: 1s - loss: 0.1068 - accuracy: 0.9699 6/71 [=>............................] - ETA: 1s - loss: 0.1076 - accuracy: 0.9693 9/71 [==>...........................] - ETA: 1s - loss: 0.1082 - accuracy: 0.968711/71 [===>..........................] - ETA: 1s - loss: 0.1083 - accuracy: 0.968418/71 [======>.......................] - ETA: 0s - loss: 0.1094 - accuracy: 0.967921/71 [=======>......................] - ETA: 0s - loss: 0.1097 - accuracy: 0.967728/71 [==========>...................] - ETA: 0s - loss: 0.1106 - accuracy: 0.967431/71 [============>.................] - ETA: 0s - loss: 0.1106 - accuracy: 0.967434/71 [=============>................] - ETA: 0s - loss: 0.1106 - accuracy: 0.967342/71 [================>.............] - ETA: 0s - loss: 0.1100 - accuracy: 0.967448/71 [===================>..........] - ETA: 0s - loss: 0.1096 - accuracy: 0.967555/71 [======================>.......] - ETA: 0s - loss: 0.1093 - accuracy: 0.967564/71 [==========================>...] - ETA: 0s - loss: 0.1090 - accuracy: 0.967571/71 [==============================] - ETA: 0s - loss: 0.1087 - accuracy: 0.967571/71 [==============================] - 1s 15ms/step - loss: 0.1087 - accuracy: 0.9675 - val_loss: 0.0626 - val_accuracy: 0.9823
Epoch 6/15
 1/71 [..............................] - ETA: 0s - loss: 0.0875 - accuracy: 0.9792 9/71 [==>...........................] - ETA: 0s - loss: 0.0885 - accuracy: 0.973116/71 [=====>........................] - ETA: 0s - loss: 0.0898 - accuracy: 0.972718/71 [======>.......................] - ETA: 0s - loss: 0.0903 - accuracy: 0.972725/71 [=========>....................] - ETA: 0s - loss: 0.0916 - accuracy: 0.972232/71 [============>.................] - ETA: 0s - loss: 0.0924 - accuracy: 0.972035/71 [=============>................] - ETA: 0s - loss: 0.0926 - accuracy: 0.971939/71 [===============>..............] - ETA: 0s - loss: 0.0930 - accuracy: 0.971944/71 [=================>............] - ETA: 0s - loss: 0.0933 - accuracy: 0.971848/71 [===================>..........] - ETA: 0s - loss: 0.0936 - accuracy: 0.971755/71 [======================>.......] - ETA: 0s - loss: 0.0939 - accuracy: 0.971659/71 [=======================>......] - ETA: 0s - loss: 0.0939 - accuracy: 0.971662/71 [=========================>....] - ETA: 0s - loss: 0.0939 - accuracy: 0.971665/71 [==========================>...] - ETA: 0s - loss: 0.0939 - accuracy: 0.971668/71 [===========================>..] - ETA: 0s - loss: 0.0939 - accuracy: 0.971671/71 [==============================] - ETA: 0s - loss: 0.0939 - accuracy: 0.971671/71 [==============================] - 1s 15ms/step - loss: 0.0939 - accuracy: 0.9716 - val_loss: 0.0550 - val_accuracy: 0.9847
Epoch 7/15
 1/71 [..............................] - ETA: 0s - loss: 0.1040 - accuracy: 0.971410/71 [===>..........................] - ETA: 0s - loss: 0.0834 - accuracy: 0.975318/71 [======>.......................] - ETA: 0s - loss: 0.0798 - accuracy: 0.976327/71 [==========>...................] - ETA: 0s - loss: 0.0790 - accuracy: 0.976531/71 [============>.................] - ETA: 0s - loss: 0.0793 - accuracy: 0.976437/71 [==============>...............] - ETA: 0s - loss: 0.0798 - accuracy: 0.976244/71 [=================>............] - ETA: 0s - loss: 0.0803 - accuracy: 0.975952/71 [====================>.........] - ETA: 0s - loss: 0.0807 - accuracy: 0.975858/71 [=======================>......] - ETA: 0s - loss: 0.0809 - accuracy: 0.975765/71 [==========================>...] - ETA: 0s - loss: 0.0812 - accuracy: 0.975671/71 [==============================] - ETA: 0s - loss: 0.0814 - accuracy: 0.975671/71 [==============================] - 1s 11ms/step - loss: 0.0814 - accuracy: 0.9756 - val_loss: 0.0505 - val_accuracy: 0.9873
Epoch 8/15
 1/71 [..............................] - ETA: 0s - loss: 0.0599 - accuracy: 0.981810/71 [===>..........................] - ETA: 0s - loss: 0.0714 - accuracy: 0.977219/71 [=======>......................] - ETA: 0s - loss: 0.0725 - accuracy: 0.977128/71 [==========>...................] - ETA: 0s - loss: 0.0727 - accuracy: 0.977332/71 [============>.................] - ETA: 0s - loss: 0.0729 - accuracy: 0.977438/71 [===============>..............] - ETA: 0s - loss: 0.0731 - accuracy: 0.977446/71 [==================>...........] - ETA: 0s - loss: 0.0735 - accuracy: 0.977451/71 [====================>.........] - ETA: 0s - loss: 0.0738 - accuracy: 0.977358/71 [=======================>......] - ETA: 0s - loss: 0.0742 - accuracy: 0.977364/71 [==========================>...] - ETA: 0s - loss: 0.0745 - accuracy: 0.977271/71 [==============================] - ETA: 0s - loss: 0.0746 - accuracy: 0.977271/71 [==============================] - 1s 10ms/step - loss: 0.0746 - accuracy: 0.9771 - val_loss: 0.0498 - val_accuracy: 0.9872
Epoch 9/15
 1/71 [..............................] - ETA: 0s - loss: 0.0549 - accuracy: 0.985710/71 [===>..........................] - ETA: 0s - loss: 0.0656 - accuracy: 0.980419/71 [=======>......................] - ETA: 0s - loss: 0.0692 - accuracy: 0.978725/71 [=========>....................] - ETA: 0s - loss: 0.0701 - accuracy: 0.978534/71 [=============>................] - ETA: 0s - loss: 0.0708 - accuracy: 0.978242/71 [================>.............] - ETA: 0s - loss: 0.0709 - accuracy: 0.978251/71 [====================>.........] - ETA: 0s - loss: 0.0710 - accuracy: 0.978260/71 [========================>.....] - ETA: 0s - loss: 0.0710 - accuracy: 0.978269/71 [============================>.] - ETA: 0s - loss: 0.0710 - accuracy: 0.978371/71 [==============================] - 1s 8ms/step - loss: 0.0710 - accuracy: 0.9783 - val_loss: 0.0453 - val_accuracy: 0.9877
Epoch 10/15
 1/71 [..............................] - ETA: 0s - loss: 0.0741 - accuracy: 0.9753 6/71 [=>............................] - ETA: 0s - loss: 0.0679 - accuracy: 0.977712/71 [====>.........................] - ETA: 0s - loss: 0.0673 - accuracy: 0.978320/71 [=======>......................] - ETA: 0s - loss: 0.0678 - accuracy: 0.978529/71 [===========>..................] - ETA: 0s - loss: 0.0674 - accuracy: 0.978731/71 [============>.................] - ETA: 0s - loss: 0.0673 - accuracy: 0.978836/71 [==============>...............] - ETA: 0s - loss: 0.0673 - accuracy: 0.978942/71 [================>.............] - ETA: 0s - loss: 0.0672 - accuracy: 0.978951/71 [====================>.........] - ETA: 0s - loss: 0.0671 - accuracy: 0.979060/71 [========================>.....] - ETA: 0s - loss: 0.0671 - accuracy: 0.979069/71 [============================>.] - ETA: 0s - loss: 0.0671 - accuracy: 0.979071/71 [==============================] - 1s 10ms/step - loss: 0.0671 - accuracy: 0.9790 - val_loss: 0.0436 - val_accuracy: 0.9875
Epoch 11/15
 1/71 [..............................] - ETA: 0s - loss: 0.0588 - accuracy: 0.9831 5/71 [=>............................] - ETA: 0s - loss: 0.0693 - accuracy: 0.979014/71 [====>.........................] - ETA: 0s - loss: 0.0686 - accuracy: 0.979023/71 [========>.....................] - ETA: 0s - loss: 0.0659 - accuracy: 0.979732/71 [============>.................] - ETA: 0s - loss: 0.0646 - accuracy: 0.979941/71 [================>.............] - ETA: 0s - loss: 0.0638 - accuracy: 0.980147/71 [==================>...........] - ETA: 0s - loss: 0.0635 - accuracy: 0.980249/71 [===================>..........] - ETA: 0s - loss: 0.0635 - accuracy: 0.980255/71 [======================>.......] - ETA: 0s - loss: 0.0634 - accuracy: 0.980260/71 [========================>.....] - ETA: 0s - loss: 0.0635 - accuracy: 0.980265/71 [==========================>...] - ETA: 0s - loss: 0.0634 - accuracy: 0.980270/71 [============================>.] - ETA: 0s - loss: 0.0634 - accuracy: 0.980371/71 [==============================] - 1s 12ms/step - loss: 0.0634 - accuracy: 0.9803 - val_loss: 0.0420 - val_accuracy: 0.9895
Epoch 12/15
 1/71 [..............................] - ETA: 1s - loss: 0.0451 - accuracy: 0.9857 5/71 [=>............................] - ETA: 1s - loss: 0.0521 - accuracy: 0.984110/71 [===>..........................] - ETA: 0s - loss: 0.0546 - accuracy: 0.983517/71 [======>.......................] - ETA: 0s - loss: 0.0557 - accuracy: 0.983222/71 [========>.....................] - ETA: 0s - loss: 0.0561 - accuracy: 0.983028/71 [==========>...................] - ETA: 0s - loss: 0.0565 - accuracy: 0.982830/71 [===========>..................] - ETA: 0s - loss: 0.0566 - accuracy: 0.982733/71 [============>.................] - ETA: 0s - loss: 0.0567 - accuracy: 0.982737/71 [==============>...............] - ETA: 0s - loss: 0.0569 - accuracy: 0.982739/71 [===============>..............] - ETA: 0s - loss: 0.0569 - accuracy: 0.982643/71 [=================>............] - ETA: 0s - loss: 0.0570 - accuracy: 0.982646/71 [==================>...........] - ETA: 0s - loss: 0.0570 - accuracy: 0.982648/71 [===================>..........] - ETA: 0s - loss: 0.0570 - accuracy: 0.982652/71 [====================>.........] - ETA: 0s - loss: 0.0570 - accuracy: 0.982655/71 [======================>.......] - ETA: 0s - loss: 0.0570 - accuracy: 0.982658/71 [=======================>......] - ETA: 0s - loss: 0.0570 - accuracy: 0.982562/71 [=========================>....] - ETA: 0s - loss: 0.0571 - accuracy: 0.982567/71 [===========================>..] - ETA: 0s - loss: 0.0571 - accuracy: 0.982571/71 [==============================] - 1s 19ms/step - loss: 0.0571 - accuracy: 0.9825 - val_loss: 0.0407 - val_accuracy: 0.9897
Epoch 13/15
 1/71 [..............................] - ETA: 0s - loss: 0.0690 - accuracy: 0.983110/71 [===>..........................] - ETA: 0s - loss: 0.0597 - accuracy: 0.982418/71 [======>.......................] - ETA: 0s - loss: 0.0588 - accuracy: 0.982223/71 [========>.....................] - ETA: 0s - loss: 0.0588 - accuracy: 0.982031/71 [============>.................] - ETA: 0s - loss: 0.0587 - accuracy: 0.981935/71 [=============>................] - ETA: 0s - loss: 0.0586 - accuracy: 0.981939/71 [===============>..............] - ETA: 0s - loss: 0.0585 - accuracy: 0.981944/71 [=================>............] - ETA: 0s - loss: 0.0584 - accuracy: 0.981948/71 [===================>..........] - ETA: 0s - loss: 0.0583 - accuracy: 0.981954/71 [=====================>........] - ETA: 0s - loss: 0.0581 - accuracy: 0.981958/71 [=======================>......] - ETA: 0s - loss: 0.0580 - accuracy: 0.981964/71 [==========================>...] - ETA: 0s - loss: 0.0578 - accuracy: 0.981971/71 [==============================] - 1s 11ms/step - loss: 0.0577 - accuracy: 0.9819 - val_loss: 0.0402 - val_accuracy: 0.9882
Epoch 14/15
 1/71 [..............................] - ETA: 0s - loss: 0.0272 - accuracy: 0.989610/71 [===>..........................] - ETA: 0s - loss: 0.0506 - accuracy: 0.984319/71 [=======>......................] - ETA: 0s - loss: 0.0518 - accuracy: 0.983925/71 [=========>....................] - ETA: 0s - loss: 0.0520 - accuracy: 0.983734/71 [=============>................] - ETA: 0s - loss: 0.0525 - accuracy: 0.983543/71 [=================>............] - ETA: 0s - loss: 0.0528 - accuracy: 0.983452/71 [====================>.........] - ETA: 0s - loss: 0.0531 - accuracy: 0.983361/71 [========================>.....] - ETA: 0s - loss: 0.0532 - accuracy: 0.983370/71 [============================>.] - ETA: 0s - loss: 0.0531 - accuracy: 0.983371/71 [==============================] - 1s 8ms/step - loss: 0.0531 - accuracy: 0.9833 - val_loss: 0.0373 - val_accuracy: 0.9902
Epoch 15/15
 1/71 [..............................] - ETA: 0s - loss: 0.0548 - accuracy: 0.988310/71 [===>..........................] - ETA: 0s - loss: 0.0507 - accuracy: 0.986119/71 [=======>......................] - ETA: 0s - loss: 0.0491 - accuracy: 0.985728/71 [==========>...................] - ETA: 0s - loss: 0.0488 - accuracy: 0.985437/71 [==============>...............] - ETA: 0s - loss: 0.0490 - accuracy: 0.985246/71 [==================>...........] - ETA: 0s - loss: 0.0491 - accuracy: 0.985155/71 [======================>.......] - ETA: 0s - loss: 0.0492 - accuracy: 0.985064/71 [==========================>...] - ETA: 0s - loss: 0.0493 - accuracy: 0.984971/71 [==============================] - 0s 7ms/step - loss: 0.0494 - accuracy: 0.9849 - val_loss: 0.0353 - val_accuracy: 0.9905
training_time: 0:00:16.179675
Test loss: 0.03183140978217125
Test accuracy: 0.9890000224113464
