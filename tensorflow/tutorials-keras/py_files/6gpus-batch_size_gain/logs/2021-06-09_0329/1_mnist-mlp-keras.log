Number of devices: 6
batch_size_per_replica: 250
batch_size: 1500 = 250 * 6
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
60000 10000
Epoch 1/20
 1/32 [..............................] - ETA: 26s - loss: 108.4762 - accuracy: 0.081321/32 [==================>...........] - ETA: 0s - loss: 39.2334 - accuracy: 0.4126  32/32 [==============================] - 1s 17ms/step - loss: 30.2321 - accuracy: 0.4654 - val_loss: 1.4981 - val_accuracy: 0.5526
Epoch 2/20
 1/32 [..............................] - ETA: 0s - loss: 1.5051 - accuracy: 0.519320/32 [=================>............] - ETA: 0s - loss: 1.4082 - accuracy: 0.573332/32 [==============================] - 0s 5ms/step - loss: 1.3518 - accuracy: 0.6005 - val_loss: 1.0060 - val_accuracy: 0.7317
Epoch 3/20
 1/32 [..............................] - ETA: 0s - loss: 0.9869 - accuracy: 0.724721/32 [==================>...........] - ETA: 0s - loss: 0.9678 - accuracy: 0.726132/32 [==============================] - 0s 5ms/step - loss: 0.9488 - accuracy: 0.7345 - val_loss: 0.8246 - val_accuracy: 0.7897
Epoch 4/20
 1/32 [..............................] - ETA: 0s - loss: 0.7772 - accuracy: 0.778721/32 [==================>...........] - ETA: 0s - loss: 0.7378 - accuracy: 0.793432/32 [==============================] - 0s 5ms/step - loss: 0.7278 - accuracy: 0.7966 - val_loss: 0.6786 - val_accuracy: 0.8307
Epoch 5/20
 1/32 [..............................] - ETA: 0s - loss: 0.6075 - accuracy: 0.833320/32 [=================>............] - ETA: 0s - loss: 0.6068 - accuracy: 0.827532/32 [==============================] - 0s 4ms/step - loss: 0.5979 - accuracy: 0.8302 - val_loss: 0.5964 - val_accuracy: 0.8572
Epoch 6/20
 1/32 [..............................] - ETA: 0s - loss: 0.4295 - accuracy: 0.869321/32 [==================>...........] - ETA: 0s - loss: 0.4920 - accuracy: 0.859632/32 [==============================] - 0s 5ms/step - loss: 0.4910 - accuracy: 0.8602 - val_loss: 0.5545 - val_accuracy: 0.8691
Epoch 7/20
 1/32 [..............................] - ETA: 0s - loss: 0.3735 - accuracy: 0.880721/32 [==================>...........] - ETA: 0s - loss: 0.4198 - accuracy: 0.875032/32 [==============================] - 0s 4ms/step - loss: 0.4205 - accuracy: 0.8760 - val_loss: 0.5153 - val_accuracy: 0.8809
Epoch 8/20
 1/32 [..............................] - ETA: 0s - loss: 0.3503 - accuracy: 0.892721/32 [==================>...........] - ETA: 0s - loss: 0.3738 - accuracy: 0.889032/32 [==============================] - 0s 4ms/step - loss: 0.3720 - accuracy: 0.8894 - val_loss: 0.4900 - val_accuracy: 0.8926
Epoch 9/20
 1/32 [..............................] - ETA: 0s - loss: 0.3213 - accuracy: 0.901321/32 [==================>...........] - ETA: 0s - loss: 0.3245 - accuracy: 0.901932/32 [==============================] - 0s 4ms/step - loss: 0.3253 - accuracy: 0.9022 - val_loss: 0.4544 - val_accuracy: 0.8943
Epoch 10/20
 1/32 [..............................] - ETA: 0s - loss: 0.2795 - accuracy: 0.916721/32 [==================>...........] - ETA: 0s - loss: 0.3040 - accuracy: 0.907232/32 [==============================] - 0s 5ms/step - loss: 0.3012 - accuracy: 0.9080 - val_loss: 0.4401 - val_accuracy: 0.9052
Epoch 11/20
 1/32 [..............................] - ETA: 0s - loss: 0.2672 - accuracy: 0.910720/32 [=================>............] - ETA: 0s - loss: 0.2710 - accuracy: 0.913632/32 [==============================] - 0s 5ms/step - loss: 0.2672 - accuracy: 0.9157 - val_loss: 0.4384 - val_accuracy: 0.9053
Epoch 12/20
 1/32 [..............................] - ETA: 0s - loss: 0.2551 - accuracy: 0.914721/32 [==================>...........] - ETA: 0s - loss: 0.2422 - accuracy: 0.922832/32 [==============================] - 0s 4ms/step - loss: 0.2422 - accuracy: 0.9233 - val_loss: 0.4171 - val_accuracy: 0.9138
Epoch 13/20
 1/32 [..............................] - ETA: 0s - loss: 0.2488 - accuracy: 0.923321/32 [==================>...........] - ETA: 0s - loss: 0.2261 - accuracy: 0.929532/32 [==============================] - 0s 4ms/step - loss: 0.2239 - accuracy: 0.9298 - val_loss: 0.4074 - val_accuracy: 0.9188
Epoch 14/20
 1/32 [..............................] - ETA: 0s - loss: 0.2231 - accuracy: 0.924021/32 [==================>...........] - ETA: 0s - loss: 0.1939 - accuracy: 0.936532/32 [==============================] - 0s 4ms/step - loss: 0.1952 - accuracy: 0.9365 - val_loss: 0.3979 - val_accuracy: 0.9228
Epoch 15/20
 1/32 [..............................] - ETA: 0s - loss: 0.1736 - accuracy: 0.945321/32 [==================>...........] - ETA: 0s - loss: 0.1878 - accuracy: 0.939532/32 [==============================] - 0s 4ms/step - loss: 0.1871 - accuracy: 0.9394 - val_loss: 0.3983 - val_accuracy: 0.9238
Epoch 16/20
 1/32 [..............................] - ETA: 0s - loss: 0.1655 - accuracy: 0.945321/32 [==================>...........] - ETA: 0s - loss: 0.1677 - accuracy: 0.945332/32 [==============================] - 0s 4ms/step - loss: 0.1677 - accuracy: 0.9451 - val_loss: 0.3895 - val_accuracy: 0.9269
Epoch 17/20
 1/32 [..............................] - ETA: 0s - loss: 0.1720 - accuracy: 0.942721/32 [==================>...........] - ETA: 0s - loss: 0.1571 - accuracy: 0.948132/32 [==============================] - 0s 5ms/step - loss: 0.1569 - accuracy: 0.9482 - val_loss: 0.3770 - val_accuracy: 0.9290
Epoch 18/20
 1/32 [..............................] - ETA: 0s - loss: 0.1488 - accuracy: 0.952721/32 [==================>...........] - ETA: 0s - loss: 0.1429 - accuracy: 0.951432/32 [==============================] - 0s 5ms/step - loss: 0.1433 - accuracy: 0.9518 - val_loss: 0.3734 - val_accuracy: 0.9299
Epoch 19/20
 1/32 [..............................] - ETA: 0s - loss: 0.1325 - accuracy: 0.956722/32 [===================>..........] - ETA: 0s - loss: 0.1341 - accuracy: 0.955632/32 [==============================] - 0s 4ms/step - loss: 0.1346 - accuracy: 0.9553 - val_loss: 0.3780 - val_accuracy: 0.9323
Epoch 20/20
 1/32 [..............................] - ETA: 0s - loss: 0.1301 - accuracy: 0.958022/32 [===================>..........] - ETA: 0s - loss: 0.1271 - accuracy: 0.957832/32 [==============================] - 0s 4ms/step - loss: 0.1266 - accuracy: 0.9577 - val_loss: 0.3627 - val_accuracy: 0.9331
training_time: 0:00:04.307438
  1/313 [..............................] - ETA: 47s - loss: 0.4557 - accuracy: 0.9375 22/313 [=>............................] - ETA: 0s - loss: 0.3191 - accuracy: 0.9347  43/313 [===>..........................] - ETA: 0s - loss: 0.4692 - accuracy: 0.9142 63/313 [=====>........................] - ETA: 0s - loss: 0.5132 - accuracy: 0.9112 83/313 [======>.......................] - ETA: 0s - loss: 0.5223 - accuracy: 0.9108103/313 [========>.....................] - ETA: 0s - loss: 0.4787 - accuracy: 0.9129123/313 [==========>...................] - ETA: 0s - loss: 0.4709 - accuracy: 0.9126143/313 [============>.................] - ETA: 0s - loss: 0.4754 - accuracy: 0.9124163/313 [==============>...............] - ETA: 0s - loss: 0.4549 - accuracy: 0.9149182/313 [================>.............] - ETA: 0s - loss: 0.4218 - accuracy: 0.9203202/313 [==================>...........] - ETA: 0s - loss: 0.4130 - accuracy: 0.9208223/313 [====================>.........] - ETA: 0s - loss: 0.3973 - accuracy: 0.9240244/313 [======================>.......] - ETA: 0s - loss: 0.3744 - accuracy: 0.9282264/313 [========================>.....] - ETA: 0s - loss: 0.3698 - accuracy: 0.9279284/313 [==========================>...] - ETA: 0s - loss: 0.3508 - accuracy: 0.9309304/313 [============================>.] - ETA: 0s - loss: 0.3395 - accuracy: 0.9336313/313 [==============================] - 1s 3ms/step - loss: 0.3467 - accuracy: 0.9321
Test results: Loss = 0.34668320417404175, Accuracy = 0.9320999979972839
