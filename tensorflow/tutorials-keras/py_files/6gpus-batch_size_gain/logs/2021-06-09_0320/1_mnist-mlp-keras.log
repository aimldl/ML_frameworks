Number of devices: 6
batch_size_per_replica: 250
batch_size: 1500 = 250 * 6
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
60000 10000
Epoch 1/20
 1/32 [..............................] - ETA: 26s - loss: 93.9865 - accuracy: 0.062719/32 [================>.............] - ETA: 0s - loss: 35.6999 - accuracy: 0.4003 32/32 [==============================] - 1s 18ms/step - loss: 25.8126 - accuracy: 0.4647 - val_loss: 1.3911 - val_accuracy: 0.5549
Epoch 2/20
 1/32 [..............................] - ETA: 0s - loss: 1.3922 - accuracy: 0.542020/32 [=================>............] - ETA: 0s - loss: 1.2821 - accuracy: 0.591932/32 [==============================] - 0s 5ms/step - loss: 1.2301 - accuracy: 0.6167 - val_loss: 0.9083 - val_accuracy: 0.7946
Epoch 3/20
 1/32 [..............................] - ETA: 0s - loss: 0.9141 - accuracy: 0.780720/32 [=================>............] - ETA: 0s - loss: 0.8660 - accuracy: 0.791332/32 [==============================] - 0s 5ms/step - loss: 0.8550 - accuracy: 0.7949 - val_loss: 0.7942 - val_accuracy: 0.8214
Epoch 4/20
 1/32 [..............................] - ETA: 0s - loss: 0.7224 - accuracy: 0.831320/32 [=================>............] - ETA: 0s - loss: 0.7080 - accuracy: 0.827132/32 [==============================] - 0s 5ms/step - loss: 0.7077 - accuracy: 0.8272 - val_loss: 0.7087 - val_accuracy: 0.8277
Epoch 5/20
 1/32 [..............................] - ETA: 0s - loss: 0.6332 - accuracy: 0.822720/32 [=================>............] - ETA: 0s - loss: 0.6223 - accuracy: 0.831232/32 [==============================] - 0s 5ms/step - loss: 0.6169 - accuracy: 0.8314 - val_loss: 0.6510 - val_accuracy: 0.8279
Epoch 6/20
 1/32 [..............................] - ETA: 0s - loss: 0.5335 - accuracy: 0.823320/32 [=================>............] - ETA: 0s - loss: 0.5343 - accuracy: 0.834332/32 [==============================] - 0s 5ms/step - loss: 0.5345 - accuracy: 0.8350 - val_loss: 0.5974 - val_accuracy: 0.8449
Epoch 7/20
 1/32 [..............................] - ETA: 0s - loss: 0.4837 - accuracy: 0.844719/32 [================>.............] - ETA: 0s - loss: 0.4611 - accuracy: 0.851632/32 [==============================] - 0s 5ms/step - loss: 0.4633 - accuracy: 0.8537 - val_loss: 0.5396 - val_accuracy: 0.8611
Epoch 8/20
 1/32 [..............................] - ETA: 0s - loss: 0.4045 - accuracy: 0.868720/32 [=================>............] - ETA: 0s - loss: 0.4084 - accuracy: 0.871232/32 [==============================] - 0s 5ms/step - loss: 0.4089 - accuracy: 0.8730 - val_loss: 0.5032 - val_accuracy: 0.8735
Epoch 9/20
 1/32 [..............................] - ETA: 0s - loss: 0.3440 - accuracy: 0.880720/32 [=================>............] - ETA: 0s - loss: 0.3581 - accuracy: 0.885832/32 [==============================] - 0s 5ms/step - loss: 0.3596 - accuracy: 0.8868 - val_loss: 0.4679 - val_accuracy: 0.8909
Epoch 10/20
 1/32 [..............................] - ETA: 0s - loss: 0.2953 - accuracy: 0.896020/32 [=================>............] - ETA: 0s - loss: 0.3242 - accuracy: 0.896732/32 [==============================] - 0s 5ms/step - loss: 0.3221 - accuracy: 0.8980 - val_loss: 0.4516 - val_accuracy: 0.8925
Epoch 11/20
 1/32 [..............................] - ETA: 0s - loss: 0.3086 - accuracy: 0.890720/32 [=================>............] - ETA: 0s - loss: 0.2917 - accuracy: 0.905832/32 [==============================] - 0s 5ms/step - loss: 0.2881 - accuracy: 0.9073 - val_loss: 0.4295 - val_accuracy: 0.9068
Epoch 12/20
 1/32 [..............................] - ETA: 0s - loss: 0.2306 - accuracy: 0.921320/32 [=================>............] - ETA: 0s - loss: 0.2591 - accuracy: 0.915132/32 [==============================] - 0s 5ms/step - loss: 0.2579 - accuracy: 0.9162 - val_loss: 0.3993 - val_accuracy: 0.9104
Epoch 13/20
 1/32 [..............................] - ETA: 0s - loss: 0.2249 - accuracy: 0.928720/32 [=================>............] - ETA: 0s - loss: 0.2327 - accuracy: 0.925932/32 [==============================] - 0s 5ms/step - loss: 0.2332 - accuracy: 0.9257 - val_loss: 0.3831 - val_accuracy: 0.9189
Epoch 14/20
 1/32 [..............................] - ETA: 0s - loss: 0.1999 - accuracy: 0.940020/32 [=================>............] - ETA: 0s - loss: 0.2096 - accuracy: 0.932332/32 [==============================] - 0s 5ms/step - loss: 0.2088 - accuracy: 0.9321 - val_loss: 0.3845 - val_accuracy: 0.9175
Epoch 15/20
 1/32 [..............................] - ETA: 0s - loss: 0.2225 - accuracy: 0.928020/32 [=================>............] - ETA: 0s - loss: 0.1941 - accuracy: 0.934332/32 [==============================] - 0s 5ms/step - loss: 0.1935 - accuracy: 0.9350 - val_loss: 0.3792 - val_accuracy: 0.9275
Epoch 16/20
 1/32 [..............................] - ETA: 0s - loss: 0.1871 - accuracy: 0.944019/32 [================>.............] - ETA: 0s - loss: 0.1709 - accuracy: 0.942332/32 [==============================] - 0s 5ms/step - loss: 0.1741 - accuracy: 0.9413 - val_loss: 0.3757 - val_accuracy: 0.9261
Epoch 17/20
 1/32 [..............................] - ETA: 0s - loss: 0.1589 - accuracy: 0.950020/32 [=================>............] - ETA: 0s - loss: 0.1686 - accuracy: 0.943232/32 [==============================] - 0s 5ms/step - loss: 0.1686 - accuracy: 0.9431 - val_loss: 0.3555 - val_accuracy: 0.9323
Epoch 18/20
 1/32 [..............................] - ETA: 0s - loss: 0.1455 - accuracy: 0.945320/32 [=================>............] - ETA: 0s - loss: 0.1548 - accuracy: 0.947932/32 [==============================] - 0s 5ms/step - loss: 0.1541 - accuracy: 0.9480 - val_loss: 0.3537 - val_accuracy: 0.9295
Epoch 19/20
 1/32 [..............................] - ETA: 0s - loss: 0.1501 - accuracy: 0.948020/32 [=================>............] - ETA: 0s - loss: 0.1433 - accuracy: 0.950832/32 [==============================] - 0s 5ms/step - loss: 0.1424 - accuracy: 0.9510 - val_loss: 0.3642 - val_accuracy: 0.9327
Epoch 20/20
 1/32 [..............................] - ETA: 0s - loss: 0.1170 - accuracy: 0.956720/32 [=================>............] - ETA: 0s - loss: 0.1333 - accuracy: 0.954432/32 [==============================] - 0s 5ms/step - loss: 0.1328 - accuracy: 0.9546 - val_loss: 0.3579 - val_accuracy: 0.9345
training_time: 0:00:04.380795
  1/313 [..............................] - ETA: 49s - loss: 0.0965 - accuracy: 0.9688 19/313 [>.............................] - ETA: 0s - loss: 0.4070 - accuracy: 0.9408  38/313 [==>...........................] - ETA: 0s - loss: 0.4981 - accuracy: 0.9227 57/313 [====>.........................] - ETA: 0s - loss: 0.5074 - accuracy: 0.9183 76/313 [======>.......................] - ETA: 0s - loss: 0.5508 - accuracy: 0.9141 96/313 [========>.....................] - ETA: 0s - loss: 0.5136 - accuracy: 0.9163115/313 [==========>...................] - ETA: 0s - loss: 0.5207 - accuracy: 0.9160134/313 [===========>..................] - ETA: 0s - loss: 0.5288 - accuracy: 0.9132153/313 [=============>................] - ETA: 0s - loss: 0.5345 - accuracy: 0.9140172/313 [===============>..............] - ETA: 0s - loss: 0.5010 - accuracy: 0.9188191/313 [=================>............] - ETA: 0s - loss: 0.4857 - accuracy: 0.9203211/313 [===================>..........] - ETA: 0s - loss: 0.4762 - accuracy: 0.9212231/313 [=====================>........] - ETA: 0s - loss: 0.4469 - accuracy: 0.9256252/313 [=======================>......] - ETA: 0s - loss: 0.4277 - accuracy: 0.9268272/313 [=========================>....] - ETA: 0s - loss: 0.4124 - accuracy: 0.9292292/313 [==========================>...] - ETA: 0s - loss: 0.3910 - accuracy: 0.9321313/313 [==============================] - ETA: 0s - loss: 0.4001 - accuracy: 0.9308313/313 [==============================] - 1s 3ms/step - loss: 0.4001 - accuracy: 0.9308
Test results: Loss = 0.40014687180519104, Accuracy = 0.9308000206947327
