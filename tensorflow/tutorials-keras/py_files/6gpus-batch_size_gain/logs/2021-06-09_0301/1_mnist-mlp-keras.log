Number of devices: 6
batch_size_per_replica: 250
batch_size: 1500 = 250 * 6
<class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'> <class 'numpy.ndarray'>
(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
60000 10000
Epoch 1/20
 1/32 [..............................] - ETA: 27s - loss: 111.1803 - accuracy: 0.112020/32 [=================>............] - ETA: 0s - loss: 42.6390 - accuracy: 0.3933  32/32 [==============================] - 1s 18ms/step - loss: 31.9128 - accuracy: 0.4790 - val_loss: 1.5697 - val_accuracy: 0.7291
Epoch 2/20
 1/32 [..............................] - ETA: 0s - loss: 1.5419 - accuracy: 0.734020/32 [=================>............] - ETA: 0s - loss: 1.4160 - accuracy: 0.688932/32 [==============================] - 0s 5ms/step - loss: 1.3548 - accuracy: 0.6881 - val_loss: 0.9957 - val_accuracy: 0.7779
Epoch 3/20
 1/32 [..............................] - ETA: 0s - loss: 0.9936 - accuracy: 0.780020/32 [=================>............] - ETA: 0s - loss: 0.9217 - accuracy: 0.780432/32 [==============================] - 0s 5ms/step - loss: 0.9063 - accuracy: 0.7815 - val_loss: 0.8038 - val_accuracy: 0.8208
Epoch 4/20
 1/32 [..............................] - ETA: 0s - loss: 0.7005 - accuracy: 0.824020/32 [=================>............] - ETA: 0s - loss: 0.7070 - accuracy: 0.824732/32 [==============================] - 0s 5ms/step - loss: 0.7040 - accuracy: 0.8257 - val_loss: 0.7112 - val_accuracy: 0.8364
Epoch 5/20
 1/32 [..............................] - ETA: 0s - loss: 0.5423 - accuracy: 0.846019/32 [================>.............] - ETA: 0s - loss: 0.6005 - accuracy: 0.849232/32 [==============================] - 0s 5ms/step - loss: 0.5958 - accuracy: 0.8504 - val_loss: 0.6302 - val_accuracy: 0.8597
Epoch 6/20
 1/32 [..............................] - ETA: 0s - loss: 0.4572 - accuracy: 0.867320/32 [=================>............] - ETA: 0s - loss: 0.5053 - accuracy: 0.864632/32 [==============================] - 0s 5ms/step - loss: 0.5015 - accuracy: 0.8670 - val_loss: 0.5809 - val_accuracy: 0.8707
Epoch 7/20
 1/32 [..............................] - ETA: 0s - loss: 0.4821 - accuracy: 0.868019/32 [================>.............] - ETA: 0s - loss: 0.4366 - accuracy: 0.876532/32 [==============================] - 0s 5ms/step - loss: 0.4320 - accuracy: 0.8793 - val_loss: 0.5430 - val_accuracy: 0.8853
Epoch 8/20
 1/32 [..............................] - ETA: 0s - loss: 0.3798 - accuracy: 0.895320/32 [=================>............] - ETA: 0s - loss: 0.3842 - accuracy: 0.892732/32 [==============================] - 0s 5ms/step - loss: 0.3822 - accuracy: 0.8937 - val_loss: 0.5145 - val_accuracy: 0.8948
Epoch 9/20
 1/32 [..............................] - ETA: 0s - loss: 0.3168 - accuracy: 0.905320/32 [=================>............] - ETA: 0s - loss: 0.3322 - accuracy: 0.910532/32 [==============================] - 0s 5ms/step - loss: 0.3302 - accuracy: 0.9111 - val_loss: 0.4854 - val_accuracy: 0.9005
Epoch 10/20
 1/32 [..............................] - ETA: 0s - loss: 0.2375 - accuracy: 0.932719/32 [================>.............] - ETA: 0s - loss: 0.2783 - accuracy: 0.920032/32 [==============================] - 0s 5ms/step - loss: 0.2823 - accuracy: 0.9198 - val_loss: 0.4705 - val_accuracy: 0.9082
Epoch 11/20
 1/32 [..............................] - ETA: 0s - loss: 0.2444 - accuracy: 0.927319/32 [================>.............] - ETA: 0s - loss: 0.2599 - accuracy: 0.926832/32 [==============================] - 0s 5ms/step - loss: 0.2607 - accuracy: 0.9265 - val_loss: 0.4584 - val_accuracy: 0.9118
Epoch 12/20
 1/32 [..............................] - ETA: 0s - loss: 0.2161 - accuracy: 0.940019/32 [================>.............] - ETA: 0s - loss: 0.2407 - accuracy: 0.931832/32 [==============================] - 0s 5ms/step - loss: 0.2400 - accuracy: 0.9316 - val_loss: 0.4417 - val_accuracy: 0.9147
Epoch 13/20
 1/32 [..............................] - ETA: 0s - loss: 0.2112 - accuracy: 0.938720/32 [=================>............] - ETA: 0s - loss: 0.2140 - accuracy: 0.936232/32 [==============================] - 0s 5ms/step - loss: 0.2139 - accuracy: 0.9366 - val_loss: 0.4339 - val_accuracy: 0.9196
Epoch 14/20
 1/32 [..............................] - ETA: 0s - loss: 0.1700 - accuracy: 0.950720/32 [=================>............] - ETA: 0s - loss: 0.1890 - accuracy: 0.944432/32 [==============================] - 0s 5ms/step - loss: 0.1921 - accuracy: 0.9435 - val_loss: 0.4294 - val_accuracy: 0.9228
Epoch 15/20
 1/32 [..............................] - ETA: 0s - loss: 0.1955 - accuracy: 0.943320/32 [=================>............] - ETA: 0s - loss: 0.1762 - accuracy: 0.945532/32 [==============================] - 0s 5ms/step - loss: 0.1765 - accuracy: 0.9460 - val_loss: 0.4198 - val_accuracy: 0.9247
Epoch 16/20
 1/32 [..............................] - ETA: 0s - loss: 0.1776 - accuracy: 0.938720/32 [=================>............] - ETA: 0s - loss: 0.1634 - accuracy: 0.946432/32 [==============================] - 0s 5ms/step - loss: 0.1630 - accuracy: 0.9474 - val_loss: 0.4162 - val_accuracy: 0.9261
Epoch 17/20
 1/32 [..............................] - ETA: 0s - loss: 0.1544 - accuracy: 0.948720/32 [=================>............] - ETA: 0s - loss: 0.1547 - accuracy: 0.951232/32 [==============================] - 0s 5ms/step - loss: 0.1543 - accuracy: 0.9517 - val_loss: 0.4100 - val_accuracy: 0.9281
Epoch 18/20
 1/32 [..............................] - ETA: 0s - loss: 0.1440 - accuracy: 0.952020/32 [=================>............] - ETA: 0s - loss: 0.1456 - accuracy: 0.953732/32 [==============================] - 0s 5ms/step - loss: 0.1442 - accuracy: 0.9543 - val_loss: 0.4238 - val_accuracy: 0.9278
Epoch 19/20
 1/32 [..............................] - ETA: 0s - loss: 0.1402 - accuracy: 0.952020/32 [=================>............] - ETA: 0s - loss: 0.1304 - accuracy: 0.957932/32 [==============================] - 0s 5ms/step - loss: 0.1306 - accuracy: 0.9582 - val_loss: 0.4090 - val_accuracy: 0.9320
Epoch 20/20
 1/32 [..............................] - ETA: 0s - loss: 0.1114 - accuracy: 0.965320/32 [=================>............] - ETA: 0s - loss: 0.1186 - accuracy: 0.962132/32 [==============================] - 0s 5ms/step - loss: 0.1193 - accuracy: 0.9621 - val_loss: 0.3992 - val_accuracy: 0.9330
training_time: 0:00:04.405702
  1/313 [..............................] - ETA: 47s - loss: 0.4976 - accuracy: 0.9688 20/313 [>.............................] - ETA: 0s - loss: 0.2985 - accuracy: 0.9406  39/313 [==>...........................] - ETA: 0s - loss: 0.4285 - accuracy: 0.9247 58/313 [====>.........................] - ETA: 0s - loss: 0.4983 - accuracy: 0.9192 77/313 [======>.......................] - ETA: 0s - loss: 0.5594 - accuracy: 0.9115 96/313 [========>.....................] - ETA: 0s - loss: 0.5348 - accuracy: 0.9160115/313 [==========>...................] - ETA: 0s - loss: 0.5149 - accuracy: 0.9190134/313 [===========>..................] - ETA: 0s - loss: 0.5224 - accuracy: 0.9174153/313 [=============>................] - ETA: 0s - loss: 0.5241 - accuracy: 0.9171171/313 [===============>..............] - ETA: 0s - loss: 0.4860 - accuracy: 0.9220191/313 [=================>............] - ETA: 0s - loss: 0.4834 - accuracy: 0.9233211/313 [===================>..........] - ETA: 0s - loss: 0.4660 - accuracy: 0.9252231/313 [=====================>........] - ETA: 0s - loss: 0.4380 - accuracy: 0.9290251/313 [=======================>......] - ETA: 0s - loss: 0.4150 - accuracy: 0.9316271/313 [========================>.....] - ETA: 0s - loss: 0.3993 - accuracy: 0.9330290/313 [==========================>...] - ETA: 0s - loss: 0.3859 - accuracy: 0.9358310/313 [============================>.] - ETA: 0s - loss: 0.3974 - accuracy: 0.9349313/313 [==============================] - 1s 3ms/step - loss: 0.3967 - accuracy: 0.9347
Test results: Loss = 0.3967321217060089, Accuracy = 0.9347000122070312
